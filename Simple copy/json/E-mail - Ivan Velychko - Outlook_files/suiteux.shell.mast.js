var shellPerformance=window.performance,HighResolutionTimingSupported=!!shellPerformance&&"function"==typeof shellPerformance.mark;HighResolutionTimingSupported&&shellPerformance.mark("shell_mast_start"),(self.suiteux_shell_webpackJsonp_main=self.suiteux_shell_webpackJsonp_main||[]).push([["mast"],{42005:function(t,e,n){"use strict";
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var i;n.d(e,{X:function(){return i},v:function(){return r}}),function(t){t[t.CRITICAL=1]="CRITICAL",t[t.WARNING=2]="WARNING"}(i||(i={}));var r={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99}},64551:function(t,e,n){"use strict";n.d(e,{Tr:function(){return p}});var i=n(54899),r=n(83370);function o(t,e){return typeof t===e}function s(t){return o(t,i.jA)||void 0===t}function a(t){return s(t)||null===t}function u(t,e){return t&&Object[i.hB].hasOwnProperty.call(t,e)}function c(t){return o(t,i.fK)}function l(t){return o(t,i.cb)}function f(t,e,n,i){void 0===i&&(i=!1);var r=!1;if(!a(t))try{a(t.addEventListener)?a(t.attachEvent)||(t.attachEvent("on"+e,n),r=!0):(t.addEventListener(e,n,i),r=!0)}catch(t){}return r}function d(t,e,n,i){if(void 0===i&&(i=!1),!a(t))try{a(t.removeEventListener)?a(t.detachEvent)||t.detachEvent("on"+e,n):t.removeEventListener(e,n,i)}catch(t){}}var p=function(){function t(){}return t.isDate=function(t){return"[object Date]"===Object[i.hB].toString.call(t)},t.isString=function(t){return o(t,"string")},t.isNumber=function(t){return o(t,"number")},t.isBoolean=function(t){return o(t,"boolean")},t.disableCookies=function(){t._canUseCookies=!1},t.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(h,(function(t){var e=0|function(){var t=(0,r.MX)();return t?t.getRandomValues(new Uint8Array(1))[0]%16:16*Math.random()}();return("x"===t?e:3&e|8).toString(16)}))},t.toISOString=function(e){if(t.isDate(e)){var n=function(t){var e=String(t);return 1===e.length&&(e="0"+e),e};return e.getUTCFullYear()+"-"+n(e.getUTCMonth()+1)+"-"+n(e.getUTCDate())+"T"+n(e.getUTCHours())+":"+n(e.getUTCMinutes())+":"+n(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}},t.arrForEach=function(t,e,n){for(var i=t.length,r=0;r<i;++r)r in t&&e.call(n||t,t[r],r,t)},t.arrIndexOf=function(t,e,n){for(var i=t.length,r=n||0,o=Math.max(r>=0?r:i-Math.abs(r),0);o<i;o++)if(o in t&&t[o]===e)return o;return-1},t.arrMap=function(t,e,n){for(var i=t.length,r=n||t,o=new Array(i),s=0;s<i;s++)s in t&&(o[s]=e.call(r,t[s],t));return o},t.arrReduce=function(t,e,n){var i,r=t.length,o=0;if(arguments.length>=3)i=arguments[2];else{for(;o<r&&!(o in t);)o++;i=t[o++]}for(;o<r;)o in t&&(i=e(i,t[o],o,t)),o++;return i},t.strTrim=function(e){return t.isString(e)?e.replace(/^\s+|\s+$/g,""):e},t.objKeys=function(t){var e=!{toString:null}.propertyIsEnumerable("toString");if(!(l(t)||c(t)&&null!==t))throw new TypeError("objKeys called on non-object");var n=[];for(var i in t)u(t,i)&&n.push(i);if(e)for(var r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],o=r.length,s=0;s<o;s++)u(t,r[s])&&n.push(r[s]);return n},t.objDefineAccessors=function(t,e,n,i){var r=Object.defineProperty;if(r)try{var o={enumerable:!0,configurable:!0};return n&&(o.get=n),i&&(o.set=i),r(t,e,o),!0}catch(t){}return!1},t.addEventHandler=function(t,e){var n=!1,i=(0,r.Jj)();i&&(n=f(i,t,e),n=f(i.body,t,e)||n);var o=(0,r.Me)();return o&&(n=g.Attach(o,t,e)||n),n},t.isTypeof=o,t.isUndefined=s,t.isNullOrUndefined=a,t.hasOwnProperty=u,t.isFunction=l,t.isObject=c,t.objCreate=i.pu,t}(),h=/[xy]/g,g=function(){function t(){}return t.Attach=f,t.AttachEvent=f,t.Detach=d,t.DetachEvent=d,t}()},83370:function(t,e,n){"use strict";n.d(e,{Ym:function(){return c},Jj:function(){return l},Me:function(){return f},d6:function(){return d},jW:function(){return p},nS:function(){return h},xA:function(){return g},MX:function(){return v}});var i=n(54899),r=i.fK,o="window",s="JSON",a=i.Rd;
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
function u(t){var e=a();return e&&e[t]?e[t]:t===o&&c()?window:null}function c(){return Boolean(typeof window===r&&window)}function l(){return c()?window:u(o)}function f(){return Boolean(typeof document===r&&document)?document:u("document")}function d(){return Boolean(typeof navigator===r&&navigator)}function p(){return d()?navigator:u("navigator")}function h(){return Boolean(typeof JSON===r&&JSON||null!==u(s))}function g(){return h()?JSON||u(s):null}function v(){return u("crypto")}},54899:function(t,e,n){"use strict";n.d(e,{cb:function(){return i},fK:function(){return r},jA:function(){return o},hB:function(){return s},Rd:function(){return a},pu:function(){return u}});
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var i="function",r="object",o="undefined",s="prototype";function a(){return typeof globalThis!==o&&globalThis?globalThis:typeof self!==o&&self?self:typeof window!==o&&window?window:typeof n.g!==o&&n.g?n.g:null}function u(t){var e=Object.create;if(e)return e(t);if(null==t)return{};var n=typeof t;if(n!==r&&n!==i)throw new TypeError("Object prototype may only be an Object:"+t);function o(){}return o[s]=t,new o}var c=function(t,e){return c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},c(t,e)};var l,f,d,p=a()||{};f=function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object[s].hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},d=function(t,e){function n(){this.constructor=t}c(t,e),t[s]=null===e?u(e):(n[s]=e[s],new n)},(l=p).__assign=l.__assign||Object.assign||f,l.__extends=l.__extends||d,__assign=p.__assign,__extends=p.__extends},70430:function(t,e,n){"use strict";n.d(e,{zU:function(){return r},vi:function(){return o},p3:function(){return s}});var i=n(42005),r={Normal:1,CostDeferred:2,RealTime:3},o={Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9},s=__assign({},i.v,{AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517});
/**
* Enums.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2018
* File containing the enums as constants.
*/},61630:function(t,e,n){"use strict";n.d(e,{vs:function(){return s},tO:function(){return v},FY:function(){return y},nd:function(){return m},dH:function(){return S},Sn:function(){return T},HD:function(){return C},jM:function(){return E},MF:function(){return P},r7:function(){return A},yj:function(){return I},CM:function(){return k},b$:function(){return F},cp:function(){return x},kJ:function(){return N},Vv:function(){return O},d8:function(){return L},hK:function(){return M},c9:function(){return R},if:function(){return B},k$:function(){return H}});var i=n(70430),r=n(64551),o=n(83370),s="1DS-Web-JS-2.3.4",a="undefined",u=i.vi,c=null;function l(t,e){return typeof t===e}function f(t){return void 0===t||l(t,"undefined")}function d(t){return f(t)||null===t}function p(t){return!f(t)}var h,g=null,v=r.Tr.arrForEach,y=(r.Tr.arrIndexOf,r.Tr.arrMap,r.Tr.arrReduce,r.Tr.objKeys);r.Tr.toISOString;function m(t){return C(t)?t.replace(/^\s+|\s+$/g,""):t}var _=Boolean((0,o.Me)()),S=Boolean((0,o.Jj)());function T(t){return!(d(t)||""===t)}function C(t){return l(t,"string")}function w(t){return l(t,"number")}function b(t){return l(t,"boolean")}function E(t){if(t){var e=t.indexOf("-");if(e>-1)return t.substring(0,e)}return""}function P(){return null===g&&(g=(0,o.d6)()&&Boolean((0,o.jW)().sendBeacon)),g}function A(t){return!!(t&&w(t)&&t>=1&&t<=3)}function I(t,e,n){if(!C(t)||d(e)||""===e)return null;if(C(e)||w(e)||b(e)||N(e))e={value:e};else if("object"!=typeof e||e.hasOwnProperty("value")){if(d(e.value)||""===e.value||!C(e.value)&&!w(e.value)&&!b(e.value)&&!N(e.value))return null}else e={value:n?JSON.stringify(e):e};if(N(e.value)&&!(e.value.length>0))return null;if(p(e.kind)){if(N(e.value)||!function(t){if(t&&w(t)&&(t>=0&&t<=13||32===t))return!0;return!1}(e.kind))return null;e.value=e.value.toString()}return e}function k(t){return t.getUTCFullYear()+"-"+U(t.getUTCMonth()+1)+"-"+U(t.getUTCDate())+"T"+U(t.getUTCHours())+":"+U(t.getUTCMinutes())+":"+U(t.getUTCSeconds())+"."+function(t){if(t<10)return"00"+t;if(t<100)return"0"+t;return t.toString()}(t.getUTCMilliseconds())+"Z"}function F(){var t=(0,o.jW)();return!(!t||!t.product)&&"ReactNative"===t.product}function x(){if(p(XMLHttpRequest)){var t=new XMLHttpRequest;return Boolean(f(t.withCredentials)&&p(XDomainRequest))}}function N(t){return t instanceof Array}function O(t,e,n){var i=-1;return f(t)?i:(e&&e>0&&(32===e?i=1<<13:e<=13&&(i=e<<5)),p(n)&&function(t){if(w(t)&&t>=0&&t<=9)return!0;return!1}(n)?(-1===i&&(i=0),i|n):(N(t)&&(t=t[0]),-1!==i?i|function(t){if(f(t))return-1;if(w(t))return u.Double;if(C(t))return u.String;if(b(t))return u.Bool;return-1}(t):w(t)?u.Double:i))}function D(){if(void 0===h){h=!1;try{var t=(0,o.Me)(),e=(0,o.jW)();t&&!f(t.cookie)&&e&&e.cookieEnabled&&(h=!0)}catch(t){}}return h}function L(t,e,n){if(D()){var i="",r=H();r&&"https:"===r.protocol&&(i=";secure",null===c&&(c=function(t){return!!C(t)&&(-1!==t.indexOf("CPU iPhone OS 12")||-1!==t.indexOf("iPad; CPU OS 12")||-1!==t.indexOf("Macintosh; Intel Mac OS X 10_14")&&-1!==t.indexOf("Version/")&&-1!==t.indexOf("Safari")||-1!==t.indexOf("Macintosh; Intel Mac OS X 10_14")&&(n="AppleWebKit/605.1.15 (KHTML, like Gecko)",i=(e=t).length,r=i-n.length,e.substring(r>=0?r:0,i)===n)||-1!==t.indexOf("Chrome/5")||-1!==t.indexOf("Chrome/6")||-1!==t.indexOf("UnrealEngine")&&-1===t.indexOf("Chrome")||-1!==t.indexOf("UCBrowser/12")||-1!==t.indexOf("UCBrowser/11"));var e,n,i,r}(((0,o.jW)()||{}).userAgent)),c||(e+=";SameSite=None"));var s=new Date;s.setTime(s.getTime()+24*n*60*60*1e3);var a="; expires="+s.toUTCString();(0,o.Me)().cookie=t+"="+e+a+"; path=/"+i}}function M(){var t=Q(j);return t?t.now():(new Date).getTime()}function U(t){return t<10?"0"+t:t.toString()}r.Tr.objDefineAccessors;function R(t){var e=z("beforeunload",t);return e=z("unload",t)||e,e=z("pagehide",t)||e}function B(t,e){var n=t;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[e]=M()}function z(t,e){var n=!1;if(S){var i=window;n=K.Attach(i,t,e),n=K.Attach(i.body,t,e)||n}return _&&(n=K.Attach(document,t,e)||n),n}function q(t,e,n,i){void 0===i&&(i=!1);var r=!1;if(!d(t))try{d(t.addEventListener)?d(t.attachEvent)||(t.attachEvent("on"+e,n),r=!0):(t.addEventListener(e,n,i),r=!0)}catch(t){}return r}var K=function(){function t(){}return t.Attach=q,t}(),j="performance";function Q(t){var e=typeof globalThis!==a&&globalThis?globalThis:typeof self!==a&&self?self:typeof window!==a&&window?window:typeof n.g!==a&&n.g?n.g:null;return e&&e[t]?e[t]:"window"===t&&(0,o.Ym)()?window:null}function H(){return"object"==typeof location&&location?location:Q("location")}},12360:function(t,e,n){"use strict";n.d(e,{d:function(){return u}});var i=n(98588),r=n(57386);function o(t,e){return{name:t,dataType:i._.String,value:e,classification:r.H.SystemMetadata}}var s=n(78920),a=n(47964),u=function(){function t(t,e){this._totalEventsInLastInterval=0,this._singleEventInLastInterval={},this._sinkName=t,this._lastIntervalStart=Date.now(),this._maxNamedEventsPerSecond={},this._oneDSSink=e}return t.prototype.setSingleEventThrottle=function(t){this._maxSingleEventPerSecond=t},t.prototype.setTotalEventThrottle=function(t){this._maxTotalEventsPerSecond=t},t.prototype.setNamedEventThrottle=function(t,e){this._maxNamedEventsPerSecond[t]=e},t.prototype.processEvent=function(t){var e=!0;return Date.now()-this._lastIntervalStart>1e3&&(this._lastIntervalStart=Date.now(),this._totalEventsInLastInterval=0,this._singleEventInLastInterval={}),this._singleEventInLastInterval[t.eventName]=this._singleEventInLastInterval[t.eventName]+1||1,t.eventName in this._maxNamedEventsPerSecond?e=this.applyThrottle(this._singleEventInLastInterval[t.eventName],this._maxNamedEventsPerSecond[t.eventName],"MaxNamedEventsPerSecond",t.eventName):this._maxSingleEventPerSecond&&(e=this.applyThrottle(this._singleEventInLastInterval[t.eventName],this._maxSingleEventPerSecond,"MaxSingleEventsPerSecond",t.eventName)),this._maxTotalEventsPerSecond&&(this._totalEventsInLastInterval++,e&&(e=this.applyThrottle(this._totalEventsInLastInterval,this._maxTotalEventsPerSecond,"MaxTotalEventsPerSecond",t.eventName))),e},t.prototype.applyThrottle=function(t,e,n,u){if(t>e){if(t===e+1){var c={eventName:"Office.Telemetry.OTelJS.EventThrottled",telemetryProperties:{ariaTenantToken:a.i9,nexusTenantToken:1723},dataFields:[o("SinkName",this._sinkName),o("ThrottledEvent.Name",u),(l=n,f=e,{name:l,dataType:i._.Int64,value:f,classification:r.H.SystemMetadata})]};this._oneDSSink.sendEventInternal(c)}return(0,s.uf)(s.in.Info,s.WD.Sink,(function(){return"1DS Sink Event Throttle: Exceeded "+e+" "+n+": "+u})),!1}var l,f;return!0},t}()},47964:function(t,e,n){"use strict";n.d(e,{i9:function(){return l},Zv:function(){return f},qI:function(){return p}});var i=n(70430),r=n(61630),o=n(57386),s=n(98588),a=function(){return a=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},a.apply(this,arguments)},u="Data.",c=0,l="f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405";function f(t,e,n){var o=p(t.dataFields,!0);return o["Event.Sequence"]={value:++c,propertyType:i.vi.Int64},o["Event.Name"]=t.eventName,o["Event.Source"]="OTelJS",o["Event.Time"]={value:(0,r.CM)(d(n)),propertyType:i.vi.DateTime},e&&(o["Event.Id"]=e+"."+c),t.eventContract&&(o["Event.Contract"]=t.eventContract.name,o=a(a({},o),p(t.eventContract.dataFields,!1))),o}function d(t){return t?new Date(t):new Date}function p(t,e){var n={};return t&&t.forEach((function(t){if(!t.classification||t.classification===o.H.SystemMetadata||t.classification===o.H.EssentialServiceMetadata){var r,a;switch(r=e?"zC."===t.name.substr(0,3)?"zC.Data."+t.name.substr(3):u+t.name:t.name,t.dataType){case s._.Double:a=i.vi.Double;break;case s._.Int64:a=i.vi.Int64;break;case s._.Guid:a=i.vi.Guid;break;case s._.Boolean:case s._.String:default:return void(n[r]=t.value)}var c={value:t.value,propertyType:a};n[r]=c}})),n}},71246:function(t,e,n){"use strict";var i;n.d(e,{x:function(){return i}}),function(t){t.USGOV_DOD="https://pf.events.data.cloudapp.onecollector.akadns.net/OneCollector/1.0/",t.USGOV_DOJ="https://tb.events.data.cloudapp.onecollector.akadns.net/OneCollector/1.0/",t.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/"}(i||(i={}))},96791:function(t,e,n){"use strict";n.d(e,{a:function(){return Rt}});var i=n(78920),r=n(42005),o=n(64551),s=n(83370),a=function(){function t(e,n,i,r){void 0===i&&(i=!1),this.messageId=e,this.message=(i?t.AiUserActionablePrefix:t.AiNonUserActionablePrefix)+e;var o="";(0,s.nS)()&&(o=(0,s.xA)().stringify(r));var a=(n?" message:"+t.sanitizeDiagnosticText(n):"")+(r?" props:"+t.sanitizeDiagnosticText(o):"");this.message+=a}return t.sanitizeDiagnosticText=function(t){return t?'"'+t.replace(/\"/g,"")+'"':""},t.dataType="MessageData",t.AiNonUserActionablePrefix="AI (Internal): ",t.AiUserActionablePrefix="AI: ",t}(),u=function(){function t(t){this.queue=[],this.AIInternalMessagePrefix="AITR_",this._messageCount=0,this._messageLogged={},this.enableDebugExceptions=function(){return!1},this.consoleLoggingLevel=function(){return 0},this.telemetryLoggingLevel=function(){return 1},this.maxInternalMessageLimit=function(){return 25},o.Tr.isNullOrUndefined(t)||(o.Tr.isNullOrUndefined(t.loggingLevelConsole)||(this.consoleLoggingLevel=function(){return t.loggingLevelConsole}),o.Tr.isNullOrUndefined(t.loggingLevelTelemetry)||(this.telemetryLoggingLevel=function(){return t.loggingLevelTelemetry}),o.Tr.isNullOrUndefined(t.maxMessageLimit)||(this.maxInternalMessageLimit=function(){return t.maxMessageLimit}),o.Tr.isNullOrUndefined(t.enableDebugExceptions)||(this.enableDebugExceptions=function(){return t.enableDebugExceptions}))}return t.prototype.throwInternal=function(t,e,n,i,s){void 0===s&&(s=!1);var u=new a(e,n,s,i),c=this;if(c.enableDebugExceptions())throw u;if(!o.Tr.isUndefined(u)&&u&&!o.Tr.isUndefined(u.message)){if(s){var l=+u.messageId;!c._messageLogged[l]&&c.consoleLoggingLevel()>=r.X.WARNING&&(c.warnToConsole(u.message),c._messageLogged[l]=!0)}else c.consoleLoggingLevel()>=r.X.WARNING&&c.warnToConsole(u.message);c.logInternalMessage(t,u)}},t.prototype.warnToConsole=function(t){!o.Tr.isUndefined(console)&&console&&(o.Tr.isFunction(console.warn)||o.Tr.isFunction(console.log))},t.prototype.resetInternalMessageCount=function(){this._messageCount=0,this._messageLogged={}},t.prototype.logInternalMessage=function(t,e){var n=this;if(!n._areInternalMessagesThrottled()){var i=!0,o=n.AIInternalMessagePrefix+e.messageId;if(n._messageLogged[o]?i=!1:n._messageLogged[o]=!0,i&&(t<=n.telemetryLoggingLevel()&&(n.queue.push(e),n._messageCount++),n._messageCount===n.maxInternalMessageLimit())){var s="Internal events throttle limit per PageView reached for this app.",u=new a(r.v.MessageLimitPerPVExceeded,s,!1);n.queue.push(u),n.warnToConsole(s)}}},t.prototype._areInternalMessagesThrottled=function(){return this._messageCount>=this.maxInternalMessageLimit()},t}(),c=o.Tr.isFunction,l=function(t,e){var n=this,i=null,o=c(t.processTelemetry),s=c(t.setNextPlugin);n._hasRun=!1,n.getPlugin=function(){return t},n.getNext=function(){return i},n.setNext=function(t){i=t},n.processTelemetry=function(a,u){if(u||(u=e),t&&o){n._hasRun=!0;try{u.setNext(i),s&&t.setNextPlugin(i),i&&(i._hasRun=!1),t.processTelemetry(a,u)}catch(e){var c=i&&i._hasRun;i&&c||u.diagLog().throwInternal(r.X.CRITICAL,r.v.PluginException,"Plugin ["+t.identifier+"] failed during processTelemetry - "+e),i&&!c&&i.processTelemetry(a,u)}}else i&&(n._hasRun=!0,i.processTelemetry(a,u))}},f=o.Tr.isNullOrUndefined;function d(t,e){var n=[];if(t&&t.length>0)for(var i=null,r=0;r<t.length;r++){var s=t[r];if(s&&o.Tr.isFunction(s.processTelemetry)){var a=new l(s,e);n.push(a),i&&i.setNext(a),i=a}}return n.length>0?n[0]:null}var p=function t(e,n,i,r){var s=this,a=null;null!==r&&(e&&o.Tr.isFunction(e.getPlugin)?a=function(t,e,n){var i=[],r=!n;if(t)for(;t;){var o=t.getPlugin();(r||o===n)&&(r=!0,i.push(o)),t=t.getNext()}return r||i.push(n),d(i,e)}(e,s,r||e.getPlugin()):r?a=function(t,e,n){var i=t,r=!1;return n&&t&&(i=[],o.Tr.arrForEach(t,(function(t){(r||t===n)&&(r=!0,i.push(t))}))),n&&!r&&(i||(i=[]),i.push(n)),d(i,e)}(e,s,r):o.Tr.isUndefined(r)&&(a=d(e,s))),s.core=function(){return i},s.diagLog=function(){var t=(i||{}).logger;return t||(t=new u(n||{})),t},s.getCfg=function(){return n},s.getExtCfg=function(t,e){var i;if(void 0===e&&(e={}),n){var r=n.extensionConfig;r&&t&&(i=r[t])}return i||e},s.getConfig=function(t,e,i){var r;void 0===i&&(i=!1);var o=s.getExtCfg(t,null);return o&&!f(o[e])?r=o[e]:n&&!f(n[e])&&(r=n[e]),f(r)?i:r},s.hasNext=function(){return null!=a},s.getNext=function(){return a},s.setNext=function(t){a=t},s.processNext=function(t){var e=a;e&&(a=e.getNext(),e.processTelemetry(t,s))},s.createNew=function(e,r){return void 0===e&&(e=null),new t(e||a,n,i,r)}},h=o.Tr.isFunction,g=function(){function t(){var t=this,e=!1,n=null,i=null;t.core=null,t.diagLog=function(e){return t._getTelCtx(e).diagLog()},t.isInitialized=function(){return e},t.setInitialized=function(t){e=t},t.setNextPlugin=function(t){i=t},t.processNext=function(t,e){e?e.processNext(t):i&&h(i.processTelemetry)&&i.processTelemetry(t,null)},t._getTelCtx=function(e){void 0===e&&(e=null);var r=e;if(!r){var o=n||new p(null,{},t.core);r=i&&i.getPlugin?o.createNew(null,i.getPlugin):o.createNew(null,i)}return r},t._baseTelInit=function(r,o,s,a){r&&(r.extensionConfig=r.extensionConfig||[]),!a&&o&&(a=o.getProcessTelContext().getNext());var u=i;i&&i.getPlugin&&(u=i.getPlugin()),t.core=o,n=new p(a,r,o,u),e=!0}}return t.prototype.initialize=function(t,e,n,i){this._baseTelInit(t,e,n,i)},t}(),v=o.Tr.isFunction;function y(t,e){for(var n=[],i=null,r=t.getNext();r;){var s=r.getPlugin();s&&(i&&v(i.setNextPlugin)&&v(s.processTelemetry)&&i.setNextPlugin(s),v(s.isInitialized)&&s.isInitialized()||n.push(s),i=s,r=r.getNext())}o.Tr.arrForEach(n,(function(n){n.initialize(t.getCfg(),t.core(),e,t.getNext())}))}function m(t){return t.sort((function(t,e){var n=0,i=v(e.processTelemetry);return v(t.processTelemetry)?n=i?t.priority-e.priority:1:i&&(n=-1),n}))}
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var _=500,S=o.Tr.arrForEach,T=o.Tr.objDefineAccessors;function C(t,e){e&&e.length>0&&(function(t){S(t,(function(t){if(t.priority<_)throw Error("Channel has invalid priority"+t.identifier)}))}(e=e.sort((function(t,e){return t.priority-e.priority}))),t.push(e))}var w=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.identifier="ChannelControllerPlugin",e.priority=_,e}return __extends(e,t),e.prototype.processTelemetry=function(t,e){var n=this;this._channelQueue&&S(this._channelQueue,(function(i){i.length>0&&n._getTelCtx(e).createNew(i).processNext(t)}))},e.prototype.getChannelControls=function(){return this._channelQueue},e.prototype.initialize=function(e,n,i){if(!this.isInitialized()){t.prototype.initialize.call(this,e,n,i),e.isCookieUseDisabled&&o.Tr.disableCookies();var r=this._channelQueue=function(t,e){var n=[];if(t&&S(t,(function(t){return C(n,t)})),e){var i=[];S(e,(function(t){t.priority>_&&i.push(t)})),C(n,i)}return n}((e||{}).channels,i);S(r,(function(t){return y(new p(t,e,n),i)}))}},e._staticInit=(T(e.prototype,"ChannelControls",e.prototype.getChannelControls),void T(e.prototype,"channelQueue",e.prototype.getChannelControls)),e}(g),b=o.Tr.arrForEach,E=o.Tr.isNullOrUndefined,P=function(){function t(){var t=!1,e=this;e._extensions=new Array,e._channelController=new w,e.isInitialized=function(){return t},e._setInit=function(e){t=e},e._eventQueue=[]}return t.prototype.initialize=function(t,e,n,i){var r=this;if(r.isInitialized())throw Error("Core should not be initialized more than once");if(!t||E(t.instrumentationKey))throw Error("Please provide instrumentation key");r.config=t;var s=r._channelController;i||(i=o.Tr.objCreate({addNotificationListener:function(t){},removeNotificationListener:function(t){},eventsSent:function(t){},eventsDiscarded:function(t,e){},eventsSendRequest:function(t,e){}})),r._notificationManager=i,t.extensions=E(t.extensions)?[]:t.extensions,(t.extensionConfig=E(t.extensionConfig)?{}:t.extensionConfig).NotificationManager=i,n||(n=o.Tr.objCreate({throwInternal:function(t,e,n,i,r){void 0===r&&(r=!1)},warnToConsole:function(t){},resetInternalMessageCount:function(){}})),r.logger=n;var a=[];a.push.apply(a,e.concat(t.extensions)),a=m(a);var u=[],c=[],l={};if(b(a,(function(t){if(E(t)||E(t.initialize))throw Error("Extensions must provide callback to initialize");var e=t.priority,i=t.identifier;t&&e&&(E(l[e])?l[e]=i:n.warnToConsole("Two extensions have same priority #"+e+" - "+l[e]+", "+i)),!e||e<s.priority?u.push(t):c.push(t)})),a.push(s),u.push(s),a=m(a),r._extensions=a,y(new p([s],t,r),a),y(new p(u,t,r),a),r._extensions=u,0===r.getTransmissionControls().length)throw new Error("No channels available");r._setInit(!0)},t.prototype.getTransmissionControls=function(){return this._channelController.getChannelControls()},t.prototype.track=function(t){var e=this;t.iKey||(t.iKey=e.config.instrumentationKey),t.time||(t.time=o.Tr.toISOString(new Date)),E(t.ver)&&(t.ver="4.0"),e.isInitialized()?(e._eventQueue.length>0&&(b(e._eventQueue,(function(t){e.getProcessTelContext().processNext(t)})),e._eventQueue=[]),e.getProcessTelContext().processNext(t)):e._eventQueue.push(t)},t.prototype.getProcessTelContext=function(){var t=this,e=t._extensions,n=e;return e&&0!==e.length||(n=[t._channelController]),new p(n,t.config,t)},t}(),A=1,I=2,k=3,F=4,x=5,N=function(){function t(){this.listeners=[]}return t.prototype.addNotificationListener=function(t){this.listeners.push(t)},t.prototype.removeNotificationListener=function(t){for(var e=o.Tr.arrIndexOf(this.listeners,t);e>-1;)this.listeners.splice(e,1),e=o.Tr.arrIndexOf(this.listeners,t)},t.prototype.eventsSent=function(t){for(var e=this,n=function(n){i.listeners[n].eventsSent&&setTimeout((function(){return e.listeners[n].eventsSent(t)}),0)},i=this,r=0;r<this.listeners.length;++r)n(r)},t.prototype.eventsDiscarded=function(t,e){for(var n=this,i=function(i){r.listeners[i].eventsDiscarded&&setTimeout((function(){return n.listeners[i].eventsDiscarded(t,e)}),0)},r=this,o=0;o<this.listeners.length;++o)i(o)},t.prototype.eventsSendRequest=function(t,e){for(var n=this,i=function(i){if(r.listeners[i].eventsSendRequest)if(e)setTimeout((function(){return n.listeners[i].eventsSendRequest(t,e)}),0);else try{r.listeners[i].eventsSendRequest(t,e)}catch(t){}},r=this,o=0;o<this.listeners.length;++o)i(o)},t}(),O=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initialize=function(e,n){var i=this;i._notificationManager=new N,i.logger=new u(e),i.config=e,t.prototype.initialize.call(this,e,n,i.logger,i._notificationManager)},e.prototype.getTransmissionControls=function(){return t.prototype.getTransmissionControls.call(this)},e.prototype.track=function(e){if(null===e)throw this._notifyInvalidEvent(e),Error("Invalid telemetry item");this._validateTelemetryItem(e),t.prototype.track.call(this,e)},e.prototype.addNotificationListener=function(t){this._notificationManager&&this._notificationManager.addNotificationListener(t)},e.prototype.removeNotificationListener=function(t){this._notificationManager&&this._notificationManager.removeNotificationListener(t)},e.prototype.pollInternalLogs=function(t){var e=this,n=this.config.diagnosticLogInterval;return n&&n>0||(n=1e4),setInterval((function(){var n=e,i=n.logger?n.logger.queue:[];o.Tr.arrForEach(i,(function(e){var i={name:t||"InternalMessageId: "+e.messageId,iKey:n.config.instrumentationKey,time:o.Tr.toISOString(new Date),baseType:a.dataType,baseData:{message:e.message}};n.track(i)})),i.length=0}),n)},e.prototype._validateTelemetryItem=function(t){if(o.Tr.isNullOrUndefined(t.name))throw this._notifyInvalidEvent(t),Error("telemetry name required")},e.prototype._notifyInvalidEvent=function(t){this._notificationManager&&this._notificationManager.eventsDiscarded([t],I)},e}(P),D=n(70430),L=n(61630),M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pluginVersionStringArr=[],e.pluginVersionString="",e}return __extends(e,t),e.prototype.initialize=function(e,n){if(e){e.endpointUrl||(e.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var i=e.propertyStorageOverride;if(i&&(!i.getProperty||!i.setProperty))throw"Invalid property storage override passed.";if(e.channels)for(var o=0;o<e.channels.length;o++)if(e.channels[o])for(var s=0;s<e.channels[o].length;s++){var a=e.channels[o][s];if(a.identifier&&a.version){var u=a.identifier+"="+a.version;this.pluginVersionStringArr.push(u)}}}if(this.getWParam=function(){return"undefined"!=typeof document?0:-1},n)for(o=0;o<n.length;o++){var c=n[o];if(c.identifier&&c.version){u=c.identifier+"="+c.version;this.pluginVersionStringArr.push(u)}}this.pluginVersionString=this.pluginVersionStringArr.join(";");try{t.prototype.initialize.call(this,e,n)}catch(t){this.logger.throwInternal(r.X.CRITICAL,D.p3.ErrorProvidedChannels,"Channels must be provided through config.channels only")}this.pollInternalLogs("InternalLog")},e.prototype.track=function(e){var n=e;if(n){n.timings=n.timings||{},n.timings.trackStart=(0,L.hK)(),(0,L.r7)(n.latency)||(n.latency=D.zU.Normal);var i=n.ext=n.ext||{};i.sdk=i.sdk||{},i.sdk.ver=L.vs;var r=n.baseData=n.baseData||{};r.properties||(r.properties={});var o=r.properties;o.version||(o.version=""),""!=this.pluginVersionString&&(o.version=this.pluginVersionString)}t.prototype.track.call(this,n)},e}(O),U=M,R="REAL_TIME",B=function(){function t(){}return t.getPayloadBlob=function(t,e){var n="",i={};for(var r in t)if(t.hasOwnProperty(r))for(var o=0;o<t[r].length;++o){n&&(n+="\n");var s=n.length;if((n+=this.getEventBlob(t[r][o])).length-s>2e6&&(e&&e.eventsDiscarded([t[r][o]],k),delete t[r][o],n=n.substring(0,s)),n.length>3984588){i={};var a=t[r];t[r]=a.splice(0,o),i[r]=a;break}}return{payloadBlob:n,remainingRequest:i}},t.getEventBlob=function(t){var e={};if(e.name=t.name,e.time=t.time,e.ver=t.ver,e.iKey="o:"+(0,L.jM)(t.iKey),t.ext)for(var n in e.ext={},t.ext)if(t.ext.hasOwnProperty(n))for(var i in e.ext[n]={},t.ext[n])t.ext[n].hasOwnProperty(i)&&t.ext[n][i]&&(e.ext[n][i]=(0,L.yj)(i,t.ext[n][i]).value);if(e.data={},e.data.baseData={},e.data.baseType=t.baseType,t.baseData)for(var n in t.baseData)if(t.baseData.hasOwnProperty(n)){var r=(0,L.yj)(n,t.baseData[n]);z(e.data.baseData,n,r),q(e.ext,"baseData."+n,r)}if(t.data)for(var n in t.data)if(t.data.hasOwnProperty(n)){r=(0,L.yj)(n,t.data[n]);z(e.data,n,r),q(e.ext,n,r)}return JSON.stringify(e)},t}();function z(t,e,n){if(n){for(var i=t,r=e.split("."),o=0;o<r.length-1;++o)i[r[o]]||(i[r[o]]={}),i=i[r[o]];i[r[r.length-1]]=n.value}}function q(t,e,n){if(n){var i=(0,L.Vv)(n.value,n.kind,n.propertyType);if(i>-1){var r=t;r.metadata||(r.metadata={}),r.metadata.f||(r.metadata.f={}),r=r.metadata.f;for(var o=e.split("."),s=0;s<o.length-1;++s)r[o[s]]||(r[o[s]]={f:{}}),r=r[o[s]].f;(0,L.kJ)(n.value)?r[o[o.length-1]]={a:{t:i}}:r[o[o.length-1]]={t:i}}}}
/*!
 * 1DS JS SDK POST plugin, 2.3.4
 * Copyright (c) Microsoft and contributors. All rights reserved.
 * (Microsoft Internal Only)
 */
/**
* RetryPolicy.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2018
*/
var K=function(){function t(){}return t.shouldRetryForStatus=function(t){return!(t>=300&&t<500&&408!==t&&429!==t||501===t||505===t)},t.getMillisToBackoffForRetry=function(t){var e,n=Math.floor(1200*Math.random())+2400;return e=Math.pow(2,t)*n,Math.min(e,6e5)},t}(),j="constructor",Q="prototype",H="function",W="_dynClass",V="_unknown_",J=Object.getPrototypeOf,G=0;function X(t,e){return t&&Object.prototype.hasOwnProperty.call(t,e)}function Z(t){return typeof t===H}function $(t){return t&&(t===Object.prototype||t===Array.prototype)}function Y(t){return $(t)||t===Function.prototype}function tt(t){if(t){if(J)return J(t);var e=t.__proto__||t.prototype||t.constructor;if(e)return e}return null}function et(t,e,n){return e!==j&&Z(t[e])&&(n||X(t,e))}function nt(t){throw new TypeError("DynamicProto: "+t)}function it(t,e){for(var n=t.length-1;n>=0;n--)if(t[n]===e)return!0;return!1}function rt(t,e){return X(t,Q)?t.name||e||V:((t||{}).constructor||{}).name||e||V}var ot=function(t,e,n){X(t,Q)||nt("theClass is an invalid class definition.");var i=t.prototype;(function(t,e){for(var n=tt(e);n&&!Y(n);){if(n===t)return!0;n=tt(n)}return!1})(i,e)||nt("["+rt(t)+"] is not in class heirarchy of ["+rt(e)+"]");var r=null;X(i,W)?r=i._dynClass:(r="_dynCls$"+rt(t,"_")+"$"+G,G++,i._dynClass=r);var o=function(t){var e={};for(var n in t)!e[n]&&et(t,n,!1)&&(e[n]=t[n]);return e}(e),s=function(t,e,n){function i(t,e){return function(){return e.apply(t,arguments)}}var r={};for(var o in n)r[o]=i(e,n[o]);for(var s=tt(t),a=[];s&&!Y(s)&&!it(a,s);){for(var o in s)!r[o]&&et(s,o,!J)&&(r[o]=i(e,s[o]));a.push(s),s=tt(s)}return r}(i,e,o);n(e,s),function(t,e,n,i){function r(t,e){var n=function(){var i=this;if(i&&X(t,W)){var r=((i._dynInstFuncs||{})[t._dynClass]||{})[e];if(r)return r.apply(i,arguments);nt("Missing ["+e+"] "+H)}var o=t[e];return o===n&&(o=tt(t)[e]),Z(o)||nt("["+e+"] is not a "+H),o.apply(i,arguments)};return n._isDynProxy=1,n}if(!$(t)){var o=n._dynInstFuncs=n._dynInstFuncs||{},s=o[e]=o[e]||{};for(var a in n)et(n,a,!1)&&n[a]!==i[a]&&(s[a]=n[a],delete n[a],(!X(t,a)||t[a]&&!t[a]._isDynProxy)&&(t[a]=r(t,a)))}}(i,r,e,o)},st=function t(){var e={};ot(t,this,(function(t){t.setKillSwitchTenants=function(t,n){if(t&&n)try{var i=(s=t.split(","),a=[],s&&(0,L.tO)(s,(function(t){a.push((0,L.nd)(t))})),a);if("this-request-only"===n)return i;for(var r=1e3*parseInt(n,10),o=0;o<i.length;++o)e[i[o]]=Date.now()+r}catch(t){return[]}var s,a;return[]},t.isTenantKilled=function(t){var n=e,i=(0,L.nd)(t);return void 0!==n[i]&&n[i]>Date.now()||(delete n[i],!1)}}))},at=function t(){var e=!0,n=!0,i=!0,r="use-collector-delta",o=!1;ot(t,this,(function(t){t.allowRequestSending=function(){return i&&!o?(i=!1,e=!1,!0):e},t.shouldAddClockSkewHeaders=function(){return n},t.getClockSkewHeaderValue=function(){return r},t.setClockSkew=function(t){o||(t?r=t:n=!1,o=!0,e=!0)}}))},ut="POST",ct="Microsoft_ApplicationInsights_BypassAjaxInstrumentation";function lt(t){try{return t.responseText}catch(t){}return""}var ft,dt,pt,ht,gt,vt=function(){function t(t){this._requestQueue=t,this._urlString="?cors=true&content-type=application/x-json-stream&client-id=NO_AUTH&client-version="+L.vs,this._killSwitch=new st,this._paused=!1,this._clockSkewManager=new at,this._useBeacons=!1,this._activeConnections=0,this._customHttpInterface=!0,this._queryStringParameters=[],this._headers={}}return t.prototype.initialize=function(t,e,n,i){var r=this;if(this._urlString=t+this._urlString,this._core=e,this._postManager=n,this._httpInterface=i,!this._httpInterface){var o=!0,s=(0,L.k$)();s&&s.protocol&&"file:"===s.protocol.toLowerCase()&&(o=!1),this._customHttpInterface=!1,this._useBeacons=!(0,L.b$)(),this._httpInterface={sendPOST:function(t,e,n){if((0,L.cp)()){var i=new XDomainRequest;i.open(ut,t.urlString),i.onload=function(){e(200,{},lt(i)),r._handleCollectorResponse(lt(i))},i.onerror=function(){e(400,{})},i.ontimeout=function(){e(500,{})},i.send(t.data)}else if((0,L.b$)())try{fetch(t.urlString,(a={body:t.data,method:ut,credentials:"include"},a[ct]=!0,a.headers=t.headers,a)).then((function(t){var n={},i="";t.headers&&t.headers.forEach((function(t,e){n[e]=t})),t.body&&t.text().then((function(t){i=t})),e(t.status,n,i),r._handleCollectorResponse(i)})).catch((function(t){e(0,{})}))}catch(t){e(0,{})}else if("undefined"!=typeof XMLHttpRequest){var s=new XMLHttpRequest;try{s[ct]=!0}catch(t){}o&&(s.withCredentials=!0),s.open(ut,t.urlString,!n),(0,L.tO)((0,L.FY)(t.headers),(function(e){s.setRequestHeader(e,t.headers[e])})),s.onload=function(){e(s.status,r._convertAllHeadersToMap(s.getAllResponseHeaders()),lt(s)),r._handleCollectorResponse(lt(s))},s.onerror=function(){e(s.status,r._convertAllHeadersToMap(s.getAllResponseHeaders()))},s.ontimeout=function(){e(s.status,r._convertAllHeadersToMap(s.getAllResponseHeaders()))},s.send(t.data)}var a}}}},t.prototype.addQueryStringParameter=function(t,e){for(var n=0;n<this._queryStringParameters.length;n++)if(this._queryStringParameters[n].name===t)return void(this._queryStringParameters[n].value=e);this._queryStringParameters.push({name:t,value:e})},t.prototype.addHeader=function(t,e){this._headers[t]=e},t.prototype.hasIdleConnection=function(){return this._activeConnections<2},t.prototype.sendQueuedRequests=function(t,e){for(var n=!1;this.hasIdleConnection()&&!this._paused&&this._requestQueue.length>0&&this._clockSkewManager.allowRequestSending();)n||(this._notifyEventsSendRequest(t||0,e),n=!0),this._activeConnections++,this._sendRequest(this._requestQueue.shift(),0,!1);this.hasIdleConnection()&&this._postManager._scheduleTimer()},t.prototype.isCompletelyIdle=function(){return 0===this._activeConnections},t.prototype.teardown=function(){if(this._requestQueue.length>0)for(this._notifyEventsSendRequest(2,!0);this._requestQueue.length>0;)this._sendRequest(this._requestQueue.shift(),0,!0)},t.prototype.pause=function(){this._paused=!0},t.prototype.resume=function(){this._paused=!1,this.sendQueuedRequests(4,!1)},t.prototype.removeQueuedRequests=function(){this._requestQueue.length=0},t.prototype.sendSynchronousRequest=function(t,e){this._activeConnections++,this._notifyEventsSendRequest(e||0,!0),this._sendRequest(t,0,!1,!0)},t.prototype._sendRequest=function(t,e,n,i){void 0===i&&(i=!1);var r=this;if(t){if(r._paused)return r._activeConnections--,void r._postManager._addBackRequest(t);var o=0,s="";for(var a in t)t.hasOwnProperty(a)&&(r._killSwitch.isTenantKilled(a)?(r._postManager._notificationManager&&r._postManager._notificationManager.eventsDiscarded(t[a],F),delete t[a]):(s.length>0&&(s+=","),s+=a,o++));if(o>0){var u=(0,L.hK)(),c=B.getPayloadBlob(t,r._postManager._notificationManager),l=(0,L.hK)();c.remainingRequest&&r._requestQueue.push(c.remainingRequest);var f=r._urlString+"&apikey="+s+"&upload-time="+Date.now().toString(),d=r._getMsfpc(t);if((0,L.Sn)(d)&&(f=f+"&ext.intweb.msfpc="+d),r._clockSkewManager.shouldAddClockSkewHeaders()&&(f=f+"&time-delta-to-apply-millis="+r._clockSkewManager.getClockSkewHeaderValue()),r._core.getWParam){var p=r._core.getWParam();p>=0&&(f=f+"&w="+p)}for(var h=0;h<r._queryStringParameters.length;h++)f=f+"&"+r._queryStringParameters[h].name+"="+r._queryStringParameters[h].value;var g=(0,L.hK)();for(var a in t)if(t.hasOwnProperty(a))for(h=0;h<t[a].length;++h){var v=t[a][h];v.timings=v.timings||{},v.timings.sendEventStart=v.timings.sendEventStart||{},v.timings.serializationStart=v.timings.serializationStart||{},v.timings.serializationCompleted=v.timings.serializationCompleted||{},v.timings.sendEventStart[r._postManager.identifier]=g,v.timings.serializationStart[r._postManager.identifier]=u,v.timings.serializationCompleted[r._postManager.identifier]=l,v.sendAttempt>0?v.sendAttempt++:v.sendAttempt=1}var y={data:c.payloadBlob,urlString:f,headers:r._headers},m=null,_=!!r.sendHook;!r._customHttpInterface&&r._useBeacons&&(0,L.MF)()&&n?(_=!1,m=function(e){r._sendUsingBeacons(y,t),r.sendListener&&r.sendListener(y,y,i||n,!0)}):r._httpInterface&&(m=function(a){r._httpInterface.sendPOST(a,(function(a,u){r._retryRequestIfNeeded(a,u,t,o,s,e,n,i)}),n||i),r.sendListener&&r.sendListener(y,a,i||n,!1)}),m&&(_?r.sendHook(y,m,i||n):m(y))}else n||r._handleRequestFinished(null,{},n,i)}},t.prototype._sendUsingBeacons=function(t,e){try{if(navigator.sendBeacon(t.urlString,t.data))return void this._handleRequestFinished(!0,e,!0,!0);for(var n in e)if(e.hasOwnProperty(n))for(var i=0;i<e[n].length;++i){if(!navigator.sendBeacon(t.urlString,B.getEventBlob(e[n][i])))return;this._notifyEventCompleted(!0,[e[n][i]])}}catch(t){this._postManager.diagLog().warnToConsole("Failed to send telemetry using sendBeacon API. Ex:"+t)}},t.prototype._addEventCompletedTimings=function(t){for(var e=(0,L.hK)(),n=0;n<t.length;++n)t[n].timings=t[n].timings||{},t[n].timings.sendEventCompleted=t[n].timings.sendEventCompleted||{},t[n].timings.sendEventCompleted[this._postManager.identifier]=e},t.prototype._retryRequestIfNeeded=function(t,e,n,i,r,o,s,a){var u=this,c=!0;if(void 0!==t){if(e){var l=this._killSwitch.setKillSwitchTenants(e["kill-tokens"],e["kill-duration-seconds"]);this._clockSkewManager.setClockSkew(e["time-delta-millis"]);for(var f=0;f<l.length;++f)this._postManager._notificationManager&&this._postManager._notificationManager.eventsDiscarded(n[l[f]],F),delete n[l[f]],i--}else this._clockSkewManager.setClockSkew("");if(200===t)return void this._handleRequestFinished(!0,n,s,a);(!K.shouldRetryForStatus(t)||i<=0)&&(c=!1)}c?a?(this._activeConnections--,this._postManager._addBackRequest(n)):o<1?this._postManager._setTimeoutOverride((function(){return u._sendRequest(n,o+1,!1)}),K.getMillisToBackoffForRetry(o)):(this._activeConnections--,this._postManager._backOffTransmission(),this._postManager._addBackRequest(n)):this._handleRequestFinished(!1,n,s,a)},t.prototype._handleRequestFinished=function(t,e,n,i){for(var r in t&&this._postManager._clearBackOff(),e)e.hasOwnProperty(r)&&this._notifyEventCompleted(t,e[r],A);this._activeConnections--,i||n||this.sendQueuedRequests()},t.prototype._notifyEventCompleted=function(t,e,n){this._addEventCompletedTimings(e);var i=this._postManager._notificationManager;i&&(t?i.eventsSent(e):i.eventsDiscarded(e,n))},t.prototype._notifyEventsSendRequest=function(t,e){var n=this._postManager._notificationManager;if(n&&n.eventsSendRequest)try{n.eventsSendRequest(t,!!e)}catch(t){this._postManager.diagLog().throwInternal(r.X.CRITICAL,D.p3.NotificationException,"send request notification failed: "+t)}},t.prototype._convertAllHeadersToMap=function(t){var e={};if((0,L.HD)(t))for(var n=t.split("\n"),i=0;i<n.length;++i){var r=n[i].split(": ");e[r[0]]=r[1]}return e},t.prototype._getMsfpc=function(t){for(var e in t)if(t.hasOwnProperty(e))for(var n=0;n<t[e].length;++n)if(t[e][n].ext&&t[e][n].ext.intweb&&(0,L.Sn)(t[e][n].ext.intweb.msfpc))return encodeURIComponent(t[e][n].ext.intweb.msfpc);return""},t.prototype._handleCollectorResponse=function(t){try{if(t){var e=JSON.parse(t);(0,L.Sn)(e.webResult)&&(0,L.Sn)(e.webResult.msfpc)&&(0,L.d8)("MSFPC",e.webResult.msfpc,365)}}catch(t){}},t}(),yt=function t(e,n){var i={},r=0;ot(t,this,(function(t){t.addEventToBatch=function(e){var o=e.iKey;if(o){if(e.sync){var s={};return s[o]=[e],s}r>=n&&t.flushBatch();var a=i;void 0===a[o]&&(a[o]=[]),a[o].push(e),r++}return null},t.flushBatch=function(){r>0&&(e.push(i),i={},r=0)},t.hasBatch=function(){return r>0}}))},mt=L.dH?window:void 0,_t=function(t){function e(){var e=t.call(this)||this;return e.identifier="PostChannel",e.priority=1011,e.version="2.3.4",e._isTeardownCalled=!1,e._isCurrentlyFlushingNow=!1,e._flushQueue=[],e._databaseAdded=!1,e._paused=!1,e._queueSize=0,e._queueSizeLimit=1e4,e._profiles={},e._currentProfile=R,e._timeout=null,e._currentBackoffCount=0,e._timerCount=0,e._flushCallback=-1,e._flushOutboundQueue=[],e._outboundQueue=[],e._inboundQueues={},e._inboundQueues[D.zU.RealTime]=[],e._inboundQueues[D.zU.CostDeferred]=[],e._inboundQueues[D.zU.Normal]=[],e._initializeProfiles(),e._addEmptyQueues(),e._batcher=new yt(e._outboundQueue,500),e._syncFlushBatcher=new yt(e._flushOutboundQueue,500),e._httpManager=new vt(e._outboundQueue),e}return __extends(e,t),e.prototype.initialize=function(e,n,i){var r=this,o=n;t.prototype.initialize.call(this,e,n,i),this.setInitialized(!1);var s=this._getTelCtx();e.extensionConfig[this.identifier]=e.extensionConfig[this.identifier]||{},this._config=s.getExtCfg(this.identifier),this._setTimeoutOverride=this._config.setTimeoutOverride?this._config.setTimeoutOverride:setTimeout.bind(mt),this._clearTimeoutOverride=this._config.clearTimeoutOverride?this._config.clearTimeoutOverride:clearTimeout.bind(mt);var a=o.getWParam;o.getWParam=function(){var t=0;return r._config.ignoreMc1Ms0CookieProcessing&&(t|=2),t|a()},this._config.eventsLimitInMem>0&&(this._queueSizeLimit=this._config.eventsLimitInMem),this._config.autoFlushEventsLimit>0&&(this._autoFlushEventsLimit=this._config.autoFlushEventsLimit),this._config.httpXHROverride&&this._config.httpXHROverride.sendPOST&&(this._xhrOverride=this._config.httpXHROverride),(0,L.Sn)(e.anonCookieName)&&this._httpManager.addQueryStringParameter("anoncknm",e.anonCookieName),this._httpManager.sendHook=this._config.payloadPreprocessor,this._httpManager.sendListener=this._config.payloadListener;var u=this._config.overrideEndpointUrl?this._config.overrideEndpointUrl:e.endpointUrl;this._notificationManager=e.extensionConfig.NotificationManager,this._httpManager.initialize(u,this.core,this,this._xhrOverride);for(var c=0;c<i.length;++c)i[c].identifier&&"LocalStorage"===i[c].identifier&&(this._databaseAdded=!0);(0,L.c9)((function(){r.releaseAllQueuesUsingBeacons()})),this.setInitialized(!0)},e.prototype.processTelemetry=function(t,e){(0,L.if)(t,this.identifier);var n=(e=this._getTelCtx(e)).getExtCfg(this.identifier),i=!!this._config.disableTelemetry;n&&(i=i||!!this._config.disableTelemetry);var r=t;if(!i&&!this._isTeardownCalled){if(this._config.overrideInstrumentationKey&&(r.iKey=this._config.overrideInstrumentationKey),n&&n.overrideInstrumentationKey&&(r.iKey=n.overrideInstrumentationKey),r.sendAttempt||(r.sendAttempt=0),r.latency||(r.latency=D.zU.Normal),r.ext&&r.ext.trace&&delete r.ext.trace,r.ext&&r.ext.user&&r.ext.user.id&&delete r.ext.user.id,r.sync)if(this._currentBackoffCount>0||this._paused)r.latency=D.zU.RealTime,r.sync=!1;else if(this._httpManager)return void this._httpManager.sendSynchronousRequest(this._batcher.addEventToBatch(r),3);this._queueSize<this._queueSizeLimit||this._dropEventWithLatencyOrLess(r.latency)?this._addEventToProperQueue(r):this._notifyEventsDiscarded([r],x),this._scheduleTimer()}this.processNext(r,e)},e.prototype.setEventQueueLimits=function(t,e){var n=this,i=!1;n._queueSizeLimit=t>0?t:1e4,n._queueSize<t&&(i=!0),n._autoFlushEventsLimit=e>0?e:0,e>0&&n._queueSize<e&&(i=!0),i&&n.flush(!1,null,20)},e.prototype.teardown=function(){this.releaseAllQueuesUsingBeacons(),this._isTeardownCalled=!0},e.prototype.pause=function(){this._clearTimeout(),this._paused=!0,this._httpManager.pause(),this._databaseAdded&&(this._queueSize-=this._inboundQueues[D.zU.RealTime][0].length+this._inboundQueues[D.zU.CostDeferred][0].length+this._inboundQueues[D.zU.Normal][0].length,this._inboundQueues[D.zU.RealTime][0]=[],this._inboundQueues[D.zU.CostDeferred][0]=[],this._inboundQueues[D.zU.Normal][0]=[],this._httpManager.removeQueuedRequests())},e.prototype.resume=function(){this._paused=!1,this._httpManager.resume(),this._scheduleTimer()},e.prototype._loadTransmitProfiles=function(t){for(var e in this._resetTransmitProfiles(),t)if(t.hasOwnProperty(e)){if(t[e].length<2)continue;if(t[e].splice(0,t[e].length-2),t[e][1]<0&&(t[e][0]=-1),t[e][1]>0&&t[e][0]>0){var n=t[e][0]/t[e][1];t[e][0]=Math.ceil(n)*t[e][1]}this._profiles[e]=t[e]}},e.prototype.flush=function(t,e,n){var i=this;if(void 0===t&&(t=!0),!this._paused)if(this._clearTimeout(),t)this._addEmptyQueues(),this._isCurrentlyFlushingNow?this._flushQueue.push(e):(this._isCurrentlyFlushingNow=!0,this._setTimeoutOverride((function(){return i._flushImpl(e,n||1,t)}),0));else{this._batchEvents(D.zU.Normal,this._syncFlushBatcher);for(var r=0;r<this._flushOutboundQueue.length;r++)this._httpManager.sendSynchronousRequest(this._flushOutboundQueue[r],n||1);null!=e&&e()}},e.prototype.setMsaAuthTicket=function(t){this._httpManager.addHeader("X-AuthMsaDeviceTicket",t)},e.prototype._setTransmitProfile=function(t){this._currentProfile!==t&&void 0!==this._profiles[t]&&(this._clearTimeout(),this._currentProfile=t,this._scheduleTimer())},e.prototype._sendEventsForLatencyAndAbove=function(t,e,n){this._batchEvents(t),this._httpManager.sendQueuedRequests(e,n)},e.prototype._hasEvents=function(){return(this._inboundQueues[D.zU.RealTime][0].length>0||this._inboundQueues[D.zU.CostDeferred][0].length>0||this._inboundQueues[D.zU.Normal][0].length>0||this._batcher.hasBatch())&&this._httpManager.hasIdleConnection()},e.prototype._addBackRequest=function(t){if(!this._paused||!this._databaseAdded)for(var e in t)if(t.hasOwnProperty(e)){1===t[e].length&&t[e][0].sync&&(t[e][0].latency=D.zU.RealTime,t[e][0].sync=!1);for(var n=0;n<t[e].length;++n)t[e][n].sendAttempt<6?this.processTelemetry(t[e][n]):this._notifyEventsDiscarded([t[e][n]],A)}},e.prototype._scheduleTimer=function(){var t=this,e=this._profiles[this._currentProfile][1];if(!this._timeout&&e>=0&&!this._paused)if(this._hasEvents()){0===e&&this._currentBackoffCount>0&&(e=1);var n=1e3;this._currentBackoffCount>0&&(n=K.getMillisToBackoffForRetry(this._currentBackoffCount-1)),this._timeout=this._setTimeoutOverride((function(){return t._batchAndSendEvents(1,!1)}),e*n)}else this._timerCount=0},e.prototype._backOffTransmission=function(){this._currentBackoffCount<4&&(this._currentBackoffCount++,this._clearTimeout(),this._scheduleTimer())},e.prototype._clearBackOff=function(){this._currentBackoffCount>0&&(this._currentBackoffCount=0,this._clearTimeout(),this._scheduleTimer())},e.prototype._clearTimeout=function(){this._timeout&&(this._clearTimeoutOverride(this._timeout),this._timeout=null,this._timerCount=0)},e.prototype._batchAndSendEvents=function(t,e){var n=D.zU.RealTime;this._timerCount++,2===this._timerCount&&(n=D.zU.Normal,this._timerCount=0),this._sendEventsForLatencyAndAbove(n,t,e),this._timeout=null,this._scheduleTimer()},e.prototype.releaseAllQueuesUsingBeacons=function(){this._clearTimeout(),this._flushCallback>0&&this._clearTimeoutOverride(this._flushCallback),this._paused||this._databaseAdded||(this._mergeQueues(),this._batchEvents(D.zU.Normal),this._httpManager.teardown())},e.prototype._removeFirstQueues=function(){this._inboundQueues[D.zU.RealTime].shift(),this._inboundQueues[D.zU.CostDeferred].shift(),this._inboundQueues[D.zU.Normal].shift()},e.prototype._addEmptyQueues=function(){this._inboundQueues[D.zU.RealTime].push([]),this._inboundQueues[D.zU.CostDeferred].push([]),this._inboundQueues[D.zU.Normal].push([])},e.prototype._mergeQueues=function(){for(var t=D.zU.Normal;t<=D.zU.RealTime;t++)for(var e=1;e<this._inboundQueues[t].length;e++)for(;this._inboundQueues[t][e].length>0;)this._inboundQueues[t][0].push(this._inboundQueues[t][e].pop())},e.prototype._addEventToProperQueue=function(t){var e=this;e._paused&&e._databaseAdded||(e._queueSize++,e._inboundQueues[t.latency][e._inboundQueues[t.latency].length-1].push(t),0===t.sendAttempt&&e._autoFlushEventsLimit>0&&e._queueSize>e._autoFlushEventsLimit&&e.flush(!1,null,20))},e.prototype._dropEventWithLatencyOrLess=function(t){for(var e=D.zU.Normal;e<=t;){if(this._inboundQueues[e][this._inboundQueues[e].length-1].length>0){var n=this._inboundQueues[e][this._inboundQueues[e].length-1].splice(0,20);return this._notifyEventsDiscarded(n,x),!0}e++}return!1},e.prototype._batchEvents=function(t,e){void 0===e&&(e=this._batcher);for(var n=D.zU.RealTime;n>=t;){for(;this._inboundQueues[n][0].length>0;){var i=this._inboundQueues[n][0].pop();this._queueSize--,e.addEventToBatch(i)}n--}e.flushBatch()},e.prototype._flushImpl=function(t,e,n){var i=this;this._hasEvents()&&this._sendEventsForLatencyAndAbove(D.zU.Normal,e,n),this._checkOutboundQueueEmptyAndSent((function(){i._removeFirstQueues(),null!=t&&t(),i._flushQueue.length>0?i._flushCallback=i._setTimeoutOverride((function(){return i._flushImpl(i._flushQueue.shift(),e,n)}),0):(i._isCurrentlyFlushingNow=!1,i._hasEvents()&&i._scheduleTimer())}))},e.prototype._checkOutboundQueueEmptyAndSent=function(t){var e=this;this._httpManager.isCompletelyIdle()?t():this._flushCallback=this._setTimeoutOverride((function(){return e._checkOutboundQueueEmptyAndSent(t)}),250)},e.prototype._notifyEventsDiscarded=function(t,e){var n=this._notificationManager;n&&n.eventsDiscarded&&n.eventsDiscarded(t,e)},e.prototype._resetTransmitProfiles=function(){this._clearTimeout(),this._initializeProfiles(),this._currentProfile=R,this._scheduleTimer()},e.prototype._initializeProfiles=function(){this._profiles={},this._profiles.REAL_TIME=[2,1],this._profiles.NEAR_REAL_TIME=[6,3],this._profiles.BEST_EFFORT=[18,9]},e}(g);function St(t,e,n,i){void 0===i&&(i=!1);var r=0;for(var o in t)t.hasOwnProperty(o)&&(r+=t[o].length);var s=performance.now();ft(t,e,n,i),ht(performance.now()-s,r)}function Tt(t,e,n){dt(t,e,n),gt(t.data.length)}function Ct(t,e){pt(t,e),t.data&&"string"==typeof t.data&&gt(t.data.length)}var wt,bt,Et,Pt,At,It,kt=(wt=function(t,e){return wt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},wt(t,e)},function(t,e){function n(){this.constructor=t}wt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return kt(e,t),e.prototype.initialize=function(e,n){this._postChannel=new _t;var i=[];n&&(i=i.concat(n)),e.channels=[[this._postChannel]],e.extensionConfig=e.extensionConfig||[],e.extensionConfig[this._postChannel.identifier]=e.channelConfiguration?e.channelConfiguration:{};try{t.prototype.initialize.call(this,e,i)}catch(t){this.logger.warnToConsole("Failed to initialize SDK."+t)}},e.prototype.addInstrumentation=function(t){this._postChannel&&t&&(function(t,e,n){if(!t._httpManager)return!1;var i=t._httpManager;if(!(i&&i._httpInterface&&i._sendRequest&&i._sendUsingBeacons))return!1;ft=i._sendRequest.bind(i),i._sendRequest=St;var r=i._httpInterface;return dt=r.sendPOST.bind(i),r.sendPOST=Tt,pt=i._sendUsingBeacons.bind(i),i._sendUsingBeacons=Ct,ht=e,gt=n,!0}(this._postChannel,t.requestProcessingStats,t.networkStats)||(0,i.uf)(i.in.Error,i.WD.Sink,(function(){return"Failed to instrument 1DS delivery task"})))},e.prototype.setUploadFrequency=function(t){if(this._postChannel&&t){var e=t/1e3,n=e/2,i={};i.OTelCustomTransmissionProfile=[e,n],this._postChannel._loadTransmitProfiles(i),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},e.prototype.connectNotificationListener=function(t){t&&this.addNotificationListener(t)},e.prototype.flush=function(t){this._postChannel&&this._postChannel.flush(t)},e.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},e}(U);!function(t){t[t.NotSet=0]="NotSet",t[t.Measure=1]="Measure",t[t.Diagnostics=2]="Diagnostics",t[t.CriticalBusinessImpact=191]="CriticalBusinessImpact",t[t.CriticalCensus=192]="CriticalCensus",t[t.CriticalExperimentation=193]="CriticalExperimentation",t[t.CriticalUsage=194]="CriticalUsage"}(bt||(bt={})),function(t){t[t.NotSet=0]="NotSet",t[t.Normal=1]="Normal",t[t.High=2]="High"}(Et||(Et={})),function(t){t[t.NotSet=0]="NotSet",t[t.Normal=1]="Normal",t[t.High=2]="High"}(Pt||(Pt={})),function(t){t[t.NotSet=0]="NotSet",t[t.SoftwareSetup=1]="SoftwareSetup",t[t.ProductServiceUsage=2]="ProductServiceUsage",t[t.ProductServicePerformance=4]="ProductServicePerformance",t[t.DeviceConfiguration=8]="DeviceConfiguration",t[t.InkingTypingSpeech=16]="InkingTypingSpeech"}(At||(At={})),function(t){t[t.ReservedDoNotUse=0]="ReservedDoNotUse",t[t.BasicEvent=10]="BasicEvent",t[t.FullEvent=100]="FullEvent",t[t.NecessaryServiceDataEvent=110]="NecessaryServiceDataEvent",t[t.AlwaysOnNecessaryServiceDataEvent=120]="AlwaysOnNecessaryServiceDataEvent"}(It||(It={}));var xt,Nt=function(){function t(){this._fullEventsEnabled=!1}return t.prototype.processEvent=function(t){if(!this._fullEventsEnabled&&!t.eventFlags)throw new Error(t.eventName+" missing Event Flags");var e=this._fullEventsEnabled||!!t.eventFlags&&(t.eventFlags.diagnosticLevel===It.BasicEvent||t.eventFlags.diagnosticLevel===It.NecessaryServiceDataEvent||t.eventFlags.diagnosticLevel===It.AlwaysOnNecessaryServiceDataEvent);return e||(0,i.uf)(i.in.Info,i.WD.Sink,(function(){return"1DS Data Classification Failed to Send: "+t.eventName})),e},t.prototype.setFullEventsEnabled=function(t){this._fullEventsEnabled=t},t}(),Ot=n(47964),Dt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Lt=function(){return Lt=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},Lt.apply(this,arguments)},Mt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.identifier="PartAPlugin",e.priority=3,e._properties={},e}return Dt(e,t),e.prototype.initialize=function(e,n,i){t.prototype.initialize.call(this,e,n,i)},e.prototype.processTelemetry=function(t,e){t.data=Lt(Lt({},t.data),this._properties);var n=this._getTelCtx(e);this.processNext(t,n)},e.prototype.setProperties=function(t){this._properties=Lt(Lt({},this._properties),t)},e}(g),Ut=n(84269);!function(t){t.newGuid=function(){return(0,Ut.v4)()}}(xt||(xt={}));var Rt=function(){function t(t,e){this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0,this._persistentDataFields=[],this._preprocessors=[],this._partADataFieldsPlugin=new Mt,this.setPersistentDataFields(t),this._oneDSSinkSessionId=xt.newGuid(),this._epoch=(new Date).getTime().toString(),this._applicationInsights=new Ft,this._applicationInsights.initialize({instrumentationKey:Ot.i9,endpointUrl:e.endpointUrl,channelConfiguration:{eventsLimitInMem:e.eventsLimitInMem,httpXHROverride:e.httpXHROverride,setTimeoutOverride:e.setTimeoutOverride,clearTimeoutOverride:e.clearTimeoutOverride}},[this._partADataFieldsPlugin]),this._applicationInsights.setUploadFrequency(e.uploadFrequency),this._applicationInsights.connectNotificationListener(e.notificationListener),this._applicationInsights.addInstrumentation(e.stats),e.disableStatsTracking||this.hookUp1DSNotifications(this._applicationInsights),this._dataClassificationChecker=new Nt,this.addPreprocessor(this._dataClassificationChecker)}return t.prototype.sendTelemetryEvent=function(t,e){try{for(var n=0;n<this._preprocessors.length;n++)if(!this._preprocessors[n].processEvent(t))return;this.sendEventInternal(t,e)}catch(t){(0,i.H)(i.WD.Sink,"1DS Sink",t)}},t.prototype.getPersistentDataFields=function(){return this._persistentDataFields},t.prototype.setPersistentDataFields=function(t){this._partADataFieldsPlugin.setProperties((0,Ot.qI)(t,!1)),this._persistentDataFields=t},t.prototype.addPreprocessor=function(t){this._preprocessors.push(t)},t.prototype.setFullEventsEnabled=function(t){this._dataClassificationChecker.setFullEventsEnabled(t)},t.prototype.sendEventInternal=function(t,e){if(this.eventsProcessed++,!t.telemetryProperties||!t.telemetryProperties.ariaTenantToken)throw new Error("Missing Aria Tenant Token");var n=(0,Ot.Zv)(t,this._oneDSSinkSessionId,e);this._applicationInsights.track({iKey:t.telemetryProperties.ariaTenantToken,name:t.eventName,data:n,time:(new Date).toISOString(),baseType:"EventData",ext:{sdk:{seq:n?n["Event.Sequence"]:1,epoch:this._epoch}}})},t.prototype.hookUp1DSNotifications=function(t){var e=this;t.addNotificationListener({eventsSent:function(t){(0,i.uf)(i.in.Info,i.WD.Transport,(function(){return"Successfully sent "+t.length+" event(s)"})),(0,i.uf)(i.in.Verbose,i.WD.Transport,(function(){return"Sent event(s) details : "+JSON.stringify(t,null,2)})),e.eventsSent+=t.length},eventsDiscarded:function(t,n){(0,i.uf)(i.in.Error,i.WD.Transport,(function(){return"Discarded "+t.length+" event(s) because "+n})),(0,i.uf)(i.in.Verbose,i.WD.Transport,(function(){return"Discarded event(s) details : "+JSON.stringify(t,null,2)})),e.eventsDiscarded+=t.length}})},t.prototype.flush=function(t){this._applicationInsights.flush(t)},t.prototype.shutdown=function(){try{this._applicationInsights.shutdown()}catch(t){(0,i.uf)(i.in.Error,i.WD.Transport,(function(){return"An error occurred on shutdown"}))}},t}()},34805:function(){},6567:function(t,e,n){"use strict";n.r(e),n.d(e,{OneDSSink:function(){return i.a},EventThrottler:function(){return r.d},OneDSEndpoint:function(){return u.x}});var i=n(96791),r=n(12360),o=n(34805),s={};for(var a in o)["default","OneDSSink","EventThrottler"].indexOf(a)<0&&(s[a]=function(t){return o[t]}.bind(0,a));n.d(e,s);var u=n(71246)},1039:function(t,e,n){"use strict";var i;n.d(e,{j:function(){return u}}),function(t){var e,n=0;t.getNext=function(){return void 0===e&&(e=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=22,n=[],i=0;i<e;i++)n.push(t.charAt(Math.floor(Math.random()*t.length)));return n.join("")}()),new i(e,++n)},t.getNextChild=function(t){return new i(t.getString(),++t.nextChild)};var i=function(){function t(t,e){this.base=t,this.id=e,this.nextChild=0}return t.prototype.getString=function(){return this.base+"."+this.id},t}();t.CV=i}(i||(i={}));var r=n(58113),o=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function s(t){try{u(i.next(t))}catch(t){o(t)}}function a(t){try{u(i.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((i=i.apply(t,e||[])).next())}))},s=function(t,e){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},a=function(){return 1e3*Date.now()};"object"==typeof window.performance&&"now"in window.performance&&(a=function(){return 1e3*Math.floor(window.performance.now())});var u=function(){function t(t,e,n){this._optionalEventFlags={},this._ended=!1,this._telemetryLogger=t,this._activityName=e,this._cv=n?i.getNextChild(n._cv):i.getNext(),this._dataFields=[],this._success=void 0,this._startTime=a()}return t.createNew=function(e,n){return new t(e,n)},t.prototype.createChildActivity=function(e){return new t(this._telemetryLogger,e,this)},t.prototype.setEventFlags=function(t){this._optionalEventFlags=t},t.prototype.addDataField=function(t){this._dataFields.push(t)},t.prototype.addDataFields=function(t){var e;(e=this._dataFields).push.apply(e,t)},t.prototype.setSuccess=function(t){this._success=t},t.prototype.setResult=function(t,e,n){this._result={code:t,type:e,tag:n}},t.prototype.endNow=function(){if(!this._ended){void 0===this._success&&void 0===this._result&&(0,r.uf)(r.in.Warning,r.WD.Core,(function(){return"Activity does not have success or result set"}));var t=a()-this._startTime;this._ended=!0;var e={duration:t,count:1,aggMode:0,cV:this._cv.getString(),success:this._success,result:this._result};return this._telemetryLogger.sendActivity(this._activityName,e,this._dataFields,this._optionalEventFlags)}(0,r.uf)(r.in.Error,r.WD.Core,(function(){return"Activity has already ended"}))},t.prototype.executeAsync=function(t){return o(this,void 0,void 0,(function(){var e=this;return s(this,(function(n){return[2,t(this).then((function(t){return e.endNow(),t})).catch((function(t){throw e.endNow(),t}))]}))}))},t.prototype.executeSync=function(t){try{var e=t(this);return this.endNow(),e}catch(t){throw this.endNow(),t}},t.prototype.executeChildActivityAsync=function(t,e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,this.createChildActivity(t).executeAsync(e)]}))}))},t.prototype.executeChildActivitySync=function(t,e){return this.createChildActivity(t).executeSync(e)},t}()},84599:function(t,e,n){"use strict";n.d(e,{a:function(){return r}});var i=n(55824);function r(t,e,n){t.push((0,i.dt)("zC."+e,n))}},74793:function(t,e,n){"use strict";n.d(e,{c:function(){return r}});var i=n(84599);function r(t,e,n){var r=n.map((function(e){return{name:t+"."+e.name,value:e.value,dataType:e.dataType}}));return(0,i.a)(r,t,e),r}},97977:function(t,e,n){"use strict";var i;n.d(e,{H:function(){return i}}),function(t){t[t.EssentialServiceMetadata=1]="EssentialServiceMetadata",t[t.AccountData=2]="AccountData",t[t.SystemMetadata=4]="SystemMetadata",t[t.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",t[t.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",t[t.CustomerContent=32]="CustomerContent",t[t.AccessControl=64]="AccessControl"}(i||(i={}))},77126:function(){},55824:function(t,e,n){"use strict";n.d(e,{UL:function(){return o},Kq:function(){return s},b_:function(){return a},dt:function(){return u},xq:function(){return c}});var i=n(42598),r=n(97977);function o(t,e){return{name:t,dataType:i._.Boolean,value:e,classification:r.H.SystemMetadata}}function s(t,e){return{name:t,dataType:i._.Int64,value:e,classification:r.H.SystemMetadata}}function a(t,e){return{name:t,dataType:i._.Double,value:e,classification:r.H.SystemMetadata}}function u(t,e){return{name:t,dataType:i._.String,value:e,classification:r.H.SystemMetadata}}function c(t,e){return{name:t,dataType:i._.Guid,value:e,classification:r.H.SystemMetadata}}},42598:function(t,e,n){"use strict";var i;n.d(e,{_:function(){return i}}),function(t){t[t.String=0]="String",t[t.Boolean=1]="Boolean",t[t.Int64=2]="Int64",t[t.Double=3]="Double",t[t.Guid=4]="Guid"}(i||(i={}))},17963:function(t,e,n){"use strict";n.d(e,{j:function(){return i}});var i=function(){function t(){this._listeners=[]}return t.prototype.fireEvent=function(t){this._listeners.forEach((function(e){return e(t)}))},t.prototype.addListener=function(t){t&&this._listeners.push(t)},t.prototype.removeListener=function(t){this._listeners=this._listeners.filter((function(e){return e!==t}))},t.prototype.getListenerCount=function(){return this._listeners.length},t}()},46966:function(t,e,n){"use strict";n.d(e,{S:function(){return o}});var i=n(58180),r=n(58113);function o(t){var e={costPriority:i.jZ.Normal,samplingPolicy:i.Yb.Measure,persistencePriority:i.a8.Normal,dataCategories:i.Rw.NotSet,diagnosticLevel:i.NI.FullEvent};return t.eventFlags&&t.eventFlags.dataCategories||(0,r.uf)(r.in.Error,r.WD.Core,(function(){return"Event is missing DataCategories event flag"})),t.eventFlags?(t.eventFlags.costPriority&&(e.costPriority=t.eventFlags.costPriority),t.eventFlags.samplingPolicy&&(e.samplingPolicy=t.eventFlags.samplingPolicy),t.eventFlags.persistencePriority&&(e.persistencePriority=t.eventFlags.persistencePriority),t.eventFlags.dataCategories&&(e.dataCategories=t.eventFlags.dataCategories),t.eventFlags.diagnosticLevel&&(e.diagnosticLevel=t.eventFlags.diagnosticLevel),e):e}},58180:function(t,e,n){"use strict";var i,r,o,s,a;n.d(e,{Yb:function(){return i},a8:function(){return r},jZ:function(){return o},Rw:function(){return s},NI:function(){return a}}),function(t){t[t.NotSet=0]="NotSet",t[t.Measure=1]="Measure",t[t.Diagnostics=2]="Diagnostics",t[t.CriticalBusinessImpact=191]="CriticalBusinessImpact",t[t.CriticalCensus=192]="CriticalCensus",t[t.CriticalExperimentation=193]="CriticalExperimentation",t[t.CriticalUsage=194]="CriticalUsage"}(i||(i={})),function(t){t[t.NotSet=0]="NotSet",t[t.Normal=1]="Normal",t[t.High=2]="High"}(r||(r={})),function(t){t[t.NotSet=0]="NotSet",t[t.Normal=1]="Normal",t[t.High=2]="High"}(o||(o={})),function(t){t[t.NotSet=0]="NotSet",t[t.SoftwareSetup=1]="SoftwareSetup",t[t.ProductServiceUsage=2]="ProductServiceUsage",t[t.ProductServicePerformance=4]="ProductServicePerformance",t[t.DeviceConfiguration=8]="DeviceConfiguration",t[t.InkingTypingSpeech=16]="InkingTypingSpeech"}(s||(s={})),function(t){t[t.ReservedDoNotUse=0]="ReservedDoNotUse",t[t.BasicEvent=10]="BasicEvent",t[t.FullEvent=100]="FullEvent",t[t.NecessaryServiceDataEvent=110]="NecessaryServiceDataEvent",t[t.AlwaysOnNecessaryServiceDataEvent=120]="AlwaysOnNecessaryServiceDataEvent"}(a||(a={}))},58113:function(t,e,n){"use strict";n.d(e,{in:function(){return i},WD:function(){return r},kr:function(){return s},uf:function(){return a},H:function(){return u}});var i,r,o=new(n(17963).j);function s(){return o}function a(t,e,n){o.fireEvent({level:t,category:e,message:n})}function u(t,e,n){a(i.Error,t,(function(){var t=n instanceof Error?n.message:"";return e+": "+t}))}!function(t){t[t.Error=0]="Error",t[t.Warning=1]="Warning",t[t.Info=2]="Info",t[t.Verbose=3]="Verbose"}(i||(i={})),function(t){t[t.Core=0]="Core",t[t.Sink=1]="Sink",t[t.Transport=2]="Transport"}(r||(r={}))},13439:function(){},42783:function(t,e,n){"use strict";n.d(e,{D:function(){return d},V:function(){return f}});var i,r,o=n(58113);!function(t){t[t.Aria=0]="Aria",t[t.Nexus=1]="Nexus"}(i||(i={})),function(t){var e={},n={},r={};function s(t){if("object"!=typeof t)throw new Error("tokenTree must be an object");r=l(r,t)}function a(t){if(e[t])return e[t];var n=c(t,i.Aria);return"string"==typeof n?(e[t]=n,n):void 0}function u(t){if(n[t])return n[t];var e=c(t,i.Nexus);return"number"==typeof e?(n[t]=e,e):void 0}function c(t,e){var n=t.split("."),o=r,s=void 0;if(o){for(var a=0;a<n.length-1;a++)o[n[a]]&&(o=o[n[a]],e===i.Aria&&"string"==typeof o.ariaTenantToken?s=o.ariaTenantToken:e===i.Nexus&&"number"==typeof o.nexusTenantToken&&(s=o.nexusTenantToken));return s}}function l(t,e){if("object"!=typeof e)return e;for(var n=0,i=Object.keys(e);n<i.length;n++){var r=i[n];r in t&&(t[r],1)?t[r]=l(t[r],e[r]):t[r]=e[r]}return t}t.setTenantToken=function(t,e,n){var i=t.split(".");if(i.length<2||"Office"!==i[0])(0,o.uf)(o.in.Error,o.WD.Core,(function(){return"Invalid namespace: "+t}));else{var r=Object.create(Object.prototype);e&&(r.ariaTenantToken=e),n&&(r.nexusTenantToken=n);var a,u=r;for(a=i.length-1;a>=0;--a){var c=Object.create(Object.prototype);c[i[a]]=u,u=c}s(u)}},t.setTenantTokens=s,t.getTenantTokens=function(t){var e=a(t),n=u(t);if(!n||!e)throw new Error("Could not find tenant token for "+t);return{ariaTenantToken:e,nexusTenantToken:n}},t.getAriaTenantToken=a,t.getNexusTenantToken=u,t.clear=function(){e={},n={},r={}}}(r||(r={}));var s,a=n(42598);!function(t){var e=/^[A-Z][a-zA-Z0-9]*$/,n=/^[a-zA-Z0-9_\.]*$/;function i(t){return void 0!==t&&n.test(t)}function r(t){if(!((e=t.name)&&i(e)&&e.length+5<100))throw new Error("Invalid dataField name");var e;t.dataType===a._.Int64&&o(t.value)}function o(t){if("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t<-9007199254740991||t>9007199254740991)throw new Error("Invalid integer "+JSON.stringify(t))}t.validateTelemetryEvent=function(t){if(!function(t){var n=98;if(!t||t.length>n)return!1;var i=t.split("."),r=i[i.length-1];return function(t){return!!t&&t.length>=3&&"Office"===t[0]}(i)&&(o=r,void 0!==o&&e.test(o));var o}(t.eventName))throw new Error("Invalid eventName");if(t.eventContract&&!i(t.eventContract.name))throw new Error("Invalid eventContract");if(null!=t.dataFields)for(var n=0;n<t.dataFields.length;n++)r(t.dataFields[n])},t.validateInt=o}(s||(s={}));var u=n(17963),c=n(55824),l=function(){return l=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},l.apply(this,arguments)},f=-1,d=function(){function t(t,e,n){var i,r;this.onSendEvent=new u.j,this.persistentDataFields=[],this.config=n||{},t?(this.onSendEvent=t.onSendEvent,(i=this.persistentDataFields).push.apply(i,t.persistentDataFields),this.config=l(l({},t.getConfig()),this.config)):this.persistentDataFields.push((0,c.dt)("OTelJS.Version","3.1.49")),e&&(r=this.persistentDataFields).push.apply(r,e)}return t.prototype.sendTelemetryEvent=function(t){var e;try{if(0===this.onSendEvent.getListenerCount())return void(0,o.uf)(o.in.Warning,o.WD.Core,(function(){return"No telemetry sinks are attached."}));e=this.cloneEvent(t),this.processTelemetryEvent(e)}catch(t){return void(0,o.H)(o.WD.Core,"SendTelemetryEvent",t)}try{this.onSendEvent.fireEvent(e)}catch(t){}},t.prototype.processTelemetryEvent=function(t){var e;t.telemetryProperties||(t.telemetryProperties=r.getTenantTokens(t.eventName)),t.dataFields&&this.persistentDataFields&&(e=t.dataFields).unshift.apply(e,this.persistentDataFields),this.config.disableValidation||s.validateTelemetryEvent(t)},t.prototype.addSink=function(t){this.onSendEvent.addListener((function(e){return t.sendTelemetryEvent(e)}))},t.prototype.setTenantToken=function(t,e,n){r.setTenantToken(t,e,n)},t.prototype.setTenantTokens=function(t){r.setTenantTokens(t)},t.prototype.cloneEvent=function(t){var e={eventName:t.eventName,eventFlags:t.eventFlags};return t.telemetryProperties&&(e.telemetryProperties={ariaTenantToken:t.telemetryProperties.ariaTenantToken,nexusTenantToken:t.telemetryProperties.nexusTenantToken}),t.eventContract&&(e.eventContract={name:t.eventContract.name,dataFields:t.eventContract.dataFields.slice()}),e.dataFields=t.dataFields?t.dataFields.slice():[],e},t.prototype.getConfig=function(){return this.config},t}()},14565:function(){},14186:function(t,e,n){"use strict";n.d(e,{h:function(){return l}});var i,r=n(42783),o=n(1039),s=n(19937),a=(i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},i(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function s(t){try{u(i.next(t))}catch(t){o(t)}}function a(t){try{u(i.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((i=i.apply(t,e||[])).next())}))},c=function(t,e){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.executeActivityAsync=function(t,e){return u(this,void 0,void 0,(function(){return c(this,(function(n){return[2,this.createNewActivity(t).executeAsync(e)]}))}))},e.prototype.executeActivitySync=function(t,e){return this.createNewActivity(t).executeSync(e)},e.prototype.createNewActivity=function(t){return o.j.createNew(this,t)},e.prototype.sendActivity=function(t,e,n,i){return this.sendTelemetryEvent({eventName:t,eventContract:{name:s.a.Office.System.Activity.contractName,dataFields:s.a.Office.System.Activity.getFields(e)},dataFields:n,eventFlags:i})},e.prototype.sendError=function(t){var e=s.a.Office.System.Error.getFields("Error",t.error);return null!=t.dataFields&&e.push.apply(e,t.dataFields),this.sendTelemetryEvent({eventName:t.eventName,dataFields:e,eventFlags:t.eventFlags})},e}(r.D)},1893:function(){},11819:function(){},19937:function(t,e,n){"use strict";n.d(e,{a:function(){return p}});var i,r,o,s,a,u,c,l,f=n(55824),d=n(84599);!function(t){t.getFields=function(t,e){var n=[];return n.push((0,f.Kq)(t+".Code",e.code)),void 0!==e.type&&n.push((0,f.dt)(t+".Type",e.type)),void 0!==e.tag&&n.push((0,f.Kq)(t+".Tag",e.tag)),void 0!==e.isExpected&&n.push((0,f.UL)(t+".IsExpected",e.isExpected)),(0,d.a)(n,t,"Office.System.Result"),n}}(i||(i={})),function(t){t.contractName="Office.System.Activity",t.getFields=function(e){var n="Activity",r=[];return void 0!==e.cV&&r.push((0,f.dt)("Activity.CV",e.cV)),r.push((0,f.Kq)("Activity.Duration",e.duration)),r.push((0,f.Kq)("Activity.Count",e.count)),r.push((0,f.Kq)("Activity.AggMode",e.aggMode)),void 0!==e.success&&r.push((0,f.UL)("Activity.Success",e.success)),void 0!==e.result&&r.push.apply(r,i.getFields("Activity.Result",e.result)),(0,d.a)(r,n,t.contractName),r}}(r||(r={})),function(t){t.getFields=function(t,e){var n=[];return void 0!==e.id&&n.push((0,f.dt)(t+".Id",e.id)),void 0!==e.version&&n.push((0,f.dt)(t+".Version",e.version)),void 0!==e.sessionId&&n.push((0,f.dt)(t+".SessionId",e.sessionId)),(0,d.a)(n,t,"Office.System.Host"),n}}(o||(o={})),function(t){t.getFields=function(t,e){var n=[];return void 0!==e.alias&&n.push((0,f.dt)(t+".Alias",e.alias)),void 0!==e.primaryIdentityHash&&n.push((0,f.dt)(t+".PrimaryIdentityHash",e.primaryIdentityHash)),void 0!==e.primaryIdentitySpace&&n.push((0,f.dt)(t+".PrimaryIdentitySpace",e.primaryIdentitySpace)),void 0!==e.tenantId&&n.push((0,f.dt)(t+".TenantId",e.tenantId)),void 0!==e.tenantGroup&&n.push((0,f.dt)(t+".TenantGroup",e.tenantGroup)),void 0!==e.isAnonymous&&n.push((0,f.UL)(t+".IsAnonymous",e.isAnonymous)),(0,d.a)(n,t,"Office.System.User"),n}}(s||(s={})),function(t){t.getFields=function(t,e){var n=[];return void 0!==e.id&&n.push((0,f.dt)(t+".Id",e.id)),void 0!==e.version&&n.push((0,f.dt)(t+".Version",e.version)),void 0!==e.instanceId&&n.push((0,f.dt)(t+".InstanceId",e.instanceId)),void 0!==e.name&&n.push((0,f.dt)(t+".Name",e.name)),void 0!==e.marketplaceType&&n.push((0,f.dt)(t+".MarketplaceType",e.marketplaceType)),void 0!==e.sessionId&&n.push((0,f.dt)(t+".SessionId",e.sessionId)),void 0!==e.browserToken&&n.push((0,f.dt)(t+".BrowserToken",e.browserToken)),void 0!==e.osfRuntimeVersion&&n.push((0,f.dt)(t+".OsfRuntimeVersion",e.osfRuntimeVersion)),void 0!==e.officeJsVersion&&n.push((0,f.dt)(t+".OfficeJsVersion",e.officeJsVersion)),void 0!==e.hostJsVersion&&n.push((0,f.dt)(t+".HostJsVersion",e.hostJsVersion)),void 0!==e.assetId&&n.push((0,f.dt)(t+".AssetId",e.assetId)),void 0!==e.providerName&&n.push((0,f.dt)(t+".ProviderName",e.providerName)),void 0!==e.type&&n.push((0,f.dt)(t+".Type",e.type)),(0,d.a)(n,t,"Office.System.SDX"),n}}(a||(a={})),function(t){t.getFields=function(t,e){var n=[];return void 0!==e.name&&n.push((0,f.dt)(t+".Name",e.name)),void 0!==e.state&&n.push((0,f.dt)(t+".State",e.state)),(0,d.a)(n,t,"Office.System.Funnel"),n}}(u||(u={})),function(t){t.getFields=function(t,e){var n=[];return void 0!==e.id&&n.push((0,f.Kq)(t+".Id",e.id)),void 0!==e.name&&n.push((0,f.dt)(t+".Name",e.name)),void 0!==e.commandSurface&&n.push((0,f.dt)(t+".CommandSurface",e.commandSurface)),void 0!==e.parentName&&n.push((0,f.dt)(t+".ParentName",e.parentName)),void 0!==e.triggerMethod&&n.push((0,f.dt)(t+".TriggerMethod",e.triggerMethod)),void 0!==e.timeOffsetMs&&n.push((0,f.Kq)(t+".TimeOffsetMs",e.timeOffsetMs)),(0,d.a)(n,t,"Office.System.UserAction"),n}}(c||(c={})),function(t){t.getFields=function(t,e){var n=[];return n.push((0,f.dt)(t+".ErrorGroup",e.errorGroup)),n.push((0,f.Kq)(t+".Tag",e.tag)),void 0!==e.code&&n.push((0,f.Kq)(t+".Code",e.code)),void 0!==e.id&&n.push((0,f.Kq)(t+".Id",e.id)),void 0!==e.count&&n.push((0,f.Kq)(t+".Count",e.count)),(0,d.a)(n,t,"Office.System.Error"),n}}(l||(l={}));var p,h=r,g=i,v=l,y=u,m=o,_=a,S=c,T=s;!function(t){!function(t){!function(t){t.Activity=h,t.Result=g,t.Error=v,t.Funnel=y,t.Host=m,t.SDX=_,t.User=T,t.UserAction=S}(t.System||(t.System={}))}(t.Office||(t.Office={}))}(p||(p={}))},25578:function(t,e,n){"use strict";n.r(e),n.d(e,{Contracts:function(){return i.a},ActivityScope:function(){return r.j},addContractField:function(){return o.a},getFieldsForContract:function(){return s.c},DataClassification:function(){return a.H},makeBooleanDataField:function(){return f.UL},makeDoubleDataField:function(){return f.b_},makeGuidDataField:function(){return f.xq},makeInt64DataField:function(){return f.Kq},makeStringDataField:function(){return f.dt},DataFieldType:function(){return d._},getEffectiveEventFlags:function(){return p.S},CostPriority:function(){return h.jZ},DataCategories:function(){return h.Rw},DiagnosticLevel:function(){return h.NI},PersistencePriority:function(){return h.a8},SamplingPolicy:function(){return h.Yb},Category:function(){return v.WD},LogLevel:function(){return v.in},logError:function(){return v.H},logNotification:function(){return v.uf},onNotification:function(){return v.kr},SimpleTelemetryLogger:function(){return y.D},SuppressNexus:function(){return y.V},TelemetryLogger:function(){return m.h}});var i=n(19937),r=n(1039),o=n(84599),s=n(74793),a=n(97977),u=n(77126),c={};for(var l in u)["default","Contracts","ActivityScope","addContractField","getFieldsForContract","DataClassification"].indexOf(l)<0&&(c[l]=function(t){return u[t]}.bind(0,l));n.d(e,c);var f=n(55824),d=n(42598),p=n(46966),h=n(58180),g=n(13439);c={};for(var l in g)["default","Contracts","ActivityScope","addContractField","getFieldsForContract","DataClassification","makeBooleanDataField","makeDoubleDataField","makeGuidDataField","makeInt64DataField","makeStringDataField","DataFieldType","getEffectiveEventFlags","CostPriority","DataCategories","DiagnosticLevel","PersistencePriority","SamplingPolicy"].indexOf(l)<0&&(c[l]=function(t){return g[t]}.bind(0,l));n.d(e,c);var v=n(58113),y=n(42783),m=n(14186),_=n(14565);c={};for(var l in _)["default","Contracts","ActivityScope","addContractField","getFieldsForContract","DataClassification","makeBooleanDataField","makeDoubleDataField","makeGuidDataField","makeInt64DataField","makeStringDataField","DataFieldType","getEffectiveEventFlags","CostPriority","DataCategories","DiagnosticLevel","PersistencePriority","SamplingPolicy","Category","LogLevel","logError","logNotification","onNotification","SimpleTelemetryLogger","SuppressNexus","TelemetryLogger"].indexOf(l)<0&&(c[l]=function(t){return _[t]}.bind(0,l));n.d(e,c);var S=n(1893);c={};for(var l in S)["default","Contracts","ActivityScope","addContractField","getFieldsForContract","DataClassification","makeBooleanDataField","makeDoubleDataField","makeGuidDataField","makeInt64DataField","makeStringDataField","DataFieldType","getEffectiveEventFlags","CostPriority","DataCategories","DiagnosticLevel","PersistencePriority","SamplingPolicy","Category","LogLevel","logError","logNotification","onNotification","SimpleTelemetryLogger","SuppressNexus","TelemetryLogger"].indexOf(l)<0&&(c[l]=function(t){return S[t]}.bind(0,l));n.d(e,c);var T=n(11819);c={};for(var l in T)["default","Contracts","ActivityScope","addContractField","getFieldsForContract","DataClassification","makeBooleanDataField","makeDoubleDataField","makeGuidDataField","makeInt64DataField","makeStringDataField","DataFieldType","getEffectiveEventFlags","CostPriority","DataCategories","DiagnosticLevel","PersistencePriority","SamplingPolicy","Category","LogLevel","logError","logNotification","onNotification","SimpleTelemetryLogger","SuppressNexus","TelemetryLogger"].indexOf(l)<0&&(c[l]=function(t){return T[t]}.bind(0,l));n.d(e,c)},57386:function(t,e,n){"use strict";var i;n.d(e,{H:function(){return i}}),function(t){t[t.EssentialServiceMetadata=1]="EssentialServiceMetadata",t[t.AccountData=2]="AccountData",t[t.SystemMetadata=4]="SystemMetadata",t[t.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",t[t.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",t[t.CustomerContent=32]="CustomerContent",t[t.AccessControl=64]="AccessControl"}(i||(i={}))},98588:function(t,e,n){"use strict";var i;n.d(e,{_:function(){return i}}),function(t){t[t.String=0]="String",t[t.Boolean=1]="Boolean",t[t.Int64=2]="Int64",t[t.Double=3]="Double",t[t.Guid=4]="Guid"}(i||(i={}))},78920:function(t,e,n){"use strict";n.d(e,{WD:function(){return r},in:function(){return i},H:function(){return a},uf:function(){return s}});var i,r,o=new(function(){function t(){this._listeners=[]}return t.prototype.fireEvent=function(t){this._listeners.forEach((function(e){return e(t)}))},t.prototype.addListener=function(t){t&&this._listeners.push(t)},t.prototype.removeListener=function(t){this._listeners=this._listeners.filter((function(e){return e!==t}))},t.prototype.getListenerCount=function(){return this._listeners.length},t}());function s(t,e,n){o.fireEvent({level:t,category:e,message:n})}function a(t,e,n){s(i.Error,t,(function(){var t=n instanceof Error?n.message:"";return e+": "+t}))}!function(t){t[t.Error=0]="Error",t[t.Warning=1]="Warning",t[t.Info=2]="Info",t[t.Verbose=3]="Verbose"}(i||(i={})),function(t){t[t.Core=0]="Core",t[t.Sink=1]="Sink",t[t.Transport=2]="Transport"}(r||(r={}))},54716:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t,e){this.sessionTrackingKey=t,this.lastActiveTime=e};e.SignedInAccount=n},28168:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(38438),r=n(22263),o=n(21564),s=n(71381),a=n(17753),u=n(87321),c=function(){function t(e,n){void 0===n&&(n=null),window.addEventListener("storage",(function(){t.prototype.enableAutomaticPopup&&t.prototype.showPrompt("Unspecified")})),t.prototype.appendLoginHint=!1,t.prototype.enableConsoleLog=!1,a.MultiAccountSessionTrackerState.prototype.enableConsoleLog=t.prototype.enableConsoleLog,t.prototype.enablePageRedirect=!1,t.prototype.enableAutomaticPopup=!0,t.prototype.appFriendlyName=s.Constants.removeWWW(window.location.hostname),t.prototype.updateConfiguration(e),null==e.mastPromptLocalizedStrings&&i.LoggingUtils.error("MAST component initialization failed because there is no valid localized strings provided.",t.prototype.enableConsoleLog),null!=n&&t.prototype.setCallbacks(n),o.TelemetryUtils.setUpTelemetryLogger(),o.TelemetryUtils.logTelemetryEventForLoad(t.prototype.appFriendlyName),i.LoggingUtils.log("Successfully initialized MAST component with provided configurations.",t.prototype.enableConsoleLog)}return t.prototype.updateConfiguration=function(e){if(null==e)return!1;null!=e.appendLoginHint&&(t.prototype.appendLoginHint=e.appendLoginHint),null!=e.enablePageRedirect&&(t.prototype.enablePageRedirect=e.enablePageRedirect),null!=e.enableAutomaticPopup&&(t.prototype.enableAutomaticPopup=e.enableAutomaticPopup),null!=e.enableConsoleLogging&&(t.prototype.enableConsoleLog=e.enableConsoleLogging,a.MultiAccountSessionTrackerState.prototype.enableConsoleLog=t.prototype.enableConsoleLog),null!=e.mastPromptLocalizedStrings&&(t.prototype.mastPromptLocalizedStrings=e.mastPromptLocalizedStrings),r.StringUtils.isEmpty(e.appFriendlyName)||(t.prototype.appFriendlyName=e.appFriendlyName),r.StringUtils.isEmpty(e.postAccountSwitchRedirectUri)||(t.prototype.postAccountSwitchRedirectUri=e.postAccountSwitchRedirectUri),r.StringUtils.isEmpty(e.postLogoutRedirectUri)||(t.prototype.postLogoutRedirectUri=e.postLogoutRedirectUri),i.LoggingUtils.log("Successfully updated MAST component with provided configurations.",t.prototype.enableConsoleLog)},t.prototype.setCallbacks=function(e){null!=e?t.prototype.customCallbacks=e:i.LoggingUtils.error("Failed to set custom callback functions because provided callback object is null.",t.prototype.enableConsoleLog)},t.prototype.getSwitchAccountPromptDescription=function(e){return r.StringUtils.isEmpty(e)?r.StringUtils.formatString(t.prototype.mastPromptLocalizedStrings.switchAccountDescriptionWithoutUpn,t.prototype.mastPromptLocalizedStrings.appFriendlyName):r.StringUtils.formatString(t.prototype.mastPromptLocalizedStrings.switchAccountDescriptionWithUpn,e,t.prototype.mastPromptLocalizedStrings.appFriendlyName)},t.prototype.getSignOutPromptDescription=function(e){return r.StringUtils.isEmpty(e)?r.StringUtils.formatString(t.prototype.mastPromptLocalizedStrings.signOutDescriptionWithoutUpn,t.prototype.mastPromptLocalizedStrings.appFriendlyName):r.StringUtils.formatString(t.prototype.mastPromptLocalizedStrings.signOutDescriptionWithUpn,e,t.prototype.mastPromptLocalizedStrings.appFriendlyName)},t.prototype.onRefreshButtonClick=function(e,n){void 0===n&&(n=t.prototype.customCallbacks),null!=n&&null!=n.afterSwitchAccountButtonClickCallbackFunction&&n.afterSwitchAccountButtonClickCallbackFunction();var i=window.sessionStorage.getItem(s.Constants.PersistentCacheKeys.ActiveAccountIdentifierKey)||"";o.TelemetryUtils.logTelemetryEventForPrompt(i,t.prototype.appFriendlyName,o.TelemetryUtils.SwitchAccount,!0),t.prototype.enablePageRedirect&&location.assign(e)},t.prototype.getSwitchAccountRedirectUri=function(e,n,i){void 0===i&&(i=t.prototype.customCallbacks);var o=r.StringUtils.isEmpty(t.prototype.postAccountSwitchRedirectUri)?window.location.href:t.prototype.postAccountSwitchRedirectUri;if(null!=i&&null!=i.modifySwitchAccountRedirectUriFunction&&(o=i.modifySwitchAccountRedirectUriFunction(e,n,o)),t.prototype.appendLoginHint&&!r.StringUtils.isEmpty(n.upn)&&-1===o.indexOf(s.Constants.Web.LoginHintQueryString)){var a=-1===o.indexOf("?")?"?":"&";o=o+"\n\t\t\t\t"+a+"\n\t\t\t\t"+s.Constants.Web.LoginHintQueryString+"\n\t\t\t\t"+n.upn}return o},t.prototype.onSignoutButtonClick=function(e,n){void 0===n&&(n=t.prototype.customCallbacks),null!=n&&null!=n.afterSignOutButtonClickCallbackFunction&&n.afterSignOutButtonClickCallbackFunction();var i=window.sessionStorage.getItem(s.Constants.PersistentCacheKeys.ActiveAccountIdentifierKey)||"";o.TelemetryUtils.logTelemetryEventForPrompt(i,t.prototype.appFriendlyName,o.TelemetryUtils.SignOut,!0),t.prototype.enablePageRedirect&&location.assign(e)},t.prototype.getSignoutRedirectUri=function(e,n){void 0===n&&(n=t.prototype.customCallbacks);var i=r.StringUtils.isEmpty(t.prototype.postLogoutRedirectUri)?window.location.href:t.prototype.postLogoutRedirectUri;return null!=n&&null!=n.modifySignoutRedirectUriFunction&&(i=n.modifySignoutRedirectUriFunction(e,i)),i},t.prototype.showPrompt=function(e){var n=window.sessionStorage.getItem(s.Constants.PersistentCacheKeys.ActiveAccountIdentifierKey)||"",i=a.MultiAccountSessionTrackerState.prototype.getMostRecentActiveAccount();switch(e){case"Unspecified":if(r.StringUtils.isEmpty(n))return;if(r.StringUtils.isEmpty(i))return void t.prototype.renderSignOutPrompt();i!==window.sessionStorage.getItem(s.Constants.PersistentCacheKeys.ActiveAccountIdentifierKey)&&t.prototype.renderSwitchAccountPrompt(i);break;case"SignOut":t.prototype.renderSignOutPrompt();break;case"SwitchAccount":t.prototype.renderSwitchAccountPrompt(i)}},t.prototype.renderSwitchAccountPrompt=function(e,n){void 0===n&&(n=t.prototype.customCallbacks),null!=n&&null!=n.beforeSwitchAccountPromptCallbackFunction&&n.beforeSwitchAccountPromptCallbackFunction();var u=JSON.parse(window.localStorage.getItem(e)||"[]"),c=window.sessionStorage.getItem(s.Constants.PersistentCacheKeys.ActiveAccountIdentifierKey)||"",l=JSON.parse(window.localStorage.getItem(c)||"[]"),f=t.prototype.getSwitchAccountRedirectUri(l,u,n),d={title:t.prototype.mastPromptLocalizedStrings.switchAccountTitle,description:t.prototype.getSwitchAccountPromptDescription(r.StringUtils.isEmpty(u.upn)?"":u.upn),subDescription:t.prototype.mastPromptLocalizedStrings.switchAccountSubDescription,buttonText:t.prototype.mastPromptLocalizedStrings.switchAccountButtonText,divName:s.Constants.BlockingPromptStrings.DivName,buttonClickFunction:function(){return t.prototype.onRefreshButtonClick(f,n)}};t.prototype.renderPrompt(d),a.MultiAccountSessionTrackerState.prototype.refreshPage(f),null!=n&&null!=n.afterSwitchAccountPromptCallbackFunction&&n.afterSwitchAccountPromptCallbackFunction(),o.TelemetryUtils.logTelemetryEventForPrompt(c,t.prototype.appFriendlyName,o.TelemetryUtils.SwitchAccount),i.LoggingUtils.log("Successfully shown switch account prompt.",t.prototype.enableConsoleLog)},t.prototype.renderSignOutPrompt=function(e){void 0===e&&(e=t.prototype.customCallbacks),null!=e&&null!=e.beforeSignOutPromptCallbackFunction&&e.beforeSignOutPromptCallbackFunction();var n=u.MultiAccountSessionTrackerLogout.prototype.getSignedOutAccountData(),c=u.MultiAccountSessionTrackerLogout.prototype.getMostRecentSignedOutAccount(),l=t.prototype.getSignoutRedirectUri(n,e),f={title:t.prototype.mastPromptLocalizedStrings.signOutTitle,description:t.prototype.getSignOutPromptDescription(r.StringUtils.isEmpty(n.upn)?"":n.upn),subDescription:t.prototype.mastPromptLocalizedStrings.signOutSubDescription,buttonText:t.prototype.mastPromptLocalizedStrings.signOutButtonText,divName:s.Constants.BlockingPromptStrings.DivName,buttonClickFunction:function(){return t.prototype.onSignoutButtonClick(l,e)}};t.prototype.renderPrompt(f),a.MultiAccountSessionTrackerState.prototype.signOutPage(l,n.sessionId),null!=e&&null!=e.afterSignOutPromptCallbackFunction&&e.afterSignOutPromptCallbackFunction(),o.TelemetryUtils.logTelemetryEventForPrompt(c,t.prototype.appFriendlyName,o.TelemetryUtils.SignOut),i.LoggingUtils.log("Successfully shown sign out prompt.",t.prototype.enableConsoleLog)},t.prototype.renderPrompt=function(e){if(null!=window.MastUI)window.MastUI.MultiAccountSessionTrackerRenderPrompt(e);else{if(null==window.LoadMastPromptJs)return void i.LoggingUtils.error("Can't find the declaration of the prompt. Not showing prompt.",t.prototype.enableConsoleLog);window.LoadMastPromptJs.Download((function(){return window.MastUI.MultiAccountSessionTrackerRenderPrompt(e)}))}},t}();e.MultiAccountSessionTracker=c,window.MastInteraction={UpdateConfiguration:c.prototype.updateConfiguration,SetCallbacks:c.prototype.setCallbacks,ClearAccountState:a.MultiAccountSessionTrackerState.prototype.clearAccountState,GetMostRecentActiveAccount:a.MultiAccountSessionTrackerState.prototype.getMostRecentActiveAccount,SetActiveAccount:a.MultiAccountSessionTrackerState.prototype.setActiveAccount,UpdateAccount:a.MultiAccountSessionTrackerState.prototype.updateAccount,RefreshPage:a.MultiAccountSessionTrackerState.prototype.refreshPage,SignOutPage:a.MultiAccountSessionTrackerState.prototype.signOutPage,ShowPrompt:c.prototype.showPrompt}},87321:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(71381),r=n(38438),o=n(22263),s=function(){function t(){}return t.prototype.signOutAccount=function(t,e,n){var s,a;void 0===e&&(e=!0),void 0===n&&(n=!1);var u=JSON.parse(window.localStorage.getItem(i.Constants.PersistentCacheKeys.SignedInAccountListKey)||"[]");if(o.StringUtils.isEmpty(t)){var c=window.sessionStorage.getItem(i.Constants.PersistentCacheKeys.ActiveAccountIdentifierKey)||"";if(!o.StringUtils.isEmpty(c)){s=JSON.parse(window.localStorage.getItem(c)||"[]");for(var l=u.length-1;l>=0;l--){if(c===(f=u[l].sessionTrackingKey)){a=l;break}}}}else for(l=u.length-1;l>=0;l--){var f=u[l].sessionTrackingKey,d=JSON.parse(window.localStorage.getItem(f)||"[]");if(d&&!o.StringUtils.isEmpty(d.sessionId)&&d.sessionId.toLowerCase()===t.toLowerCase()){s=d,a=l;break}}return s?(e?(window.localStorage.removeItem(f),u.splice(a,1),r.LoggingUtils.log("Cleared the account state in local storage.",n)):s&&(s.lastActiveTime=(new Date).getTime(),s.authenticatedState=3,u[a].lastActiveTime=0,window.localStorage.setItem(f,JSON.stringify(s)),r.LoggingUtils.log("Updated account's authenticated state to NotSignedIn in local storage.",n)),window.localStorage.setItem(i.Constants.PersistentCacheKeys.SignedInAccountListKey,JSON.stringify(u)),window.sessionStorage.removeItem(i.Constants.PersistentCacheKeys.ActiveAccountIdentifierKey),!0):(r.LoggingUtils.error("Cannot sign out accounts when session Id is empty and no active account signed in.",n),!1)},t.prototype.getSignedOutAccountData=function(){var t=window.sessionStorage.getItem(i.Constants.PersistentCacheKeys.ActiveAccountIdentifierKey)||"";return o.StringUtils.isEmpty(t)&&(t=this.getMostRecentSignedOutAccount()),o.StringUtils.isEmpty(t)?"[]":JSON.parse(window.localStorage.getItem(t)||"[]")},t.prototype.getMostRecentSignedOutAccount=function(){var t=JSON.parse(window.localStorage.getItem(i.Constants.PersistentCacheKeys.SignedInAccountListKey)||"[]"),e="",n=0;return t.forEach((function(t){if(0===t.lastActiveTime){var i=JSON.parse(window.localStorage.getItem(t.sessionTrackingKey)||"[]");3===i.authenticatedState&&i.lastActiveTime&&i.lastActiveTime>n&&(n=i.lastActiveTime,e=t.sessionTrackingKey)}})),e},t}();e.MultiAccountSessionTrackerLogout=s},17753:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(54716),r=n(38438),o=n(22263),s=n(71381),a=n(87321),u=function(){function t(){}return t.prototype.clearAccountState=function(t){for(var e=JSON.parse(window.localStorage.getItem(s.Constants.PersistentCacheKeys.SignedInAccountListKey)||"[]"),n=e.length-1;n>=0;n--)e[n].lastActiveTime<t&&(window.localStorage.removeItem(e[n].sessionTrackingKey),e.splice(n,1));window.localStorage.setItem(s.Constants.PersistentCacheKeys.SignedInAccountListKey,JSON.stringify(e))},t.prototype.getMostRecentActiveAccount=function(){var t=JSON.parse(window.localStorage.getItem(s.Constants.PersistentCacheKeys.SignedInAccountListKey)||"[]"),e="",n=0;return t.forEach((function(t){t.lastActiveTime&&t.lastActiveTime>n&&(3!==JSON.parse(window.localStorage.getItem(t.sessionTrackingKey)||"[]").authenticatedState&&(n=t.lastActiveTime,e=t.sessionTrackingKey))})),e},t.prototype.setActiveAccount=function(e){var n=t.prototype.generateKey(e),i=JSON.parse(window.localStorage.getItem(n)||"[]");return o.StringUtils.isEmpty(i)?(r.LoggingUtils.error("Cannot update the account to active because the account does not exist in the storage.",t.prototype.enableConsoleLog),!1):(window.sessionStorage.setItem(s.Constants.PersistentCacheKeys.ActiveAccountIdentifierKey,n),t.prototype.updateSignedInAccountListAndAccountData(n,(new Date).getTime(),i),!0)},t.prototype.updateAccount=function(e,n,i){if(o.StringUtils.isEmpty(e))return r.LoggingUtils.error("Cannot update account information with null or empty account identifier.",t.prototype.enableConsoleLog),!1;var a=t.prototype.generateKey(e);return i&&window.sessionStorage.setItem(s.Constants.PersistentCacheKeys.ActiveAccountIdentifierKey,a),t.prototype.updateSignedInAccountListAndAccountData(a,i?(new Date).getTime():0,n),!0},t.prototype.signOutPage=function(t,e,n){void 0===n&&(n=!0),a.MultiAccountSessionTrackerLogout.prototype.signOutAccount(e,n),window.postMessage({request:s.Constants.PostMessageType.SignOutBackToLanding,url:t},window.location.href)},t.prototype.refreshPage=function(e){var n=t.prototype.getMostRecentActiveAccount();window.sessionStorage.setItem(s.Constants.PersistentCacheKeys.ActiveAccountIdentifierKey,n),window.postMessage({request:s.Constants.PostMessageType.SwitchAccountRedirect,url:e},window.location.href)},t.prototype.updateSignedInAccountListAndAccountData=function(t,e,n){for(var r=JSON.parse(window.localStorage.getItem(s.Constants.PersistentCacheKeys.SignedInAccountListKey)||"[]"),o=r.length-1;o>=0;o--)if(r[o].sessionTrackingKey.toLowerCase()===t.toLowerCase()){r.splice(o,1);break}0===e?r.unshift(new i.SignedInAccount(t,e)):r.push(new i.SignedInAccount(t,e)),n.lastActiveTime=e,window.localStorage.setItem(t,JSON.stringify(n)),window.localStorage.setItem(s.Constants.PersistentCacheKeys.SignedInAccountListKey,JSON.stringify(r))},t.prototype.generateKey=function(t){return""+s.Constants.PersistentCacheKeys.SessionTrackingPrefix+t},t}();e.MultiAccountSessionTrackerState=u},76820:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,i=function(){function t(){}return t.GetBrowser=function(){var t=[{keyword:"PhantomJS",browserType:n.PhantomJS},{keyword:"Edge",browserType:n.Edge},{keyword:"MSIE",browserType:n.IE},{keyword:"Teams",browserType:n.Teams},{keyword:"Chrome",browserType:n.Chrome},{keyword:"CriOS",browserType:n.Chrome},{keyword:"Firefox",browserType:n.Firefox},{keyword:"Safari",browserType:n.Safari}],e=window.navigator.userAgent.toLowerCase(),i={keyword:"Other",browserType:n.Other};return t.some((function(t){return-1!==e.indexOf(t.keyword.toLowerCase())&&(i=t,!0)})),i.keyword.toString()},t}();e.BrowserUtils=i,function(t){t[t.IE=0]="IE",t[t.Edge=1]="Edge",t[t.Teams=2]="Teams",t[t.Chrome=3]="Chrome",t[t.Firefox=4]="Firefox",t[t.Safari=5]="Safari",t[t.PhantomJS=6]="PhantomJS",t[t.Other=7]="Other"}(n=e.BrowserType||(e.BrowserType={}))},71381:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){var e=function(){function t(){}return t.DivName="mast",t}();t.BlockingPromptStrings=e;var n=function(){function t(){}return t.SessionTrackingPrefix="sessionTracking_",t.ActiveAccountIdentifierKey=t.SessionTrackingPrefix+"ActiveAccountIdentifier",t.SignedInAccountListKey=t.SessionTrackingPrefix+"SignedInAccountList",t}();t.PersistentCacheKeys=n;var i=function(){function t(){}return t.SwitchAccountRedirect="SwitchAccountRedirect",t.SignOutBackToLanding="SignOutBackToLanding",t}();t.PostMessageType=i;var r=function(){function t(){}return t.LoginHintQueryString="login_hint=",t.WwwDot="www.",t}();t.Web=r,t.removeWWW=function(t){var e=t.indexOf(r.WwwDot),n=r.WwwDot.length;return e<0&&t.length>n?t:t.substring(n)}}(e.Constants||(e.Constants={}))},38438:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.shouldProceed=function(t){return!(null!=t&&void 0!==t&&!t)},t.log=function(e,n){t.shouldProceed(n)},t.warn=function(e,n){t.shouldProceed(n)},t.error=function(e,n){t.shouldProceed(n)},t}();e.LoggingUtils=n},22263:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.isEmpty=function(t){return!t||void 0===t||0===t.length},t.formatString=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t?t.replace(/\{(\d+)\}/g,(function(t,n){return void 0===e[n]?t:e[n]})):""},t}();e.StringUtils=n},21564:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(76820),r=n(6567),o=n(25578),s=function(){function t(){}return t.setUpTelemetryLogger=function(){this.telemetryLogger.setTenantTokens({Office:{Identity:{ariaTenantToken:"5c65bbc4edbf480d9637ace04d62bd98-12844893-8ab9-4dde-b850-5612cb12e0f2-7822",nexusTenantToken:-1,WebAuthMast:{}}}});var t=new r.OneDSSink([],{endpointUrl:r.OneDSEndpoint.PUBLIC});t.setFullEventsEnabled(!0),this.telemetryLogger.addSink(t)},t.logTelemetryEventForLoad=function(e){this.telemetryLogger.sendTelemetryEvent({eventName:t.DefaultLoggingNamespace+t.LoadEventName,dataFields:[o.makeStringDataField(t.AppName,e),o.makeStringDataField(t.BrowserName,i.BrowserUtils.GetBrowser())]})},t.logTelemetryEventForPrompt=function(e,n,r,s){void 0===s&&(s=!1),this.telemetryLogger.sendTelemetryEvent({eventName:t.DefaultLoggingNamespace+t.PromptEventName,dataFields:[o.makeStringDataField(t.Puid,e),o.makeStringDataField(t.AppName,n),o.makeStringDataField(t.BrowserName,i.BrowserUtils.GetBrowser()),o.makeStringDataField(t.PromptType,r),o.makeBooleanDataField(t.ButtonClicked,s)]})},t.DefaultLoggingNamespace="Office.Identity.WebAuthMast.",t.LoadEventName="Load",t.PromptEventName="Prompt",t.AppName="AppName",t.BrowserName="BrowserName",t.ButtonClicked="ButtonClicked",t.PromptType="PromptType",t.Puid="Puid",t.SignOut="Sign Out",t.SwitchAccount="Switch Account",t.telemetryLogger=new o.TelemetryLogger,t}();e.TelemetryUtils=s},84269:function(t,e,n){var i=n(8266),r=n(25638),o=r;o.v1=i,o.v4=r,t.exports=o},68547:function(t){for(var e=[],n=0;n<256;++n)e[n]=(n+256).toString(16).substr(1);t.exports=function(t,n){var i=n||0,r=e;return[r[t[i++]],r[t[i++]],r[t[i++]],r[t[i++]],"-",r[t[i++]],r[t[i++]],"-",r[t[i++]],r[t[i++]],"-",r[t[i++]],r[t[i++]],"-",r[t[i++]],r[t[i++]],r[t[i++]],r[t[i++]],r[t[i++]],r[t[i++]]].join("")}},3017:function(t){var e="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(e){var n=new Uint8Array(16);t.exports=function(){return e(n),n}}else{var i=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),i[e]=t>>>((3&e)<<3)&255;return i}}},8266:function(t,e,n){var i,r,o=n(3017),s=n(68547),a=0,u=0;t.exports=function(t,e,n){var c=e&&n||0,l=e||[],f=(t=t||{}).node||i,d=void 0!==t.clockseq?t.clockseq:r;if(null==f||null==d){var p=o();null==f&&(f=i=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==d&&(d=r=16383&(p[6]<<8|p[7]))}var h=void 0!==t.msecs?t.msecs:(new Date).getTime(),g=void 0!==t.nsecs?t.nsecs:u+1,v=h-a+(g-u)/1e4;if(v<0&&void 0===t.clockseq&&(d=d+1&16383),(v<0||h>a)&&void 0===t.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=h,u=g,r=d;var y=(1e4*(268435455&(h+=122192928e5))+g)%4294967296;l[c++]=y>>>24&255,l[c++]=y>>>16&255,l[c++]=y>>>8&255,l[c++]=255&y;var m=h/4294967296*1e4&268435455;l[c++]=m>>>8&255,l[c++]=255&m,l[c++]=m>>>24&15|16,l[c++]=m>>>16&255,l[c++]=d>>>8|128,l[c++]=255&d;for(var _=0;_<6;++_)l[c+_]=f[_];return e||s(l)}},25638:function(t,e,n){var i=n(3017),r=n(68547);t.exports=function(t,e,n){var o=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var s=(t=t||{}).random||(t.rng||i)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e)for(var a=0;a<16;++a)e[o+a]=s[a];return e||r(s)}}}]),HighResolutionTimingSupported&&(shellPerformance.mark("shell_mast_end"),shellPerformance.measure("shell_mast","shell_mast_start","shell_mast_end"));