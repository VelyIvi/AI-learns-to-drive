"use strict";(self.webpackChunkOwa_name_=self.webpackChunkOwa_name_||[]).push([[45961],{345961:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(973472),t)},716614:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=n(964973),o=n(128358),a=function(){function e(e,t){this.settingsOverride=e,this.additionalFeatures=t}return e.prototype.getName=function(){return"ContentEdit"},e.prototype.initialize=function(e){var t=this,n=[],a=(0,r.default)();(0,o.getObjectKeys)(a).forEach((function(e){var r=a[e],o=t.settingsOverride&&void 0!==t.settingsOverride[e];(o&&t.settingsOverride[e]||!o&&!r.defaultDisabled)&&n.push(r)})),n.concat(this.additionalFeatures||[]).forEach((function(t){return e.addContentEditFeature(t)}))},e.prototype.dispose=function(){},e}();t.default=a},151166:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AutoLinkFeatures=void 0;var r=n(463816),o=n(128358),a=/[.+=\s:;"',>]+$/i,i={keys:[13,32,257],shouldHandleEvent:u,handleEvent:function(e,t){var n=t.getDocument().createElement("a"),a=u(e,t),i=t.getContentSearcherOfCursor();n.textContent=a.originalUrl,n.href=a.normalizedUrl,t.runAsync((function(t){t.addUndoSnapshot((function(){return(0,r.replaceWithNode)(t,a.originalUrl,n,!1,i),(0,o.clearEventDataCache)(e),n}),"AutoLink",!0)}))}},l={keys:[8],shouldHandleEvent:function(e,t){return t.getContentSearcherOfCursor(e).getInlineElementBefore()instanceof o.LinkInlineElement},handleEvent:function(e,t){e.rawEvent.preventDefault(),(0,r.removeLink)(t)},defaultDisabled:!0};function u(e,t){return 0==e.eventType||7==e.eventType&&"Paste"==e.source?(0,o.cacheGetEventData)(e,"LINK_DATA",(function(){var n=7==e.eventType&&"Paste"==e.source&&e.data,r=(0,o.matchLink)((n.text||"").trim()),i=t.getContentSearcherOfCursor(e);if(r&&i.getRangeFromText(r.originalUrl,!1))return r;var l=i&&i.getWordBefore();if(l&&l.length>5){var u=(l.match(a)||[])[0]||"",s=l.substring(0,l.length-u.length);return["()","{}","[]"].forEach((function(e){s[s.length-1]==e[1]&&s.indexOf(e[0])<0&&(s=s.substr(0,s.length-1))})),(0,o.matchLink)(s)}return null})):null}t.AutoLinkFeatures={autoLink:i,unlinkWhenBackspaceAfterLink:l}},785616:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CursorFeatures=void 0;var r=n(128358),o={keys:[37,39],allowFunctionKeys:!0,shouldHandleEvent:function(e,t,n){var o,a;if(!(n&&(o=t.getSelectionRange())&&o.collapsed&&(a=r.Position.getStart(o))&&t.isPositionAtBeginning(a)))return!1;var i="rtl"==(0,r.getComputedStyle)(a.element,"direction"),l=e.rawEvent;return!i&&37==l.which||i&&39==l.which},handleEvent:function(e){e.rawEvent.preventDefault()},defaultDisabled:!r.Browser.isChrome};t.CursorFeatures={noCycleCursorMove:o}},264666:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EntityFeatures=void 0;var r=n(128358),o={keys:[13],shouldHandleEvent:function(e,t){return i(e,t)},handleEvent:function(e,t){i(e,t,1)}},a={keys:[27],shouldHandleEvent:function(e,t){return i(e,t)},handleEvent:function(e,t){i(e,t,3)}};function i(e,t,n){var o=(0,r.cacheGetEventData)(e,"READONLY_ENTITY_ELEMENT",(function(){var n=e.rawEvent.target,o=n&&t.getElementAtCursor((0,r.getEntitySelector)(),n);return o&&!o.isContentEditable?o:null}));return o&&void 0!==n&&t.triggerPluginEvent(15,{operation:n,rawEvent:e.rawEvent,entity:(0,r.getEntityFromElement)(o)}),o}var l={keys:[13],shouldHandleEvent:function(e,t){return d(e,t,!0,!1)},handleEvent:function(e,t){var n;e.rawEvent.preventDefault();var o=t.getSelectionRange(),a=r.Position.getEnd(o).normalize().node,i=t.getDocument().createElement("BR");a.parentNode.insertBefore(i,a.nextSibling);var l,u=t.getBlockElementAtNode(a);u&&(l=u.collapseToSingleElement(),null===(n=i.parentNode)||void 0===n||n.removeChild(i)),t.getSelectionRange().deleteContents(),l.nextSibling&&t.select(l.nextSibling,0)}},u={keys:[8],shouldHandleEvent:function(e,t){return d(e,t,!1,!0)},handleEvent:function(e,t){d(e,t,!1,!0,5)}},s={keys:[46],shouldHandleEvent:function(e,t){return d(e,t,!0,!0)},handleEvent:function(e,t){d(e,t,!0,!0,4)}};function d(e,t,n,o,a){var i=(0,r.cacheGetEventData)(e,"NEIGHBOR_ENTITY_ELEMENT_"+n+"_"+o,(function(){var e=t.getSelectionRange();if(o&&!e.collapsed)return null;e.commonAncestorContainer.normalize();var a=r.Position.getEnd(e).normalize(),i=null;if(0==a.offset||a.isAtEnd){var l=t.getBodyTraverser(a.node),u=n?0==a.offset?l.currentInlineElement:l.getNextInlineElement():a.isAtEnd?l.currentInlineElement:l.getPreviousInlineElement(),s=u&&u.getContainerNode();if(!o){var d=t.getBlockElementAtNode(a.node);d&&d.contains(s)||(s=null)}i=s&&t.getElementAtCursor((0,r.getEntitySelector)(),s)}return i}));return i&&void 0!==a&&t.triggerPluginEvent(15,{operation:a,rawEvent:e.rawEvent,entity:(0,r.getEntityFromElement)(i)}),i}t.EntityFeatures={clickOnEntity:o,escapeFromEntity:a,enterBeforeReadonlyEntity:l,backspaceAfterEntity:u,deleteBeforeEntity:s}},923046:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ListFeatures=void 0;var r=n(380276),o=n(765021),a=n(463816),i=n(128358),l={keys:[9],shouldHandleEvent:function(e,t){return!e.rawEvent.shiftKey&&C(e,t)},handleEvent:function(e,t){(0,a.setIndentation)(t,0),e.rawEvent.preventDefault()}},u={keys:[9],shouldHandleEvent:function(e,t){return e.rawEvent.shiftKey&&C(e,t)},handleEvent:function(e,t){(0,a.setIndentation)(t,1),e.rawEvent.preventDefault()}},s={keys:[8],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",null,e),r=t.getSelectionRange();return n&&(null==r?void 0:r.collapsed)&&(0,i.isPositionAtBeginningOf)(i.Position.getStart(r),n)},handleEvent:function(e,t){var n=t.getElementAtCursor("LI",null,e);n.previousSibling?(0,a.blockFormat)(t,(function(t,r,o){var a=(0,i.createVListFromRegion)(t,!1,n);a.setIndentation(r,o,1,!0),a.writeBack(),e.rawEvent.preventDefault()})):b(e,t)},defaultDisabled:!0},d={keys:[8],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",null,e);return n&&(0,i.isNodeEmpty)(n)&&!n.previousSibling},handleEvent:b},c={keys:[46],shouldHandleEvent:function(e,t){if(t.getElementAtCursor("LI",null,e))return!1;var n=i.Position.getEnd(t.getSelectionRange()).isAtEnd?function(e,t){return(0,i.cacheGetEventData)(e,"nextSibling",(function(){var e,n=t.getSelectionRange(),r=i.Position.getEnd(n).normalize(),o=t.getBodyTraverser(r.node);return null===(e=null==o?void 0:o.getNextBlockElement())||void 0===e?void 0:e.getStartNode()}))}(e,t):null;return t.getElementAtCursor("LI",n,e)},handleEvent:function(e,t){var n=p(t);t.runAsync((function(e){return(0,a.experimentCommitListChains)(e,n)}))}},f={keys:[13],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",null,e);return!e.rawEvent.shiftKey&&n&&(0,i.isNodeEmpty)(n)},handleEvent:function(e,t){t.addUndoSnapshot((function(){return b(e,t,!1)}),null,!0)},defaultDisabled:!i.Browser.isIE&&!i.Browser.isChrome};function v(e){return/^(\*|-|[0-9]{1,2}\.|[0-9]{1,2}\>|[0-9]{1,2}\)|[0-9]{1,2}\-|\([0-9]{1,2}\))$/.test(e)}var g={keys:[32],shouldHandleEvent:function(e,t){if(!C(e,t)){var n=t.getContentSearcherOfCursor(e);return v(n.getSubStringBefore(4))&&!n.getNearestNonTextInlineElement()}return!1},handleEvent:function(e,t){t.insertContent("&nbsp;"),e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){var e,n,r=t.getContentSearcherOfCursor(),o=r.getSubStringBefore(4),i=r.getRangeFromText(o,!0);if(i){if(0==o.indexOf("*")||0==o.indexOf("-"))y(t,i),(0,a.toggleBullet)(t);else if(v(o))y(t,i),(0,a.toggleNumbering)(t);else if((n=t.getSelectedRegions())&&1==n.length){var l=parseInt(o);y(t,i),(0,a.toggleNumbering)(t,l)}}else;null===(e=r.getRangeFromText(o,!0))||void 0===e||e.deleteContents()}),null,!0)}},E={keys:[32],shouldHandleEvent:function(e,t){return!(C(e,t)||!t.isFeatureEnabled("AutoFormatList"))&&S(e,t,r.default)},handleEvent:function(e,t){t.insertContent("&nbsp;"),e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){var e,n=t.getContentSearcherOfCursor(),o=n.getSubStringBefore(5),i=n.getRangeFromText(o,!0),l=(0,r.default)(o);i&&(y(t,i),(0,a.toggleBullet)(t,l,"autoToggleList")),null===(e=n.getRangeFromText(o,!0))||void 0===e||e.deleteContents()}),null,!0)}},h={keys:[32],shouldHandleEvent:function(e,t){return!(C(e,t)||!t.isFeatureEnabled("AutoFormatList"))&&S(e,t,o.default)},handleEvent:function(e,t){t.insertContent("&nbsp;"),e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){var e,n,r=t.getContentSearcherOfCursor(),i=r.getSubStringBefore(5),l=r.getRangeFromText(i,!0);if(l)if((n=t.getSelectedRegions())&&1==n.length){var u=parseInt(i),s=(0,o.default)(i,u);y(t,l),(0,a.toggleNumbering)(t,u,s,"autoToggleList")}else{s=(0,o.default)(i);y(t,l),(0,a.toggleNumbering)(t,void 0,s,"autoToggleList")}else;null===(e=r.getRangeFromText(i,!0))||void 0===e||e.deleteContents()}),null,!0)}},m={keys:[13,9,46,8,258],shouldHandleEvent:function(e,t){return t.queryElements("li",1).length>0},handleEvent:function(e,t){var n=p(t);t.runAsync((function(e){return(0,a.experimentCommitListChains)(e,n)}))}};function p(e){return i.VListChain.createListChains(e.getSelectedRegions())}function y(e,t){var n=e.getBlockElementAtNode(t.startContainer),r=null==n?void 0:n.getEndNode();if(r&&"BR"!=(0,i.getTagOfNode)(r)){var o=e.getDocument().createElement("BR");(0,i.isBlockElement)(r)?r.appendChild(o):r.parentNode.insertBefore(o,r.nextSibling),e.select(t.startContainer,t.startOffset)}}function b(e,t,n){void 0===n&&(n=!0);var r=C(e,t);if(r){var o=r[0],l=(0,i.getTagOfNode)(o);"UL"!=l&&"OL"!=l||(0,a.toggleListType)(t,"UL"==l?2:1,null,n),t.focus(),e.rawEvent.preventDefault()}}function C(e,t){var n=t.getElementAtCursor("LI,TABLE",null,e),r=n&&"LI"==(0,i.getTagOfNode)(n)&&t.getElementAtCursor("UL,OL",n);return r?[r,n]:null}function S(e,t,n){var r=t.getContentSearcherOfCursor(e),o=r.getSubStringBefore(4);return!/\s/g.test(o)&&!r.getNearestNonTextInlineElement()&&n(o)}t.ListFeatures={autoBullet:g,indentWhenTab:l,outdentWhenShiftTab:u,outdentWhenBackspaceOnEmptyFirstLine:d,outdentWhenEnterOnEmptyLine:f,mergeInNewLineWhenBackspaceOnFirstChar:s,maintainListChain:m,maintainListChainWhenDelete:c,autoNumberingList:h,autoBulletList:E}},36017:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MarkdownFeatures=void 0;var r=n(128358);function o(e,t,n,r){return{keys:[e],shouldHandleEvent:function(e,n){return e.rawEvent.shiftKey===r&&!!a(e,n,t)},handleEvent:function(e,r){r.runAsync((function(r){!function(e,t,n,r){t.addUndoSnapshot((function(){var o=a(e,t,n);if(o){var i=o.cloneRange();i.setStart(i.startContainer,i.startOffset+1),o.setEnd(o.endContainer,o.endOffset+1);var l=t.getDocument().createElement(r);l.appendChild(i.extractContents()),o.deleteContents();var u=t.getDocument().createTextNode("​");o.insertNode(u),o.insertNode(l),t.select(u,-1)}}),"Format",!0)}(e,r,t,n)}))}}}function a(e,t,n){return(0,r.cacheGetEventData)(e,"MARKDOWN_RANGE",(function(){var o,a;return t.getContentSearcherOfCursor(e).forEachTextInlineElement((function(e){if(a&&o)return!0;var t=e.getTextContent();if(0==t[t.length-1].trim().length)return!1;if(t[t.length-1]===n)return!1;if(a||(a=e.getStartPosition().move(t.length)),t[0]==n)o=e.getStartPosition();else for(var r=t.length-1;r>0;r--){if(o)return!0;if(t[r]==n&&0==t[r-1].trim().length)return o=e.getStartPosition().move(r),!0}})),!!o&&!!a&&(0,r.createRange)(o,a)}))}var i=o(56,"*","b",!0),l=o(189,"_","i",!0),u=o(192,"~","s",!0),s=o(192,"`","code",!1);t.MarkdownFeatures={markdownBold:i,markdownItalic:l,markdownStrikethru:u,markdownInlineCode:s}},847255:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.QuoteFeatures=void 0;var r=n(463816),o=n(128358),a="BLOCKQUOTE",i=[a,"LI","TD","TH"].join(","),l={keys:[8],shouldHandleEvent:function(e,t){var n=s(e,t);return n&&(0,o.isNodeEmpty)(n)&&!n.previousSibling},handleEvent:d},u={keys:[13],shouldHandleEvent:function(e,t){var n=s(e,t);return!e.rawEvent.shiftKey&&n&&(0,o.isNodeEmpty)(n)},handleEvent:function(e,t){return t.addUndoSnapshot((function(){return d(e,t)}),null,!0)}};function s(e,t){return(0,o.cacheGetEventData)(e,"QUOTE_CHILD",(function(){var e=t.getElementAtCursor(i);if(e&&(0,o.getTagOfNode)(e)==a){var n=t.getFocusedPosition(),r=n&&t.getBlockElementAtNode(n.normalize().node);if(r){var l=r.getStartNode()==e?r.getStartNode():r.collapseToSingleElement();return(0,o.isNodeEmpty)(l)?l:null}}return null}))}function d(e,t){t.addUndoSnapshot((function(){var n,i,l=s(e,t);(0,o.getTagOfNode)(l)==a&&(l=(0,o.wrap)((0,o.toArray)(l.childNodes))),n=(0,o.splitBalancedNodeRange)(l),i=c(n),(0,o.unwrap)(n),t.select(l,0),i&&(0,r.clearFormat)(t)})),e.rawEvent.preventDefault()}var c=function(e){return!!(e&&(0,o.safeInstanceOf)(e,"HTMLQuoteElement")&&e.style.borderLeft&&e.style.borderColor&&e.style.paddingLeft&&e.style.color)};t.QuoteFeatures={unquoteWhenBackspaceOnEmptyFirstLine:l,unquoteWhenEnterOnEmptyLine:u}},350409:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ShortcutFeatures=void 0;var r=n(128358),o=n(463816);function a(e,t,n,r){return void 0===r&&(r=!1),r?null:{winKey:e,macKey:t,action:n}}var i=[a(4162,8258,o.toggleBold),a(4169,8265,o.toggleItalic),a(4181,8277,o.toggleUnderline),a(4128,8224,o.clearFormat),a(4186,8282,(function(e){return e.undo()})),a(26,26,(function(e){return e.undo()}),r.Browser.isMac),a(4185,24666,(function(e){return e.redo()})),a(4286,8382,o.toggleBullet),a(4287,8383,o.toggleNumbering),a(20670,24766,(function(e){return(0,o.changeFontSize)(e,0)})),a(20668,24764,(function(e){return(0,o.changeFontSize)(e,1)}))].filter((function(e){return!!e})),l={allowFunctionKeys:!0,keys:[66,73,85,89,90,188,190,191,32,8],shouldHandleEvent:u,handleEvent:function(e,t){var n=u(e);n&&(n.action(t),e.rawEvent.preventDefault(),e.rawEvent.stopPropagation())}};function u(e){return(0,r.cacheGetEventData)(e,"DEFAULT_SHORT_COMMAND",(function(){var t=e.rawEvent,n=0!=e.eventType||t.getModifierState("AltGraph")?0:t.which|(t.metaKey&&8192)|(t.shiftKey&&16384)|(t.ctrlKey&&4096)|(t.altKey&&18);return n&&i.filter((function(e){return(r.Browser.isMac?e.macKey:e.winKey)==n}))[0]}))}t.ShortcutFeatures={defaultShortcut:l}},628339:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StructuredNodeFeatures=void 0;var r=n(128358),o={TD:"TABLE",TH:"TABLE",LI:"OL,UL"},a=(0,r.getObjectKeys)(o).join(","),i={keys:[13],shouldHandleEvent:l,handleEvent:function(e,t){var n=l(e,t),o=(0,r.createElement)(1,t.getDocument());t.addUndoSnapshot((function(){n.parentNode.insertBefore(o,n),"TABLE"==(0,r.getTagOfNode)(n)&&t.select(new r.Position(o,0).normalize())})),e.rawEvent.preventDefault()},defaultDisabled:!0};function l(e,t){return(0,r.cacheGetEventData)(e,"FIRST_STRUCTURE",(function(){var n=e.rawEvent.shiftKey?null:t.getElementAtCursor(a);if(n){var i=t.getSelectionRange();if(i&&i.collapsed&&(0,r.isPositionAtBeginningOf)(r.Position.getStart(i),n)&&!t.getBodyTraverser(n).getPreviousBlockElement())return t.getElementAtCursor(o[(0,r.getTagOfNode)(n)])}return null}))}t.StructuredNodeFeatures={insertLineBeforeStructuredNodeFeature:i}},956840:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TableFeatures=void 0;var r=n(463816),o=n(128358),a={keys:[9],shouldHandleEvent:function(e,t){return u(e,t)&&!s(e,t)},handleEvent:function(e,t){for(var n=e.rawEvent.shiftKey,o=d(e,u(e,t)),a=n?-1:1,i=o.row,l=o.col+a;;l+=a){if(l<0||l>=o.cells[i].length){if((i+=a)<0){t.select(o.table,-2);break}if(i>=o.cells.length){(0,r.editTable)(t,1);break}l=n?o.cells[i].length-1:0}var s=o.getCell(i,l);if(s.td){t.select(s.td,0);break}}e.rawEvent.preventDefault()}},i={keys:[9],shouldHandleEvent:function(e,t){return u(e,t)&&s(e,t)},handleEvent:function(e,t){e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){var n=e.rawEvent.shiftKey,o=t.getSelectionRangeEx(),a=u(e,t),i=d(e,a);n&&t.getElementAtCursor("blockquote",i.table,e)?(0,r.setIndentation)(t,1):n||(0,r.setIndentation)(t,0),t.select(o.table,o.coordinates)}))}},l={keys:[38,40],shouldHandleEvent:function(e,t){return u(e,t)&&!s(e,t)},handleEvent:function(e,t){var n,r=u(e,t),a=new o.VTable(r),i=38==e.rawEvent.which,l=i?-1:1,s=e.rawEvent.shiftKey,d=null===(n=t.getDocument().defaultView)||void 0===n?void 0:n.getSelection(),c=null;if(d){for(var f=d.anchorNode,v=d.anchorOffset,g=a.row;g>=0&&g<a.cells.length;g+=l){var E=a.getCell(g,a.col);if(E.td&&E.td!=r){c=E.td;break}}t.runAsync((function(e){var t,n=e.getElementAtCursor();if((0,o.contains)(a.table,n)&&!(0,o.contains)(r,n,!0)){var l=c?new o.Position(c,0):new o.Position(a.table,i?-2:-3);if(s){l=1==l.node.nodeType&&(0,o.isVoidHtmlElement)(l.node)?new o.Position(l.node,l.isAtEnd?-3:-2):l;var u=null===(t=e.getDocument().defaultView)||void 0===t?void 0:t.getSelection();null==u||u.setBaseAndExtent(f,v,l.node,l.offset)}else e.select(l)}}))}},defaultDisabled:!o.Browser.isChrome&&!o.Browser.isSafari};function u(e,t){return(0,o.cacheGetEventData)(e,"TABLE_CELL_FOR_TABLE_FEATURES",(function(){var e=t.getFocusedPosition(),n=e&&t.getElementAtCursor("TD,TH,LI",e.node);return n&&("LI"==(0,o.getTagOfNode)(n)?null:n)}))}function s(e,t){return(0,o.cacheGetEventData)(e,"WHOLE_TABLE_SELECTED_FOR_FEATURES",(function(){var n=u(e,t),r=d(e,n),a=t.getSelectionRangeEx();return 1==a.type&&(0,o.isWholeTableSelected)(r,a.coordinates)}))}function d(e,t){return(0,o.cacheGetEventData)(e,"VTABLE_FOR_TABLE_FEATURES",(function(){return new o.VTable(t)}))}t.TableFeatures={tabInTable:a,upDownInTable:l,indentTableOnTab:i}},201732:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextFeatures=void 0;var r=n(463816),o=n(128358),a={keys:[9],shouldHandleEvent:function(e,t){if(t.isFeatureEnabled("TabKeyTextFeatures")&&!e.rawEvent.shiftKey){var n=t.getDocument().activeElement,r=t.getElementAtCursor("LI,TABLE",null,e),a=t.getElementAtCursor((0,o.getEntitySelector)(),void 0,e);return!r&&(a?a.isContentEditable:n.isContentEditable)}return!1},handleEvent:function(e,t){var n=t.getSelectionRangeEx();0==n.type&&(t.addUndoSnapshot((function(){if(n.areAllCollapsed)s(t,e);else{var a=n.ranges,i=a[0];if(l(t,i))(0,r.setIndentation)(t,0);else{var u=(0,o.createRange)(i.startContainer,i.startOffset);a.forEach((function(e){return e.deleteContents()})),t.select(u),s(t,e)}}})),e.rawEvent.preventDefault())}},i={keys:[9],shouldHandleEvent:function(e,t){if(e.rawEvent.shiftKey&&t.isFeatureEnabled("TabKeyTextFeatures")){var n=t.getSelectionRangeEx();return 0==n.type&&!n.areAllCollapsed&&t.getElementAtCursor("blockquote",null,e)&&!t.getElementAtCursor("LI,TABLE",null,e)&&l(t,n.ranges[0])}return!1},handleEvent:function(e,t){t.addUndoSnapshot((function(){return(0,r.setIndentation)(t,1)})),e.rawEvent.preventDefault()}};function l(e,t){var n=!1,r=o.Position.getStart(t),a=o.Position.getEnd(t),i=e.getBlockElementAtNode(r.node),l=e.getBlockElementAtNode(a.node);if(!i||!l)return!1;if(i.equals(l)){var s=new o.Position(i.getStartNode(),0),d=new o.Position(i.getEndNode(),-1),c=(0,o.createRange)(s,o.Position.getStart(t)),f=(0,o.createRange)(o.Position.getEnd(t),d);return!n&&u(c)&&u(f)&&(n=!0),n}return!0}function u(e){return""==e.toString()&&0==(0,o.queryElements)(e.commonAncestorContainer,"img,table,ul,ol",null,2,e).length}function s(e,t){for(var n,r=e.getDocument().createElement("span"),a=6-e.getContentSearcherOfCursor(t).getSubStringBefore(Number.MAX_SAFE_INTEGER).length%6,i="",l=0;l<a;l++)i+="&ensp;";e.insertNode(r),r.nextElementSibling&&"A"==(0,o.getTagOfNode)(r.nextElementSibling)&&((n=e.getDocument().createElement("span")).textContent=" ",e.insertNode(n),e.select((0,o.createRange)(n,-2))),e.insertContent(i,{position:5,range:(0,o.createRange)(r,0),updateCursor:!1}),e.select((0,o.createRange)(r,-3)),n&&e.deleteNode(n)}t.TextFeatures={indentWhenTabText:a,outdentWhenTabText:i,autoHyphen:{keys:[],shouldHandleEvent:function(e,t){return!1},handleEvent:function(e,t){return!1},defaultDisabled:!0}}},964973:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(151166),a=n(785616),i=n(264666),l=n(923046),u=n(36017),s=n(847255),d=n(350409),c=n(628339),f=n(956840),v=n(201732),g=r(r(r(r(r(r(r(r(r(r({},l.ListFeatures),s.QuoteFeatures),f.TableFeatures),c.StructuredNodeFeatures),o.AutoLinkFeatures),d.ShortcutFeatures),a.CursorFeatures),u.MarkdownFeatures),i.EntityFeatures),v.TextFeatures);t.default=function(){return g}},973472:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAllFeatures=t.ContentEdit=void 0;var r=n(716614);Object.defineProperty(t,"ContentEdit",{enumerable:!0,get:function(){return r.default}});var o=n(964973);Object.defineProperty(t,"getAllFeatures",{enumerable:!0,get:function(){return o.default}})},380276:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var n={"*":1,"-":2,"--":3,"->":5,"--\x3e":5,"=>":6,">":4,"—":7};t.default=function(e){var t=e.trim();return n[t]||null}},765021:(e,t)=>{var n,r,o,a,i,l,u,s;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Decimal=1]="Decimal",e[e.LowerAlpha=2]="LowerAlpha",e[e.UpperAlpha=3]="UpperAlpha",e[e.LowerRoman=4]="LowerRoman",e[e.UpperRoman=5]="UpperRoman"}(u||(u={})),function(e){e[e.Dot=1]="Dot",e[e.Dash=2]="Dash",e[e.Parenthesis=3]="Parenthesis",e[e.DoubleParenthesis=4]="DoubleParenthesis"}(s||(s={}));var d={".":1,"-":2,")":3},c={1:1,i:4,I:5,a:2,A:3},f=((n={})[1]=function(e){return m[e]||null},n[2]=function(e){return h[e]||null},n[3]=function(e){return E[e]||null},n[4]=function(e){return g[e]||null},n[5]=function(e){return v[e]||null},n),v=((r={})[1]=17,r[2]=20,r[3]=18,r[4]=19,r),g=((o={})[1]=13,o[2]=16,o[3]=14,o[4]=15,o),E=((a={})[1]=9,a[2]=12,a[3]=10,a[4]=11,a),h=((i={})[1]=5,i[2]=8,i[3]=6,i[4]=7,i),m=((l={})[1]=1,l[2]=2,l[3]=3,l[4]=4,l),p=function(e,t,n){var r,o=t?4:d[e[1]];if(o){var a=3===e.length?e[1]:e[0],i=n?(r=a,isNaN(parseInt(r))?/[a-z]+/g.test(r)?"i"===r?4:2:/[A-Z]+/g.test(r)?"I"===r?5:3:void 0:1):c[a];return i?f[i](o):null}return null};t.default=function(e,t){var n=e.trim(),r=3===n.length&&"("===n[0]&&")"===n[2];return 2===n.length||r?p(n,r,t):null}}}]),self.scriptsLoaded=self.scriptsLoaded||{},self.scriptsLoaded["owa.45961.js"]=1;