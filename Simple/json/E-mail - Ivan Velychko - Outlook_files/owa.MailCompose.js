/*! For license information please see owa.MailCompose.js.LICENSE.txt */
(self.webpackChunkOwa_name_=self.webpackChunkOwa_name_||[]).push([[25433,54146,16562,46465,73344,15920,4673,96751,82406,77456,99110,80964,1627,33658,63293,9849,13717,665,28838,81097,47719,73118,90518,69295,47451,62611,64998,43414],{934371:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={mentionsCompose:"t0qjo"}},946316:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={resetColors:"FiU6T",textSelectable:"sBugl",anchorReset:"eQcvi"}},812402:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={recipientContent:"orabL",groupOrDl:"Hmnqc",recipientPillPadding:"R7fnK",full:"_4Ytb",medium:"_kXun",compact:"n5H_1",recipientPillDisplay:"xVUBs"}},252810:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={label:"I9W53",wellLabelTextNormalWeight:"l812K",recipientsContainer:"GJi1M",wellWrapper:"SIbGX",full:"YYJ6x",compact:"qWzA_",medium:"vXAHD",wellTrailingComponent:"UYa63"}},722410:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={pill:"fHiSY",validPill:"HZwsk",iconContainer:"VeoX9",removeIconContainer:"YNYQC",textContainer:"Zvwrd",darkMode:"UgXFr",selectedValidPill:"fgu2Q",invalidPill:"CUwWX",selectedInvalidPill:"HNicI",expandIconContainer:"PVfop",invalidIconContainer:"Sorio",groupText:"gRetq",individualText:"XNgcG",presenceContainer:"eO6dz",presenceIcon:"ZzsXd"}},222700:(e,t,n)=>{"use strict";n.d(t,{O:()=>a,I:()=>s});var i=n(979687),r={},o={};function s(e){var t=l(e);return r[t]}function a(e,t,i){var s=l(t),a=r[s];if(a&&!i)return Promise.resolve(a);var c=o[s];if(c&&!i)return c;if(!e)return Promise.reject("Missing bootstrapper config");var d=n.e(5491).then(n.bind(n,305491)).then((function(t){return t.initialize(e).then((function(e){return r[s]=e,e}))}));return o[s]=d,d}function l(e){return e?(0,i.Xt)(e):""}},934954:(e,t,n)=>{"use strict";n.d(t,{k:()=>r});var i=n(979687);function r(e,t,n){var r=(0,i._7)(e),o=window.localStorage.getItem(r)||"{}",s=JSON.parse(o).value;if(s)return s.hasTenantLicense&&s.hasUserLicense&&(!n||s.isPreviewUser)&&(!t||s.permission.indexOf(t)>=0)}},979687:(e,t,n)=>{"use strict";function i(e,t){var n=t.userAadObjectId,i=t.tenantAadObjectId;return"".concat(e,"-").concat(n,"-").concat(i)}function r(e){return i("Cortex.TopicsCapabilities",e)}function o(e){return i("Cortex.TopicsSdks",e)}n.d(t,{ah:()=>i,_7:()=>r,Xt:()=>o})},868570:(e,t,n)=>{"use strict";function i(e){return e.toLowerCase()}n.d(t,{W:()=>r});var r=function(){function e(e){if(this._headersMap={},e)for(var t in e)this.set(t,e[t])}return e.prototype.set=function(e,t){this._headersMap[i(e)]={name:e,value:t.toString()}},e.prototype.get=function(e){var t=this._headersMap[i(e)];return t?t.value:void 0},e.prototype.contains=function(e){return!!this._headersMap[i(e)]},e.prototype.remove=function(e){var t=this.contains(e);return delete this._headersMap[i(e)],t},e.prototype.rawHeaders=function(){var e={};for(var t in this._headersMap){var n=this._headersMap[t];e[n.name.toLowerCase()]=n.value}return e},e.prototype.headersArray=function(){var e=[];for(var t in this._headersMap)e.push(this._headersMap[t]);return e},e.prototype.headerNames=function(){for(var e=[],t=this.headersArray(),n=0;n<t.length;++n)e.push(t[n].name);return e},e.prototype.headerValues=function(){for(var e=[],t=this.headersArray(),n=0;n<t.length;++n)e.push(t[n].value);return e},e.prototype.toJson=function(){return this.rawHeaders()},e.prototype.toString=function(){return JSON.stringify(this.toJson())},e.prototype.clone=function(){return new e(this.rawHeaders())},e}()},317257:(e,t,n)=>{"use strict";var i;n.d(t,{U:()=>r,_:()=>o}),function(e){e[e.OFF=0]="OFF",e[e.ERROR=1]="ERROR",e[e.WARNING=2]="WARNING",e[e.INFO=3]="INFO"}(i||(i={}));var r=function(){function e(e,t){this._nextPolicy=e,this._options=t}return e.prototype.shouldLog=function(e){return this._options.shouldLog(e)},e.prototype.log=function(e,t){this._options.log(e,t)},e}(),o=function(){function e(e){this._logger=e}return e.prototype.shouldLog=function(e){return!!this._logger&&e!==i.OFF&&e<=this._logger.minimumLogLevel},e.prototype.log=function(e,t){this._logger&&this.shouldLog(e)&&this._logger.log(e,t)},e}()},416385:(e,t,n)=>{"use strict";n.d(t,{a2:()=>l,IM:()=>c,oO:()=>d});var i=n(859726),r=n(868570),o=n(834364);function s(){return"x-ms-command-name"}var a=n(317257);var l=s;function c(){var e,t,n,i,r=[{key:"ms-rest-js",value:o.g.msRestVersion}],s=[{key:"OS",value:((e=window.navigator).oscpu||e.platform).replace(" ","")}];return t=r.concat(s),void 0===n&&(n=" "),void 0===i&&(i="/"),t.map((function(e){var t=e.value?""+i+e.value:"";return""+e.key+t})).join(n)}function d(e){var t=e&&null!=e.key?e.key:"x-ms-command-name",n=e&&null!=e.value?e.value:c();return{create:function(e,i){return new u(e,i,t,n)}}}var u=function(e){function t(t,n,i,r){var o=e.call(this,t,n)||this;return o._nextPolicy=t,o._options=n,o.headerKey=i,o.headerValue=r,o}return i.ZT(t,e),t.prototype.sendRequest=function(e){return this.addUserAgentHeader(e),this._nextPolicy.sendRequest(e)},t.prototype.addUserAgentHeader=function(e){e.headers||(e.headers=new r.W),!e.headers.get(this.headerKey)&&this.headerValue&&e.headers.set(this.headerKey,this.headerValue)},t}(a.U)},601674:(e,t,n)=>{"use strict";var i;n.d(t,{c:()=>i}),function(e){e.Csv=",",e.Ssv=" ",e.Tsv="\t",e.Pipes="|",e.Multi="Multi"}(i||(i={}))},42809:(e,t,n)=>{"use strict";function i(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}function r(e){for(var t=atob(e),n=new Uint8Array(t.length),i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}n.d(t,{lX:()=>m,ei:()=>s});var o=n(874913),s=function(){function e(e,t){void 0===e&&(e={}),this.modelMappers=e,this.isXML=t}return e.prototype.validateConstraints=function(e,t,n){var i=function(e,i){throw new Error('"'+n+'" with value "'+t+'" should satisfy the constraint "'+e+'": '+i+".")};if(e.constraints&&null!=t){var r=e.constraints,o=r.ExclusiveMaximum,s=r.ExclusiveMinimum,a=r.InclusiveMaximum,l=r.InclusiveMinimum,c=r.MaxItems,d=r.MaxLength,u=r.MinItems,p=r.MinLength,m=r.MultipleOf,h=r.Pattern,f=r.UniqueItems;null!=o&&t>=o&&i("ExclusiveMaximum",o),null!=s&&t<=s&&i("ExclusiveMinimum",s),null!=a&&t>a&&i("InclusiveMaximum",a),null!=l&&t<l&&i("InclusiveMinimum",l),null!=c&&t.length>c&&i("MaxItems",c),null!=d&&t.length>d&&i("MaxLength",d),null!=u&&t.length<u&&i("MinItems",u),null!=p&&t.length<p&&i("MinLength",p),null!=m&&t%m!=0&&i("MultipleOf",m),h&&null===t.match(h)&&i("Pattern",h),f&&t.some((function(e,t,n){return n.indexOf(e)!==t}))&&i("UniqueItems",f)}},e.prototype.serialize=function(e,t,n){var r={},s=e.type.name;n||(n=e.serializedName),null!==s.match(/^Sequence$/gi)&&(r=[]),null!=t||null==e.defaultValue&&!e.isConstant||(t=e.defaultValue);var c=e.required,p=e.nullable;if(c&&p&&void 0===t)throw new Error(n+" cannot be undefined.");if(c&&!p&&null==t)throw new Error(n+" cannot be null or undefined.");if(!c&&!1===p&&null===t)throw new Error(n+" cannot be null.");if(null==t)r=t;else if(this.validateConstraints(e,t,n),null!==s.match(/^any$/gi))r=t;else if(null!==s.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/gi))r=function(e,t,n){if(null!=n)if(null!==e.match(/^Number$/gi)){if("number"!=typeof n)throw new Error(t+" with value "+n+" must be of type number.")}else if(null!==e.match(/^String$/gi)){if("string"!=typeof n.valueOf())throw new Error(t+' with value "'+n+'" must be of type string.')}else if(null!==e.match(/^Uuid$/gi)){if("string"!=typeof n.valueOf()||!o.TP(n))throw new Error(t+' with value "'+n+'" must be of type string and a valid uuid.')}else if(null!==e.match(/^Boolean$/gi)){if("boolean"!=typeof n)throw new Error(t+" with value "+n+" must be of type boolean.")}else if(null!==e.match(/^Stream$/gi)){var i=typeof n;if(!("string"===i||"function"===i||n instanceof ArrayBuffer||ArrayBuffer.isView(n)||"function"==typeof Blob&&n instanceof Blob))throw new Error(t+" must be a string, Blob, ArrayBuffer, ArrayBufferView, or a function returning NodeJS.ReadableStream.")}return n}(s,n,t);else if(null!==s.match(/^Enum$/gi)){r=function(e,t,n){if(!t)throw new Error("Please provide a set of allowedValues to validate "+e+" as an Enum Type.");if(!t.some((function(e){return"string"==typeof e.valueOf()?e.toLowerCase()===n.toLowerCase():e===n})))throw new Error(n+" is not a valid value for "+e+". The valid values are: "+JSON.stringify(t)+".");return n}(n,e.type.allowedValues,t)}else null!==s.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/gi)?r=function(e,t,n){if(null!=t)if(null!==e.match(/^Date$/gi)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(n+" must be an instanceof Date or a string in ISO8601 format.");t=t instanceof Date?t.toISOString().substring(0,10):new Date(t).toISOString().substring(0,10)}else if(null!==e.match(/^DateTime$/gi)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(n+" must be an instanceof Date or a string in ISO8601 format.");t=t instanceof Date?t.toISOString():new Date(t).toISOString()}else if(null!==e.match(/^DateTimeRfc1123$/gi)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(n+" must be an instanceof Date or a string in RFC-1123 format.");t=t instanceof Date?t.toUTCString():new Date(t).toUTCString()}else if(null!==e.match(/^UnixTime$/gi)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(n+" must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.");t=function(e){if(!e)return;"string"==typeof e.valueOf()&&(e=new Date(e));return Math.floor(e.getTime()/1e3)}(t)}else if(null!==e.match(/^TimeSpan$/gi)){if(!o._9(t))throw new Error(n+' must be a string in ISO 8601 format. Instead was "'+t+'".');t=t}return t}(s,t,n):null!==s.match(/^ByteArray$/gi)?r=function(e,t){if(null!=t){if(!(t instanceof Uint8Array))throw new Error(e+" must be of type Uint8Array.");t=i(t)}return t}(n,t):null!==s.match(/^Base64Url$/gi)?r=function(e,t){if(null!=t){if(!(t instanceof Uint8Array))throw new Error(e+" must be of type Uint8Array.");t=function(e){if(!e)return;if(!(e instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");return function(e,t){var n=e.length;for(;n-1>=0&&e[n-1]===t;)--n;return e.substr(0,n)}(i(e),"=").replace(/\+/g,"-").replace(/\//g,"_")}(t)}return t}(n,t):null!==s.match(/^Sequence$/gi)?r=function(e,t,n,i){if(!Array.isArray(n))throw new Error(i+" must be of type Array.");var r=t.type.element;if(!r||"object"!=typeof r)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '+i+".");for(var o=[],s=0;s<n.length;s++)o[s]=e.serialize(r,n[s],i);return o}(this,e,t,n):null!==s.match(/^Dictionary$/gi)?r=function(e,t,n,i){if("object"!=typeof n)throw new Error(i+" must be of type object.");var r=t.type.value;if(!r||"object"!=typeof r)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '+i+".");for(var o={},s=0,a=Object.keys(n);s<a.length;s++){var l=a[s];o[l]=e.serialize(r,n[l],i+"."+l)}return o}(this,e,t,n):null!==s.match(/^Composite$/gi)&&(r=function(e,t,n,i){var r;u(e,t)&&(t=d(e,t,n,"clientName"));if(null!=n){for(var o={},s=l(e,t,i),c=0,p=Object.keys(s);c<p.length;c++){var m=p[c],h=s[m];if(!h.readOnly){var f=void 0,g=o;if(e.isXML)f=h.xmlIsWrapped?h.xmlName:h.xmlElementName||h.xmlName;else{var v=a(h.serializedName);f=v.pop();for(var y=0,S=v;y<S.length;y++){var b=S[y];null==g[b]&&null!=n[m]&&(g[b]={}),g=g[b]}}if(null!=g){var I=""!==h.serializedName?i+"."+h.serializedName:i,w=n[m],C=u(e,t);C&&C.clientName===m&&null==w&&(w=t.serializedName);var E=e.serialize(h,w,I);void 0!==E&&null!=f&&(h.xmlIsAttribute?(g.$=g.$||{},g.$[f]=E):h.xmlIsWrapped?g[f]=((r={})[h.xmlElementName]=E,r):g[f]=E)}}}var P=t.type.additionalProperties;if(P){var T=Object.keys(s),R=function(t){T.every((function(e){return e!==t}))&&(o[t]=e.serialize(P,n[t],i+'["'+t+'"]'))};for(var x in n)R(x)}return o}return n}(this,e,t,n));return r},e.prototype.deserialize=function(e,t,n){if(null==t)return this.isXML&&"Sequence"===e.type.name&&!e.xmlIsWrapped&&(t=[]),t;var i,o=e.type.name;return n||(n=e.serializedName),null!==o.match(/^Composite$/gi)?i=function(e,t,n,i){u(e,t)&&(t=d(e,t,n,"serializedName"));for(var r=l(e,t,i),o={},s=[],p=0,m=Object.keys(r);p<m.length;p++){var h=m[p],f=r[h],g=a(r[h].serializedName);s.push(g[0]);var v=f.serializedName,y=f.xmlName,S=f.xmlElementName,b=i;""!==v&&void 0!==v&&(b=i+"."+v);var I=f.headerCollectionPrefix;if(I){for(var w={},C=0,E=Object.keys(n);C<E.length;C++){var P=E[C];P.startsWith(I)&&(w[P.substring(I.length)]=e.deserialize(f.type.value,n[P],b)),s.push(P)}o[h]=w}else if(e.isXML)if(f.xmlIsAttribute&&n.$)o[h]=e.deserialize(f,n.$[y],b);else{var T=n[S||y||v];if(f.xmlIsWrapped)void 0===(T=(T=n[y])&&T[S])&&(T=[]);o[h]=e.deserialize(f,T,b)}else{for(var R=void 0,x=n,k=0,N=g;k<N.length;k++){var A=N[k];if(!x)break;x=x[A]}R=x;var D=t.type.polymorphicDiscriminator;D&&f.serializedName===D.serializedName&&null==R&&(R=t.serializedName);var Z=void 0;Array.isArray(n[h])&&""===r[h].serializedName?(R=n[h],o=e.deserialize(f,R,b)):void 0!==R&&(Z=e.deserialize(f,R,b),o[h]=Z)}}var M=t.type.additionalProperties;if(M){var O=function(e){for(var t in r){if(a(r[t].serializedName)[0]===e)return!1}return!0};for(var F in n)O(F)&&(o[F]=e.deserialize(M,n[F],i+'["'+F+'"]'))}else if(n)for(var _=0,L=Object.keys(n);_<L.length;_++){void 0!==o[h=L[_]]||s.includes(h)||c(h)||(o[h]=n[h])}return o}(this,e,t,n):(this.isXML&&null!=t.$&&null!=t._&&(t=t._),null!==o.match(/^Number$/gi)?(i=parseFloat(t),isNaN(i)&&(i=t)):null!==o.match(/^Boolean$/gi)?i="true"===t||"false"!==t&&t:null!==o.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/gi)?i=t:null!==o.match(/^(Date|DateTime|DateTimeRfc1123)$/gi)?i=new Date(t):null!==o.match(/^UnixTime$/gi)?i=function(e){if(!e)return;return new Date(1e3*e)}(t):null!==o.match(/^ByteArray$/gi)?i=r(t):null!==o.match(/^Base64Url$/gi)?i=function(e){if(!e)return;if(e&&"string"!=typeof e.valueOf())throw new Error("Please provide an input of type string for converting to Uint8Array");return r(e=e.replace(/\-/g,"+").replace(/\_/g,"/"))}(t):null!==o.match(/^Sequence$/gi)?i=function(e,t,n,i){var r=t.type.element;if(!r||"object"!=typeof r)throw new Error('element" metadata for an Array must be defined in the mapper and it must of type "object" in '+i);if(n){Array.isArray(n)||(n=[n]);for(var o=[],s=0;s<n.length;s++)o[s]=e.deserialize(r,n[s],i+"["+s+"]");return o}return n}(this,e,t,n):null!==o.match(/^Dictionary$/gi)&&(i=function(e,t,n,i){var r=t.type.value;if(!r||"object"!=typeof r)throw new Error('"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in '+i);if(n){for(var o={},s=0,a=Object.keys(n);s<a.length;s++){var l=a[s];o[l]=e.deserialize(r,n[l],i)}return o}return n}(this,e,t,n))),e.isConstant&&(i=e.defaultValue),i},e}();function a(e){var t=[],n="";if(e)for(var i=0,r=e.split(".");i<r.length;i++){var o=r[i];"\\"===o.charAt(o.length-1)?n+=o.substr(0,o.length-1)+".":(n+=o,t.push(n),n="")}return t}function l(e,t,n){var i=t.type.modelProperties;if(!i){var r=t.type.className;if(!r)throw new Error('Class name for model "'+n+'" is not provided in the mapper "'+JSON.stringify(t,void 0,2)+'".');var o=e.modelMappers[r];if(!o)throw new Error('mapper() cannot be null or undefined for model "'+r+'".');if(!(i=o.type.modelProperties))throw new Error('modelProperties cannot be null or undefined in the mapper "'+JSON.stringify(o)+'" of type "'+r+'" for object "'+n+'".')}return i}function c(e){return["$","_"].includes(e)}function d(e,t,n,i){var r=u(e,t);if(r){var o=r[i];if(null!=o){var s=n[o];if(null!=s){var a=t.type.uberParent||t.type.className,l=s===a?s:a+"."+s,c=e.modelMappers.discriminators[l];c&&(t=c)}}}return t}function u(e,t){return t.type.polymorphicDiscriminator||p(e,t.type.uberParent)||p(e,t.type.className)}function p(e,t){return t&&e.modelMappers[t]&&e.modelMappers[t].type.polymorphicDiscriminator}var m=function(e){for(var t={},n=0,i=e;n<i.length;n++){var r=i[n];t[r]=r}return t}(["Base64Url","Boolean","ByteArray","Composite","Date","DateTime","DateTimeRfc1123","Dictionary","Enum","Number","Object","Sequence","String","Stream","TimeSpan","UnixTime"])},566684:(e,t,n)=>{"use strict";n.d(t,{St:()=>ie});var i=n(859726),r=n(868570),o=function(e){function t(n,i,r,o,s,a){var l=e.call(this,n)||this;return l.code=i,l.statusCode=r,l.request=o,l.response=s,l.body=a,Object.setPrototypeOf(l,t.prototype),l}return i.ZT(t,e),t.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",t.REQUEST_ABORTED_ERROR="REQUEST_ABORTED_ERROR",t.PARSE_ERROR="PARSE_ERROR",t}(Error),s=function(){function e(){}return e.prototype.sendRequest=function(e){var t=new XMLHttpRequest;if(e.agentSettings)throw new Error("HTTP agent settings not supported in browser environment");if(e.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");var n=e.abortSignal;if(n){var i=function(){t.abort()};n.addEventListener("abort",i),t.addEventListener("readystatechange",(function(){t.readyState===XMLHttpRequest.DONE&&n.removeEventListener("abort",i)}))}if(a(t.upload,e.onUploadProgress),a(t,e.onDownloadProgress),e.formData){for(var r=e.formData,o=new FormData,s=function(e,t){t&&t.hasOwnProperty("value")&&t.hasOwnProperty("options")?o.append(e,t.value,t.options):o.append(e,t)},d=0,u=Object.keys(r);d<u.length;d++){var p=u[d],m=r[p];if(Array.isArray(m))for(var h=0;h<m.length;h++)s(p,m[h]);else s(p,m)}e.body=o,e.formData=void 0;var f=e.headers.get("Content-Type");f&&-1!==f.indexOf("multipart/form-data")&&e.headers.remove("Content-Type")}t.open(e.method,e.url),t.timeout=e.timeout,t.withCredentials=e.withCredentials;for(var g=0,v=e.headers.headersArray();g<v.length;g++){var y=v[g];t.setRequestHeader(y.name,y.value)}return t.responseType=e.streamResponseBody?"blob":"text",t.send(void 0===e.body?null:e.body),e.streamResponseBody?new Promise((function(n,i){t.addEventListener("readystatechange",(function(){if(t.readyState===XMLHttpRequest.HEADERS_RECEIVED){var i=new Promise((function(n,i){t.addEventListener("load",(function(){n(t.response)})),c(e,t,i)}));n({request:e,status:t.status,headers:l(t),blobBody:i})}})),c(e,t,i)})):new Promise((function(n,i){t.addEventListener("load",(function(){return n({request:e,status:t.status,headers:l(t),bodyAsText:t.responseText})})),c(e,t,i)}))},e}();function a(e,t){t&&e.addEventListener("progress",(function(e){return t({loadedBytes:e.loaded})}))}function l(e){for(var t=new r.W,n=0,i=e.getAllResponseHeaders().trim().split(/[\r\n]+/);n<i.length;n++){var o=i[n],s=o.indexOf(":"),a=o.slice(0,s),l=o.slice(s+2);t.set(a,l)}return t}function c(e,t,n){t.addEventListener("error",(function(){return n(new o("Failed to send request to "+e.url,o.REQUEST_SEND_ERROR,void 0,e))})),t.addEventListener("abort",(function(){return n(new o("The request was aborted",o.REQUEST_ABORTED_ERROR,void 0,e))})),t.addEventListener("timeout",(function(){return n(new o("timeout of "+t.timeout+"ms exceeded",o.REQUEST_SEND_ERROR,void 0,e))}))}function d(e){return u(e.parameterPath,e.mapper)}function u(e,t){return"string"==typeof e?e:Array.isArray(e)?e.join("."):t.serializedName}var p=n(42809);function m(e){var t=!1;for(var n in e.responses){var i=e.responses[n];if(i.bodyMapper&&i.bodyMapper.type.name===p.lX.Stream){t=!0;break}}return t}var h=n(874913),f=new DOMParser;function g(e){try{var t=f.parseFromString(e,"application/xml");!function(e){if(v){var t=e.getElementsByTagNameNS(v,"parsererror");if(t.length)throw new Error(t.item(0).innerHTML)}}(t);var n=y(t.childNodes[0]);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}var v="";try{v=f.parseFromString("INVALID","text/xml").getElementsByTagName("parsererror")[0].namespaceURI}catch(e){}function y(e){var t={},n=e.childNodes.length,i=e.childNodes[0],r=i&&1===n&&i.nodeType===Node.TEXT_NODE&&i.nodeValue||void 0,o=function(e){return function(e){return!!e.attributes}(e)&&e.hasAttributes()?e:void 0}(e);if(o){t.$={};for(var s=0;s<o.attributes.length;s++){var a=o.attributes[s];t.$[a.nodeName]=a.nodeValue}r&&(t._=r)}else 0===n?t="":r&&(t=r);if(!r)for(s=0;s<n;s++){var l=e.childNodes[s];if(l.nodeType!==Node.TEXT_NODE){var c=y(l);t[l.nodeName]?Array.isArray(t[l.nodeName])?t[l.nodeName].push(c):t[l.nodeName]=[t[l.nodeName],c]:t[l.nodeName]=c}}return t}var S=document.implementation.createDocument(null,null,null),b=new XMLSerializer;function I(e,t){var n=C(e,t&&t.rootName||"root")[0];return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+b.serializeToString(n)}function w(e){for(var t=[],n=0,i=Object.keys(e);n<i.length;n++){var r=i[n],o=S.createAttribute(r);o.value=e[r].toString(),t.push(o)}return t}function C(e,t){if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return(l=S.createElement(t)).textContent=e.toString(),[l];if(Array.isArray(e)){for(var n=[],i=0,r=e;i<r.length;i++)for(var o=0,s=C(r[i],t);o<s.length;o++){var a=s[o];n.push(a)}return n}if("object"==typeof e){for(var l=S.createElement(t),c=0,d=Object.keys(e);c<d.length;c++){var u=d[c];if("$"===u)for(var p=0,m=w(e[u]);p<m.length;p++){var h=m[p];l.attributes.setNamedItem(h)}else for(var f=0,g=C(e[u],u);f<g.length;f++){a=g[f];l.appendChild(a)}}return[l]}throw new Error("Illegal value passed to buildObject: "+e)}var E=n(317257);var P=["application/json","text/json"],T=["application/xml","application/atom+xml"],R=function(e){function t(t,n,i){var r=e.call(this,t,i)||this;return r.jsonContentTypes=n&&n.json||P,r.xmlContentTypes=n&&n.xml||T,r}return i.ZT(t,e),t.prototype.sendRequest=function(e){return i.mG(this,void 0,void 0,(function(){var t=this;return i.Jh(this,(function(n){return[2,this._nextPolicy.sendRequest(e).then((function(e){return function(e,t,n){return function(e,t,n){var i=function(e){var t='Error "'+e+'" occurred while parsing the response body - '+n.bodyAsText+".",i=e.code||o.PARSE_ERROR,r=new o(t,i,n.status,n.request,n,n.bodyAsText);return Promise.reject(r)};if(!n.request.streamResponseBody&&n.bodyAsText){var r=n.bodyAsText,s=n.headers.get("Content-Type")||"",a=s?s.split(";").map((function(e){return e.toLowerCase()})):[];if(0===a.length||a.some((function(t){return-1!==e.indexOf(t)})))return new Promise((function(e){n.parsedBody=JSON.parse(r),e(n)})).catch(i);if(a.some((function(e){return-1!==t.indexOf(e)})))return g(r).then((function(e){return n.parsedBody=e,n})).catch(i)}return Promise.resolve(n)}(e,t,n).then((function(e){var t=function(e){var t,n=e.request.shouldDeserialize;t=void 0===n||("boolean"==typeof n?n:n(e));return t}(e);if(t){var i=e.request.operationSpec;if(i&&i.responses){var r=e.status,s=Object.keys(i.responses),a=0===s.length||1===s.length&&"default"===s[0],l=function(e){var t,n=e.request,i=n.operationSpec;if(i){var r=n.operationResponseGetter;t=r?r(i,e):i.responses[e.status]}return t}(e);if(a?200<=r&&r<300:!!l){if(l){if(l.bodyMapper){S=e.parsedBody;i.isXML&&l.bodyMapper.type.name===p.lX.Sequence&&(S="object"==typeof S?S[l.bodyMapper.xmlElementName]:[]);try{e.parsedBody=i.serializer.deserialize(l.bodyMapper,S,"operationRes.parsedBody")}catch(f){var c=new o("Error "+f+" occurred in deserializing the responseBody - "+e.bodyAsText);return c.request=h.Fl(e.request),c.response=h.eg(e),Promise.reject(c)}}else"HEAD"===i.httpMethod&&(e.parsedBody=n.status>=200&&n.status<300);l.headersMapper&&(e.parsedHeaders=i.serializer.deserialize(l.headersMapper,e.headers.rawHeaders(),"operationRes.parsedHeaders"))}}else{var d=i.responses.default;if(d){var u=m(i)?"Unexpected status code: "+r:e.bodyAsText,f=new o(u);f.statusCode=r,f.request=h.Fl(e.request),f.response=h.eg(e);var g=e.parsedBody;try{if(g){var v=d.bodyMapper;if(v&&"CloudError"===v.serializedName)g.error&&(g=g.error),g.code&&(f.code=g.code),g.message&&(f.message=g.message);else{var y=g;g.error&&(y=g.error),f.code=y.code,y.message&&(f.message=y.message)}if(v){var S=g;i.isXML&&v.type.name===p.lX.Sequence&&(S="object"==typeof g?g[v.xmlElementName]:[]),f.body=i.serializer.deserialize(v,S,"error.body")}}}catch(t){f.message='Error "'+t.message+'" occurred in deserializing the responseBody - "'+e.bodyAsText+'" for the default response.'}return Promise.reject(f)}}}}return Promise.resolve(e)}))}(t.jsonContentTypes,t.xmlContentTypes,e)}))]}))}))},t}(E.U);var x=function(e){function t(t,n,i,r,o,s){var a=e.call(this,t,n)||this;function l(e){return"number"==typeof e}return a.retryCount=l(i)?i:3,a.retryInterval=l(r)?r:3e4,a.minRetryInterval=l(o)?o:3e3,a.maxRetryInterval=l(s)?s:9e4,a}return i.ZT(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).then((function(n){return k(t,e,n)})).catch((function(n){return k(t,e,n.response,void 0,n)}))},t}(E.U);function k(e,t,n,i,r){i=function(e,t,n){t||(t={retryCount:0,retryInterval:0}),n&&(t.error&&(n.innerError=t.error),t.error=n),t.retryCount++;var i=Math.pow(2,t.retryCount)-1;return i*=.8*e.retryInterval+Math.floor(Math.random()*(1.2*e.retryInterval-.8*e.retryInterval)),t.retryInterval=Math.min(e.minRetryInterval+i,e.maxRetryInterval),t}(e,i,r);var s=t.abortSignal&&t.abortSignal.aborted;if(!s&&function(e,t,n){if(null==t||t<500&&408!==t||501===t||505===t)return!1;if(!n)throw new Error("retryData for the ExponentialRetryPolicyFilter cannot be null.");return(n&&n.retryCount)<e.retryCount}(e,n&&n.status,i))return h.gw(i.retryInterval).then((function(){return e._nextPolicy.sendRequest(t.clone())})).then((function(n){return k(e,t,n,i,void 0)})).catch((function(r){return k(e,t,n,i,r)}));if(s||r||!n){var a=i.error||new o("Failed to send the request.",o.REQUEST_SEND_ERROR,n&&n.status,n&&n.request,n);return Promise.reject(a)}return Promise.resolve(n)}var N=function(e){function t(t,n,i){var r=e.call(this,t,n)||this;return r._requestIdHeaderName=i,r}return i.ZT(t,e),t.prototype.sendRequest=function(e){return e.headers.contains(this._requestIdHeaderName)||e.headers.set(this._requestIdHeaderName,h.Rl()),this._nextPolicy.sendRequest(e)},t}(E.U),A=n(416385),D=function(){function e(){this._rawQuery={}}return e.prototype.any=function(){return Object.keys(this._rawQuery).length>0},e.prototype.set=function(e,t){if(e)if(null!=t){var n=Array.isArray(t)?t:t.toString();this._rawQuery[e]=n}else delete this._rawQuery[e]},e.prototype.get=function(e){return e?this._rawQuery[e]:void 0},e.prototype.toString=function(){var e="";for(var t in this._rawQuery){e&&(e+="&");var n=this._rawQuery[t];if(Array.isArray(n)){for(var i=[],r=0,o=n;r<o.length;r++){var s=o[r];i.push(t+"="+s)}e+=i.join("&")}else e+=t+"="+n}return e},e.parse=function(t){var n=new e;if(t){t.startsWith("?")&&(t=t.substring(1));for(var i="ParameterName",r="",o="",s=0;s<t.length;++s){var a=t[s];switch(i){case"ParameterName":switch(a){case"=":i="ParameterValue";break;case"&":r="",o="";break;default:r+=a}break;case"ParameterValue":switch(a){case"=":r="",o="",i="Invalid";break;case"&":n.set(r,o),r="",o="",i="ParameterName";break;default:o+=a}break;case"Invalid":"&"===a&&(i="ParameterName");break;default:throw new Error("Unrecognized URLQuery parse state: "+i)}}"ParameterValue"===i&&n.set(r,o)}return n},e}(),Z=function(){function e(){}return e.prototype.setScheme=function(e){e?this.set(e,"SCHEME"):this._scheme=void 0},e.prototype.getScheme=function(){return this._scheme},e.prototype.setHost=function(e){e?this.set(e,"SCHEME_OR_HOST"):this._host=void 0},e.prototype.getHost=function(){return this._host},e.prototype.setPort=function(e){null==e||""===e?this._port=void 0:this.set(e.toString(),"PORT")},e.prototype.getPort=function(){return this._port},e.prototype.setPath=function(e){e?-1!==e.indexOf("://")?this.set(e,"SCHEME"):this.set(e,"PATH"):this._path=void 0},e.prototype.appendPath=function(e){if(e){var t=this.getPath();t&&(t.endsWith("/")||(t+="/"),e.startsWith("/")&&(e=e.substring(1)),e=t+e),this.set(e,"PATH")}},e.prototype.getPath=function(){return this._path},e.prototype.setQuery=function(e){this._query=e?D.parse(e):void 0},e.prototype.setQueryParameter=function(e,t){e&&(this._query||(this._query=new D),this._query.set(e,t))},e.prototype.getQueryParameterValue=function(e){return this._query?this._query.get(e):void 0},e.prototype.getQuery=function(){return this._query?this._query.toString():void 0},e.prototype.set=function(e,t){for(var n=new O(e,t);n.next();){var i=n.current();if(i)switch(i.type){case"SCHEME":this._scheme=i.text||void 0;break;case"HOST":this._host=i.text||void 0;break;case"PORT":this._port=i.text||void 0;break;case"PATH":var r=i.text||void 0;this._path&&"/"!==this._path&&"/"===r||(this._path=r);break;case"QUERY":this._query=D.parse(i.text);break;default:throw new Error("Unrecognized URLTokenType: "+i.type)}}},e.prototype.toString=function(){var e="";return this._scheme&&(e+=this._scheme+"://"),this._host&&(e+=this._host),this._port&&(e+=":"+this._port),this._path&&(this._path.startsWith("/")||(e+="/"),e+=this._path),this._query&&this._query.any()&&(e+="?"+this._query.toString()),e},e.prototype.replaceAll=function(e,t){e&&(this.setScheme((0,h.ko)(this.getScheme(),e,t)),this.setHost((0,h.ko)(this.getHost(),e,t)),this.setPort((0,h.ko)(this.getPort(),e,t)),this.setPath((0,h.ko)(this.getPath(),e,t)),this.setQuery((0,h.ko)(this.getQuery(),e,t)))},e.parse=function(t){var n=new e;return n.set(t,"SCHEME_OR_HOST"),n},e}(),M=function(){function e(e,t){this.text=e,this.type=t}return e.scheme=function(t){return new e(t,"SCHEME")},e.host=function(t){return new e(t,"HOST")},e.port=function(t){return new e(t,"PORT")},e.path=function(t){return new e(t,"PATH")},e.query=function(t){return new e(t,"QUERY")},e}();var O=function(){function e(e,t){this._text=e,this._textLength=e?e.length:0,this._currentState=null!=t?t:"SCHEME_OR_HOST",this._currentIndex=0}return e.prototype.current=function(){return this._currentToken},e.prototype.next=function(){if(F(this))switch(this._currentState){case"SCHEME":t=function(e){return B(e,(function(e){return function(e){var t=e.charCodeAt(0);return 48<=t&&t<=57||65<=t&&t<=90||97<=t&&t<=122}(e)}))}(e=this),e._currentToken=M.scheme(t),F(e)?e._currentState="HOST":e._currentState="DONE";break;case"SCHEME_OR_HOST":!function(e){var t=V(e,":","/","?");F(e)?":"===_(e)?"://"===z(e,3)?(e._currentToken=M.scheme(t),e._currentState="HOST"):(e._currentToken=M.host(t),e._currentState="PORT"):(e._currentToken=M.host(t),"/"===_(e)?e._currentState="PATH":e._currentState="QUERY"):(e._currentToken=M.host(t),e._currentState="DONE")}(this);break;case"HOST":!function(e){"://"===z(e,3)&&L(e,3);var t=V(e,":","/","?");e._currentToken=M.host(t),F(e)?":"===_(e)?e._currentState="PORT":"/"===_(e)?e._currentState="PATH":e._currentState="QUERY":e._currentState="DONE"}(this);break;case"PORT":!function(e){":"===_(e)&&L(e);var t=V(e,"/","?");e._currentToken=M.port(t),F(e)?"/"===_(e)?e._currentState="PATH":e._currentState="QUERY":e._currentState="DONE"}(this);break;case"PATH":!function(e){var t=V(e,"?");e._currentToken=M.path(t),F(e)?e._currentState="QUERY":e._currentState="DONE"}(this);break;case"QUERY":!function(e){"?"===_(e)&&L(e);var t=function(e){var t="";e._currentIndex<e._textLength&&(t=e._text.substring(e._currentIndex),e._currentIndex=e._textLength);return t}(e);e._currentToken=M.query(t),e._currentState="DONE"}(this);break;default:throw new Error("Unrecognized URLTokenizerState: "+this._currentState)}else this._currentToken=void 0;var e,t;return!!this._currentToken},e}();function F(e){return e._currentIndex<e._textLength}function _(e){return e._text[e._currentIndex]}function L(e,t){F(e)&&(t||(t=1),e._currentIndex+=t)}function z(e,t){var n=e._currentIndex+t;return e._textLength<n&&(n=e._textLength),e._text.substring(e._currentIndex,n)}function B(e,t){for(var n="";F(e);){var i=_(e);if(!t(i))break;n+=i,L(e)}return n}function V(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return B(e,(function(e){return-1===t.indexOf(e)}))}var U=function(e){function t(t,n,i){void 0===i&&(i=20);var r=e.call(this,t,n)||this;return r.maxRetries=i,r}return i.ZT(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e).then((function(e){return q(t,e,0)}))},t}(E.U);function q(e,t,n){var i=t.request,r=t.status,o=t.headers.get("location");if(o&&(300===r||307===r||303===r&&"POST"===i.method)&&(!e.maxRetries||n<e.maxRetries)){var s=Z.parse(i.url);return s.setPath(o),i.url=s.toString(),303===r&&(i.method="GET"),e._nextPolicy.sendRequest(i).then((function(t){return q(e,t,n+1)}))}return Promise.resolve(t)}var W=function(e){function t(t,n,i){void 0===i&&(i=30);var r=e.call(this,t,n)||this;return r._retryTimeout=i,r}return i.ZT(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).then((function(n){return function(e,t,n){if(409===n.status){var i=function(e){var t,n;if(e){try{n=JSON.parse(e)}catch(e){}if(n&&n.error&&n.error.message&&n.error.code&&"MissingSubscriptionRegistration"===n.error.code){var i=n.error.message.match(/.*'(.*)'/i);i&&(t=i.pop())}}return t}(n.bodyAsText);if(i){var r=function(e){var t,n=e.match(/.*\/subscriptions\/[a-f0-9-]+\//gi);if(!n||!n[0])throw new Error("Unable to extract subscriptionId from the given url - "+e+".");t=n[0];return t}(t.url);return function(e,t,n,i){var r=t+"providers/"+n+"/register?api-version=2016-02-01",o=t+"providers/"+n+"?api-version=2016-02-01",s=H(i);return s.method="POST",s.url=r,e._nextPolicy.sendRequest(s).then((function(t){if(200!==t.status)throw new Error("Autoregistration of "+n+" failed. Please try registering manually.");return j(e,o,i)}))}(e,r,i,t).catch((function(){return!1})).then((function(i){return i?(t.headers.set("x-ms-client-request-id",h.Rl()),e._nextPolicy.sendRequest(t.clone())):n}))}}return Promise.resolve(n)}(t,e,n)}))},t}(E.U);function H(e,t){void 0===t&&(t=!1);var n=e.clone();return t&&(n.url=e.url),n.headers.set("x-ms-client-request-id",h.Rl()),n.headers.set("Content-Type","application/json; charset=utf-8"),n}function j(e,t,n){var i=H(n);return i.url=t,i.method="GET",e._nextPolicy.sendRequest(i).then((function(i){var r=i.parsedBody;return!(!i.parsedBody||!r.registrationState||"Registered"!==r.registrationState)||h.gw(1e3*e._retryTimeout).then((function(){return j(e,t,n)}))}))}var G=function(e){function t(t,n,i){var r=e.call(this,t,n)||this;return r.authenticationProvider=i,r}return i.ZT(t,e),t.prototype.signRequest=function(e){return this.authenticationProvider.signRequest(e)},t.prototype.sendRequest=function(e){var t=this;return this.signRequest(e).then((function(e){return t._nextPolicy.sendRequest(e)}))},t}(E.U);var K=function(e){function t(t,n,i,r,o,s){var a=e.call(this,t,n)||this;return a.DEFAULT_CLIENT_RETRY_INTERVAL=3e4,a.DEFAULT_CLIENT_RETRY_COUNT=3,a.DEFAULT_CLIENT_MAX_RETRY_INTERVAL=9e4,a.DEFAULT_CLIENT_MIN_RETRY_INTERVAL=3e3,a.retryCount="number"==typeof i?i:a.DEFAULT_CLIENT_RETRY_COUNT,a.retryInterval="number"==typeof r?r:a.DEFAULT_CLIENT_RETRY_INTERVAL,a.minRetryInterval="number"==typeof o?o:a.DEFAULT_CLIENT_MIN_RETRY_INTERVAL,a.maxRetryInterval="number"==typeof s?s:a.DEFAULT_CLIENT_MAX_RETRY_INTERVAL,a}return i.ZT(t,e),t.prototype.sendRequest=function(e){var t=this;return this._nextPolicy.sendRequest(e.clone()).then((function(n){return X(t,e,n)}))},t}(E.U);function X(e,t,n,i,r){return i=function(e,t,n){t||(t={retryCount:0,retryInterval:0}),n&&(t.error&&(n.innerError=t.error),t.error=n),t.retryCount++;var i=Math.pow(2,t.retryCount)-1;return i*=.8*e.retryInterval+Math.floor(Math.random()*(1.2*e.retryInterval-.8*e.retryInterval)),t.retryInterval=Math.min(e.minRetryInterval+i,e.maxRetryInterval),t}(e,i,r),r&&r.code&&function(e,t){if(!t)throw new Error("retryData for the SystemErrorRetryPolicyFilter cannot be null.");return(t&&t.retryCount)<e.retryCount}(e,i)&&("ETIMEDOUT"===r.code||"ESOCKETTIMEDOUT"===r.code||"ECONNREFUSED"===r.code||"ECONNRESET"===r.code||"ENOENT"===r.code)?h.gw(i.retryInterval).then((function(){return e._nextPolicy.sendRequest(t.clone())})).then((function(n){return X(e,t,n,i,r)})).catch((function(r){return X(e,t,n,i,r)})):null!=r?(r=i.error,Promise.reject(r)):Promise.resolve(n)}var $=n(601674),J=function(){function e(e,t,n,i,o,s,a,l,c,d,u,p,m,h){this.streamResponseBody=s,this.url=e||"",this.method=t||"GET",this.headers=o instanceof r.W?o:new r.W(o),this.body=n,this.query=i,this.formData=void 0,this.withCredentials=a||!1,this.abortSignal=l,this.timeout=c||0,this.onUploadProgress=d,this.onDownloadProgress=u,this.proxySettings=p,this.keepAlive=m,this.agentSettings=h}return e.prototype.validateRequestProperties=function(){if(!this.method)throw new Error("WebResource.method is required.");if(!this.url)throw new Error("WebResource.url is required.")},e.prototype.prepare=function(e){if(!e)throw new Error("options object is required");if(null==e.method||"string"!=typeof e.method.valueOf())throw new Error("options.method must be a string.");if(e.url&&e.pathTemplate)throw new Error("options.url and options.pathTemplate are mutually exclusive. Please provide exactly one of them.");if(!(null!=e.pathTemplate&&"string"==typeof e.pathTemplate.valueOf()||null!=e.url&&"string"==typeof e.url.valueOf()))throw new Error("Please provide exactly one of options.pathTemplate or options.url.");if(e.url){if("string"!=typeof e.url)throw new Error('options.url must be of type "string".');this.url=e.url}if(e.method){var t=["GET","PUT","HEAD","DELETE","OPTIONS","POST","PATCH","TRACE"];if(-1===t.indexOf(e.method.toUpperCase()))throw new Error('The provided method "'+e.method+'" is invalid. Supported HTTP methods are: '+JSON.stringify(t))}if(this.method=e.method.toUpperCase(),e.pathTemplate){var n=e.pathTemplate,i=e.pathParameters;if("string"!=typeof n)throw new Error('options.pathTemplate must be of type "string".');e.baseUrl||(e.baseUrl="https://management.azure.com");var r=e.baseUrl,o=r+(r.endsWith("/")?"":"/")+(n.startsWith("/")?n.slice(1):n),s=o.match(/({\w*\s*\w*})/gi);if(s&&s.length){if(!i)throw new Error("pathTemplate: "+n+" has been provided. Hence, options.pathParameters must also be provided.");s.forEach((function(e){var t=e.slice(1,-1),r=i[t];if(null==r||"string"!=typeof r&&"object"!=typeof r)throw new Error("pathTemplate: "+n+" contains the path parameter "+t+" however, it is not present in "+i+" - "+JSON.stringify(i,void 0,2)+'.The value of the path parameter can either be a "string" of the form { '+t+': "some sample value" } or it can be an "object" of the form { "'+t+'": { value: "some sample value", skipUrlEncoding: true } }.');if("string"==typeof r.valueOf()&&(o=o.replace(e,encodeURIComponent(r))),"object"==typeof r.valueOf()){if(!r.value)throw new Error("options.pathParameters["+t+'] is of type "object" but it does not contain a "value" property.');o=r.skipUrlEncoding?o.replace(e,r.value):o.replace(e,encodeURIComponent(r.value))}}))}this.url=o}if(e.queryParameters){var a=e.queryParameters;if("object"!=typeof a)throw new Error('options.queryParameters must be of type object. It should be a JSON object of "query-parameter-name" as the key and the "query-parameter-value" as the value. The "query-parameter-value" may be fo type "string" or an "object" of the form { value: "query-parameter-value", skipUrlEncoding: true }.');this.url&&-1===this.url.indexOf("?")&&(this.url+="?");var l=[];for(var c in this.query={},a){var d=a[c];if(d)if("string"==typeof d)l.push(c+"="+encodeURIComponent(d)),this.query[c]=encodeURIComponent(d);else if("object"==typeof d){if(!d.value)throw new Error("options.queryParameters["+c+'] is of type "object" but it does not contain a "value" property.');d.skipUrlEncoding?(l.push(c+"="+d.value),this.query[c]=d.value):(l.push(c+"="+encodeURIComponent(d.value)),this.query[c]=encodeURIComponent(d.value))}}this.url+=l.join("&")}if(e.headers)for(var u=e.headers,m=0,f=Object.keys(e.headers);m<f.length;m++){var g=f[m];this.headers.set(g,u[g])}return this.headers.get("accept-language")||this.headers.set("accept-language","en-US"),this.headers.get("x-ms-client-request-id")||e.disableClientRequestId||this.headers.set("x-ms-client-request-id",(0,h.Rl)()),this.headers.get("Content-Type")||this.headers.set("Content-Type","application/json; charset=utf-8"),this.body=e.body,null!=e.body&&(e.bodyIsStream?(this.headers.get("Transfer-Encoding")||this.headers.set("Transfer-Encoding","chunked"),"application/octet-stream"!==this.headers.get("Content-Type")&&this.headers.set("Content-Type","application/octet-stream")):(e.serializationMapper&&(this.body=new p.ei(e.mappers).serialize(e.serializationMapper,e.body,"requestBody")),e.disableJsonStringifyOnBody||(this.body=JSON.stringify(e.body)))),this.abortSignal=e.abortSignal,this.onDownloadProgress=e.onDownloadProgress,this.onUploadProgress=e.onUploadProgress,this},e.prototype.clone=function(){var t=new e(this.url,this.method,this.body,this.query,this.headers&&this.headers.clone(),this.streamResponseBody,this.withCredentials,this.abortSignal,this.timeout,this.onUploadProgress,this.onDownloadProgress,this.proxySettings,this.keepAlive,this.agentSettings);return this.formData&&(t.formData=this.formData),this.operationSpec&&(t.operationSpec=this.operationSpec),this.shouldDeserialize&&(t.shouldDeserialize=this.shouldDeserialize),this.operationResponseGetter&&(t.operationResponseGetter=this.operationResponseGetter),t},e}(),Q=new Error("AgentPolicy is not supported in browser environment");!function(e){function t(t,n){e.call(this,t,n);throw Q}i.ZT(t,e),t.prototype.sendRequest=function(e){throw Q}}(E.U);var Y=new Error("ProxyPolicy is not supported in browser environment");!function(e){function t(t,n){e.call(this,t,n);throw Y}i.ZT(t,e),t.prototype.sendRequest=function(e){throw Y}}(E.U);var ee=n(834364),te=ee.g.HttpConstants.StatusCodes;var ne=function(e){function t(t,n,i){var r=e.call(this,t,n)||this;return r._handleResponse=i||r._defaultResponseHandler,r}return i.ZT(t,e),t.prototype.sendRequest=function(e){return i.mG(this,void 0,void 0,(function(){var t=this;return i.Jh(this,(function(n){return[2,this._nextPolicy.sendRequest(e.clone()).then((function(n){return n.status!==te.TooManyRequests?n:t._handleResponse(e,n)}))]}))}))},t.prototype._defaultResponseHandler=function(e,n){return i.mG(this,void 0,void 0,(function(){var r,o,s=this;return i.Jh(this,(function(i){return(r=n.headers.get(ee.g.HeaderConstants.RETRY_AFTER))&&(o=t.parseRetryAfterHeader(r))?[2,(0,h.gw)(o).then((function(t){return s._nextPolicy.sendRequest(e)}))]:[2,n]}))}))},t.parseRetryAfterHeader=function(e){var n=Number(e);return Number.isNaN(n)?t.parseDateRetryAfterHeader(e):1e3*n},t.parseDateRetryAfterHeader=function(e){try{var t=Date.now(),n=Date.parse(e)-t;return Number.isNaN(n)?void 0:n}catch(e){return}},t}(E.U),ie=function(){function e(e,t){if(t||(t={}),e&&!e.signRequest)throw new Error("credentials argument needs to implement signRequest method");var n;if(this._withCredentials=t.withCredentials||!1,this._httpClient=t.httpClient||new s,this._requestPolicyOptions=new E._(t.httpPipelineLogger),Array.isArray(t.requestPolicyFactories))n=t.requestPolicyFactories;else if(n=function(e,t){var n=[];t.generateClientRequestIdHeader&&n.push((void 0===(i=t.clientRequestIdHeaderName)&&(i="x-ms-client-request-id"),{create:function(e,t){return new N(e,t,i)}}));var i;e&&("function"==typeof e.create?n.push(e):n.push((r=e,{create:function(e,t){return new G(e,t,r)}})));var r;var o=re(t.userAgentHeaderName,A.a2),s=re(t.userAgent,A.IM);o&&s&&n.push((0,A.oO)({key:o,value:s}));n.push(function(e){return void 0===e&&(e=20),{create:function(t,n){return new U(t,n,e)}}}()),n.push(function(e){return void 0===e&&(e=30),{create:function(t,n){return new W(t,n,e)}}}(t.rpRegistrationRetryTimeout)),t.noRetryPolicy||(n.push({create:function(e,t){return new x(e,t,a,l,c,d)}}),n.push(function(e,t,n,i){return{create:function(r,o){return new K(r,o,e,t,n,i)}}}()),n.push({create:function(e,t){return new ne(e,t)}}));var a,l,c,d;n.push((u=t.deserializationContentTypes,{create:function(e,t){return new R(e,u,t)}}));var u;var p=t.proxySettings||void 0;p&&n.push({create:function(e,t){throw Y}});t.agentSettings&&n.push((t.agentSettings,{create:function(e,t){throw Q}}));return n}(e,t),t.requestPolicyFactories){var i=t.requestPolicyFactories(n);i&&(n=i)}this._requestPolicyFactories=n}return e.prototype.sendRequest=function(e){if(null==e||"object"!=typeof e)throw new Error("options cannot be null or undefined and it must be of type object.");var t;try{e instanceof J?(e.validateRequestProperties(),t=e):t=(t=new J).prepare(e)}catch(e){return Promise.reject(e)}var n=this._httpClient;if(this._requestPolicyFactories&&this._requestPolicyFactories.length>0)for(var i=this._requestPolicyFactories.length-1;i>=0;--i)n=this._requestPolicyFactories[i].create(n,this._requestPolicyOptions);return n.sendRequest(t)},e.prototype.sendOperationRequest=function(e,t,n){"function"==typeof e.options&&(n=e.options,e.options=void 0);var r,o=new J;try{var s=t.baseUrl||this.baseUri;if(!s)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a baseUri string property that contains the base URL to use.");o.method=t.httpMethod,o.operationSpec=t;var a=Z.parse(s);if(t.path&&a.appendPath(t.path),t.urlParameters&&t.urlParameters.length>0)for(var l=0,c=t.urlParameters;l<c.length;l++){var u=c[l],f=oe(this,e,u,t.serializer);f=t.serializer.serialize(u.mapper,f,d(u)),u.skipEncoding||(f=encodeURIComponent(f)),a.replaceAll("{"+(u.mapper.serializedName||d(u))+"}",f)}if(t.queryParameters&&t.queryParameters.length>0)for(var g=0,v=t.queryParameters;g<v.length;g++){var y=v[g],S=oe(this,e,y,t.serializer);if(null!=S){if(S=t.serializer.serialize(y.mapper,S,d(y)),null!=y.collectionFormat)if(y.collectionFormat===$.c.Multi)if(0===S.length)S="";else for(var b in S){var w=S[b];S[b]=null==w?"":w.toString()}else S=S.join(y.collectionFormat);if(!y.skipEncoding)if(Array.isArray(S))for(var b in S)S[b]=encodeURIComponent(S[b]);else S=encodeURIComponent(S);a.setQueryParameter(y.mapper.serializedName||d(y),S)}}o.url=a.toString();var C=t.contentType||this.requestContentType;if(C&&o.headers.set("Content-Type",C),t.headerParameters)for(var E=0,P=t.headerParameters;E<P.length;E++){var T=P[E],R=oe(this,e,T,t.serializer);if(null!=R){R=t.serializer.serialize(T.mapper,R,d(T));var x=T.mapper.headerCollectionPrefix;if(x)for(var k=0,N=Object.keys(R);k<N.length;k++){var A=N[k];o.headers.set(x+A,R[A])}else o.headers.set(T.mapper.serializedName||d(T),R)}}var D=e.options;if(D){if(D.customHeaders)for(var M in D.customHeaders)o.headers.set(M,D.customHeaders[M]);D.abortSignal&&(o.abortSignal=D.abortSignal),D.timeout&&(o.timeout=D.timeout),D.onUploadProgress&&(o.onUploadProgress=D.onUploadProgress),D.onDownloadProgress&&(o.onDownloadProgress=D.onDownloadProgress)}o.withCredentials=this._withCredentials,function(e,t,n,i){if(i.requestBody&&i.requestBody.mapper){t.body=oe(e,n,i.requestBody,i.serializer);var r=i.requestBody.mapper,o=r.required,s=r.xmlName,a=r.xmlElementName,l=r.serializedName,c=r.type.name;try{if(null!=t.body||o){var u=d(i.requestBody);t.body=i.serializer.serialize(r,t.body,u);var m=c===p.lX.Stream;i.isXML?c===p.lX.Sequence?t.body=I(h.WQ(t.body,a||s||l),{rootName:s||l}):m||(t.body=I(t.body,{rootName:s||l})):m||(t.body=JSON.stringify(t.body))}}catch(e){throw new Error('Error "'+e.message+'" occurred in serializing the payload - '+JSON.stringify(l,void 0,"  ")+".")}}else if(i.formDataParameters&&i.formDataParameters.length>0){t.formData={};for(var f=0,g=i.formDataParameters;f<g.length;f++){var v=g[f],y=oe(e,n,v,i.serializer);if(null!=y){var S=v.mapper.serializedName||d(v);t.formData[S]=i.serializer.serialize(v.mapper,y,d(v))}}}}(this,o,e,t),null==o.streamResponseBody&&(o.streamResponseBody=m(t)),r=this.sendRequest(o).then((function(e){return function(e,t){var n=e.parsedHeaders,r=t&&t.bodyMapper,o=function(t){return Object.defineProperty(t,"_response",{value:e})};if(r){var s=r.type.name;if("Stream"===s)return o(i.pi({},n,{blobBody:e.blobBody,readableStreamBody:e.readableStreamBody}));var a="Composite"===s&&r.type.modelProperties||{},l=Object.keys(a).some((function(e){return""===a[e].serializedName}));if("Sequence"===s||l){for(var c=(Array.isArray(e.parsedBody)?e.parsedBody:[]).slice(),d=0,u=Object.keys(a);d<u.length;d++){var p=u[d];a[p].serializedName&&(c[p]=e.parsedBody[p])}if(n)for(var m=0,h=Object.keys(n);m<h.length;m++){c[p=h[m]]=n[p]}return o(c),c}if("Composite"===s||"Dictionary"===s)return o(i.pi({},n,e.parsedBody))}if(r||"HEAD"===e.request.method)return o(i.pi({},n,{body:e.parsedBody}));return o(i.pi({},n,e.parsedBody))}(e,t.responses[e.status])}))}catch(e){r=Promise.reject(e)}var O=n;return O&&r.then((function(e){return O(null,e._response.parsedBody,e._response.request,e._response)})).catch((function(e){return O(e)})),r},e}();function re(e,t){var n;return"string"==typeof e?n=e:(n=t(),"function"==typeof e&&(n=e(n))),n}function oe(e,t,n,i){return se(e,t,n.parameterPath,n.mapper,i)}function se(e,t,n,i,r){var o;if("string"==typeof n&&(n=[n]),Array.isArray(n)){if(n.length>0){if(i.isConstant)o=i.defaultValue;else{var s=ae(t,n);s.propertyFound||(s=ae(e,n));var a=!1;s.propertyFound||(a=i.required||"options"===n[0]&&2===n.length),o=a?i.defaultValue:s.propertyValue}var l=u(n,i);r.serialize(i,o,l)}}else for(var c in i.required&&(o={}),n){var d=i.type.modelProperties[c],p=n[c],m=se(e,t,p,d,r),h=u(p,d);r.serialize(d,m,h),void 0!==m&&(o||(o={}),o[c]=m)}return o}function ae(e,t){for(var n={propertyFound:!1},i=0;i<t.length;++i){var r=t[i];if(null==e||!(r in e))break;e=e[r]}return i===t.length&&(n.propertyValue=e,n.propertyFound=!0),n}},834364:(e,t,n)=>{"use strict";n.d(t,{g:()=>i});var i={msRestVersion:"1.9.1",HTTP:"http:",HTTPS:"https:",HTTP_PROXY:"HTTP_PROXY",HTTPS_PROXY:"HTTPS_PROXY",HttpConstants:{HttpVerbs:{PUT:"PUT",GET:"GET",DELETE:"DELETE",POST:"POST",MERGE:"MERGE",HEAD:"HEAD",PATCH:"PATCH"},StatusCodes:{TooManyRequests:429}},HeaderConstants:{AUTHORIZATION:"authorization",AUTHORIZATION_SCHEME:"Bearer",RETRY_AFTER:"Retry-After",USER_AGENT:"User-Agent"}}},874913:(e,t,n)=>{"use strict";n.d(t,{eg:()=>o,Fl:()=>s,TP:()=>a,Rl:()=>l,gw:()=>c,WQ:()=>d,_9:()=>p,ko:()=>m});var i=n(815651),r=n.n(i);"undefined"!=typeof process&&!!process.version&&!!process.versions&&process.versions.node;function o(e){var t={};return t.body=e.bodyAsText,t.headers=e.headers,t.status=e.status,t}function s(e){var t=e.clone();return t.headers&&t.headers.remove("authorization"),t}function a(e){return new RegExp("^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$","ig").test(e)}function l(){return r()()}function c(e,t){return new Promise((function(n){return setTimeout((function(){return n(t)}),e)}))}function d(e,t){var n;return Array.isArray(e)||(e=[e]),(n={})[t]=e,n}var u=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function p(e){return u.test(e)}function m(e,t,n){return e&&t?e.split(t).join(n||""):e}},859726:(e,t,n)=>{"use strict";n.d(t,{ZT:()=>r,pi:()=>o,mG:()=>s,Jh:()=>a});var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},i(e,t)};function r(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o.apply(this,arguments)};function s(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))}function a(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}},437841:e=>{for(var t=[],n=0;n<256;++n)t[n]=(n+256).toString(16).substr(1);e.exports=function(e,n){var i=n||0,r=t;return[r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]]].join("")}},287493:e=>{var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var n=new Uint8Array(16);e.exports=function(){return t(n),n}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},815651:(e,t,n)=>{var i=n(287493),r=n(437841);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||i)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[o+a]=s[a];return t||r(s)}},491176:(e,t,n)=>{"use strict";n.d(t,{GX:()=>De});var i={};n.r(i),n.d(i,{Acronym:()=>a,AcronymsResponse:()=>l,BrowserExtensionRequestV1:()=>d,BrowserExtensionResponseV1:()=>u,CheckRequestV1:()=>b,CheckResponseV1:()=>x,CheckedSpan:()=>I,ClientSuggestion:()=>v,CommonAppIdProperty:()=>c,CommonAppVersionProperty:()=>g,CommonCritique:()=>k,CommonDescriptorsProperty:()=>N,CommonLanguageIdProperty:()=>m,CommonLanguageUXIdProperty:()=>A,CommonOverriddenCritiqueTypeOptions:()=>D,CommonParagraphIdProperty:()=>Z,CommonParagraphRevisionIdProperty:()=>M,CommonRequestIdProperty:()=>O,CommonResponseStatusProperty:()=>R,CommonRevisionIdProperty:()=>_,CommonRunOnProfileIdProperty:()=>L,CommonTextUnitProperty:()=>z,CommonTileIdProperty:()=>F,ConfigRequestV1:()=>B,ConfigRequestV2:()=>H,ConfigResponseV1:()=>W,ConfigResponseV2:()=>j,ConfigV1Headers:()=>be,ConfigV2Headers:()=>Ie,Critique:()=>C,CritiqueCategoryInfo:()=>U,CritiqueTypeInfo:()=>V,CritiqueTypeOption:()=>h,Descriptor:()=>p,DocumentStructureMetadata:()=>S,Email:()=>o,File:()=>s,GetCheckHeaders:()=>ye,InsightsRequestV1:()=>G,InsightsResponseV1:()=>X,InsightsResponseV1AnalyzerData:()=>K,InstrumentationHeaders:()=>Ee,InstrumentationRequestV1:()=>$,LanguageInfoRequestV1:()=>J,LanguageInfoResponseV1:()=>Y,LanguageinfoHeaders:()=>we,Metadata:()=>te,MetadataContent:()=>ee,Metadatum:()=>w,NeuralBatchCheckRequestV1:()=>ie,NeuralBatchCheckResponseV1:()=>re,NeuralRewriteRequestV1:()=>oe,NeuralRewriteResponseV1:()=>se,NeuralbatchcheckHeaders:()=>Ce,PostCheckHeaders:()=>ve,PostTileCheckHeaders:()=>Se,Profile:()=>q,ReadingConcept:()=>E,ReadingCritique:()=>P,ReadingResponse:()=>T,SelectedLanguages:()=>ae,Suggestion:()=>f,SupportedActions:()=>le,SupportedLanguage:()=>Q,TextElement:()=>ne,TileCheckCritique:()=>he,TileCheckRequestV1:()=>me,TileCheckResponseV1:()=>fe,TileCheckSpan:()=>de,TileContent:()=>pe,TileElement:()=>ue,Tiling:()=>y,TopologyNode:()=>ce,UserIdentity:()=>ge});var r=n(42809);const o={serializedName:"Email",type:{name:"Composite",className:"Email",modelProperties:{id:{serializedName:"Id",type:{name:"String"}},subject:{serializedName:"Subject",type:{name:"String"}},body:{serializedName:"Body",type:{name:"String"}},sender:{serializedName:"Sender",type:{name:"String"}},instrumentationId:{serializedName:"InstrumentationId",type:{name:"String"}},snippet:{serializedName:"Snippet",type:{name:"String"}}}}},s={serializedName:"File",type:{name:"Composite",className:"File",modelProperties:{id:{serializedName:"Id",type:{name:"String"}},name:{serializedName:"Name",type:{name:"String"}},extension:{serializedName:"Extension",type:{name:"String"}},uri:{serializedName:"Uri",type:{name:"String"}},instrumentationId:{serializedName:"InstrumentationId",type:{name:"String"}},snippet:{serializedName:"Snippet",type:{name:"String"}}}}},a={serializedName:"Acronym",type:{name:"Composite",className:"Acronym",modelProperties:{description:{serializedName:"Description",type:{name:"String"}},id:{serializedName:"Id",type:{name:"String"}},instrumentationId:{serializedName:"InstrumentationId",type:{name:"String"}},name:{serializedName:"Name",type:{name:"String"}},source:{serializedName:"Source",type:{name:"String"}},sourceEmail:{serializedName:"SourceEmail",type:{name:"Composite",className:"Email"}},sourceFile:{serializedName:"SourceFile",type:{name:"Composite",className:"File"}},sourceType:{serializedName:"SourceType",type:{name:"String"}},type:{serializedName:"Type",type:{name:"String"}}}}},l={serializedName:"AcronymsResponse",type:{name:"Composite",className:"AcronymsResponse",modelProperties:{transactionId:{serializedName:"TransactionId",type:{name:"String"}},acronyms:{serializedName:"Acronyms",type:{name:"Sequence",element:{type:{name:"Composite",className:"Acronym"}}}}}}},c={serializedName:"CommonAppIdProperty",type:{name:"Composite",className:"CommonAppIdProperty",modelProperties:{appId:{serializedName:"AppId",type:{name:"String"}}}}},d={serializedName:"BrowserExtensionRequestV1",type:{name:"Composite",className:"BrowserExtensionRequestV1",modelProperties:Object.assign(Object.assign({},c.type.modelProperties),{browser:{serializedName:"Browser",type:{name:"String"}},browserVersion:{serializedName:"BrowserVersion",type:{name:"String"}},clientId:{serializedName:"ClientId",type:{name:"String"}},email:{serializedName:"Email",type:{name:"String"}},extensionId:{serializedName:"ExtensionId",type:{name:"String"}},firstInstallVersion:{serializedName:"FirstInstallVersion",type:{name:"String"}},languageId:{serializedName:"LanguageId",type:{name:"String"}},languageUxId:{serializedName:"LanguageUxId",type:{name:"String"}},licenseType:{serializedName:"LicenseType",type:{name:"String"}},storeId:{serializedName:"StoreId",type:{name:"String"}},tenantId:{serializedName:"TenantId",type:{name:"String"}}})}},u={serializedName:"BrowserExtensionResponseV1",type:{name:"Composite",className:"BrowserExtensionResponseV1",modelProperties:{responseStatus:{serializedName:"ResponseStatus",defaultValue:0,type:{name:"Enum",allowedValues:[0,1,2,3]}},requestId:{serializedName:"RequestId",type:{name:"String"}},useTileCheck:{serializedName:"UseTileCheck",defaultValue:!1,type:{name:"Boolean"}},disabledWebSites:{serializedName:"DisabledWebSites",type:{name:"Sequence",element:{type:{name:"String"}}}},allowedUrls:{serializedName:"AllowedUrls",type:{name:"Sequence",element:{type:{name:"String"}}}},disabledGrammars:{serializedName:"DisabledGrammars",type:{name:"Sequence",element:{type:{name:"String"}}}},versionEmergencyOverrides:{serializedName:"VersionEmergencyOverrides",type:{name:"Dictionary",value:{type:{name:"String"}}}},featureFlags:{serializedName:"FeatureFlags",type:{name:"Dictionary",value:{type:{name:"String"}}}},descriptors:{serializedName:"Descriptors",type:{name:"String"}},spellCheckAttributes:{serializedName:"SpellCheckAttributes",type:{name:"Sequence",element:{type:{name:"String"}}}},conflictingElements:{serializedName:"ConflictingElements",type:{name:"Sequence",element:{type:{name:"String"}}}},styleObserverIntervalTime:{serializedName:"StyleObserverIntervalTime",defaultValue:0,type:{name:"Number"}},styleSampleTime:{serializedName:"StyleSampleTime",defaultValue:0,type:{name:"Number"}},rootContentMaxLengthInChars:{serializedName:"RootContentMaxLengthInChars",defaultValue:2e3,type:{name:"Number"}},schedulerDefaultWaitingTime:{serializedName:"SchedulerDefaultWaitingTime",defaultValue:0,type:{name:"Number"}},schedulerDefaultWaitingTimeIncrement:{serializedName:"SchedulerDefaultWaitingTimeIncrement",defaultValue:0,type:{name:"Number"}},schedulerDefaultMaxTime:{serializedName:"SchedulerDefaultMaxTime",defaultValue:0,type:{name:"Number"}},refreshCritiqueWaitingTime:{serializedName:"RefreshCritiqueWaitingTime",defaultValue:0,type:{name:"Number"}},requestCritiqueDelay:{serializedName:"RequestCritiqueDelay",defaultValue:0,type:{name:"Number"}},enableDirtyRangeAutoRehydration:{serializedName:"EnableDirtyRangeAutoRehydration",defaultValue:!1,type:{name:"Boolean"}},telemetryTenant:{serializedName:"TelemetryTenant",type:{name:"String"}},logGroupName:{serializedName:"LogGroupName",type:{name:"String"}},sendToAria:{serializedName:"SendToAria",defaultValue:!1,type:{name:"Boolean"}},intervalForActivityCleanup:{serializedName:"IntervalForActivityCleanup",defaultValue:0,type:{name:"Number"}},maxAllowedTimeForActivities:{serializedName:"MaxAllowedTimeForActivities",defaultValue:0,type:{name:"Number"}},calloutHoverTimeout:{serializedName:"CalloutHoverTimeout",defaultValue:0,type:{name:"Number"}},maxSuggestionItemsDisplayNumber:{serializedName:"MaxSuggestionItemsDisplayNumber",defaultValue:0,type:{name:"Number"}},editorClientState:{serializedName:"EditorClientState",type:{name:"Number"}},editorCanvas:{serializedName:"EditorCanvas",type:{name:"Object"}},configurationId:{serializedName:"ConfigurationId",type:{name:"String"}}}}},p={serializedName:"Descriptor",type:{name:"Composite",className:"Descriptor",modelProperties:{name:{required:!0,serializedName:"Name",type:{name:"String"}},value:{required:!0,serializedName:"Value",type:{name:"String"}}}}},m={serializedName:"CommonLanguageIdProperty",type:{name:"Composite",className:"CommonLanguageIdProperty",modelProperties:{languageId:{serializedName:"LanguageId",type:{name:"String"}}}}},h={serializedName:"CritiqueTypeOption",type:{name:"Composite",className:"CritiqueTypeOption",modelProperties:Object.assign(Object.assign({},m.type.modelProperties),{id:{required:!0,serializedName:"Id",type:{name:"Uuid"}},name:{serializedName:"Name",type:{name:"String"}},typeName:{serializedName:"TypeName",type:{name:"String"}},value:{required:!0,serializedName:"Value",type:{name:"String"}}})}},f={serializedName:"Suggestion",type:{name:"Composite",className:"Suggestion",modelProperties:{text:{required:!0,serializedName:"Text",type:{name:"String"}},description:{serializedName:"Description",type:{name:"String"}},confidenceLevel:{serializedName:"ConfidenceLevel",type:{name:"Enum",allowedValues:[0,1,2]}},source:{serializedName:"Source",type:{name:"Enum",allowedValues:[0,1,2,3,4]}},action:{required:!0,serializedName:"Action",type:{name:"Number"}},bucketId:{serializedName:"BucketId",type:{name:"Number"}},numberOfInstances:{serializedName:"NumberOfInstances",type:{name:"Number"}}}}},g={serializedName:"CommonAppVersionProperty",type:{name:"Composite",className:"CommonAppVersionProperty",modelProperties:{appVersion:{serializedName:"AppVersion",type:{name:"String"}}}}},v={serializedName:"ClientSuggestion",type:{name:"Composite",className:"ClientSuggestion",modelProperties:Object.assign(Object.assign({},g.type.modelProperties),{start:{serializedName:"Start",defaultValue:0,type:{name:"Number"}},length:{serializedName:"Length",defaultValue:0,type:{name:"Number"}},suggestions:{serializedName:"Suggestions",type:{name:"Sequence",element:{type:{name:"Composite",className:"Suggestion"}}}}})}},y={serializedName:"Tiling",type:{name:"Composite",className:"Tiling",modelProperties:{tilingType:{serializedName:"TilingType",type:{name:"Enum",allowedValues:[0,1]}},paragraphIds:{serializedName:"ParagraphIds",type:{name:"Sequence",element:{type:{name:"String"}}}},paragraphRevisionIds:{serializedName:"ParagraphRevisionIds",type:{name:"Sequence",element:{type:{name:"String"}}}},numberOfParagraphsInTiling:{nullable:!0,serializedName:"NumberOfParagraphsInTiling",type:{name:"Number"}}}}},S={serializedName:"DocumentStructureMetadata",type:{name:"Composite",className:"DocumentStructureMetadata",modelProperties:{paragraphId:{serializedName:"ParagraphId",type:{name:"String"}},paragraphRevisionId:{serializedName:"ParagraphRevisionId",type:{name:"String"}},tileId:{serializedName:"TileId",type:{name:"String"}},revisionId:{serializedName:"RevisionId",type:{name:"String"}},requestOrderInSession:{serializedName:"RequestOrderInSession",type:{name:"Number"}},areTilingsComplete:{serializedName:"AreTilingsComplete",defaultValue:!1,type:{name:"Boolean"}},tilings:{serializedName:"Tilings",type:{name:"Sequence",element:{type:{name:"Composite",className:"Tiling"}}}}}}},b={serializedName:"CheckRequestV1",type:{name:"Composite",className:"CheckRequestV1",modelProperties:{appId:{required:!0,serializedName:"AppId",type:{name:"String"}},appVersion:{serializedName:"AppVersion",type:{name:"String"}},descriptors:{serializedName:"Descriptors",type:{name:"Sequence",element:{type:{name:"Composite",className:"Descriptor"}}}},languageId:{required:!0,serializedName:"LanguageId",type:{name:"String"}},languageUXId:{serializedName:"LanguageUXId",type:{name:"String"}},runOnProfileId:{serializedName:"RunOnProfileId",type:{name:"Uuid"}},textUnit:{serializedName:"TextUnit",type:{name:"Enum",allowedValues:[0,1,2,4,8,16,32,64,256,16384]}},overriddenCritiqueTypeOptions:{serializedName:"OverriddenCritiqueTypeOptions",type:{name:"Sequence",element:{type:{name:"Composite",className:"CritiqueTypeOption"}}}},autoSelect:{serializedName:"AutoSelect",type:{name:"Boolean"}},clientSuggestions:{serializedName:"ClientSuggestions",type:{name:"Sequence",element:{type:{name:"Composite",className:"ClientSuggestion"}}}},enabledLanguages:{serializedName:"EnabledLanguages",type:{name:"Sequence",element:{type:{name:"Sequence",element:{type:{name:"Composite",className:"CommonLanguageIdProperty"}}}}}},length:{serializedName:"Length",defaultValue:0,type:{name:"Number"}},requestId:{serializedName:"RequestId",type:{name:"Uuid"}},start:{serializedName:"Start",defaultValue:0,type:{name:"Number"}},text:{required:!0,serializedName:"Text",type:{name:"String"}},documentStructureMetadata:{serializedName:"DocumentStructureMetadata",type:{name:"Composite",className:"DocumentStructureMetadata"}}}}},I={serializedName:"CheckedSpan",type:{name:"Composite",className:"CheckedSpan",modelProperties:{start:{required:!0,serializedName:"Start",defaultValue:0,type:{name:"Number"}},length:{required:!0,serializedName:"Length",defaultValue:0,type:{name:"Number"}}}}},w={serializedName:"Metadatum",type:{name:"Composite",className:"Metadatum",modelProperties:{name:{required:!0,serializedName:"Name",type:{name:"String"}},value:{required:!0,serializedName:"Value",type:{name:"String"}}}}},C={serializedName:"Critique",type:{name:"Composite",className:"Critique",modelProperties:{traceId:{required:!0,serializedName:"TraceId",type:{name:"Uuid"}},typeId:{required:!0,serializedName:"TypeId",type:{name:"Uuid"}},categoryTitle:{required:!0,serializedName:"CategoryTitle",type:{name:"String"}},context:{serializedName:"Context",type:{name:"String"}},start:{required:!0,serializedName:"Start",defaultValue:0,type:{name:"Number"}},startInContext:{serializedName:"StartInContext",defaultValue:0,type:{name:"Number"}},length:{required:!0,serializedName:"Length",defaultValue:0,type:{name:"Number"}},languageId:{serializedName:"LanguageId",type:{name:"String"}},priority:{required:!0,serializedName:"Priority",type:{name:"Number"}},metadata:{serializedName:"Metadata",type:{name:"Sequence",element:{type:{name:"Composite",className:"Metadatum"}}}},paragraphId:{serializedName:"ParagraphId",type:{name:"String"}},paragraphRevisionId:{serializedName:"ParagraphRevisionId",type:{name:"String"}},tileId:{serializedName:"TileId",type:{name:"String"}},revisionId:{serializedName:"RevisionId",type:{name:"String"}},supportedActions:{serializedName:"SupportedActions",type:{name:"Number"}},explanationTitle:{serializedName:"ExplanationTitle",type:{name:"String"}},explanationLabel:{serializedName:"ExplanationLabel",type:{name:"String"}},explanation:{serializedName:"Explanation",type:{name:"String"}},isDocumentLevelCritique:{serializedName:"IsDocumentLevelCritique",defaultValue:!1,type:{name:"Boolean"}},suggestions:{required:!0,serializedName:"Suggestions",type:{name:"Sequence",element:{type:{name:"Composite",className:"Suggestion"}}}}}}},E={serializedName:"ReadingConcept",type:{name:"Composite",className:"ReadingConcept",modelProperties:{id:{serializedName:"Id",type:{name:"String"}},score:{serializedName:"Score",type:{name:"Number"}}}}},P={serializedName:"ReadingCritique",type:{name:"Composite",className:"ReadingCritique",modelProperties:{traceId:{serializedName:"TraceId",type:{name:"Uuid"}},typeId:{serializedName:"TypeId",type:{name:"Uuid"}},categoryTitle:{serializedName:"CategoryTitle",type:{name:"String"}},context:{serializedName:"Context",type:{name:"String"}},start:{serializedName:"Start",defaultValue:0,type:{name:"Number"}},startInContext:{serializedName:"StartInContext",defaultValue:0,type:{name:"Number"}},length:{serializedName:"Length",defaultValue:0,type:{name:"Number"}},languageId:{serializedName:"LanguageId",type:{name:"String"}},priority:{serializedName:"Priority",type:{name:"Number"}},metadata:{serializedName:"Metadata",type:{name:"Sequence",element:{type:{name:"Composite",className:"Metadatum"}}}},paragraphId:{serializedName:"ParagraphId",type:{name:"String"}},paragraphRevisionId:{serializedName:"ParagraphRevisionId",type:{name:"String"}},isDocumentLevelCritique:{serializedName:"IsDocumentLevelCritique",defaultValue:!1,type:{name:"Boolean"}},readingConcepts:{serializedName:"ReadingConcepts",type:{name:"Sequence",element:{type:{name:"Composite",className:"ReadingConcept"}}}}}}},T={serializedName:"ReadingResponse",type:{name:"Composite",className:"ReadingResponse",modelProperties:{acronymsResponse:{serializedName:"AcronymsResponse",type:{name:"Composite",className:"AcronymsResponse"}}}}},R={serializedName:"CommonResponseStatusProperty",type:{name:"Composite",className:"CommonResponseStatusProperty",modelProperties:{responseStatus:{serializedName:"ResponseStatus",defaultValue:0,type:{name:"Enum",allowedValues:[0,1,2,3]}}}}},x={serializedName:"CheckResponseV1",type:{name:"Composite",className:"CheckResponseV1",modelProperties:Object.assign(Object.assign({},R.type.modelProperties),{requestId:{serializedName:"RequestId",type:{name:"Uuid"}},checkedSpans:{serializedName:"CheckedSpans",type:{name:"Sequence",element:{type:{name:"Composite",className:"CheckedSpan"}}}},critiques:{required:!0,serializedName:"Critiques",type:{name:"Sequence",element:{type:{name:"Composite",className:"Critique"}}}},metadata:{serializedName:"Metadata",type:{name:"Sequence",element:{type:{name:"String"}}}},readingCritiques:{serializedName:"ReadingCritiques",type:{name:"Sequence",element:{type:{name:"Composite",className:"ReadingCritique"}}}},readingResponse:{serializedName:"ReadingResponse",type:{name:"Composite",className:"ReadingResponse"}}})}},k={serializedName:"CommonCritique",type:{name:"Composite",className:"CommonCritique",modelProperties:{traceId:{serializedName:"TraceId",type:{name:"Uuid"}},typeId:{serializedName:"TypeId",type:{name:"Uuid"}},categoryTitle:{serializedName:"CategoryTitle",type:{name:"String"}},context:{serializedName:"Context",type:{name:"String"}},start:{serializedName:"Start",defaultValue:0,type:{name:"Number"}},startInContext:{serializedName:"StartInContext",defaultValue:0,type:{name:"Number"}},length:{serializedName:"Length",defaultValue:0,type:{name:"Number"}},languageId:{serializedName:"LanguageId",type:{name:"String"}},priority:{serializedName:"Priority",type:{name:"Number"}},metadata:{serializedName:"Metadata",type:{name:"Sequence",element:{type:{name:"Composite",className:"Metadatum"}}}}}}},N={serializedName:"CommonDescriptorsProperty",type:{name:"Composite",className:"CommonDescriptorsProperty",modelProperties:{descriptors:{serializedName:"Descriptors",type:{name:"Sequence",element:{type:{name:"Composite",className:"Descriptor"}}}}}}},A={serializedName:"CommonLanguageUXIdProperty",type:{name:"Composite",className:"CommonLanguageUXIdProperty",modelProperties:{languageUXId:{serializedName:"LanguageUXId",type:{name:"String"}}}}},D={serializedName:"CommonOverriddenCritiqueTypeOptions",type:{name:"Composite",className:"CommonOverriddenCritiqueTypeOptions",modelProperties:{overriddenCritiqueTypeOptions:{serializedName:"OverriddenCritiqueTypeOptions",type:{name:"Sequence",element:{type:{name:"Composite",className:"CritiqueTypeOption"}}}}}}},Z={serializedName:"CommonParagraphIdProperty",type:{name:"Composite",className:"CommonParagraphIdProperty",modelProperties:{paragraphId:{serializedName:"ParagraphId",type:{name:"String"}}}}},M={serializedName:"CommonParagraphRevisionIdProperty",type:{name:"Composite",className:"CommonParagraphRevisionIdProperty",modelProperties:{paragraphRevisionId:{serializedName:"ParagraphRevisionId",type:{name:"String"}}}}},O={serializedName:"CommonRequestIdProperty",type:{name:"Composite",className:"CommonRequestIdProperty",modelProperties:{requestId:{serializedName:"RequestId",type:{name:"String"}}}}},F={serializedName:"CommonTileIdProperty",type:{name:"Composite",className:"CommonTileIdProperty",modelProperties:{tileId:{serializedName:"TileId",type:{name:"String"}}}}},_={serializedName:"CommonRevisionIdProperty",type:{name:"Composite",className:"CommonRevisionIdProperty",modelProperties:{revisionId:{serializedName:"RevisionId",type:{name:"String"}}}}},L={serializedName:"CommonRunOnProfileIdProperty",type:{name:"Composite",className:"CommonRunOnProfileIdProperty",modelProperties:{runOnProfileId:{serializedName:"RunOnProfileId",type:{name:"Uuid"}}}}},z={serializedName:"CommonTextUnitProperty",type:{name:"Composite",className:"CommonTextUnitProperty",modelProperties:{textUnit:{serializedName:"TextUnit",type:{name:"Enum",allowedValues:[0,1,2,4,8,16,32,64,256,16384]}}}}},B={serializedName:"ConfigRequestV1",type:{name:"Composite",className:"ConfigRequestV1",modelProperties:{appId:{required:!0,serializedName:"AppId",type:{name:"String"}},appVersion:{serializedName:"AppVersion",type:{name:"String"}},descriptors:{serializedName:"Descriptors",type:{name:"Sequence",element:{type:{name:"Composite",className:"Descriptor"}}}},languageId:{required:!0,serializedName:"LanguageId",type:{name:"String"}},languageUXId:{serializedName:"LanguageUXId",type:{name:"String"}},requestId:{serializedName:"RequestId",type:{name:"String"}},runOnProfileId:{serializedName:"RunOnProfileId",type:{name:"Uuid"}}}}},V={serializedName:"CritiqueTypeInfo",type:{name:"Composite",className:"CritiqueTypeInfo",modelProperties:{id:{required:!0,serializedName:"Id",type:{name:"Uuid"}},name:{required:!0,serializedName:"Name",type:{name:"String"}},isBinaryCritiqueType:{serializedName:"IsBinaryCritiqueType",type:{name:"Boolean"}},critiqueTypeValues:{serializedName:"CritiqueTypeValues",type:{name:"Sequence",element:{type:{name:"String"}}}},defaultCritiqueValue:{required:!0,serializedName:"DefaultCritiqueValue",type:{name:"Number"}},critiquePriority:{serializedName:"CritiquePriority",type:{name:"Number"}},critiqueTag:{serializedName:"CritiqueTag",type:{name:"String"}}}}},U={serializedName:"CritiqueCategoryInfo",type:{name:"Composite",className:"CritiqueCategoryInfo",modelProperties:{id:{required:!0,serializedName:"Id",type:{name:"Uuid"}},name:{required:!0,serializedName:"Name",type:{name:"String"}},priority:{serializedName:"Priority",type:{name:"Number"}},critiqueTypeInfoList:{serializedName:"CritiqueTypeInfoList",type:{name:"Sequence",element:{type:{name:"Composite",className:"CritiqueTypeInfo"}}}}}}},q={serializedName:"Profile",type:{name:"Composite",className:"Profile",modelProperties:Object.assign(Object.assign({},m.type.modelProperties),{id:{required:!0,serializedName:"Id",type:{name:"Uuid"}},title:{serializedName:"Title",type:{name:"String"}},default:{serializedName:"Default",type:{name:"Boolean"}},critiqueCategoryInfoList:{required:!0,serializedName:"CritiqueCategoryInfoList",type:{name:"Sequence",element:{type:{name:"Composite",className:"CritiqueCategoryInfo"}}}}})}},W={serializedName:"ConfigResponseV1",type:{name:"Composite",className:"ConfigResponseV1",modelProperties:{responseStatus:{required:!0,serializedName:"ResponseStatus",defaultValue:0,type:{name:"Enum",allowedValues:[0,1,2,3]}},requestId:{required:!0,serializedName:"RequestId",type:{name:"String"}},profiles:{required:!0,serializedName:"Profiles",type:{name:"Sequence",element:{type:{name:"Composite",className:"Profile"}}}}}}},H={serializedName:"ConfigRequestV2",type:{name:"Composite",className:"ConfigRequestV2",modelProperties:{appId:{required:!0,serializedName:"AppId",type:{name:"String"}},appVersion:{serializedName:"AppVersion",type:{name:"String"}},descriptors:{serializedName:"Descriptors",type:{name:"Sequence",element:{type:{name:"Composite",className:"Descriptor"}}}},languageId:{required:!0,serializedName:"LanguageId",type:{name:"String"}},languageUXId:{serializedName:"LanguageUXId",type:{name:"String"}},runOnProfileId:{serializedName:"RunOnProfileId",type:{name:"Uuid"}}}}},j={serializedName:"ConfigResponseV2",type:{name:"Composite",className:"ConfigResponseV2",modelProperties:Object.assign(Object.assign({},R.type.modelProperties),{critiqueCategoryInfoList:{required:!0,serializedName:"CritiqueCategoryInfoList",type:{name:"Sequence",element:{type:{name:"Composite",className:"CritiqueCategoryInfo"}}}}})}},G={serializedName:"InsightsRequestV1",type:{name:"Composite",className:"InsightsRequestV1",modelProperties:{appId:{required:!0,serializedName:"AppId",type:{name:"String"}},languageId:{required:!0,serializedName:"LanguageId",type:{name:"String"}},text:{required:!0,serializedName:"Text",type:{name:"String"}}}}},K={serializedName:"InsightsResponseV1_AnalyzerData",type:{name:"Composite",className:"InsightsResponseV1AnalyzerData",modelProperties:{contentWordsCount:{serializedName:"ContentWordsCount",type:{name:"Number"}},functionalWordsCount:{serializedName:"FunctionalWordsCount",type:{name:"Number"}},pronounsCount:{serializedName:"PronounsCount",type:{name:"Number"}},sentencesCount:{serializedName:"SentencesCount",type:{name:"Number"}},syllablesCount:{serializedName:"SyllablesCount",type:{name:"Number"}},wordsCount:{serializedName:"WordsCount",type:{name:"Number"}},wordFrequency:{serializedName:"WordFrequency",type:{name:"Number"}},wordCharactersCount:{serializedName:"WordCharactersCount",type:{name:"Number"}},semicolonsCount:{serializedName:"SemicolonsCount",type:{name:"Number"}},wordsLongerThan8Count:{serializedName:"WordsLongerThan8Count",type:{name:"Number"}}}}},X={serializedName:"InsightsResponseV1",type:{name:"Composite",className:"InsightsResponseV1",modelProperties:{responseStatus:{serializedName:"ResponseStatus",defaultValue:0,type:{name:"Enum",allowedValues:[0,1,2,3]}},requestId:{serializedName:"RequestId",type:{name:"String"}},analyzerData:{serializedName:"AnalyzerData",type:{name:"Composite",className:"InsightsResponseV1AnalyzerData"}}}}},$={serializedName:"InstrumentationRequestV1",type:{name:"Composite",className:"InstrumentationRequestV1",modelProperties:{appId:{required:!0,serializedName:"AppId",type:{name:"String"}},languageId:{required:!0,serializedName:"LanguageId",type:{name:"String"}},descriptors:{serializedName:"Descriptors",type:{name:"Sequence",element:{type:{name:"Composite",className:"Descriptor"}}}},traceId:{required:!0,serializedName:"TraceId",type:{name:"Uuid"}},critiqueGenerationTime:{serializedName:"CritiqueGenerationTime",type:{name:"Number"}},critiquePriority:{required:!0,serializedName:"CritiquePriority",type:{name:"Number"}},critiqueTypeId:{required:!0,serializedName:"CritiqueTypeId",type:{name:"Uuid"}},eventId:{required:!0,serializedName:"EventId",type:{name:"Enum",allowedValues:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]}},flaggedText:{required:!0,serializedName:"FlaggedText",constraints:{MaxLength:2e4,MinLength:1},type:{name:"String"}},metadata:{serializedName:"Metadata",type:{name:"Sequence",element:{type:{name:"Composite",className:"Metadatum"}}}},originalText:{serializedName:"OriginalText",type:{name:"String"}},preContextBegin:{serializedName:"PreContextBegin",type:{name:"Number"}},postContextEnd:{serializedName:"PostContextEnd",type:{name:"Number"}},substrateEventName:{serializedName:"SubstrateEventName",type:{name:"String"}},substrateEventCustomFields:{serializedName:"SubstrateEventCustomFields",type:{name:"Object"}},suggestions:{serializedName:"Suggestions",type:{name:"Sequence",element:{type:{name:"String"}}}},suggestionText:{serializedName:"SuggestionText",constraints:{MaxLength:2e4},type:{name:"String"}}}}},J={serializedName:"LanguageInfoRequestV1",type:{name:"Composite",className:"LanguageInfoRequestV1",modelProperties:{appId:{required:!0,serializedName:"AppId",type:{name:"String"}},descriptors:{serializedName:"Descriptors",type:{name:"Sequence",element:{type:{name:"Composite",className:"Descriptor"}}}},languageId:{serializedName:"LanguageId",type:{name:"String"}},languageUXId:{serializedName:"LanguageUXId",type:{name:"String"}},runOnProfileId:{serializedName:"RunOnProfileId",type:{name:"Uuid"}}}}},Q={serializedName:"SupportedLanguage",type:{name:"Composite",className:"SupportedLanguage",modelProperties:{languageId:{required:!0,serializedName:"LanguageId",type:{name:"String"}},textUnit:{required:!0,serializedName:"TextUnit",type:{name:"Enum",allowedValues:[0,1,2,4,8,16,32,64,256,16384]}},supportedCritiqueTag:{serializedName:"SupportedCritiqueTag",type:{name:"String"}}}}},Y={serializedName:"LanguageInfoResponseV1",type:{name:"Composite",className:"LanguageInfoResponseV1",modelProperties:Object.assign(Object.assign({},R.type.modelProperties),{supportedLanguages:{required:!0,serializedName:"SupportedLanguages",type:{name:"Sequence",element:{type:{name:"Composite",className:"SupportedLanguage"}}}}})}},ee={serializedName:"MetadataContent",type:{name:"Composite",className:"MetadataContent",modelProperties:{metadataType:{serializedName:"MetadataType",type:{name:"Enum",allowedValues:[0]}},value:{serializedName:"Value",type:{name:"String"}},typeId:{serializedName:"TypeId",type:{name:"Uuid"}}}}},te={serializedName:"Metadata",type:{name:"Composite",className:"Metadata",modelProperties:Object.assign(Object.assign({},z.type.modelProperties),{textUnitId:{serializedName:"TextUnitId",type:{name:"Number"}},textUnitRevisionId:{serializedName:"TextUnitRevisionId",type:{name:"Number"}},contents:{serializedName:"Contents",type:{name:"Sequence",element:{type:{name:"Composite",className:"MetadataContent"}}}}})}},ne={serializedName:"TextElement",type:{name:"Composite",className:"TextElement",modelProperties:{languageId:{required:!0,serializedName:"LanguageId",type:{name:"String"}},text:{required:!0,serializedName:"Text",type:{name:"String"}},id:{required:!0,serializedName:"Id",type:{name:"String"}}}}},ie={serializedName:"NeuralBatchCheckRequestV1",type:{name:"Composite",className:"NeuralBatchCheckRequestV1",modelProperties:{appId:{required:!0,serializedName:"AppId",type:{name:"String"}},descriptors:{serializedName:"Descriptors",type:{name:"Sequence",element:{type:{name:"Composite",className:"Descriptor"}}}},languageUXId:{serializedName:"LanguageUXId",type:{name:"String"}},overriddenCritiqueTypeOptions:{serializedName:"OverriddenCritiqueTypeOptions",type:{name:"Sequence",element:{type:{name:"Composite",className:"CritiqueTypeOption"}}}},sessionId:{serializedName:"SessionId",type:{name:"String"}},content:{required:!0,serializedName:"Content",type:{name:"Sequence",element:{type:{name:"Composite",className:"TextElement"}}}}}}},re={serializedName:"NeuralBatchCheckResponseV1",type:{name:"Composite",className:"NeuralBatchCheckResponseV1",modelProperties:Object.assign(Object.assign({},R.type.modelProperties),{critiques:{required:!0,serializedName:"Critiques",type:{name:"Sequence",element:{type:{name:"Composite",className:"Critique"}}}},metadata:{serializedName:"Metadata",type:{name:"Sequence",element:{type:{name:"String"}}}}})}},oe={serializedName:"NeuralRewriteRequestV1",type:{name:"Composite",className:"NeuralRewriteRequestV1",modelProperties:{appId:{serializedName:"AppId",type:{name:"String"}},languageId:{serializedName:"LanguageId",type:{name:"String"}},mode:{serializedName:"Mode",type:{name:"Number"}},selectionLength:{serializedName:"SelectionLength",defaultValue:0,type:{name:"Number"}},selectionStart:{serializedName:"SelectionStart",defaultValue:0,type:{name:"Number"}}}}},se={serializedName:"NeuralRewriteResponseV1",type:{name:"Composite",className:"NeuralRewriteResponseV1",modelProperties:Object.assign(Object.assign({},R.type.modelProperties),{requestId:{serializedName:"RequestId",type:{name:"Uuid"}},critiques:{required:!0,serializedName:"Critiques",type:{name:"Sequence",element:{type:{name:"Composite",className:"Critique"}}}},metadata:{serializedName:"Metadata",type:{name:"Sequence",element:{type:{name:"String"}}}}})}},ae={serializedName:"SelectedLanguages",type:{name:"Composite",className:"SelectedLanguages",modelProperties:{tildId:{serializedName:"TildId",type:{name:"String"}},selectedLanguage:{serializedName:"SelectedLanguage",type:{name:"Sequence",element:{type:{name:"Sequence",element:{type:{name:"String"}}}}}}}}},le={serializedName:"SupportedActions",type:{name:"Composite",className:"SupportedActions",modelProperties:{supportedActions:{serializedName:"SupportedActions",type:{name:"Number"}}}}},ce={serializedName:"TopologyNode",type:{name:"Composite",className:"TopologyNode",modelProperties:{id:{required:!0,serializedName:"Id",type:{name:"String"}},revisionId:{required:!0,serializedName:"RevisionId",type:{name:"String"}},analyzerData:{serializedName:"AnalyzerData",type:{name:"Object"}},type:{serializedName:"Type",type:{name:"Enum",allowedValues:[0,1,2,3,4]}},children:{serializedName:"Children",type:{name:"Sequence",element:{type:{name:"Composite",className:"TopologyNode"}}}},numberOfChildren:{serializedName:"NumberOfChildren",type:{name:"Number"}},areChildsOrdered:{serializedName:"AreChildsOrdered",defaultValue:!1,type:{name:"Boolean"}}}}},de={serializedName:"TileCheckSpan",type:{name:"Composite",className:"TileCheckSpan",modelProperties:Object.assign(Object.assign({},m.type.modelProperties),{start:{serializedName:"Start",defaultValue:0,type:{name:"Number"}},length:{serializedName:"Length",defaultValue:"tileElement.Text.Length - span.Start",type:{name:"Number"}},doNotCheck:{serializedName:"DoNotCheck",type:{name:"Boolean"}},analyzerData:{serializedName:"AnalyzerData",type:{name:"Object"}}})}},ue={serializedName:"TileElement",type:{name:"Composite",className:"TileElement",modelProperties:{languageId:{required:!0,serializedName:"LanguageId",type:{name:"String"}},textUnit:{serializedName:"TextUnit",type:{name:"Enum",allowedValues:[0,1,2,4,8,16,32,64,256,16384]}},text:{required:!0,serializedName:"Text",type:{name:"String"}},enabledLanguages:{serializedName:"EnabledLanguages",type:{name:"Sequence",element:{type:{name:"Sequence",element:{type:{name:"Composite",className:"CommonLanguageIdProperty"}}}}}},isClean:{serializedName:"IsClean",type:{name:"Boolean"}},analyzerData:{serializedName:"AnalyzerData",type:{name:"Object"}},spans:{serializedName:"Spans",type:{name:"Sequence",element:{type:{name:"Composite",className:"TileCheckSpan"}}}}}}},pe={serializedName:"TileContent",type:{name:"Composite",className:"TileContent",modelProperties:{tileId:{required:!0,serializedName:"TileId",type:{name:"String"}},revisionId:{required:!0,serializedName:"RevisionId",type:{name:"String"}},analyzerData:{serializedName:"AnalyzerData",type:{name:"Object"}},tileElements:{serializedName:"TileElements",type:{name:"Sequence",element:{type:{name:"Composite",className:"TileElement"}}}}}}},me={serializedName:"TileCheckRequestV1",type:{name:"Composite",className:"TileCheckRequestV1",modelProperties:{appId:{required:!0,serializedName:"AppId",type:{name:"String"}},descriptors:{serializedName:"Descriptors",type:{name:"Sequence",element:{type:{name:"Composite",className:"Descriptor"}}}},languageUXId:{required:!0,serializedName:"LanguageUXId",type:{name:"String"}},runOnProfileId:{serializedName:"RunOnProfileId",type:{name:"Uuid"}},overriddenCritiqueTypeOptions:{serializedName:"OverriddenCritiqueTypeOptions",type:{name:"Sequence",element:{type:{name:"Composite",className:"CritiqueTypeOption"}}}},sessionId:{serializedName:"SessionId",type:{name:"String"}},requestOrderInSession:{serializedName:"RequestOrderInSession",type:{name:"Number"}},content:{serializedName:"Content",type:{name:"Sequence",element:{type:{name:"Composite",className:"TileContent"}}}},topology:{serializedName:"Topology",type:{name:"Composite",className:"TopologyNode"}}}}},he={serializedName:"TileCheckCritique",type:{name:"Composite",className:"TileCheckCritique",modelProperties:{traceId:{serializedName:"TraceId",type:{name:"Uuid"}},typeId:{serializedName:"TypeId",type:{name:"Uuid"}},categoryTitle:{serializedName:"CategoryTitle",type:{name:"String"}},context:{serializedName:"Context",type:{name:"String"}},start:{serializedName:"Start",defaultValue:0,type:{name:"Number"}},startInContext:{serializedName:"StartInContext",defaultValue:0,type:{name:"Number"}},length:{serializedName:"Length",defaultValue:0,type:{name:"Number"}},languageId:{serializedName:"LanguageId",type:{name:"String"}},priority:{serializedName:"Priority",type:{name:"Number"}},metadata:{serializedName:"Metadata",type:{name:"Sequence",element:{type:{name:"Composite",className:"Metadatum"}}}},tileId:{serializedName:"TileId",type:{name:"String"}},revisionId:{serializedName:"RevisionId",type:{name:"String"}},supportedActions:{serializedName:"SupportedActions",type:{name:"Number"}},bucketId:{serializedName:"BucketId",type:{name:"Number"}},explanationTitle:{serializedName:"ExplanationTitle",type:{name:"String"}},explanationLabel:{serializedName:"ExplanationLabel",type:{name:"String"}},explanation:{serializedName:"Explanation",type:{name:"String"}},suggestions:{serializedName:"Suggestions",type:{name:"Sequence",element:{type:{name:"Composite",className:"Suggestion"}}}},status:{serializedName:"Status",type:{name:"Enum",allowedValues:[0,1,2]}},tag:{serializedName:"Tag",type:{name:"Enum",allowedValues:[0,1]}}}}},fe={serializedName:"TileCheckResponseV1",type:{name:"Composite",className:"TileCheckResponseV1",modelProperties:Object.assign(Object.assign({},R.type.modelProperties),{critiques:{serializedName:"Critiques",type:{name:"Sequence",element:{type:{name:"Composite",className:"TileCheckCritique"}}}}})}},ge={serializedName:"UserIdentity",type:{name:"Composite",className:"UserIdentity",modelProperties:{identityProvider:{required:!0,serializedName:"IdentityProvider",type:{name:"Number"}},puid:{required:!0,serializedName:"Puid",type:{name:"String"}},tenantId:{serializedName:"TenantId",type:{name:"String"}},cid:{serializedName:"Cid",type:{name:"String"}}}}},ve={serializedName:"postcheck-headers",type:{name:"Composite",className:"PostCheckHeaders",modelProperties:{xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}}}},ye={serializedName:"getcheck-headers",type:{name:"Composite",className:"GetCheckHeaders",modelProperties:{xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}}}},Se={serializedName:"posttilecheck-headers",type:{name:"Composite",className:"PostTileCheckHeaders",modelProperties:{xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}}}},be={serializedName:"configv1-headers",type:{name:"Composite",className:"ConfigV1Headers",modelProperties:{xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}}}},Ie={serializedName:"configv2-headers",type:{name:"Composite",className:"ConfigV2Headers",modelProperties:{xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}}}},we={serializedName:"languageinfo-headers",type:{name:"Composite",className:"LanguageinfoHeaders",modelProperties:{xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}}}},Ce={serializedName:"neuralbatchcheck-headers",type:{name:"Composite",className:"NeuralbatchcheckHeaders",modelProperties:{xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}}}},Ee={serializedName:"instrumentation-headers",type:{name:"Composite",className:"InstrumentationHeaders",modelProperties:{xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}}}};const Pe={parameterPath:["options","enabledLanguages"],mapper:{serializedName:"EnabledLanguages",type:{name:"Sequence",element:{type:{name:"String"}}}},collectionFormat:n(601674).c.Csv},Te={parameterPath:"xCorrelationId",mapper:{serializedName:"X-CorrelationId",type:{name:"Uuid"}}},Re={parameterPath:"xUserId",mapper:{serializedName:"X-UserId",type:{name:"String"}}},xe={parameterPath:"xUserSessionId",mapper:{serializedName:"X-UserSessionId",type:{name:"Uuid"}}};var ke=n(566684),Ne=n(416385);class Ae extends ke.St{constructor(e){if(e||(e={}),!e.userAgent){const t=Ne.IM();e.userAgent=`@editor/client-rest-api/1.218.5 ${t}`}super(void 0,e),this.baseUri=e.baseUri||this.baseUri||"https://nleditor.osi.officeppe.net/",this.requestContentType="application/json; charset=utf-8",null!==e.xCorrelationId&&void 0!==e.xCorrelationId&&(this.xCorrelationId=e.xCorrelationId),null!==e.xUserSessionId&&void 0!==e.xUserSessionId&&(this.xUserSessionId=e.xUserSessionId),null!==e.xUserId&&void 0!==e.xUserId&&(this.xUserId=e.xUserId),null!==e.authorization&&void 0!==e.authorization&&(this.authorization=e.authorization),null!==e.serverToServerId&&void 0!==e.serverToServerId&&(this.serverToServerId=e.serverToServerId)}}class De extends Ae{constructor(e){super(e)}postCheck(e,t,n){return this.sendOperationRequest({body:e,options:t},Me,n)}getCheck(e,t,n,i,r){return this.sendOperationRequest({appId:e,text:t,languageId:n,options:i},Oe,r)}insights(e,t,n){return this.sendOperationRequest({body:e,options:t},Fe,n)}browserextension(e,t,n){return this.sendOperationRequest({body:e,options:t},_e,n)}postTileCheck(e,t,n){return this.sendOperationRequest({body:e,options:t},Le,n)}configV1(e,t,n){return this.sendOperationRequest({body:e,options:t},ze,n)}configV2(e,t,n){return this.sendOperationRequest({body:e,options:t},Be,n)}languageinfo(e,t,n){return this.sendOperationRequest({body:e,options:t},Ve,n)}neuralbatchcheck(e,t,n){return this.sendOperationRequest({body:e,options:t},Ue,n)}neuralrewrite(e,t,n){return this.sendOperationRequest({body:e,options:t},qe,n)}instrumentation(e,t,n){return this.sendOperationRequest({body:e,options:t},We,n)}}const Ze=new r.ei(i),Me={httpMethod:"POST",path:"NLEditor/api/V1/Check",headerParameters:[Te,xe,Re],requestBody:{parameterPath:"body",mapper:Object.assign(Object.assign({},b),{required:!0})},responses:{200:{bodyMapper:x,headersMapper:ve},400:{headersMapper:ve},500:{headersMapper:ve},default:{}},serializer:Ze},Oe={httpMethod:"GET",path:"NLEditor/api/V1/Check",queryParameters:[{parameterPath:"appId",mapper:{required:!0,serializedName:"AppId",type:{name:"String"}}},{parameterPath:["options","autoSelect"],mapper:{serializedName:"AutoSelect",type:{name:"Boolean"}}},Pe,{parameterPath:"text",mapper:{required:!0,serializedName:"Text",type:{name:"String"}}},{parameterPath:"languageId",mapper:{required:!0,serializedName:"LanguageId",type:{name:"String"}}},{parameterPath:["options","appVersion"],mapper:{serializedName:"AppVersion",type:{name:"String"}}},{parameterPath:["options","descriptors0Name"],mapper:{serializedName:"Descriptors[0].Name",type:{name:"String"}}},{parameterPath:["options","descriptors0Value"],mapper:{serializedName:"Descriptors[0].Value",type:{name:"String"}}},{parameterPath:["options","descriptors1Name"],mapper:{serializedName:"Descriptors[1].Name",type:{name:"String"}}},{parameterPath:["options","descriptors1Value"],mapper:{serializedName:"Descriptors[1].Value",type:{name:"String"}}},{parameterPath:["options","languageUXId"],mapper:{serializedName:"LanguageUXId",type:{name:"String"}}},{parameterPath:["options","runOnProfileId"],mapper:{serializedName:"RunOnProfileId",type:{name:"String"}}},{parameterPath:["options","length"],mapper:{serializedName:"Length",type:{name:"Number"}}},{parameterPath:["options","start"],mapper:{serializedName:"Start",type:{name:"Number"}}},{parameterPath:["options","requestId"],mapper:{serializedName:"RequestId",type:{name:"Uuid"}}},{parameterPath:["options","textUnit"],mapper:{serializedName:"TextUnit",type:{name:"String"}}}],headerParameters:[Te,xe,Re],responses:{200:{bodyMapper:x,headersMapper:ye},400:{headersMapper:ye},500:{headersMapper:ye},default:{}},serializer:Ze},Fe={httpMethod:"POST",path:"NLEditor/api/V1/Insights",headerParameters:[Te,xe,Re],requestBody:{parameterPath:"body",mapper:Object.assign(Object.assign({},G),{required:!0})},responses:{200:{bodyMapper:X},400:{},500:{},default:{}},serializer:Ze},_e={httpMethod:"POST",path:"NLEditor/api/V1/BrowserExtension",headerParameters:[Te,xe,Re],requestBody:{parameterPath:"body",mapper:Object.assign(Object.assign({},d),{required:!0})},responses:{200:{bodyMapper:u},400:{},500:{},default:{}},serializer:Ze},Le={httpMethod:"POST",path:"NLEditor/api/V1/TileCheck",headerParameters:[Te,xe,Re],requestBody:{parameterPath:"body",mapper:Object.assign(Object.assign({},me),{required:!0})},responses:{200:{bodyMapper:fe,headersMapper:Se},400:{headersMapper:Se},500:{headersMapper:Se},default:{}},serializer:Ze},ze={httpMethod:"POST",path:"NLEditor/api/V1/Config",headerParameters:[Te,xe,Re],requestBody:{parameterPath:"body",mapper:Object.assign(Object.assign({},B),{required:!0})},responses:{200:{bodyMapper:W,headersMapper:be},400:{headersMapper:be},500:{headersMapper:be},default:{}},serializer:Ze},Be={httpMethod:"POST",path:"NLEditor/Config/V2",headerParameters:[Te,xe,Re],requestBody:{parameterPath:"body",mapper:Object.assign(Object.assign({},H),{required:!0})},responses:{200:{bodyMapper:j,headersMapper:Ie},400:{headersMapper:Ie},500:{headersMapper:Ie},default:{}},serializer:Ze},Ve={httpMethod:"POST",path:"NLEditor/api/V1/LanguageInfo",headerParameters:[Te,xe,Re],requestBody:{parameterPath:"body",mapper:Object.assign(Object.assign({},J),{required:!0})},responses:{200:{bodyMapper:Y,headersMapper:we},400:{headersMapper:we},500:{headersMapper:we},default:{}},serializer:Ze},Ue={httpMethod:"POST",path:"NLEditor/api/V1/NeuralBatchCheck",headerParameters:[Te,xe,Re],requestBody:{parameterPath:"body",mapper:Object.assign(Object.assign({},ie),{required:!0})},responses:{200:{bodyMapper:re,headersMapper:Ce},400:{headersMapper:Ce},500:{headersMapper:Ce},default:{}},serializer:Ze},qe={httpMethod:"POST",path:"NLEditor/api/V1/NeuralRewrite",headerParameters:[Te,xe,Re],requestBody:{parameterPath:"body",mapper:Object.assign(Object.assign({},oe),{required:!0})},responses:{200:{bodyMapper:se},400:{},500:{},default:{}},serializer:Ze},We={httpMethod:"POST",path:"NLEditor/api/V1/Instrumentation",headerParameters:[Te,xe,{parameterPath:"serverToServerId",mapper:{serializedName:"ServerToServerId",type:{name:"String"}}}],requestBody:{parameterPath:"body",mapper:Object.assign(Object.assign({},$),{required:!0})},responses:{200:{headersMapper:Ee},400:{headersMapper:Ee},500:{headersMapper:Ee},default:{}},serializer:Ze}},75517:(e,t,n)=>{"use strict";var i,r,o,s,a,l,c,d,u,p;n.d(t,{Mx:()=>i,bw:()=>r,Hw:()=>o,lm:()=>a,Eo:()=>l}),function(e){e[e.Success=0]="Success",e[e.PartialSuccess=1]="PartialSuccess",e[e.Error=2]="Error",e[e.Disabled=3]="Disabled"}(i||(i={})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low"}(r||(r={})),function(e){e[e.None=0]="None",e[e.OfficeOrthospeller=1]="OfficeOrthospeller",e[e.BingOneSpeller=2]="BingOneSpeller",e[e.ContextSpeller=3]="ContextSpeller",e[e.Grammar=4]="Grammar"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.DocumentText=1]="DocumentText"}(s||(s={})),function(e){e[e.Default=0]="Default",e[e.Word=1]="Word",e[e.Phrase=2]="Phrase",e[e.Sentence=4]="Sentence",e[e.Paragraph=8]="Paragraph",e[e.Page=16]="Page",e[e.Section=32]="Section",e[e.Chapter=64]="Chapter",e[e.Document=256]="Document",e[e.RawChars=16384]="RawChars"}(a||(a={})),function(e){e[e.Ignore=0]="Ignore",e[e.IgnoreAll=1]="IgnoreAll",e[e.AddToDictionary=2]="AddToDictionary",e[e.Delete=3]="Delete",e[e.ChangeSugg0=4]="ChangeSugg0",e[e.ChangeSugg1=5]="ChangeSugg1",e[e.ChangeSugg2=6]="ChangeSugg2",e[e.ChangeSuggOther=7]="ChangeSuggOther",e[e.ChangeAllSugg0=8]="ChangeAllSugg0",e[e.ChangeAllSugg1=9]="ChangeAllSugg1",e[e.ChangeAllSugg2=10]="ChangeAllSugg2",e[e.ChangeAllSuggOther=11]="ChangeAllSuggOther",e[e.ClickNoAction=12]="ClickNoAction",e[e.DoNotCheckThisIssue=13]="DoNotCheckThisIssue",e[e.ManualEdit=14]="ManualEdit",e[e.Autoreplace=15]="Autoreplace",e[e.AutoreplaceUndo=16]="AutoreplaceUndo",e[e.IgnoreUndo=17]="IgnoreUndo",e[e.IgnoreAllUndo=18]="IgnoreAllUndo",e[e.ChangeSugg0Undo=19]="ChangeSugg0Undo",e[e.ChangeSugg1Undo=20]="ChangeSugg1Undo",e[e.ChangeSugg2Undo=21]="ChangeSugg2Undo"}(l||(l={})),function(e){e[e.IsResume=0]="IsResume"}(c||(c={})),function(e){e[e.Unknown=0]="Unknown",e[e.Paragraph=1]="Paragraph",e[e.Group=2]="Group",e[e.Page=3]="Page",e[e.Document=4]="Document"}(d||(d={})),function(e){e[e.None=0]="None",e[e.Active=1]="Active",e[e.Provisional=2]="Provisional"}(u||(u={})),function(e){e[e.None=0]="None",e[e.Consistency=1]="Consistency"}(p||(p={}))},352932:(e,t,n)=>{"use strict";n.d(t,{G:()=>u});var i=n(333940),r=n(989526),o=n(55353),s=n(440655),a=n(321929),l=n(473430),c=n(352633),d="backward",u=function(e){function t(t){var n=e.call(this,t)||this;return n._inputElement=r.createRef(),n._autoFillEnabled=!0,n._onCompositionStart=function(e){n.setState({isComposing:!0}),n._autoFillEnabled=!1},n._onCompositionUpdate=function(){(0,o.f)()&&n._updateValue(n._getCurrentInputValue(),!0)},n._onCompositionEnd=function(e){var t=n._getCurrentInputValue();n._tryEnableAutofill(t,n.value,!1,!0),n.setState({isComposing:!1}),n._async.setTimeout((function(){n._updateValue(n._getCurrentInputValue(),!1)}),0)},n._onClick=function(){n.value&&""!==n.value&&n._autoFillEnabled&&(n._autoFillEnabled=!1)},n._onKeyDown=function(e){if(n.props.onKeyDown&&n.props.onKeyDown(e),!e.nativeEvent.isComposing)switch(e.which){case s.m.backspace:n._autoFillEnabled=!1;break;case s.m.left:case s.m.right:n._autoFillEnabled&&(n.setState({inputValue:n.props.suggestedDisplayValue||""}),n._autoFillEnabled=!1);break;default:n._autoFillEnabled||-1!==n.props.enableAutofillOnKeyPress.indexOf(e.which)&&(n._autoFillEnabled=!0)}},n._onInputChanged=function(e){var t=n._getCurrentInputValue(e);if(n.state.isComposing||n._tryEnableAutofill(t,n.value,e.nativeEvent.isComposing),!(0,o.f)()||!n.state.isComposing){var i=e.nativeEvent.isComposing,r=void 0===i?n.state.isComposing:i;n._updateValue(t,r)}},n._onChanged=function(){},n._updateValue=function(e,t){if(e||e!==n.value){var i=n.props,r=i.onInputChange,o=i.onInputValueChange;r&&(e=(null==r?void 0:r(e,t))||""),n.setState({inputValue:e},(function(){return null==o?void 0:o(e,t)}))}},(0,a.l)(n),n._async=new l.e(n),n.state={inputValue:t.defaultVisibleValue||"",isComposing:!1},n}return(0,i.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){if(e.updateValueInWillReceiveProps){var n=e.updateValueInWillReceiveProps();if(null!==n&&n!==t.inputValue&&!t.isComposing)return(0,i.__assign)((0,i.__assign)({},t),{inputValue:n})}return null},Object.defineProperty(t.prototype,"cursorLocation",{get:function(){if(this._inputElement.current){var e=this._inputElement.current;return"forward"!==e.selectionDirection?e.selectionEnd:e.selectionStart}return-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isValueSelected",{get:function(){return Boolean(this.inputElement&&this.inputElement.selectionStart!==this.inputElement.selectionEnd)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._getControlledValue()||this.state.inputValue||""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectionStart",{get:function(){return this._inputElement.current?this._inputElement.current.selectionStart:-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectionEnd",{get:function(){return this._inputElement.current?this._inputElement.current.selectionEnd:-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inputElement",{get:function(){return this._inputElement.current},enumerable:!1,configurable:!0}),t.prototype.componentDidUpdate=function(e,t,n){var i=this.props,r=i.suggestedDisplayValue,o=i.shouldSelectFullInputValueInComponentDidUpdate,s=0;if(!i.preventValueSelection)if(this._autoFillEnabled&&this.value&&r&&p(r,this.value)){var a=!1;if(o&&(a=o()),a&&this._inputElement.current)this._inputElement.current.setSelectionRange(0,r.length,d);else{for(;s<this.value.length&&this.value[s].toLocaleLowerCase()===r[s].toLocaleLowerCase();)s++;s>0&&this._inputElement.current&&this._inputElement.current.setSelectionRange(s,r.length,d)}}else this._inputElement.current&&(null===n||this._autoFillEnabled||this.state.isComposing||this._inputElement.current.setSelectionRange(n.start,n.end,n.dir))},t.prototype.componentWillUnmount=function(){this._async.dispose()},t.prototype.render=function(){var e=(0,c.pq)(this.props,c.Gg),t=(0,i.__assign)((0,i.__assign)({},this.props.style),{fontFamily:"inherit"});return r.createElement("input",(0,i.__assign)({autoCapitalize:"off",autoComplete:"off","aria-autocomplete":"both"},e,{style:t,ref:this._inputElement,value:this._getDisplayValue(),onCompositionStart:this._onCompositionStart,onCompositionUpdate:this._onCompositionUpdate,onCompositionEnd:this._onCompositionEnd,onChange:this._onChanged,onInput:this._onInputChanged,onKeyDown:this._onKeyDown,onClick:this.props.onClick?this.props.onClick:this._onClick,"data-lpignore":!0}))},t.prototype.focus=function(){this._inputElement.current&&this._inputElement.current.focus()},t.prototype.clear=function(){this._autoFillEnabled=!0,this._updateValue("",!1),this._inputElement.current&&this._inputElement.current.setSelectionRange(0,0)},t.prototype.getSnapshotBeforeUpdate=function(){var e,t,n=this._inputElement.current;return n&&n.selectionStart!==this.value.length?{start:null!==(e=n.selectionStart)&&void 0!==e?e:n.value.length,end:null!==(t=n.selectionEnd)&&void 0!==t?t:n.value.length,dir:n.selectionDirection||"backward"}:null},t.prototype._getCurrentInputValue=function(e){return e&&e.target&&e.target.value?e.target.value:this.inputElement&&this.inputElement.value?this.inputElement.value:""},t.prototype._tryEnableAutofill=function(e,t,n,i){!n&&e&&this._inputElement.current&&this._inputElement.current.selectionStart===e.length&&!this._autoFillEnabled&&(e.length>t.length||i)&&(this._autoFillEnabled=!0)},t.prototype._getDisplayValue=function(){return this._autoFillEnabled?function(e,t){var n=e;t&&e&&p(t,n)&&(n=t);return n}(this.value,this.props.suggestedDisplayValue):this.value},t.prototype._getControlledValue=function(){var e=this.props.value;return void 0===e||"string"==typeof e?e:e.toString()},t.defaultProps={enableAutofillOnKeyPress:[s.m.down,s.m.up]},t}(r.Component);function p(e,t){return!(!e||!t)&&0===e.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())}},752548:(e,t,n)=>{"use strict";n.d(t,{Q:()=>c});var i=n(333940),r=n(989526),o=n(18838),s=n(803919),a=n(957214),l=n(191023),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,n=e.theme;return r.createElement(o.Y,(0,i.__assign)({},this.props,{variantClassName:"ms-Button--commandBar",styles:(0,l.W)(n,t),onRenderDescription:s.S}))},t=(0,i.__decorate)([(0,a.a)("CommandBarButton",["theme","styles"],!0)],t)}(r.Component)},191023:(e,t,n)=>{"use strict";n.d(t,{W:()=>c});var i=n(333940),r=n(564229),o=n(636340),s=n(618706),a=n(156982),l=n(78421),c=(0,o.NF)((function(e,t,n,o){var c,d,u,p,m,h,f,g,v,y,S,b,I,w,C=(0,s.W)(e),E=(0,a.W)(e),P=e.palette,T=e.semanticColors,R={root:[(0,r.GL)(e,{inset:2,highContrastStyle:{left:4,top:4,bottom:4,right:4,border:"none"},borderColor:"transparent"}),e.fonts.medium,{minWidth:"40px",backgroundColor:P.white,color:P.neutralPrimary,padding:"0 4px",border:"none",borderRadius:0,selectors:(c={},c[r.qJ]={border:"none"},c)}],rootHovered:{backgroundColor:P.neutralLighter,color:P.neutralDark,selectors:(d={},d[r.qJ]={color:"Highlight"},d["."+l.n.msButtonIcon]={color:P.themeDarkAlt},d["."+l.n.msButtonMenuIcon]={color:P.neutralPrimary},d)},rootPressed:{backgroundColor:P.neutralLight,color:P.neutralDark,selectors:(u={},u["."+l.n.msButtonIcon]={color:P.themeDark},u["."+l.n.msButtonMenuIcon]={color:P.neutralPrimary},u)},rootChecked:{backgroundColor:P.neutralLight,color:P.neutralDark,selectors:(p={},p["."+l.n.msButtonIcon]={color:P.themeDark},p["."+l.n.msButtonMenuIcon]={color:P.neutralPrimary},p)},rootCheckedHovered:{backgroundColor:P.neutralQuaternaryAlt,selectors:(m={},m["."+l.n.msButtonIcon]={color:P.themeDark},m["."+l.n.msButtonMenuIcon]={color:P.neutralPrimary},m)},rootExpanded:{backgroundColor:P.neutralLight,color:P.neutralDark,selectors:(h={},h["."+l.n.msButtonIcon]={color:P.themeDark},h["."+l.n.msButtonMenuIcon]={color:P.neutralPrimary},h)},rootExpandedHovered:{backgroundColor:P.neutralQuaternaryAlt},rootDisabled:{backgroundColor:P.white,selectors:(f={},f["."+l.n.msButtonIcon]={color:T.disabledBodySubtext,selectors:(g={},g[r.qJ]=(0,i.__assign)({color:"GrayText"},(0,r.xM)()),g)},f[r.qJ]=(0,i.__assign)({color:"GrayText",backgroundColor:"Window"},(0,r.xM)()),f)},splitButtonContainer:{height:"100%",selectors:(v={},v[r.qJ]={border:"none"},v)},splitButtonDividerDisabled:{selectors:(y={},y[r.qJ]={backgroundColor:"Window"},y)},splitButtonDivider:{backgroundColor:P.neutralTertiaryAlt},splitButtonMenuButton:{backgroundColor:P.white,border:"none",borderTopRightRadius:"0",borderBottomRightRadius:"0",color:P.neutralSecondary,selectors:{":hover":{backgroundColor:P.neutralLighter,color:P.neutralDark,selectors:(S={},S[r.qJ]={color:"Highlight"},S["."+l.n.msButtonIcon]={color:P.neutralPrimary},S)},":active":{backgroundColor:P.neutralLight,selectors:(b={},b["."+l.n.msButtonIcon]={color:P.neutralPrimary},b)}}},splitButtonMenuButtonDisabled:{backgroundColor:P.white,selectors:(I={},I[r.qJ]=(0,i.__assign)({color:"GrayText",border:"none",backgroundColor:"Window"},(0,r.xM)()),I)},splitButtonMenuButtonChecked:{backgroundColor:P.neutralLight,color:P.neutralDark,selectors:{":hover":{backgroundColor:P.neutralQuaternaryAlt}}},splitButtonMenuButtonExpanded:{backgroundColor:P.neutralLight,color:P.black,selectors:{":hover":{backgroundColor:P.neutralQuaternaryAlt}}},splitButtonMenuIcon:{color:P.neutralPrimary},splitButtonMenuIconDisabled:{color:P.neutralTertiary},label:{fontWeight:"normal"},icon:{color:P.themePrimary},menuIcon:(w={color:P.neutralSecondary},w[r.qJ]={color:"GrayText"},w)};return(0,r.E$)(C,E,R,t)}))},204673:(e,t,n)=>{"use strict";n.d(t,{X:()=>w});var i=n(268292),r=n(333940),o=n(989526),s=n(287130),a=n(936306),l=n(803919),c=n(629952),d=n(321929),u=n(352633),p=n(953248),m=n(474758),h=n(775482),f=n(995388),g=n(752548),v=n(981025),y=n(636340),S=(0,y.NF)((function(e){var t={height:"100%"},n={whiteSpace:"nowrap"},i=e||{},o=i.root,s=i.label,a=(0,r.__rest)(i,["root","label"]);return(0,r.__assign)((0,r.__assign)({},a),{root:o?[t,o]:t,label:s?[n,s]:n})})),b=(0,s.y)(),I=function(e){function t(t){var n=e.call(this,t)||this;return n._overflowSet=o.createRef(),n._resizeGroup=o.createRef(),n._onRenderData=function(e){var t=n.props,i=t.ariaLabel,r=t.primaryGroupAriaLabel,s=t.farItemsGroupAriaLabel,c=e.farItems&&e.farItems.length>0;return o.createElement(h.k,{className:(0,a.i)(n._classNames.root),direction:f.U.horizontal,role:"menubar","aria-label":i},o.createElement(p.p,{role:c?"group":"none","aria-label":c?r:void 0,componentRef:n._overflowSet,className:(0,a.i)(n._classNames.primarySet),items:e.primaryItems,overflowItems:e.overflowItems.length?e.overflowItems:void 0,onRenderItem:n._onRenderItem,onRenderOverflowButton:n._onRenderOverflowButton}),c&&o.createElement(p.p,{role:"group","aria-label":s,className:(0,a.i)(n._classNames.secondarySet),items:e.farItems,onRenderItem:n._onRenderItem,onRenderOverflowButton:l.S}))},n._onRenderItem=function(e){if(e.onRender)return e.onRender(e,(function(){}));var t=e.text||e.name,i=(0,r.__assign)((0,r.__assign)({allowDisabledFocus:!0,role:"menuitem"},e),{styles:S(e.buttonStyles),className:(0,a.i)("ms-CommandBarItem-link",e.className),text:e.iconOnly?void 0:t,menuProps:e.subMenuProps,onClick:n._onButtonClick(e)});return e.iconOnly&&(void 0!==t||e.tooltipHostProps)?o.createElement(v.G,(0,r.__assign)({role:"none",content:t,setAriaDescribedBy:!1},e.tooltipHostProps),n._commandButton(e,i)):n._commandButton(e,i)},n._commandButton=function(e,t){var i=n.props.buttonAs,s=e.commandBarButtonAs,a=g.Q;return s&&(a=(0,c.Z)(s,a)),i&&(a=(0,c.Z)(i,a)),o.createElement(a,(0,r.__assign)({},t))},n._onRenderOverflowButton=function(e){var t=n.props.overflowButtonProps,i=void 0===t?{}:t,s=(0,r.__spreadArray)((0,r.__spreadArray)([],i.menuProps?i.menuProps.items:[]),e),l=(0,r.__assign)((0,r.__assign)({role:"menuitem"},i),{styles:(0,r.__assign)({menuIcon:{fontSize:"17px"}},i.styles),className:(0,a.i)("ms-CommandBar-overflowButton",i.className),menuProps:(0,r.__assign)((0,r.__assign)({},i.menuProps),{items:s}),menuIconProps:(0,r.__assign)({iconName:"More"},i.menuIconProps)}),d=n.props.overflowButtonAs?(0,c.Z)(n.props.overflowButtonAs,g.Q):g.Q;return o.createElement(d,(0,r.__assign)({},l))},n._onReduceData=function(e){var t=n.props,i=t.shiftOnReduce,o=t.onDataReduced,s=e.primaryItems,a=e.overflowItems,l=e.cacheKey,c=e.farItems,d=s[i?0:s.length-1];if(void 0!==d){d.renderedInOverflow=!0,a=(0,r.__spreadArray)([d],a),s=i?s.slice(1):s.slice(0,-1);var u=(0,r.__assign)((0,r.__assign)({},e),{primaryItems:s,overflowItems:a});return l=n._computeCacheKey({primaryItems:s,overflow:a.length>0,farItems:c}),o&&o(d),u.cacheKey=l,u}},n._onGrowData=function(e){var t=n.props,i=t.shiftOnReduce,o=t.onDataGrown,s=e.minimumOverflowItems,a=e.primaryItems,l=e.overflowItems,c=e.cacheKey,d=e.farItems,u=l[0];if(void 0!==u&&l.length>s){u.renderedInOverflow=!1,l=l.slice(1),a=i?(0,r.__spreadArray)([u],a):(0,r.__spreadArray)((0,r.__spreadArray)([],a),[u]);var p=(0,r.__assign)((0,r.__assign)({},e),{primaryItems:a,overflowItems:l});return c=n._computeCacheKey({primaryItems:a,overflow:l.length>0,farItems:d}),o&&o(u),p.cacheKey=c,p}},(0,d.l)(n),n}return(0,r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.items,n=e.overflowItems,i=e.farItems,s=e.styles,a=e.theme,l=e.dataDidRender,c=e.onReduceData,d=void 0===c?this._onReduceData:c,p=e.onGrowData,h=void 0===p?this._onGrowData:p,f=e.resizeGroupAs,g=void 0===f?m.N:f,v={primaryItems:(0,r.__spreadArray)([],t),overflowItems:(0,r.__spreadArray)([],n),minimumOverflowItems:(0,r.__spreadArray)([],n).length,farItems:i,cacheKey:this._computeCacheKey({primaryItems:(0,r.__spreadArray)([],t),overflow:n&&n.length>0,farItems:i})};this._classNames=b(s,{theme:a});var y=(0,u.pq)(this.props,u.n7);return o.createElement(g,(0,r.__assign)({},y,{componentRef:this._resizeGroup,data:v,onReduceData:d,onGrowData:h,onRenderData:this._onRenderData,dataDidRender:l}))},t.prototype.focus=function(){var e=this._overflowSet.current;e&&e.focus()},t.prototype.remeasure=function(){this._resizeGroup.current&&this._resizeGroup.current.remeasure()},t.prototype._onButtonClick=function(e){return function(t){e.inactive||e.onClick&&e.onClick(t,e)}},t.prototype._computeCacheKey=function(e){var t=e.primaryItems,n=e.overflow,i=e.farItems,r=function(e,t){var n=t.cacheKey;return e+(void 0===n?t.key:n)};return[t&&t.reduce(r,""),n?"overflow":"",i&&i.reduce(r,"")].join("")},t.defaultProps={items:[],overflowItems:[]},t}(o.Component),w=(0,i.z)(I,(function(e){var t=e.className,n=e.theme,i=n.semanticColors;return{root:[n.fonts.medium,"ms-CommandBar",{display:"flex",backgroundColor:i.bodyBackground,padding:"0 14px 0 24px",height:44},t],primarySet:["ms-CommandBar-primaryCommand",{flexGrow:"1",display:"flex",alignItems:"stretch"}],secondarySet:["ms-CommandBar-secondaryCommand",{flexShrink:"0",display:"flex",alignItems:"stretch"}]}}),void 0,{scope:"CommandBar"})},969982:(e,t,n)=>{"use strict";n.d(t,{E:()=>a});var i=n(333940),r=n(989526),o=n(352633),s=(0,n(287130).y)({cacheSize:100}),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.as,n=void 0===t?"label":t,a=e.children,l=e.className,c=e.disabled,d=e.styles,u=e.required,p=e.theme,m=s(d,{className:l,disabled:c,required:u,theme:p});return r.createElement(n,(0,i.__assign)({},(0,o.pq)(this.props,o.n7),{className:m.root}),a)},t}(r.Component)},809945:(e,t,n)=>{"use strict";n.d(t,{_:()=>s});var i=n(268292),r=n(969982),o=n(82093),s=(0,i.z)(r.E,o.W,void 0,{scope:"Label"})},82093:(e,t,n)=>{"use strict";n.d(t,{W:()=>o});var i=n(333940),r=n(564229),o=function(e){var t,n=e.theme,o=e.className,s=e.disabled,a=e.required,l=n.semanticColors,c=r.lq.semibold,d=l.bodyText,u=l.disabledBodyText,p=l.errorText;return{root:["ms-Label",n.fonts.medium,{fontWeight:c,color:d,boxSizing:"border-box",boxShadow:"none",margin:0,display:"block",padding:"5px 0",wordWrap:"break-word",overflowWrap:"break-word"},s&&{color:u,selectors:(t={},t[r.qJ]=(0,i.__assign)({color:"GrayText"},(0,r.xM)()),t)},a&&{selectors:{"::after":{content:"' *'",color:p,paddingRight:12}}},o]}}},953248:(e,t,n)=>{"use strict";n.d(t,{p:()=>b});var i=n(268292),r=n(333940),o=n(989526),s=n(940654),a=n(287130),l=n(595204),c=n(999128),d=n(352633),u=n(13040),p=n(81540),m=n(180955),h=function(e,t,n){for(var i=0,r=e;i<r.length;i++){var o=r[i];n[t.register(o,!0)]=o}},f=function(e,t){for(var n=0,i=Object.keys(t);n<i.length;n++){var r=i[n];e.unregister(t[r],r,!0),delete t[r]}},g=function(e){var t=u.K.getInstance(),n=e.className,i=e.overflowItems,s=e.keytipSequences,a=e.itemSubMenuProvider,l=e.onRenderOverflowButton,c=(0,m.B)({}),d=o.useCallback((function(e){return a?a(e):e.subMenuProps?e.subMenuProps.items:void 0}),[a]),g=o.useMemo((function(){var e=[],n=[];return s?null==i||i.forEach((function(i){var o,a=i.keytipProps;if(a){var l={content:a.content,keySequences:a.keySequences,disabled:a.disabled||!(!i.disabled&&!i.isDisabled),hasDynamicChildren:a.hasDynamicChildren,hasMenu:a.hasMenu};a.hasDynamicChildren||d(i)?(l.onExecute=t.menuExecute.bind(t,s,null===(o=null==i?void 0:i.keytipProps)||void 0===o?void 0:o.keySequences),l.hasOverflowSubMenu=!0):l.onExecute=a.onExecute,e.push(l);var c=(0,r.__assign)((0,r.__assign)({},i),{keytipProps:(0,r.__assign)((0,r.__assign)({},a),{overflowSetSequence:s})});null==n||n.push(c)}else null==n||n.push(i)})):n=i,{modifiedOverflowItems:n,keytipsToRegister:e}}),[i,d,t,s]),v=g.modifiedOverflowItems;return function(e,t,n){var i=(0,p.D)(e);o.useEffect((function(){i&&(f(n,i),h(t,n,e))})),o.useEffect((function(){return h(t,n,e),function(){f(n,e)}}),[])}(c,g.keytipsToRegister,t),o.createElement("div",{className:n},l(v))},v=(0,a.y)(),y=o.forwardRef((function(e,t){var n=o.useRef(null),i=(0,s.r)(n,t);!function(e,t){o.useImperativeHandle(e.componentRef,(function(){return{focus:function(e,n){var i=!1;return t.current&&(i=(0,l.uo)(t.current,n)),i},focusElement:function(e){var n=!1;return!!e&&(t.current&&(0,c.t)(t.current,e)&&(e.focus(),n=document.activeElement===e),n)}}}),[t])}(e,n);var a=e.items,u=e.overflowItems,p=e.className,m=e.styles,h=e.vertical,f=e.role,y=e.overflowSide,S=void 0===y?"end":y,b=e.onRenderItem,I=v(m,{className:p,vertical:h}),w=!!u&&u.length>0;return o.createElement("div",(0,r.__assign)({},(0,d.pq)(e,d.n7),{role:f||"group","aria-orientation":"menubar"===f?!0===h?"vertical":"horizontal":void 0,className:I.root,ref:i}),"start"===S&&w&&o.createElement(g,(0,r.__assign)({},e,{className:I.overflowButton})),a&&a.map((function(e,t){return o.createElement("div",{className:I.item,key:e.key,role:"none"},b(e))})),"end"===S&&w&&o.createElement(g,(0,r.__assign)({},e,{className:I.overflowButton})))}));y.displayName="OverflowSet";var S={flexShrink:0,display:"inherit"},b=(0,i.z)(y,(function(e){var t=e.className;return{root:["ms-OverflowSet",{position:"relative",display:"flex",flexWrap:"nowrap"},e.vertical&&{flexDirection:"column"},t],item:["ms-OverflowSet-item",S],overflowButton:["ms-OverflowSet-overflowButton",S]}}),void 0,{scope:"OverflowSet"})},146465:(e,t,n)=>{"use strict";n.d(t,{I:()=>I});var i=n(268292),r=n(333940),o=n(989526),s=n(287130),a=n(898171),l=n(352633),c=n(981025),d=n(897079),u=n(309598),p=n(351198),m=n(940654),h=n(967318),f=(0,s.y)(),g={size:p.Ir.size48,presence:p.H_.none,imageAlt:"",showOverflowTooltip:!0};var v=o.forwardRef((function(e,t){var n=(0,a.j)(g,e),i=o.useRef(null),s=(0,m.r)(t,i),v=function(){return n.text||n.primaryText||""},y=function(e,t,i){var r=t&&t(n,i);return r?o.createElement("div",{dir:"auto",className:e},r):void 0},S=function(e,t){return void 0===t&&(t=!0),e?t?function(){return o.createElement(c.G,{content:e,overflowMode:d.y.Parent,directionalHint:h.b.topLeftEdge},e)}:function(){return o.createElement(o.Fragment,null,e)}:void 0},b=S(v(),n.showOverflowTooltip),I=S(n.secondaryText,n.showOverflowTooltip),w=S(n.tertiaryText,n.showOverflowTooltip),C=S(n.optionalText,n.showOverflowTooltip),E=n.hidePersonaDetails,P=n.onRenderOptionalText,T=void 0===P?C:P,R=n.onRenderPrimaryText,x=void 0===R?b:R,k=n.onRenderSecondaryText,N=void 0===k?I:k,A=n.onRenderTertiaryText,D=void 0===A?w:A,Z=n.onRenderPersonaCoin,M=void 0===Z?function(e){return o.createElement(u.t,(0,r.__assign)({},e))}:Z,O=n.size,F=n.allowPhoneInitials,_=n.className,L=n.coinProps,z=n.showUnknownPersonaCoin,B=n.coinSize,V=n.styles,U=n.imageAlt,q=n.imageInitials,W=n.imageShouldFadeIn,H=n.imageShouldStartVisible,j=n.imageUrl,G=n.initialsColor,K=n.initialsTextColor,X=n.isOutOfOffice,$=n.onPhotoLoadingStateChange,J=n.onRenderCoin,Q=n.onRenderInitials,Y=n.presence,ee=n.presenceTitle,te=n.presenceColors,ne=n.showInitialsUntilImageLoads,ie=n.showSecondaryText,re=n.theme,oe=(0,r.__assign)({allowPhoneInitials:F,showUnknownPersonaCoin:z,coinSize:B,imageAlt:U,imageInitials:q,imageShouldFadeIn:W,imageShouldStartVisible:H,imageUrl:j,initialsColor:G,initialsTextColor:K,onPhotoLoadingStateChange:$,onRenderCoin:J,onRenderInitials:Q,presence:Y,presenceTitle:ee,showInitialsUntilImageLoads:ne,size:O,text:v(),isOutOfOffice:X,presenceColors:te},L),se=f(V,{theme:re,className:_,showSecondaryText:ie,presence:Y,size:O}),ae=(0,l.pq)(n,l.n7),le=o.createElement("div",{className:se.details},y(se.primaryText,x,b),y(se.secondaryText,N,I),y(se.tertiaryText,D,w),y(se.optionalText,T,C),n.children);return o.createElement("div",(0,r.__assign)({},ae,{ref:s,className:se.root,style:B?{height:B,minWidth:B}:void 0}),M(oe,M),(!E||O===p.Ir.size8||O===p.Ir.size10||O===p.Ir.tiny)&&le)}));v.displayName="PersonaBase";var y=n(564229),S=n(317496),b={root:"ms-Persona",size8:"ms-Persona--size8",size10:"ms-Persona--size10",size16:"ms-Persona--size16",size24:"ms-Persona--size24",size28:"ms-Persona--size28",size32:"ms-Persona--size32",size40:"ms-Persona--size40",size48:"ms-Persona--size48",size56:"ms-Persona--size56",size72:"ms-Persona--size72",size100:"ms-Persona--size100",size120:"ms-Persona--size120",available:"ms-Persona--online",away:"ms-Persona--away",blocked:"ms-Persona--blocked",busy:"ms-Persona--busy",doNotDisturb:"ms-Persona--donotdisturb",offline:"ms-Persona--offline",details:"ms-Persona-details",primaryText:"ms-Persona-primaryText",secondaryText:"ms-Persona-secondaryText",tertiaryText:"ms-Persona-tertiaryText",optionalText:"ms-Persona-optionalText",textContent:"ms-Persona-textContent"},I=(0,i.z)(v,(function(e){var t=e.className,n=e.showSecondaryText,i=e.theme,r=i.semanticColors,o=i.fonts,s=(0,y.Cn)(b,i),a=(0,S.yR)(e.size),l=(0,S.zx)(e.presence),c="16px",d={color:r.bodySubtext,fontWeight:y.lq.regular,fontSize:o.small.fontSize};return{root:[s.root,i.fonts.medium,y.Fv,{color:r.bodyText,position:"relative",height:S.or.size48,minWidth:S.or.size48,display:"flex",alignItems:"center",selectors:{".contextualHost":{display:"none"}}},a.isSize8&&[s.size8,{height:S.or.size8,minWidth:S.or.size8}],a.isSize10&&[s.size10,{height:S.or.size10,minWidth:S.or.size10}],a.isSize16&&[s.size16,{height:S.or.size16,minWidth:S.or.size16}],a.isSize24&&[s.size24,{height:S.or.size24,minWidth:S.or.size24}],a.isSize24&&n&&{height:"36px"},a.isSize28&&[s.size28,{height:S.or.size28,minWidth:S.or.size28}],a.isSize28&&n&&{height:"32px"},a.isSize32&&[s.size32,{height:S.or.size32,minWidth:S.or.size32}],a.isSize40&&[s.size40,{height:S.or.size40,minWidth:S.or.size40}],a.isSize48&&s.size48,a.isSize56&&[s.size56,{height:S.or.size56,minWidth:S.or.size56}],a.isSize72&&[s.size72,{height:S.or.size72,minWidth:S.or.size72}],a.isSize100&&[s.size100,{height:S.or.size100,minWidth:S.or.size100}],a.isSize120&&[s.size120,{height:S.or.size120,minWidth:S.or.size120}],l.isAvailable&&s.available,l.isAway&&s.away,l.isBlocked&&s.blocked,l.isBusy&&s.busy,l.isDoNotDisturb&&s.doNotDisturb,l.isOffline&&s.offline,t],details:[s.details,{padding:"0 24px 0 16px",minWidth:0,width:"100%",textAlign:"left",display:"flex",flexDirection:"column",justifyContent:"space-around"},(a.isSize8||a.isSize10)&&{paddingLeft:17},(a.isSize24||a.isSize28||a.isSize32)&&{padding:"0 8px"},(a.isSize40||a.isSize48)&&{padding:"0 12px"}],primaryText:[s.primaryText,y.jq,{color:r.bodyText,fontWeight:y.lq.regular,fontSize:o.medium.fontSize,selectors:{":hover":{color:r.inputTextHovered}}},n&&{height:c,lineHeight:c,overflowX:"hidden"},(a.isSize8||a.isSize10)&&{fontSize:o.small.fontSize,lineHeight:S.or.size8},a.isSize16&&{lineHeight:S.or.size28},(a.isSize24||a.isSize28||a.isSize32||a.isSize40||a.isSize48)&&n&&{height:18},(a.isSize56||a.isSize72||a.isSize100||a.isSize120)&&{fontSize:o.xLarge.fontSize},(a.isSize56||a.isSize72||a.isSize100||a.isSize120)&&n&&{height:22}],secondaryText:[s.secondaryText,y.jq,d,(a.isSize8||a.isSize10||a.isSize16||a.isSize24||a.isSize28||a.isSize32)&&{display:"none"},n&&{display:"block",height:c,lineHeight:c,overflowX:"hidden"},a.isSize24&&n&&{height:18},(a.isSize56||a.isSize72||a.isSize100||a.isSize120)&&{fontSize:o.medium.fontSize},(a.isSize56||a.isSize72||a.isSize100||a.isSize120)&&n&&{height:18}],tertiaryText:[s.tertiaryText,y.jq,d,{display:"none",fontSize:o.medium.fontSize},(a.isSize72||a.isSize100||a.isSize120)&&{display:"block"}],optionalText:[s.optionalText,y.jq,d,{display:"none",fontSize:o.medium.fontSize},(a.isSize100||a.isSize120)&&{display:"block"}],textContent:[s.textContent,y.jq]}}),void 0,{scope:"Persona"})},351198:(e,t,n)=>{"use strict";var i,r,o;n.d(t,{Ir:()=>i,H_:()=>r,z5:()=>o}),function(e){e[e.tiny=0]="tiny",e[e.extraExtraSmall=1]="extraExtraSmall",e[e.extraSmall=2]="extraSmall",e[e.small=3]="small",e[e.regular=4]="regular",e[e.large=5]="large",e[e.extraLarge=6]="extraLarge",e[e.size8=17]="size8",e[e.size10=9]="size10",e[e.size16=8]="size16",e[e.size24=10]="size24",e[e.size28=7]="size28",e[e.size32=11]="size32",e[e.size40=12]="size40",e[e.size48=13]="size48",e[e.size56=16]="size56",e[e.size72=14]="size72",e[e.size100=15]="size100",e[e.size120=18]="size120"}(i||(i={})),function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy"}(r||(r={})),function(e){e[e.lightBlue=0]="lightBlue",e[e.blue=1]="blue",e[e.darkBlue=2]="darkBlue",e[e.teal=3]="teal",e[e.lightGreen=4]="lightGreen",e[e.green=5]="green",e[e.darkGreen=6]="darkGreen",e[e.lightPink=7]="lightPink",e[e.pink=8]="pink",e[e.magenta=9]="magenta",e[e.purple=10]="purple",e[e.black=11]="black",e[e.orange=12]="orange",e[e.red=13]="red",e[e.darkRed=14]="darkRed",e[e.transparent=15]="transparent",e[e.violet=16]="violet",e[e.lightRed=17]="lightRed",e[e.gold=18]="gold",e[e.burgundy=19]="burgundy",e[e.warmGray=20]="warmGray",e[e.coolGray=21]="coolGray",e[e.gray=22]="gray",e[e.cyan=23]="cyan",e[e.rust=24]="rust"}(o||(o={}))},911061:(e,t,n)=>{"use strict";n.d(t,{x_:()=>m,CJ:()=>S});var i,r=n(333940),o=n(989526),s=n(352633);!function(e){e[e.horizontal=0]="horizontal",e[e.vertical=1]="vertical"}(i||(i={}));var a=n(180955),l=n(654470),c=n(380847),d=n(940654),u=n(287382),p=function(e){var t;void 0===e&&(t={},e={getCachedMeasurement:function(e){if(e&&e.cacheKey&&t.hasOwnProperty(e.cacheKey))return t[e.cacheKey]},addMeasurementToCache:function(e,n){e.cacheKey&&(t[e.cacheKey]=n)}});var n,i=e;function o(e,t){var n=i.getCachedMeasurement(e);if(void 0!==n)return n;var r=t();return i.addMeasurementToCache(e,r),r}function s(e,t,r){for(var s=e,a=o(e,r);a>n;){var l=t(s);if(void 0===l)return{renderedData:s,resizeDirection:void 0,dataToMeasure:void 0};if(void 0===(a=i.getCachedMeasurement(l)))return{dataToMeasure:l,resizeDirection:"shrink"};s=l}return{renderedData:s,resizeDirection:void 0,dataToMeasure:void 0}}return{getNextState:function(e,t,a,l){if(void 0!==l||void 0!==t.dataToMeasure){if(l){if(n&&t.renderedData&&!t.dataToMeasure)return(0,r.__assign)((0,r.__assign)({},t),function(e,t,i,o){var s;return s=e>n?o?{resizeDirection:"grow",dataToMeasure:o(i)}:{resizeDirection:"shrink",dataToMeasure:t}:{resizeDirection:"shrink",dataToMeasure:i},n=e,(0,r.__assign)((0,r.__assign)({},s),{measureContainer:!1})}(l,e.data,t.renderedData,e.onGrowData));n=l}var c=(0,r.__assign)((0,r.__assign)({},t),{measureContainer:!1});return t.dataToMeasure&&(c="grow"===t.resizeDirection&&e.onGrowData?(0,r.__assign)((0,r.__assign)({},c),function(e,t,a,l){for(var c=e,d=o(e,a);d<n;){var u=t(c);if(void 0===u)return{renderedData:c,resizeDirection:void 0,dataToMeasure:void 0};if(void 0===(d=i.getCachedMeasurement(u)))return{dataToMeasure:u};c=u}return(0,r.__assign)({resizeDirection:"shrink"},s(c,l,a))}(t.dataToMeasure,e.onGrowData,a,e.onReduceData)):(0,r.__assign)((0,r.__assign)({},c),s(t.dataToMeasure,e.onReduceData,a))),c}},shouldRenderDataForMeasurement:function(e){return!(!e||void 0!==i.getCachedMeasurement(e))},getInitialResizeGroupState:function(e){return{dataToMeasure:(0,r.__assign)({},e),resizeDirection:"grow",measureContainer:!0}}}},m=o.createContext({isMeasured:!1}),h={position:"fixed",visibility:"hidden"},f={position:"relative"};function g(e,t){var n;switch(t.type){case"resizeData":return(0,r.__assign)({},t.value);case"dataToMeasure":return(0,r.__assign)((0,r.__assign)({},e),{dataToMeasure:t.value,resizeDirection:"grow",measureContainer:!0});default:return(0,r.__assign)((0,r.__assign)({},e),((n={})[t.type]=t.value,n))}}function v(e,t){var n=(0,a.B)(p),s=o.useRef(null),d=o.useRef(null),m=o.useRef(!1),h=(0,l.r)(),f=function(e,t,n){var i=(0,a.B)((function(){return t.getInitialResizeGroupState(e.data)})),s=o.useReducer(g,i),l=s[0],c=s[1];o.useEffect((function(){c({type:"dataToMeasure",value:e.data})}),[e.data]);var d=o.useRef(i);return d.current=(0,r.__assign)({},l),[d,o.useCallback((function(e){e&&c({type:"resizeData",value:e})}),[]),o.useCallback((function(){n.current&&c({type:"measureContainer",value:!0})}),[n])]}(e,n,t),v=f[0],y=f[1],S=f[2];o.useEffect((function(){var t;v.current.renderedData&&(m.current=!0,null===(t=e.dataDidRender)||void 0===t||t.call(e,v.current.renderedData))})),o.useEffect((function(){h.requestAnimationFrame((function(){var r=void 0;if(v.current.measureContainer&&t.current){var o=t.current.getBoundingClientRect();r=e.direction===i.vertical?o.height:o.width}var a=n.getNextState(e,v.current,(function(){var t=m.current?d:s;if(!t.current)return 0;var n=t.current.getBoundingClientRect();return e.direction===i.vertical?n.height:n.width}),r);y(a)}),t.current)}));var b=(0,u.zY)();(0,c.d)(b,"resize",h.debounce(S,16,{leading:!0}));var I=n.shouldRenderDataForMeasurement(v.current.dataToMeasure),w=!m.current&&I;return[v.current.dataToMeasure,v.current.renderedData,S,s,d,I,w]}var y={isMeasured:!0},S=o.forwardRef((function(e,t){var n=o.useRef(null),i=(0,d.r)(n,t),a=v(e,n),l=a[0],c=a[1],u=a[2],p=a[3],g=a[4],S=a[5],b=a[6];o.useImperativeHandle(e.componentRef,(function(){return{remeasure:u}}),[u]);var I=e.className,w=e.onRenderData,C=(0,s.pq)(e,s.n7,["data"]);return o.createElement("div",(0,r.__assign)({},C,{className:I,ref:i}),o.createElement("div",{style:f},S&&!b&&o.createElement("div",{style:h,ref:g},o.createElement(m.Provider,{value:y},w(l))),o.createElement("div",{ref:p,style:b?h:void 0,"data-automation-id":"visibleContent"},b?w(l):c&&w(c))))}));S.displayName="ResizeGroupBase"},474758:(e,t,n)=>{"use strict";n.d(t,{N:()=>i});var i=n(911061).CJ},102163:(e,t,n)=>{"use strict";n.d(t,{n:()=>c});var i=n(268292),r=n(862600),o=n(333940),s=n(564229),a={root:"ms-TextField",description:"ms-TextField-description",errorMessage:"ms-TextField-errorMessage",field:"ms-TextField-field",fieldGroup:"ms-TextField-fieldGroup",prefix:"ms-TextField-prefix",suffix:"ms-TextField-suffix",wrapper:"ms-TextField-wrapper",revealButton:"ms-TextField-reveal",multiline:"ms-TextField--multiline",borderless:"ms-TextField--borderless",underlined:"ms-TextField--underlined",unresizable:"ms-TextField--unresizable",required:"is-required",disabled:"is-disabled",active:"is-active"};function l(e){var t=e.underlined,n=e.disabled,i=e.focused,r=e.theme,o=r.palette,a=r.fonts;return function(){var e;return{root:[t&&n&&{color:o.neutralTertiary},t&&{fontSize:a.medium.fontSize,marginRight:8,paddingLeft:12,paddingRight:0,lineHeight:"22px",height:32},t&&i&&{selectors:(e={},e[s.qJ]={height:31},e)}]}}}var c=(0,i.z)(r.P,(function(e){var t,n,i,r,c,d,u,p,m,h,f,g,v=e.theme,y=e.className,S=e.disabled,b=e.focused,I=e.required,w=e.multiline,C=e.hasLabel,E=e.borderless,P=e.underlined,T=e.hasIcon,R=e.resizable,x=e.hasErrorMessage,k=e.inputClassName,N=e.autoAdjustHeight,A=e.hasRevealButton,D=v.semanticColors,Z=v.effects,M=v.fonts,O=(0,s.Cn)(a,v),F={background:D.disabledBackground,color:S?D.disabledText:D.inputPlaceholderText,display:"flex",alignItems:"center",padding:"0 10px",lineHeight:1,whiteSpace:"nowrap",flexShrink:0,selectors:(t={},t[s.qJ]={background:"Window",color:S?"GrayText":"WindowText"},t)},_=[{color:D.inputPlaceholderText,opacity:1,selectors:(n={},n[s.qJ]={color:"GrayText"},n)}],L={color:D.disabledText,selectors:(i={},i[s.qJ]={color:"GrayText"},i)};return{root:[O.root,M.medium,I&&O.required,S&&O.disabled,b&&O.active,w&&O.multiline,E&&O.borderless,P&&O.underlined,s.Fv,{position:"relative"},y],wrapper:[O.wrapper,P&&[{display:"flex",borderBottom:"1px solid "+(x?D.errorText:D.inputBorder),width:"100%"},S&&{borderBottomColor:D.disabledBackground,selectors:(r={},r[s.qJ]=(0,o.__assign)({borderColor:"GrayText"},(0,s.xM)()),r)},!S&&{selectors:{":hover":{borderBottomColor:x?D.errorText:D.inputBorderHovered,selectors:(c={},c[s.qJ]=(0,o.__assign)({borderBottomColor:"Highlight"},(0,s.xM)()),c)}}},b&&[{position:"relative"},(0,s.$Y)(x?D.errorText:D.inputFocusBorderAlt,0,"borderBottom")]]],fieldGroup:[O.fieldGroup,s.Fv,{border:"1px solid "+D.inputBorder,borderRadius:Z.roundedCorner2,background:D.inputBackground,cursor:"text",height:32,display:"flex",flexDirection:"row",alignItems:"stretch",position:"relative"},w&&{minHeight:"60px",height:"auto",display:"flex"},!b&&!S&&{selectors:{":hover":{borderColor:D.inputBorderHovered,selectors:(d={},d[s.qJ]=(0,o.__assign)({borderColor:"Highlight"},(0,s.xM)()),d)}}},b&&!P&&(0,s.$Y)(x?D.errorText:D.inputFocusBorderAlt,Z.roundedCorner2),S&&{borderColor:D.disabledBackground,selectors:(u={},u[s.qJ]=(0,o.__assign)({borderColor:"GrayText"},(0,s.xM)()),u),cursor:"default"},E&&{border:"none"},E&&b&&{border:"none",selectors:{":after":{border:"none"}}},P&&{flex:"1 1 0px",border:"none",textAlign:"left"},P&&S&&{backgroundColor:"transparent"},x&&!P&&{borderColor:D.errorText,selectors:{"&:hover":{borderColor:D.errorText}}},!C&&I&&{selectors:(p={":before":{content:"'*'",color:D.errorText,position:"absolute",top:-5,right:-10}},p[s.qJ]={selectors:{":before":{color:"WindowText",right:-14}}},p)}],field:[M.medium,O.field,s.Fv,{borderRadius:0,border:"none",background:"none",backgroundColor:"transparent",color:D.inputText,padding:"0 8px",width:"100%",minWidth:0,textOverflow:"ellipsis",outline:0,selectors:(m={"&:active, &:focus, &:hover":{outline:0},"::-ms-clear":{display:"none"}},m[s.qJ]={background:"Window",color:S?"GrayText":"WindowText"},m)},(0,s.Sv)(_),w&&!R&&[O.unresizable,{resize:"none"}],w&&{minHeight:"inherit",lineHeight:17,flexGrow:1,paddingTop:6,paddingBottom:6,overflow:"auto",width:"100%"},w&&N&&{overflow:"hidden"},T&&!A&&{paddingRight:24},w&&T&&{paddingRight:40},S&&[{backgroundColor:D.disabledBackground,color:D.disabledText,borderColor:D.disabledBackground},(0,s.Sv)(L)],P&&{textAlign:"left"},b&&!E&&{selectors:(h={},h[s.qJ]={paddingLeft:11,paddingRight:11},h)},b&&w&&!E&&{selectors:(f={},f[s.qJ]={paddingTop:4},f)},k],icon:[w&&{paddingRight:24,alignItems:"flex-end"},{pointerEvents:"none",position:"absolute",bottom:6,right:8,top:"auto",fontSize:s.ld.medium,lineHeight:18},S&&{color:D.disabledText}],description:[O.description,{color:D.bodySubtext,fontSize:M.xSmall.fontSize}],errorMessage:[O.errorMessage,s.k4.slideDownIn20,M.small,{color:D.errorText,margin:0,paddingTop:5,display:"flex",alignItems:"center"}],prefix:[O.prefix,F],suffix:[O.suffix,F],revealButton:[O.revealButton,"ms-Button","ms-Button--icon",(0,s.GL)(v,{inset:1}),{height:30,width:32,border:"none",padding:"0px 4px",backgroundColor:"transparent",color:D.link,selectors:{":hover":{outline:0,color:D.primaryButtonBackgroundHovered,backgroundColor:D.buttonBackgroundHovered,selectors:(g={},g[s.qJ]={borderColor:"Highlight",color:"Highlight"},g)},":focus":{outline:0}}},T&&{marginRight:28}],revealSpan:{display:"flex",height:"100%",alignItems:"center"},revealIcon:{margin:"0px 4px",pointerEvents:"none",bottom:6,right:8,top:"auto",fontSize:s.ld.medium,lineHeight:18},subComponentStyles:{label:l(e)}}}),void 0,{scope:"TextField"})},874031:(e,t,n)=>{"use strict";n.d(t,{u:()=>m});var i=n(268292),r=n(333940),o=n(989526),s=n(287130),a=n(352633),l=n(16025),c=n(967318),d=(0,s.y)(),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRenderContent=function(e){return"string"==typeof e.content?o.createElement("p",{className:t._classNames.subText},e.content):o.createElement("div",{className:t._classNames.subText},e.content)},t}return(0,r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.calloutProps,i=e.directionalHint,s=e.directionalHintForRTL,c=e.styles,u=e.id,p=e.maxWidth,m=e.onRenderContent,h=void 0===m?this._onRenderContent:m,f=e.targetElement,g=e.theme;return this._classNames=d(c,{theme:g,className:t||n&&n.className,beakWidth:n&&n.beakWidth,gapSpace:n&&n.gapSpace,maxWidth:p}),o.createElement(l.U,(0,r.__assign)({target:f,directionalHint:i,directionalHintForRTL:s},n,(0,a.pq)(this.props,a.n7,["id"]),{className:this._classNames.root}),o.createElement("div",{className:this._classNames.content,id:u,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},h(this.props,this._onRenderContent)))},t.defaultProps={directionalHint:c.b.topCenter,maxWidth:"364px",calloutProps:{isBeakVisible:!0,beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1}},t}(o.Component),p=n(564229),m=(0,i.z)(u,(function(e){var t=e.className,n=e.beakWidth,i=void 0===n?16:n,r=e.gapSpace,o=void 0===r?0:r,s=e.maxWidth,a=e.theme,l=a.semanticColors,c=a.fonts,d=a.effects,u=-(Math.sqrt(i*i/2)+o)+1/window.devicePixelRatio;return{root:["ms-Tooltip",a.fonts.medium,p.k4.fadeIn200,{background:l.menuBackground,boxShadow:d.elevation8,padding:"8px",maxWidth:s,selectors:{":after":{content:"''",position:"absolute",bottom:u,left:u,right:u,top:u,zIndex:0}}},t],content:["ms-Tooltip-content",c.small,{position:"relative",zIndex:1,color:l.menuItemText,wordWrap:"break-word",overflowWrap:"break-word",overflow:"hidden"}],subText:["ms-Tooltip-subtext",{fontSize:"inherit",fontWeight:"inherit",color:"inherit",margin:0}]}}),void 0,{scope:"Tooltip"})},627051:(e,t,n)=>{"use strict";var i;n.d(t,{j:()=>i}),function(e){e[e.zero=0]="zero",e[e.medium=1]="medium",e[e.long=2]="long"}(i||(i={}))},981025:(e,t,n)=>{"use strict";n.d(t,{G:()=>w});var i=n(268292),r=n(333940),o=n(989526),s=n(564229),a=n(287130),l=n(364782),c=n(797794),d=n(728475),u=n(440655),p=n(321929),m=n(473430),h=n(726446),f=n(352633),g=n(897079),v=n(874031),y=n(627051),S=(0,a.y)(),b=function(e){function t(n){var i=e.call(this,n)||this;return i._tooltipHost=o.createRef(),i._defaultTooltipId=(0,l.z)("tooltip"),i.show=function(){i._toggleTooltip(!0)},i.dismiss=function(){i._hideTooltip()},i._getTargetElement=function(){if(i._tooltipHost.current){var e=i.props.overflowMode;if(void 0!==e)switch(e){case g.y.Parent:return i._tooltipHost.current.parentElement;case g.y.Self:return i._tooltipHost.current}return i._tooltipHost.current}},i._onTooltipFocus=function(e){i._ignoreNextFocusEvent?i._ignoreNextFocusEvent=!1:i._onTooltipMouseEnter(e)},i._onTooltipBlur=function(e){i._ignoreNextFocusEvent=(null===document||void 0===document?void 0:document.activeElement)===e.target,i._hideTooltip()},i._onTooltipMouseEnter=function(e){var n=i.props,r=n.overflowMode,o=n.delay;if(t._currentVisibleTooltip&&t._currentVisibleTooltip!==i&&t._currentVisibleTooltip.dismiss(),t._currentVisibleTooltip=i,void 0!==r){var s=i._getTargetElement();if(s&&!(0,c.zS)(s))return}if(!e.target||!(0,d.w)(e.target,i._getTargetElement()))if(i._clearDismissTimer(),i._clearOpenTimer(),o!==y.j.zero){var a=i._getDelayTime(o);i._openTimerId=i._async.setTimeout((function(){i._toggleTooltip(!0)}),a)}else i._toggleTooltip(!0)},i._onTooltipMouseLeave=function(e){var n=i.props.closeDelay;i._clearDismissTimer(),i._clearOpenTimer(),n?i._dismissTimerId=i._async.setTimeout((function(){i._toggleTooltip(!1)}),n):i._toggleTooltip(!1),t._currentVisibleTooltip===i&&(t._currentVisibleTooltip=void 0)},i._onTooltipKeyDown=function(e){(e.which===u.m.escape||e.ctrlKey)&&i.state.isTooltipVisible&&(i._hideTooltip(),e.stopPropagation())},i._clearDismissTimer=function(){i._async.clearTimeout(i._dismissTimerId)},i._clearOpenTimer=function(){i._async.clearTimeout(i._openTimerId)},i._hideTooltip=function(){i._clearOpenTimer(),i._clearDismissTimer(),i._toggleTooltip(!1)},i._toggleTooltip=function(e){i.state.isTooltipVisible!==e&&i.setState({isTooltipVisible:e},(function(){return i.props.onTooltipToggle&&i.props.onTooltipToggle(e)}))},i._getDelayTime=function(e){switch(e){case y.j.medium:return 300;case y.j.long:return 500;default:return 0}},(0,p.l)(i),i.state={isAriaPlaceholderRendered:!1,isTooltipVisible:!1},i._async=new m.e(i),i}return(0,r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.calloutProps,n=e.children,i=e.content,a=e.directionalHint,l=e.directionalHintForRTL,c=e.hostClassName,d=e.id,u=e.setAriaDescribedBy,p=void 0===u||u,m=e.tooltipProps,g=e.styles,y=e.theme;this._classNames=S(g,{theme:y,className:c});var b=this.state.isTooltipVisible,I=d||this._defaultTooltipId,w=(null==m?void 0:m.onRenderContent)?m.onRenderContent():i,C=b&&!!w,E=p&&b&&w?I:void 0;return o.createElement("div",(0,r.__assign)({className:this._classNames.root,ref:this._tooltipHost},{onFocusCapture:this._onTooltipFocus},{onBlurCapture:this._onTooltipBlur},{onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave,onKeyDown:this._onTooltipKeyDown,role:"none","aria-describedby":E}),n,C&&o.createElement(v.u,(0,r.__assign)({id:I+"--tooltip",content:i,targetElement:this._getTargetElement(),directionalHint:a,directionalHintForRTL:l,calloutProps:(0,h.f0)({},t,{onDismiss:this._hideTooltip,onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave}),onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave},(0,f.pq)(this.props,f.n7,["id"]),m)),o.createElement("div",{hidden:!0,id:I,style:s.ul},w))},t.prototype.componentWillUnmount=function(){t._currentVisibleTooltip&&t._currentVisibleTooltip===this&&(t._currentVisibleTooltip=void 0),this._async.dispose()},t.defaultProps={delay:y.j.medium},t}(o.Component),I={root:"ms-TooltipHost",ariaPlaceholder:"ms-TooltipHost-aria-placeholder"},w=(0,i.z)(b,(function(e){var t=e.className,n=e.theme;return{root:[(0,s.Cn)(I,n).root,{display:"inline"},t]}}),void 0,{scope:"TooltipHost"})},897079:(e,t,n)=>{"use strict";var i;n.d(t,{y:()=>i}),function(e){e[e.Parent=0]="Parent",e[e.Self=1]="Self"}(i||(i={}))},554146:e=>{"use strict";function t(){var e=Object.create(null),t=0,n=0,i=0,r=!1;function o(t){i--,delete e[t]}this.put=function(t,n,r,s){if(void 0!==r&&("number"!=typeof r||isNaN(r)||r<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==s&&"function"!=typeof s)throw new Error("Cache timeout callback must be a function");var a=e[t];a?clearTimeout(a.timeout):i++;var l={value:n,expire:r+Date.now()};return isNaN(l.expire)||(l.timeout=setTimeout(function(){o(t),s&&s(t,n)}.bind(this),r)),e[t]=l,n},this.del=function(t){var n=!0,i=e[t];return i?(clearTimeout(i.timeout),!isNaN(i.expire)&&i.expire<Date.now()&&(n=!1)):n=!1,n&&o(t),n},this.clear=function(){for(var o in e)clearTimeout(e[o].timeout);i=0,e=Object.create(null),r&&(t=0,n=0)},this.get=function(o){var s=e[o];if(void 0!==s){if(isNaN(s.expire)||s.expire>=Date.now())return r&&t++,s.value;r&&n++,i--,delete e[o]}else r&&n++;return null},this.size=function(){return i},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){r=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var i=e[n];t[n]={value:i.value,expire:i.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var i=JSON.parse(t),r=Date.now(),o=n&&n.skipDuplicates;for(var s in i)if(i.hasOwnProperty(s)){if(o)if(e[s])continue;var a=i[s],l=a.expire-r;if(l<=0){this.del(s);continue}l=l>0?l:void 0,this.put(s,a.value,l)}return this.size()}}e.exports=new t,e.exports.Cache=t},546079:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return"._Entity"+(e?"._EType_"+e:"")+(t?"._EId_"+t:"")}},522343:(e,t)=>{"use strict";function n(e){var t=e&&(e.ownerDocument||("[object HTMLDocument]"==Object.prototype.toString.apply(e)?e:null));return t&&(t.defaultView||window)}Object.defineProperty(t,"__esModule",{value:!0}),t.getTargetWindow=void 0,t.getTargetWindow=n,t.default=function(e,t){var i;if("Range"==t)return"[object Range]"==Object.prototype.toString.apply(e)&&!!(null===(i=e)||void 0===i?void 0:i.commonAncestorContainer);var r=n(e),o=r&&r[t],s=window,a=s&&s[t];return a&&e instanceof a||o&&e instanceof o}},769295:(e,t,n)=>{"use strict";n.d(t,{P8:()=>y.P8,MS:()=>g.Z,Xt:()=>f.Z,yZ:()=>S.Z,Xv:()=>E.X,_i:()=>b._,Tx:()=>m.Z,k4:()=>I.Z,RT:()=>c.R,lF:()=>l.Z,yC:()=>s.yC,vC:()=>o,aT:()=>d.Z,uP:()=>v.uP,$4:()=>a.$4,eg:()=>h.eg,j5:()=>C.j,_G:()=>a._G,gP:()=>w.g,HE:()=>P.H,Fv:()=>p.Fv,jI:()=>s.jI,zE:()=>s.zE,Bj:()=>s.Bj,_j:()=>s._j,jT:()=>s.jT,Cp:()=>s.Cp,op:()=>s.op,LO:()=>s.LO,n2:()=>s.n2,Xl:()=>s.Xl,zM:()=>s.zM,Tv:()=>s.Tv,Z7:()=>s.Z7,rt:()=>s.rt,KZ:()=>s.KZ,OM:()=>s.OM,xy:()=>s.xy,Vf:()=>s.Vf,N_:()=>s.N_,M:()=>s.M,r3:()=>s.r3,WZ:()=>s.WZ,rJ:()=>s.rJ,XO:()=>s.XO,EB:()=>s.EB,eK:()=>s.eK,u5:()=>s.u5,SR:()=>s.SR,$5:()=>s.$5,Ay:()=>s.Ay,Mh:()=>s.Mh,c6:()=>s.c6,R0:()=>s.R0,GQ:()=>u.Z,ph:()=>i.ZP,sY:()=>r.Z,K_:()=>T.Z});var i=n(939816),r=n(822228);const o=(0,n(371134).lr)("appendOnSendAction",((e,t)=>{const n=e.appendOnSend;if(!n)return;let i=!1;for(let r=0;r<n.length;r++)if(n[r].id===t.id){e.appendOnSend[r]=t,i=!0;break}i||e.appendOnSend.push(t)}));var s=n(301198),a=n(571721),l=n(520085),c=n(154517),d=n(577603),u=n(86725),p=n(485853),m=n(300659),h=n(656745),f=n(951023),g=n(265176),v=n(560725),y=n(812158),S=n(225647),b=n(308913),I=n(286973),w=n(680520),C=n(179383),E=n(974439),P=n(120684),T=n(724375)},301198:(e,t,n)=>{"use strict";n.d(t,{rJ:()=>o,c6:()=>s,_j:()=>a,u5:()=>l,Ay:()=>c,Mh:()=>d,$5:()=>u,SR:()=>p,Cp:()=>m,n2:()=>h,zX:()=>f,N_:()=>g,R0:()=>v,XO:()=>y,Z7:()=>S,eK:()=>b,yC:()=>I,Vf:()=>w,WZ:()=>C,zM:()=>E,jI:()=>P,M:()=>T,zE:()=>R,Bj:()=>x,KZ:()=>k,Xl:()=>N,r3:()=>A,rt:()=>D,OM:()=>Z,jT:()=>M,EB:()=>O,LO:()=>F,op:()=>_,xy:()=>L,Tv:()=>z});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(25671),n.e(3918),n.e(52637),n.e(32557),n.e(18838),n.e(19280),n.e(33615),n.e(17483),n.e(56337),n.e(75482),n.e(69390),n.e(11102),n.e(9598),n.e(42106),n.e(56841),n.e(9152),n.e(90885),n.e(3128),n.e(91992),n.e(71723)]).then(n.bind(n,12851)))),o=new i.EF(r,(e=>e.removeExtensibilityNotification)),s=new i.EF(r,(e=>e.updatePersistentNotifications)),a=new i.EF(r,(e=>e.closeTaskPaneAddinCommand)),l=new i.EF(r,(e=>e.triggerAppointmentTimeChangedEvent)),c=new i.EF(r,(e=>e.triggerRecipientsChangedEvent)),d=new i.EF(r,(e=>e.triggerRecurrenceChangedEvent)),u=new i.EF(r,(e=>e.triggerLocationsChangedEvent)),p=new i.EF(r,(e=>e.triggerAttachmentsChangedEvent)),m=new i.EF(r,(e=>e.deinitializeAddinsForItem)),h=new i.EF(r,(e=>e.initializeAddinsForItem)),f=new i._5(r,(e=>e.initializeExtensibilityContext)),g=new i.EF(r,(e=>e.onHostItemChanged)),v=new i.EF(r,(e=>e.whenItemHasContextualAddinKeywords)),y=new i.EF(r,(e=>e.runContextualEvaluationAndUpdate)),S=new i.EF(r,(e=>e.launchTranslateCommand)),b=new i.EF(r,(e=>e.shouldForceOnSendCompliantBehavior)),I=((0,i.$y)(r,(e=>e.AddinBarView)),(0,i.$y)(r,(e=>e.TaskPaneCollection))),w=new i.EF(r,(e=>e.onComposeClose)),C=new i.EF(r,(e=>e.openContextualCallout)),E=new i.EF(r,(e=>e.launchAddinCommand)),P=new i.EF(r,(e=>e.observeAddinCommandSurfaceItems)),T=new i._5(r,(e=>e.onItemNavigation)),R=new i.EF(r,(e=>e.allowItemSendAndBlockOnSendAddinEvents)),x=new i.EF(r,(e=>e.allowItemSendEvent)),k=new i.EF(r,(e=>e.logContextualNudgeData)),N=new i._5(r,(e=>e.ExecuteEntryPoint)),A=new i._5(r,(e=>e.onLaunchEventTriggered)),D=new i._5(r,(e=>e.logAppTeachingUICalloutTelemetry)),Z=new i._5(r,(e=>e.logCustomizeActionButtonAction)),M=new i.EF(r,(e=>e.convertRecurrenceToAddinFormat)),O=new i.EF(r,(e=>e.seriesTimeJsonConverter)),F=new i._5(r,(e=>e.highlightOverflowAddins)),_=new i._5(r,(e=>e.highlightCustomizeActionButton)),L=new i._5(r,(e=>e.logUpdatedAppPinningStatus)),z=new i._5(r,(e=>e.launchThirdPartyOnlineMeetingProviderAddin))},571286:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).lr)("updateLastFocusedControl",((e,t)=>{e.lastFocusedControl=t}))},6553:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).lr)("updateSubjectSelectionRange",((e,t,n)=>{e.selectionStart=t,e.selectionEnd=n}))},974439:(e,t,n)=>{"use strict";var i;n.d(t,{X:()=>i}),function(e){e.WithCustomizeActionButton="WithCustomizeActionButton",e.WithoutCustomizeActionButton="WithoutCustomizeActionButton",e.WaterDropCallout="WaterDropCallout"}(i||(i={}))},822228:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(38017),r=n(514743);var o=n(217915),s=n(552542);function a(){const e=null!=(0,r.Z)().Context,t=(0,i.Z)(),n=(0,s.Z)().SegmentationSettings.OnSendAddinsEnabled;return e&&t?n&&(0,o.Z)(1).length>0:n}},514743:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(177659);function r(){return i.Z}},179383:(e,t,n)=>{"use strict";n.d(t,{j:()=>r});var i=n(177659);function r(e){const t=i.Z.Context;for(const n of t.Extensions)if(n.Id.toLowerCase()===e.toLowerCase())return n;return null}},680520:(e,t,n)=>{"use strict";n.d(t,{g:()=>o});var i=n(177659),r=n(364913);function o(e){switch(e){case r.a.MessageRead:return i.Z.mailReadSurfaceNewAddinId;case r.a.MessageCompose:return i.Z.mailComposeSurfaceNewAddinId;case r.a.AppointmentOrganizer:case r.a.AppointmentAttendee:return i.Z.calendarSurfaceNewAddinId;default:return""}}},175248:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(918822);function r(e){const t=(0,i.Z)(e);return t?t.tabId:e===window?"Main":null}},38017:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(514743);function r(){const e=(0,i.Z)().EnabledAddinCommands;return!!e&&e.isInitialized}},330613:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(364913),r=n(573360);const o=class{constructor(e,t,n,i){this.event=e,this.control=t,this.extension=n,this.mode=i}getLaunchEventType(){return this.event}getControl(){return this.control}getControlId(){if((0,r.Z)(this.extension)){return this.control.id}return this.control.Id}get_EntryPoint(){var e,t;if((0,r.Z)(this.extension)){return this.control.Action.sourceLocation}{const n=this.extension;return this.mode===i.a.LaunchEvent?null===(t=null===(e=null==n?void 0:n.ExtensionPointCollection)||void 0===e?void 0:e.LaunchEvent)||void 0===t?void 0:t.SourceLocation:null}}get_IconUrl(){if((0,r.Z)(this.extension)){return this.extension.titleDefinition.iconSmall.uri}return this.extension.IconUrl}get_Label(){const e=this.control,t=this.control;return t.Label?t.Label:e.label}get_Id(){if((0,r.Z)(this.extension)){return this.extension.titleId}return this.extension.Id}get_OriginString(){return this.extension.OriginString}get_ExtensionId(){if((0,r.Z)(this.extension)){return this.extension.titleId}return this.extension.Id}get_MarketPlaceAssetId(){if((0,r.Z)(this.extension))return"null";return this.extension.MarketplaceAssetID}get_TypeString(){return this.extension.TypeString?this.extension.TypeString:"null"}get_ProviderName(){if((0,r.Z)(this.extension)){return this.extension.titleDefinition.developerName}return this.extension.ProviderName}get_ConsentMetaData(){if((0,r.Z)(this.extension))return null;return this.extension.ConsentMetadata}get_MarketPlaceContentMarket(){if((0,r.Z)(this.extension))return"null";return this.extension.MarketplaceContentMarket}get_WebApplicationResource(){if((0,r.Z)(this.extension)){return this.extension.titleDefinition.webApplicationInfo.resource}return this.extension.WebApplicationResource}get_ExtensionPointCollection(){if((0,r.Z)(this.extension))return null;return this.extension.ExtensionPointCollection}get_ExtensionDisplayName(){if((0,r.Z)(this.extension)){return this.extension.titleDefinition.name}return this.extension.DisplayName}get_Size16Icon(){var e;if((0,r.Z)(this.extension)){const t=this.control;if((null==t?void 0:t.icons)&&(null===(e=null==t?void 0:t.icons[0])||void 0===e?void 0:e.file))return t.icons[0].file}else{const e=this.control;if(null==e?void 0:e.Icon)return e.Icon.Size16Url}return null}get_ExtendedPermissions(){var e,t,n,i,o,s;if((0,r.Z)(this.extension)){const r=this.extension,a=(null===(n=null===(t=null===(e=r.titleDefinition)||void 0===e?void 0:e.authorization)||void 0===t?void 0:t.permissions)||void 0===n?void 0:n.resourceSpecific)?null===(s=null===(o=null===(i=r.titleDefinition)||void 0===i?void 0:i.authorization)||void 0===o?void 0:o.permissions)||void 0===s?void 0:s.resourceSpecific:[];for(let e=0;e<(null==a?void 0:a.length);e++)if("Mailbox.AppendOnSend"==a[e].name&&"Delegated"==a[e].type)return["AppendOnSend"];return[]}{const e=this.extension;return null==e?void 0:e.ExtendedPermissions}}get_AppStatus(){if((0,r.Z)(this.extension))return null;return this.extension.AppStatus}get_LicenseType(){if((0,r.Z)(this.extension))return null;return this.extension.LicenseType}get_Settings(){var e;return null===(e=this.extension)||void 0===e?void 0:e.Settings}get_Version(){if((0,r.Z)(this.extension)){return this.extension.titleDefinition.version}return this.extension.Version}get_AppDomains(){if((0,r.Z)(this.extension)){return this.extension.titleDefinition.validDomains}return this.extension.AppDomains}get_Type(){if((0,r.Z)(this.extension))return"metaOSExtension";return this.extension.Type}get_ConsentState(){return this.extension.ConsentState}get_RequestedCapabilities(){var e,t,n,i,o,s,a;if((0,r.Z)(this.extension)){const r=this.extension,a=(null===(n=null===(t=null===(e=r.titleDefinition)||void 0===e?void 0:e.authorization)||void 0===t?void 0:t.permissions)||void 0===n?void 0:n.resourceSpecific)?null===(s=null===(o=null===(i=r.titleDefinition)||void 0===i?void 0:i.authorization)||void 0===o?void 0:o.permissions)||void 0===s?void 0:s.resourceSpecific:[];for(let e=0;e<(null==a?void 0:a.length);e++)if("Delegated"==a[e].type&&"Mailbox.SharedFolder"!=a[e].name&&"Mailbox.AppendOnSend"!=a[e].name)switch(a[e].name){case"MailboxItem.Restricted":default:return 0;case"MailboxItem.Read":return 1;case"MailboxItem.ReadWrite":return 3;case"Mailbox.ReadWrite":return 2}return 0}return null===(a=this.extension)||void 0===a?void 0:a.RequestedCapabilities}get_EndNodeUrl(){if((0,r.Z)(this.extension))return null;{const e=this.extension;return null==e?void 0:e.EndNodeUrl}}get_SharedFolderSupportForMetaOS(){var e,t,n,i,o,s;if((0,r.Z)(this.extension)){const r=this.extension,a=(null===(n=null===(t=null===(e=r.titleDefinition)||void 0===e?void 0:e.authorization)||void 0===t?void 0:t.permissions)||void 0===n?void 0:n.resourceSpecific)?null===(s=null===(o=null===(i=r.titleDefinition)||void 0===i?void 0:i.authorization)||void 0===o?void 0:o.permissions)||void 0===s?void 0:s.resourceSpecific:[];for(let e=0;e<(null==a?void 0:a.length);e++)if("Mailbox.SharedFolder"==a[e].name&&"Delegated"==a[e].type)return!0;return!1}return!1}get_IsMos(){return(0,r.Z)(this.extension)}set_ConsentState(e){this.extension.ConsentState=e}set_RequestedCapabilities(e){this.extension.RequestedCapabilities=e}set_TypeString(e){this.extension.TypeString=e}set_ExtensionId(e){if((0,r.Z)(this.extension)){this.extension.titleId=e}else{this.extension.Id=e}}set_OriginString(e){this.extension.OriginString=e}set_Settings(e){this.extension.Settings=e}}},177659:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(371134);var r=n(559621);const o=(0,i.MT)("extensibility",{EnabledAddinCommands:null,HostItems:new r.ObservableMap,IsPreinstalledTeachingUIAvailable:!1,Context:null,taskPanes:new r.ObservableMap,activeDialogs:new r.ObservableMap,ExtensibilityStateIsDirty:!1,contextualCalloutState:new r.ObservableMap,runningContextualAddinCommand:new r.ObservableMap,runningUILessExtendedAddinCommands:new r.ObservableMap,autoRunAddinCommandWaitingQueue:new r.ObservableMap,compliance:{isMinor:!1},activeAutorunUilessFrames:new r.ObservableMap,currentSoftBlockDialogState:new r.ObservableMap,telemetryLoggedInfo:new Map,addinsMap:new Map})()},217915:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l,r:()=>c});var i=n(364913),r=n(514743);const o="User",s="Organization",a="Default";function l(e,t){const n=(0,r.Z)().EnabledAddinCommands;if(!n)return[];let o=n.getExtensionPoint(i.a.TrapOnSendEvent);if(t){const e=n.getAutoRunAddinsByLaunchEventType(t).map((e=>e.Id));o=o.filter((t=>!e.includes(t.Id)))}return o.map((t=>null==t?void 0:t.AddinCommands.get(e.toString())))}function c(e,t,n){const i=l(e,n),r=i.filter((e=>{var t;return(null===(t=e.get_OriginString)||void 0===t?void 0:t.call(e))==o})),c=i.filter((e=>{var t;return(null===(t=e.get_OriginString)||void 0===t?void 0:t.call(e))==a})),u=i.filter((e=>{var t;return(null===(t=e.get_OriginString)||void 0===t?void 0:t.call(e))==s}));if(r.sort(((e,t)=>d(e,t))),c.sort(((e,t)=>d(e,t))),u.sort(((e,t)=>d(e,t))),t)switch(t){case o:return r;case a:return c;case s:return u}return[...r,...c,...u]}function d(e,t){const n=e.get_Id(),i=t.get_Id();return n<i?-1:n>i?1:0}},952137:(e,t,n)=>{"use strict";n.d(t,{j:()=>s,Y:()=>a});var i=n(514743),r=n(485853),o=n(61075);function s(e){const t=(0,o.Y_)(e);return t?t.targetWindow:function(e){const t=(0,r.R3)(e);let n=window;const i=l();return t&&i?(i.forEach(((i,r)=>{r===t&&i.forEach(((t,i)=>{e==i&&(n=t.targetWindow)}))})),n):n}(e)}function a(e){let t=window;const n=l();return n?(n.forEach((n=>{n.forEach((n=>{n.hostItemIndex===e&&(t=n.targetWindow)}))})),t):t}function l(){return(0,i.Z)().runningUILessExtendedAddinCommands}},120684:(e,t,n)=>{"use strict";n.d(t,{H:()=>r});var i=n(514743);function r(){var e;return null===(e=(0,i.Z)())||void 0===e?void 0:e.uiLessAddinRunningForEMO}},571721:(e,t,n)=>{"use strict";n.d(t,{$4:()=>o,_G:()=>s,RG:()=>a});const i="extCompose",r="extRead",o=e=>`extCompose_${e}`,s=e=>`extRead_${e}`,a=e=>0===e.indexOf(i)?"Compose":0===e.indexOf(r)?"Read":""},573360:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(55461);function r(e){return(0,i.cr)("addin-enableMetaOSExtensions")&&"metaOSExtension"==(null==e?void 0:e.__type)}},939816:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>a});var i=n(954947),r=n(55461),o=n(866371),s=n(414691);function a(e){var t;if(function(e){return null!=e.RightsManagementLicenseData}(e)&&!function(e){var t;return(0,r.cr)("addin-enableAddinsForIRM")&&!(0,i.Z)()&&(null===(t=e.RightsManagementLicenseData)||void 0===t?void 0:t.ProgrammaticAccessAllowed)}(e))return!1;if(e.IsDraft)return!1;const n=e.ItemClass?e.ItemClass.toLowerCase():"";return(0!=n.indexOf("ipm.note.smime")||-1!=n.indexOf("ipm.note.smime.multipartsigned"))&&(0!=n.indexOf("report")&&(!(0,r.cr)("addin-disableAddinsForInPlaceArchiveFolder")||!(null===(t=null==e?void 0:e.ParentFolderId)||void 0===t?void 0:t.Id)||(0,o.Z)(e.ParentFolderId.Id)!==s.Yo))}},724375:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(226362),r=n(572561),o=n(924848),s=n(72251);function a(e){return!!(0,o.Z)("mon-show-addins")&&(!(0,r.U$)()||!(0,o.Z)("mon-disable-secondaryAccountAddins")||(0,s.M4)((0,i.zl)())===(0,s.M4)(e))}},61075:(e,t,n)=>{"use strict";n.d(t,{nW:()=>o,Y_:()=>s,L1:()=>a,ZE:()=>l});var i=n(514743),r=n(175248);function o(e,t){var n;const{taskPanes:o}=(0,i.Z)(),s=(0,r.Z)(t);return null===(n=null==o?void 0:o.get(s))||void 0===n?void 0:n.get(e)}function s(e){const{taskPanes:t}=(0,i.Z)();if(!t)return null;for(const n of t.values())for(const t of n.values())if(t&&t.controlId===e)return t;return null}function a(e){const{taskPanes:t}=(0,i.Z)();if(!t)return null;for(const n of t.values())for(const[t,i]of n)if(i&&i.controlId===e)return t;return null}function l(e){return"Persistent"===e?"NonPersistent":"Persistent"}},485853:(e,t,n)=>{"use strict";n.d(t,{IK:()=>a,Fv:()=>l,F_:()=>c,cN:()=>d,R3:()=>u,WH:()=>p,MA:()=>m});var i=n(514743),r=n(330613),o=n(952137),s=n(175248);function a(e){return(0,i.Z)().runningUILessExtendedAddinCommands.has(e)}function l(e){var t;const n=null===(t=(0,i.Z)().runningUILessExtendedAddinCommands)||void 0===t?void 0:t.get(e);if(n)for(const e of n.values()){if(!(e.addinCommand instanceof r.Z))return!0}return!1}function c(e){const t=h();if(!t)return null;for(const n of t.values())for(const t of n.keys())if(t===e)return n.get(t).addinCommand;return null}function d(e){const t=(0,o.j)(e),n=(0,s.Z)(t);return h().has(n)&&h().get(n).has(e)?h().get(n).get(e).addinCommandTelemetry:null}function u(e){const t=h();if(!t)return null;let n=null;return t.forEach(((t,i)=>{for(const r of t.keys())if(r===e){n=i;break}})),n}function p(e){return null!==c(e)}function m(e){const t=h();if(!t)return null;let n=null;return t.forEach(((t,i)=>{if(e==i)for(const e of t.values()){n=e.hostItemIndex;break}})),n}function h(){return(0,i.Z)().runningUILessExtendedAddinCommands}},12773:(e,t,n)=>{"use strict";n.d(t,{Vm:()=>i,tL:()=>r,vq:()=>o,kC:()=>s,rn:()=>a,Xk:()=>l,Zp:()=>c,VZ:()=>d,Le:()=>u,Th:()=>p,mH:()=>m,PE:()=>h});const i="Box",r="Dropbox",o="Facebook",s="GDrive",a="Mailbox",l="MailMessage",c="OneDriveConsumer",d="OneDrivePro",u="WopiBox",p="WopiDropbox",m="WopiEgnyte",h={BOX:i,DROPBOX:r,FACEBOOK:o,GDRIVE:s,MAILBOX:a,ONE_DRIVE_CONSUMER:c,ONE_DRIVE_PRO:d,RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:u,WOPI_EGNYTE:m}},341747:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(979021);function r(e){if(!e)return null;return(0,i.Z)().attachments.get(e.Id)}},517525:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).aD)("ON_ATTACHMENT_CREATED",((e,t,n,i,r=!0)=>({parentItemId:e,attachmentId:t,attachment:n,targetWindow:i,shouldTriggerAddInAttachmentsChangedCallback:r})))},482431:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).aD)("ON_ATTACHMENT_DELETED",((e,t,n,i,r=!0)=>({parentItemId:e,attachmentId:t,attachment:n,targetWindow:i,shouldTriggerAddInAttachmentsChangedCallback:r})))},239913:(e,t,n)=>{"use strict";n.d(t,{F:()=>i});const i=(0,n(371134).aD)("setAnnouncedComponentMessage",((e,t)=>({attachmentWell:e,message:t})))},789568:(e,t,n)=>{"use strict";n.d(t,{xP:()=>r.Z,no:()=>o.Z,Q7:()=>a,MS:()=>l,vg:()=>c,pV:()=>d,gF:()=>u,m5:()=>p,rz:()=>m,B3:()=>h,BA:()=>f,i3:()=>g,$t:()=>v,zl:()=>y,z$:()=>S,s:()=>b,vc:()=>I,aT:()=>w,fc:()=>C,c7:()=>E,Qv:()=>P,AC:()=>T,Io:()=>R,e4:()=>x});var i=n(717420),r=n(517525),o=n(482431);const s=new i.nI((()=>Promise.all([n.e(3918),n.e(94044),n.e(77456),n.e(99110),n.e(44928),n.e(16293),n.e(46688),n.e(14773),n.e(82120),n.e(45087),n.e(665),n.e(37330),n.e(47877),n.e(78159),n.e(49792),n.e(95994),n.e(22107),n.e(69939),n.e(13201),n.e(97226)]).then(n.bind(n,754487)))),a=new i._5(s,(e=>e.initializeAttachments)),l=new i._5(s,(e=>e.reinitializeAttachments)),c=new i._5(s,(e=>e.addAttachmentIntoWellBeforeUpload)),d=new i._5(s,(e=>e.updateChangeKeyOnItemId)),u=new i.EF(s,(e=>e.refreshSharingTipsAttachmentWell)),p=new i.EF(s,(e=>e.createAttachmentsViaQueueManager)),m=new i.EF(s,(e=>e.createAttachmentsFromRecentAttachments)),h=new i._5(s,(e=>e.deleteAttachmentViaQueueManager)),f=new i.EF(s,(e=>e.createAttachmentFullViewStateAndStoreBackingModel)),g=new i.EF(s,(e=>e.createAttachmentFullViewState)),v=new i.EF(s,(e=>e.getAttachmentWellInitialValue)),y=new i.EF(s,(e=>e.getAttachmentWellForCompose)),S=new i.EF(s,(e=>e.getConversationAttachmentWellInitialValue)),b=new i.EF(s,(e=>e.getAvailableLocalAttachmentSize)),I=new i.EF(s,(e=>e.createAttachmentFileFromExistingMailboxAttachment)),w=new i._5(s,(e=>e.mergeToConversationAttachmentWell)),C=new i._5(s,(e=>e.sortConversationAttachmentWell)),E=new i._5(s,(e=>e.convertImageViewAttachmentToInlineAttachment)),P=new i.EF(s,(e=>e.getLastCloudyAttachmentsSharingIssueForBlockOnSend)),T=new i.EF(s,(e=>e.getAllValidAttachments)),R=new i.EF(s,(e=>e.uploadLocalFile)),x=new i.EF(s,(e=>e.getUpsellProperties))},234853:(e,t,n)=>{"use strict";n.d(t,{N:()=>o});var i=n(717420);const r=new i.nI((()=>n.e(44910).then(n.bind(n,144910)))),o=(0,i.$y)(r,(e=>e.ComposeDropHint))},732286:(e,t,n)=>{"use strict";n.d(t,{X9:()=>a,_O:()=>l,e_:()=>c,kg:()=>d,mX:()=>u,rQ:()=>p,J7:()=>m,hn:()=>h,Nc:()=>r.N,To:()=>o.To,uL:()=>o.uL});var i=n(717420),r=n(757692),o=n(669438);const s=new i.nI((()=>Promise.all([n.e(7181),n.e(77456),n.e(99110),n.e(27413)]).then(n.bind(n,761308)))),a=new i.EF(s,(e=>e.clearCachedAttachmentSuggestions)),l=new i.EF(s,(e=>e.getAttachmentSuggestionsAction)),c=new i.EF(s,(e=>e.createCloudFileFromAttachmentData)),d=new i.EF(s,(e=>e.getAttachmentSuggestionsMenuItems)),u=new i.EF(s,(e=>e.getAttachmentSuggestionsTraceId)),p=new i.EF(s,(e=>e.getAttachmentSuggestionsTraceIdByComposeId)),m=new i.EF(s,(e=>e.getAttachmentSuggestionsSessionIdByComposeId)),h=new i._5(s,(e=>e.logEntitiesFromFilePicker))},757692:(e,t,n)=>{"use strict";var i;n.d(t,{N:()=>i}),function(e){e[e.Contextual=0]="Contextual",e[e.MRUCloudy=1]="MRUCloudy",e[e.MRUClassic=2]="MRUClassic",e[e.MRUContextual=3]="MRUContextual",e[e.MRUClassicContextual=4]="MRUClassicContextual"}(i||(i={}))},544306:(e,t,n)=>{"use strict";n.d(t,{h:()=>i});const i=(0,n(371134).aD)("onUpdateRecipientsInCompose",((e,t,n,i)=>({numberOfRecipients:e,recipientName:t,composeId:n,attachments:i})))},13998:(e,t,n)=>{"use strict";n.d(t,{Wr:()=>l,L4:()=>c,bh:()=>o.b,p2:()=>s.p});var i=n(717420),r=n(544306),o=n(456095),s=n(301462);const a=new i.nI((()=>n.e(22196).then(n.bind(n,422196)))),l=(0,i.$y)(a,(e=>e.RecentAttachmentPillContainer)),c=new i._5(a,(e=>e.onUpdateRecipientsInCompose));(0,i.Kv)(r.h,a,(e=>e.onUpdateRecipientsInComposeOrchestrator))},301462:(e,t,n)=>{"use strict";var i;n.d(t,{p:()=>i}),function(e){e[e.Show=0]="Show",e[e.Hide=1]="Hide",e[e.Pending=2]="Pending"}(i||(i={}))},456095:(e,t,n)=>{"use strict";n.d(t,{b:()=>s});var i=n(371134);const r={recentAttachmentPills:new(n(559621).ObservableMap)({})},o=(0,i.MT)("recentAttachmentPills",r)(),s=()=>o},149607:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});const i=(0,n(371134).aD)("REMOVE_SHARING_LINKS",(e=>({linkIds:e})))},200166:(e,t,n)=>{"use strict";n.d(t,{b:()=>a,k:()=>o.k});var i=n(717420),r=n(126573),o=n(149607);const s=new i.nI((()=>Promise.all([n.e(52637),n.e(72760),n.e(28358),n.e(63816),n.e(7181),n.e(46688),n.e(14773),n.e(45087),n.e(665),n.e(37330),n.e(47877),n.e(49792),n.e(95994),n.e(22107),n.e(30092),n.e(45897),n.e(78287),n.e(87615),n.e(65592),n.e(17424)]).then(n.bind(n,363661)))),a=(0,r.Z)(s,(e=>e.LinkPlugin),"Link",(function(e){return 7===e.eventType||11===e.eventType||10===e.eventType||8===e.eventType||2===e.eventType||6===e.eventType||0===e.eventType||1===e.eventType}),!0)},729379:(e,t,n)=>{"use strict";n.d(t,{gx:()=>o,FM:()=>s,jh:()=>a,wy:()=>l,MS:()=>c,Np:()=>d,Fl:()=>u,Bw:()=>p,gN:()=>m,jl:()=>h,QI:()=>f,HI:()=>g,TC:()=>r.TC,Hj:()=>r.Hj,IF:()=>r.IF});var i=n(717420),r=n(432147);const o=new i.nI((()=>Promise.all([n.e(52637),n.e(72760),n.e(28358),n.e(63816),n.e(7181),n.e(77456),n.e(99110),n.e(46688),n.e(14773),n.e(45087),n.e(665),n.e(37330),n.e(47877),n.e(49792),n.e(95994),n.e(22107),n.e(30092),n.e(45897),n.e(78287),n.e(72292)]).then(n.bind(n,883890)))),s=new i.EF(o,(e=>e.convertClassicAttachmentToLinkHandler)),a=new i.EF(o,(e=>e.getAllInsertLinksIds)),l=new i.EF(o,(e=>e.getAtLeastOneInsertLinkPendingOrFailed)),c=new i.EF(o,(e=>e.getBlockDialogOnSendStrings)),d=new i.EF(o,(e=>e.getBlockDialogOnSaveStrings)),u=new i.EF(o,(e=>e.insertLinkPlaceholdersRemoveOrRehydrate)),p=new i.EF(o,(e=>e.getPendingInsertLinkIds)),m=new i.EF(o,(e=>e.insertLinks)),h=new i.EF(o,(e=>e.updateUpsellUserSelectionText)),f=(0,i.$y)(o,(e=>e.InsertLinksBlockDialog)),g=new i._5(o,(e=>e.areEditorLinksValid))},299668:(e,t,n)=>{"use strict";n.d(t,{gv:()=>s,Fi:()=>f,Zd:()=>u,AX:()=>p,uV:()=>i,XZ:()=>h,_4:()=>c});const i=(0,n(371134).aD)("openCalendarBoardView");var r=n(55461),o=n(964659);function s(){var e;return(0,r.cr)("cal-sublimity")&&!(null===(e=(0,o.c6)().SessionSettings)||void 0===e?void 0:e.IsShadowMailbox)}var a=n(165201);const l="BoardViewLastLoad";function c(e){(0,a.LS)(window,l,e)}var d=n(509636);function u(){if(!s())return!1;const e=(0,a.rV)(window,l);return!!e&&e>(0,d.fh)((0,d.E4)((0,d.zO)(),-7))}function p(){window.open("/calendar/view/board","_blank")}let m="Unset";function h(e){m=e}function f(){return m}},922002:(e,t,n)=>{"use strict";n.d(t,{Y0:()=>o.Y,H$:()=>g,y$:()=>h,ee:()=>p,II:()=>m,uj:()=>r,hv:()=>u,N_:()=>d,gl:()=>c,og:()=>a});const i=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");function r(e){let t=null;const n=i.exec(e);if(n){const e=n[1],i=n[2];let r=null;try{r=atob(i)}catch(e){}if(r){const n=new ArrayBuffer(r.length),i=new Uint8Array(n);for(let e=0;e<r.length;e++)i[e]=r.charCodeAt(e);t=new File([n],"image.png",{type:e})}}return t}var o=n(256234),s=n(212971);function a(e){return e.map((e=>({fileType:o.Y.Uri,name:e.name,type:(0,s.LG)(e.url)||"",size:0,uri:e.url})))}var l=n(448259);function c(e,t,n){if(e.length!=t.length)return l.rx("The sizes of subjects and latestItemIds are different"),null;const i=[];for(let r=0;r<e.length;r++){const s={fileType:o.Y.MailItem,name:e[r],size:(null==n?void 0:n[r])||0,itemId:t[r]};i.push(s)}return i}function d(e,t,n){const i=[],r={fileType:o.Y.MailItem,name:e,size:n||0,mimeContent:t};return i.push(r),i}function u(e){if(!e)return null;const t=[];for(var n=0;n<e.length;n++){const i=e[n],r={fileType:o.Y.Local,name:i.name,size:i.size,type:i.type,fileObject:i};t.push(r)}return t}function p(e){if(!e)return null;const t=[];for(let n=0;n<e.length;n++){const i=e[n],r={fileType:i.fileType,name:i.name,size:i.size,type:i.type,dataUri:i.dataUri};t.push(r)}return t}function m(e){var t,n;if(null===e)return null;return{fileType:o.Y.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(t=e.Thumbnail)||void 0===t?void 0:t.Url)||"",previewUrl:(null===(n=e.Preview)||void 0===n?void 0:n.Url)||"",type:e.MimeType}}function h(e){if(null===e)return null;return{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:o.Y.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var f=n(12773);function g(e){switch(e?e.toLowerCase():null){case f.PE.ONE_DRIVE_PRO.toLowerCase():return 0;case f.PE.GDRIVE.toLowerCase():return 5;case f.PE.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case f.PE.DROPBOX.toLowerCase():return 2;case f.PE.BOX.toLowerCase():return 3;case f.PE.WOPI_BOX.toLowerCase():return 7;case f.PE.WOPI_EGNYTE.toLowerCase():return 8;case f.PE.MAILBOX.toLowerCase():return 4;case f.PE.FACEBOOK.toLowerCase():return 6;default:return null}}},256234:(e,t,n)=>{"use strict";var i;n.d(t,{Y:()=>i}),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc",e[e.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage",e[e.Sonora=18]="Sonora"}(i||(i={}))},64047:(e,t,n)=>{"use strict";n.d(t,{lq:()=>r.lq,QJ:()=>r.QJ,Zv:()=>r.Zv,hE:()=>r.Pb,Hd:()=>r.Hd,jf:()=>r.jf,xB:()=>r.xB,ne:()=>r.ne,pX:()=>s,Ue:()=>a,MN:()=>l,uK:()=>c});var i=n(717420),r=n(673122);const o=new i.nI((()=>n.e(86656).then(n.bind(n,886656)))),s=new i._5(o,(e=>e.attachmentFilePicker)),a=new i._5(o,(e=>e.attachmentActionsPanel)),l=(0,i.$y)(o,(e=>e.AttachmentLocalComputerFilePicker)),c=new i.EF(o,(e=>e.logAttachOrShareDatapoint))},285132:(e,t,n)=>{"use strict";n.d(t,{H:()=>i});const i="special/attachments"},517185:(e,t,n)=>{"use strict";n.d(t,{H:()=>r.H,c:()=>s});var i=n(717420),r=n(285132);const o=new i.nI((()=>Promise.all([n.e(52637),n.e(32557),n.e(39006),n.e(18838),n.e(16025),n.e(19280),n.e(33615),n.e(17483),n.e(56337),n.e(75482),n.e(69390),n.e(11102),n.e(56841),n.e(62600),n.e(9152),n.e(90885),n.e(3128),n.e(5989),n.e(99458),n.e(34921)]).then(n.bind(n,305445)))),s=new i.EF(o,(e=>e.showAttachmentFolderPicker))},336627:(e,t,n)=>{"use strict";n.d(t,{bN:()=>a,KM:()=>l,EU:()=>r.E,M3:()=>o.M});var i=n(717420),r=n(147708),o=n(346414);const s=new i.nI((()=>Promise.all([n.e(46688),n.e(17565)]).then(n.bind(n,945699)))),a=new i.EF(s,(e=>e.fetchUploadFolder)),l=new i._5(s,(e=>e.preloadUploadFolder))},147708:(e,t,n)=>{"use strict";n.d(t,{E:()=>s});var i=n(397534),r=n(964659),o=n(226362);function s(e){var t;void 0===e&&(e=null===(t=(0,r.pX)((0,o.B6)()).SessionSettings)||void 0===t?void 0:t.UserEmailAddress);return(0,i.b)().uploadFolders.get(e)||null}},346414:(e,t,n)=>{"use strict";var i;n.d(t,{M:()=>i}),function(e){e.User="User",e.Group="Group"}(i||(i={}))},397534:(e,t,n)=>{"use strict";n.d(t,{b:()=>s});var i=n(371134);const r={uploadFolders:new(n(559621).ObservableMap)},o=(0,i.MT)("attachmentsUploadFolderStore",r)(),s=()=>o},936823:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).aD)("LOAD_FAVORITES",(e=>({mailboxInfo:e})))},51861:(e,t,n)=>{"use strict";n.d(t,{J:()=>r,n:()=>o});var i=n(371134);const r=(0,i.aD)("SET_LOAD_STATE",(e=>({preloadState:e}))),o=(0,i.aD)("SHOW_FILE_PROVIDER_INLINE_VIEW",(e=>({visible:e})))},673122:(e,t,n)=>{"use strict";n.d(t,{jf:()=>c.j,QJ:()=>a.Z,uF:()=>S,xM:()=>d.x,fp:()=>p.f,xB:()=>f.x,lq:()=>u.lq,h8:()=>y,Zv:()=>l.Z,Hd:()=>m.Hd,ne:()=>g,fB:()=>I,B$:()=>b,rm:()=>C,_Z:()=>E,Pb:()=>w});var i=n(717420),r=n(51861),o=n(818917),s=n(371134);(0,s.ed)(r.J,(e=>{(0,o.v)().viewState.preloadState=e.preloadState})),(0,s.ed)(r.n,(e=>{(0,o.v)().viewState.showFileProviderInlineView=e.visible}));var a=n(306338),l=n(100314),c=n(32781),d=n(999147),u=n(169002),p=n(641354),m=n(770351),h=n(954947),f=n(47108);function g(){return(0,h.Z)()?f.x.InsertLinkConsumer:f.x.InsertLinkBusiness}const v=new i.nI((()=>Promise.all([n.e(25671),n.e(52637),n.e(56337),n.e(9598),n.e(99458),n.e(64826),n.e(91566),n.e(7181),n.e(71168),n.e(19924),n.e(767),n.e(41939),n.e(52411),n.e(77456),n.e(99110),n.e(46688),n.e(14773),n.e(82120),n.e(78159),n.e(71685)]).then(n.bind(n,902340)))),y=(0,i.$y)(v,(e=>e.LocalComputerFilePicker)),S=(0,i.$y)(v,(e=>e.FilePickerActionsPanelButtonView)),b=new i.EF(v,(e=>e.filePicker)),I=new i.EF(v,(e=>e.actionsPanel)),w=new i.EF(v,(e=>e.preloadFilePicker)),C=new i.EF(v,(e=>e.getDefaultFileProvider)),E=new i.EF(v,(e=>e.getShareIconForActionPanel))},818917:(e,t,n)=>{"use strict";n.d(t,{v:()=>c});var i=n(371134),r=n(169002),o=n(32781),s=n(47108),a=n(999147);const l=(0,i.MT)("filepicker",{viewState:{isOpen:!1,preloadState:2,fileSelectionFilter:r.lq.None,fileProvidersFilter:s.x.None,selectedFileProvider:null,selectedProviderScope:null,filePickerViewState:{breadcrumbs:[],columnSorting:null,fileProviderItems:[],isLoadingItems:!1,pagingMetadata:null,selectedFileProviderItems:[],selectedFolder:null,selectedView:null,supportedActions:[],supportedActionsMessages:[],supportedViews:[],totalItemsCount:0,userPreferredViewType:a.x.List,searchViewState:{searchQuery:"",isInSearchMode:!1},filterOptionsState:{showFilterOptions:!1,selectedFilterOption:0}},filePickerErrorMessageViewState:{isShown:!1,message:null},filePickerActionsViewState:{isOpen:!1,saveUserChoice:!1,isCalloutVisible:!1,uploadConfiguration:{composeUniqueState:o.j.None}},showFileProviderInlineView:!1}})(),c=()=>l},306338:(e,t,n)=>{"use strict";var i;n.d(t,{Z:()=>r}),function(e){e[e.Attach=1]="Attach",e[e.Share=2]="Share",e[e.InsertInlineImage=3]="InsertInlineImage",e[e.AttachAndShare=4]="AttachAndShare",e[e.InsertAsLink=5]="InsertAsLink"}(i||(i={}));const r=i},32781:(e,t,n)=>{"use strict";var i;n.d(t,{j:()=>i}),function(e){e[e.None=0]="None",e[e.PlainText=1]="PlainText",e[e.Encrypted=2]="Encrypted",e[e.GroupCalendar=3]="GroupCalendar"}(i||(i={}))},641354:(e,t,n)=>{"use strict";var i;n.d(t,{f:()=>i}),function(e){e[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Group=2]="Group"}(i||(i={}))},47108:(e,t,n)=>{"use strict";var i;n.d(t,{x:()=>i}),function(e){e[e.None=0]="None",e[e.InsertLinkBusiness=1]="InsertLinkBusiness",e[e.InsertLinkConsumer=2]="InsertLinkConsumer",e[e.OneDrive=3]="OneDrive",e[e.OtherOnlineLocations=4]="OtherOnlineLocations"}(i||(i={}))},100314:(e,t,n)=>{"use strict";var i;n.d(t,{Z:()=>i}),function(e){e[e.LocalComputerFiles=0]="LocalComputerFiles",e[e.ProviderFiles=1]="ProviderFiles"}(i||(i={}))},999147:(e,t,n)=>{"use strict";var i;n.d(t,{x:()=>i,K:()=>r}),function(e){e[e.List=0]="List",e[e.Tile=1]="Tile",e[e.Groups=2]="Groups"}(i||(i={}));const r={[i.List]:()=>"List",[i.Tile]:()=>"ViewAll"}},770351:(e,t,n)=>{"use strict";n.d(t,{Bf:()=>i,DS:()=>r,Hd:()=>o});const i="scopeId",r="searchId",o=5120},213067:(e,t,n)=>{"use strict";n.d(t,{l:()=>E});var i=n(398327);function r(e){return Object.assign({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},e)}function o(e){const t=r({ProviderType:e});return void 0===(n=t)||n.__type||(n=r(n)),(0,i.S)("GetNewAttachmentDataProviderCreationInfo",n,o);var n,o}function s(e){return Object.assign({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},e)}function a(e){const t=s({ProviderType:e});return void 0===(n=t)||n.__type||(n=s(n)),(0,i.S)("GetAttachmentDataProviderCreator",n,r);var n,r}var l=n(297462);function c(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?`${e}&${t}=${n}`:`${e}?${t}=${n}`}const d=(0,n(325876).wc)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function u(e){const t=e?encodeURIComponent(`?provider=${e}`):"",n=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return`${(0,l.P$)()}/mail/${n}${t}`}function p(e){const t=`${(0,l.P$)()}/mail/AddFileProvider.html`,n=encodeURIComponent(`provider=${e}&url=${t}`);return`${d}/ADPRedirect.aspx?${n}`}function m(e,t,n,i,r,o){return()=>{const e=function(){const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=e.length-1,n=[];for(let i=0;i<16;i++)n.push(e[Math.round(Math.random()*t)]);return"owa_csrf_token_"+n.join("")}();let s=c(t,"client_id",i);if(s=c(s,"redirect_uri",n),s=c(s,"response_type",r),o){const t=o(e);s=Object.keys(t).reduce(((e,n)=>c(e,n,t[n])),s)}return{authUrl:s,redirectUrl:n,csrfToken:e}}}var h=n(32099),f=n(55461);const g="code";function v(e){return{state:e}}function y(e){return e.state}function S(e){return e.code}async function b(e,t,n,i,r,s,l){try{let l;if(7===e||9===e||8===e){const t=await a(e);l=t.AttachmentDataProviderCreator.ProviderAppKey,n=t.AttachmentDataProviderCreator.AuthorizationUri}else{l=(await o(e)).ProviderAppKey}t.getAuthUrlInfo=m(0,n,i,l,r,s)}catch(o){l>0&&setTimeout((()=>b(e,t,n,i,r,s,--l)),3e3)}}function I(e,t,n,i,r){const o={providerType:e,getAuthUrlInfo:null,getCSRFToken:y,getOAuthCode:S};return b(e,o,t,n,i,r,3),o}let w=null;function C(){if(!w){if(w={},(0,h.Z)(3)&&(w[3]=I(3,"https://app.box.com/api/oauth2/authorize",p(3),g,v)),(0,h.Z)(2)&&(w[2]=I(2,"https://www.dropbox.com/oauth2/authorize",u(2),g,v)),(0,h.Z)(5)){const e=(0,f.cr)("doc-gdrive-token-scope-change")?"false":"true",t=I(5,"https://accounts.google.com/o/oauth2/auth",`${d}/ADPRedirect.aspx`,g,(t=>{const n={state:t,provider:5..toString(),url:u()};return{state:JSON.stringify(n),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:e}}));t.getCSRFToken=e=>JSON.parse(e.state).state,w[5]=t}(0,h.Z)(1)&&(w[1]=I(1,"https://login.live.com/oauth20_authorize.srf",p(1),g,(e=>({state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"})))),(0,h.Z)(7)&&(w[7]=I(7,"",p(7),g,v)),(0,h.Z)(8)&&(w[8]=I(8,"",p(8),g,v)),(0,h.Z)(9)&&(w[9]=I(9,"",p(9),g,v))}return w}function E(e){const t=C();return e in t?t[e]:null}},32099:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(676186),r=n(954947),o=n(135726),s=n(55461);function a(e){const t=(0,i.Z)();switch(e){case 5:return(null==t?void 0:t.GoogleDriveAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&(0,s.cr)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return(null==t?void 0:t.BoxAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&(0,s.cr)("doc-fileProvider-box");case 2:return(null==t?void 0:t.DropboxAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&(0,s.cr)("doc-fileProvider-dropbox");case 6:return!1;case 1:return!!(0,r.Z)()||(null==t?void 0:t.OnedriveAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled);case 10:return(0,s.cr)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&(0,s.cr)("doc-fileProvider-wopiClient");default:return(0,o.v)(e)}}},645549:(e,t,n)=>{"use strict";n.d(t,{Sv:()=>o,vS:()=>r,sg:()=>s});var i=n(371134);const r=(0,i.aD)("FILE_PROVIDER_ADDED",(e=>({providerViewState:e}))),o=(0,i.aD)("FILE_PROVIDER_REMOVED",(e=>({providerType:e}))),s=(0,i.aD)("PROVIDERS_LOADED",(e=>({providers:e})))},169002:(e,t,n)=>{"use strict";n.d(t,{lq:()=>r.Z,xf:()=>o.Z,vS:()=>s.vS,Sv:()=>s.Sv,sg:()=>s.sg,Zq:()=>a.Zq,Q8:()=>l.Q,bj:()=>l.b,JT:()=>c.J,m7:()=>d.m,lV:()=>u.l,ci:()=>m,R3:()=>h,LU:()=>f,lY:()=>g});var i=n(717420),r=n(803027),o=n(155175),s=(n(228364),n(645549)),a=n(90183),l=n(625178),c=n(797905),d=n(613464),u=n(213067);const p=new i.nI((()=>Promise.all([n.e(77456),n.e(99110),n.e(665),n.e(4424)]).then(n.bind(n,929884)))),m=new i.EF(p,(e=>e.loadProviders)),h=new i.EF(p,(e=>e.removeFileProvider)),f=new i.EF(p,(e=>e.addFileProvider)),g=new i.EF(p,(e=>e.removeAndAddFileProvider))},625178:(e,t,n)=>{"use strict";n.d(t,{b:()=>r,Q:()=>o});var i=n(228364);const r=()=>[...(0,i.Z)().providers.values()],o=e=>(0,i.Z)().providers.get(e)||null},797905:(e,t,n)=>{"use strict";n.d(t,{J:()=>r});var i=n(228364);function r(){return(0,i.Z)().loadState}},803027:(e,t,n)=>{"use strict";var i;n.d(t,{Z:()=>r}),function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(i||(i={}));const r=i},613464:(e,t,n)=>{"use strict";var i;n.d(t,{m:()=>i}),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded",e[e.Throttled=3]="Throttled"}(i||(i={}))},228364:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(371134),r=n(559621),o=n(613464);const s=(0,i.MT)("fileProviderStore",{providers:new r.ObservableMap,loadState:o.m.NotLoaded,removalPending:new r.ObservableMap})(),a=()=>s},90183:(e,t,n)=>{"use strict";var i;n.d(t,{Zq:()=>i,y2:()=>r,GK:()=>o}),function(e){e[e.Groups=1e4]="Groups"}(i||(i={}));const r=Object.freeze([1,3,2,6,5,7,8,9]),o=Object.freeze([...r,0,4,10])},155175:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(219590),r=n(155313),o=n(101060),s=n(135726);function a(e,t=!1){if(t)return"";switch(e){case 0:return(0,o.ZP)(r.D0);case 1:return(0,o.ZP)(r.UV);case 2:case 9:return(0,o.ZP)("BQc");case 3:case 7:return(0,o.ZP)("CQc");case 5:return(0,o.ZP)("DQc");case 6:return(0,o.ZP)("EQc");case 4:return(0,o.ZP)("FQc");case 10:return(0,o.ZP)(i.ZJ);case 8:return(0,o.ZP)("GQc");default:return(0,s.v)(e)}}},528368:(e,t,n)=>{"use strict";n.d(t,{m:()=>o});var i=n(676186),r=n(169002);function o(e){const t=(0,i.Z)();return!!((null==t?void 0:t.AttachmentDataProviderAvailable)&&!s()||e&&(null==t?void 0:t.GroupsOneDriveDataProviderAvailable))}const s=()=>{(0,r.JT)()===r.m7.NotLoaded&&r.ci.import().then((e=>e((()=>{}))));const e=(0,r.Q8)((0).toString());return!!e&&!e.name}},212971:(e,t,n)=>{"use strict";n.d(t,{y1:()=>d.y,LG:()=>i.ZP,oL:()=>i.oL,xn:()=>i.xn,Zd:()=>p.x,BT:()=>u,CO:()=>s.Z,QE:()=>c,YG:()=>o});var i=n(920295);var r=n(101060);function o(e){let t;return e>=1073741824?(e/=1073741824,t=(0,r.ZP)("JDc")):e>=1048576?(e/=1048576,t=(0,r.ZP)("KDc")):e>=1024?(e/=1024,t=(0,r.ZP)("LDc")):t=(0,r.ZP)("MDc"),(0,r.WU)(t,Math.round(e))}var s=n(616059),a=n(55461);const l=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function c(e){if(!(0,a.cr)("doc-attachment-documentThumbnail"))return!1;const t=(0,i.ZP)(e);return!!t&&l.indexOf(t.toLowerCase())>=0}var d=n(848291);function u(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return d.y.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return d.y.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return d.y.PowerPoint;default:return null}}var p=n(612110)},848291:(e,t,n)=>{"use strict";var i;n.d(t,{y:()=>i}),function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(i||(i={}))},920295:(e,t,n)=>{"use strict";function i(e){if(!e)return null;const t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function r(e){const t=i(e);return t?t.replace(".",""):null}function o(e){var t;return(null===(t=r(e))||void 0===t?void 0:t.substring(0,4))||""}n.d(t,{ZP:()=>i,oL:()=>r,xn:()=>o})},616059:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l,D:()=>c});var i=n(920295),r=n(612110),o=n(382717);const s=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png"],a=[".tiff",".tif"];function l(e,t,n=!0){return c((0,i.ZP)(e)||(0,r.Z)(t),n)}function c(e,t=!0){return!!e&&(s.indexOf(e.toLowerCase())>=0||t&&a.indexOf(e.toLowerCase())>=0&&(0,o.Fo)())}},612110:(e,t,n)=>{"use strict";function i(e){return function(e){const t=o.exec(e);return t&&t.length>1&&r[t[1].toLowerCase()]}(e||"")}n.d(t,{Z:()=>i,x:()=>s});const r={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},o=/^\s*([^;\s]*)(?:;|\s|$)/;function s(e){let t="";return Object.entries(r).forEach((n=>{n[1]===e&&(t=n[0])})),t}},118336:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var i=n(101060),r=n(136947),o=n(925967),s=n(915818),a=n(114594),l=n(448259);function c(e){const t=(0,s.Z)({EntityFeedbackEntries:e});return(0,o.Z)({Header:(0,a.F)(),Body:t}).then((e=>{!function(e){if(null==e?void 0:e.Body){const t=e.Body;l.g4.info((0,i.WU)("addEntityFeedback Error count: {0}",t.ErrorCount)),l.g4.info((0,i.WU)("addEntityFeedback error details: {0}",t.ErrorDetails))}}(e)}))}const d=(0,r.aD)("attemptToSubmitAddEntityFeedback")((function(e,t,n){e&&t&&(e.entityFeedbackEntries.push(t),(n||e.entityFeedbackEntries.length>=e.maxActionBatchSize)&&(c(e.entityFeedbackEntries),l.g4.info((0,i.WU)("{0} Submitted {1} entities.",e.entityScenarioName,e.entityFeedbackEntries.length)),e.entityFeedbackEntries=[]))}))},669038:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var i=n(101060);const r=(0,n(136947).aD)("increaseEntrySequenceNumber")((function(e){e&&e.entrySequenceNumber++}));var o=n(775390),s=n(448259),a=n(509636),l=n(444928);function c(e,t,n,c,d,u,p,m=(0,a.zO)()){if(!e)return s.g4.warn("Attempting to create entity feedback entry with invalid feedbackManager"),null;if((0,o.T)(e.clientSessionId))return s.g4.warn((0,i.WU)("{0} - Attempting to create entity feedback entry with empty client session id",e.entityScenarioName)),null;const h={ClientEventTimeUtc:(0,a.CM)(m),ClientEventTimeLocal:(0,l.dd)(m),ClientSessionId:e.clientSessionId,ClientVersion:e.clientVersion,ClientId:e.clientId,EntityType:e.entityType,EntrySequenceNumber:e.entrySequenceNumber,TransactionId:t,EventType:n,TargetEntityList:c,EntityAddSource:d,JsonPropertyBag:u,ScenarioName:p||e.entityScenarioName};return r(e),h}},41718:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(101060),r=n(669038),o=n(448259);function s(e,t){if((0,i.LP)(e.clientSessionId))return o.g4.warn((0,i.WU)("{0} - Attempting to create session feedback entry with empty client session id",e.entityScenarioName)),null;let n="";t&&(n=null==t.recipientEmailAddresses?"":JSON.stringify(t.recipientEmailAddresses));let s="";if(!(0,i.LP)(t.endSessionAction)){const e={EndSessionAction:t.endSessionAction};s=JSON.stringify(e)}return(0,r.Z)(e,"",t.eventType,n,0,s)}},399101:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(101060),r=n(118336),o=n(41718),s=n(448259);const a=(0,n(136947).aD)("pauseSession")((function(e){if((null==e?void 0:e.hasSessionStarted)&&!e.isSessionPaused){const t={eventType:"SessionPaused",recipientEmailAddresses:null,endSessionAction:null},n=(0,o.Z)(e,t);(0,r.Z)(e,n,!1),e.isSessionPaused=!0,s.g4.info((0,i.WU)("{0} pauseSession : Session paused. Session id: {1}",e.entityScenarioName,e.clientSessionId))}}))},361130:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(101060),r=n(118336),o=n(41718),s=n(448259);const a=(0,n(136947).aD)("resumeSession")((function(e){if(null==e?void 0:e.isSessionPaused){const t={eventType:"SessionResumed",recipientEmailAddresses:null,endSessionAction:null},n=(0,o.Z)(e,t);(0,r.Z)(e,n,!1),e.isSessionPaused=!1,s.g4.info((0,i.WU)("{0} FeedbackManagerBase.ResumeSession: Session resumed. Session id: {1}",e.entityScenarioName,e.clientSessionId))}}))},267662:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var i=n(101060),r=n(118336),o=n(669038),s=n(509636),a=n(444928),l=n(775390),c=n(448259);const d=(0,n(136947).aD)("transactionFailed")((function(e,t,n,d,u,p=null){if(null==e?void 0:e.hasSessionStarted){const m={TransactionRequestTime:(0,a.dd)(d),TransactionRequestDuration:(0,s._Q)((0,s.zO)(),d),QueryString:(0,i.LP)(t)?"":t,QueryStringLength:(0,l.T)(t)?0:t.length,ImpressionId:n};p&&Object.keys(p).forEach((e=>{m[e]=p[e]})),u&&(m.Context=u);const h=JSON.stringify(m),f=(0,o.Z)(e,n,"TransactionFailed",null,0,h);(0,r.Z)(e,f,!1),c.g4.info((0,i.WU)("{0} TransactionComplete. Session id: {1}",e.entityScenarioName,e.clientSessionId))}}))},241505:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={Unknown:0,Person:1,DistributionList:2,ModernGroup:5,ImplicitGroup:10,ExplicitGroup:11,LinkedIn:12}},410716:(e,t,n)=>{"use strict";function i(e){var t,n;return e?(null===(t=e.EmailAddress)||void 0===t?void 0:t.EmailAddress)||(null===(n=e.PersonaId)||void 0===n?void 0:n.Id):null}n.d(t,{Z:()=>i})},669034:(e,t,n)=>{"use strict";n.d(t,{PZ:()=>o,dr:()=>s,D2:()=>a,fG:()=>l});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(85267),n.e(72940)]).then(n.bind(n,72940)))),o=new i.EF(r,(e=>e.searchCacheTrie)),s=new i.EF(r,(e=>e.compareFeatureData)),a=new i._5(r,(e=>e.initializeSuggestionTrie)),l=new i._5(r,(e=>e.isSuggestionTrieEmpty))},249395:(e,t,n)=>{"use strict";n.d(t,{Y:()=>o,j:()=>s});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(3918),n.e(52637),n.e(32557),n.e(56337),n.e(62600),n.e(62199),n.e(64826),n.e(91992),n.e(54964),n.e(50546),n.e(96921),n.e(35684),n.e(88928),n.e(49520),n.e(93854),n.e(47210),n.e(59935),n.e(22590),n.e(30186),n.e(66968)]).then(n.bind(n,966968)))),o=new i._5(r,(e=>e.showAdminInstalledNewAddinFRECallout)),s=new i._5(r,(e=>e.showUnpinnedAdminAddinFRECallout))},364913:(e,t,n)=>{"use strict";var i;n.d(t,{a:()=>r}),function(e){e[e.Unknown=0]="Unknown",e[e.AppointmentOrganizer=1]="AppointmentOrganizer",e[e.AppointmentAttendee=2]="AppointmentAttendee",e[e.MessageCompose=3]="MessageCompose",e[e.MessageRead=4]="MessageRead",e[e.MeetingRequest=5]="MeetingRequest",e[e.DetectedEntity=7]="DetectedEntity",e[e.Events=8]="Events",e[e.LaunchEvent=9]="LaunchEvent",e[e.TrapOnSendEvent=6]="TrapOnSendEvent"}(i||(i={}));const r=i},336417:(e,t,n)=>{"use strict";n.d(t,{Y:()=>s,r:()=>a});var i=n(101060);var r=n(972506),o=n(55461);const s="goTo";function a(){const e={gotoMail:l("RYb","ctrl+shift+1","ctrl+1"),gotoCalendar:l("SYb","ctrl+shift+2","ctrl+2"),gotoPeople:l("TYb","ctrl+shift+3","ctrl+3")};return(0,r.Pg)()!==r.gX.None&&(e.gotoToDo=l((0,r.um)()?"VYb":"UYb","ctrl+shift+4","ctrl+4")),(0,o.cr)("fwk-customDevToolsHotKeys")&&(e.goToDevTools=l("WYb","ctrl+shift+d","ctrl+shift+d"),e.goToEdgeTracingTools=l("XYb","ctrl+shift+t","ctrl+shift+t")),e}function l(e,t,n){return{category:s,description:(0,i.ZP)(e),hotmail:t,yahoo:t,gmail:t,owa:t,outlook:n}}},274443:(e,t,n)=>{"use strict";n.d(t,{O3:()=>o,ft:()=>s});var i=n(964659),r=n(226362);function o(e,t){var n,o;return!!(e&((null===(o=null===(n=(0,i.pX)(null!=t?t:(0,r.B6)()))||void 0===n?void 0:n.ViewStateConfiguration)||void 0===o?void 0:o.ListViewBitFlags)||0))}function s(e,t,n){const s=null!=n?n:(0,r.B6)();o(t,s)!==e&&(0,i.mj)(s,(n=>{!function(e,t,n){var i;if(null==(null===(i=t.ViewStateConfiguration)||void 0===i?void 0:i.ListViewBitFlags))return;e?t.ViewStateConfiguration.ListViewBitFlags|=n:t.ViewStateConfiguration.ListViewBitFlags&=~n}(e,n,t)}))}},4161:(e,t,n)=>{"use strict";n.d(t,{x:()=>l});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(53515),n.e(95397),n.e(63684),n.e(63673),n.e(39053),n.e(57265),n.e(18669),n.e(42297),n.e(55782),n.e(58247),n.e(39930)]).then(n.bind(n,650607)))),o=new i.EF(r,(e=>e.getLoopCardChannelProvider)),s=new i.EF(r,(e=>e.getLoopMetaOSProvider)),a=new i.EF(r,(e=>e.getLoopUrlHandlerProvider)),l={getLazyCardChannelProvider:async()=>await o.import(),getLazyMetaOSProvider:async()=>await s.import(),getLazyUrlHandlerProvider:async()=>await a.import()}},788128:(e,t,n)=>{"use strict";n.d(t,{Hu:()=>i,X:()=>r,R5:()=>o,Ie:()=>s});const i=["#51a7f9","#6fc040","#f5d427","#f3901d","#ed5c57","#b36ae2","#0c64c0","#0c882a","#dcbe22","#de6a19","#c82613","#763e9b","#174e86","#0f5c1a","#c3971d","#be5b17","#861106","#5e327c","#002451","#06400c","#a37519","#934511","#570606","#3b204d","#ffffff","#cccccc","#999999","#666666","#333333","#000000"],r=["#0075c2","#207a00","#5d4d00","#ab5500","#df504d","#ab63da","#6da0ff","#3da848","#6d5c00","#d3610c","#ff6847","#d394f9","#93b8f9","#7fc57b","#946f00","#de7633","#ff9b7c","#dea9fd","#cedbff","#a3da9b","#b5852a","#ef935c","#ffc0b1","#eecaff","#333333","#535353","#777777","#a0a0a0","#cfcfcf","#ffffff"],o=["#00ffff","#00ff00","#ffff00","#ff8000","#ff0000","#ff00ff","#80ffff","#80ff80","#ffff80","#ffc080","#ff8080","#ff80ff","#ffffff","#cccccc","#999999","#666666","#333333","#000000"],s=["#005357","#005e00","#383e00","#bf4c00","#ff2711","#e700e8","#004c4f","#005400","#343c00","#77480b","#bc454a","#aa2bad","#333333","#535353","#777777","#a0a0a0","#cfcfcf","#ffffff"]},376807:(e,t,n)=>{"use strict";n.d(t,{h7:()=>b,j1:()=>S,dN:()=>I,og:()=>w,mu:()=>C.m,SI:()=>E,rB:()=>f,tZ:()=>r,BQ:()=>o});var i=n(371134);const r=(0,i.aD)("onShyRibbonChanged",(e=>({shyRibbon:e}))),o=(0,i.aD)("onViewModeChanged",(e=>({viewMode:e})));var s=n(411321),a=n(769367);async function l(e){const t=await async function(){const e=await a.tR.import();return e&&await e(a.Xm.Commanding)}()||(0,a.Bb)(a.Xm.Commanding),n=Object.assign(Object.assign({},t),e);a.mX.importAndExecute(a.Xm.Commanding,n)}function c(e){l({viewMode:e})}var d=n(55461),u=n(329746),p=n(165201);const m="bootstrapRibbonImport";function h(){const e=(0,s.b)().viewMode,t=(0,d.cr)("mon-ribbon-toolbar")||(0,d.cr)("mon-ribbon-calendar-toolbar");2===e||1===e||0===e&&t?(0,p.LS)(window,m,"true"):(0,p.cl)(window,m)}const f=(0,i.lr)("initializeCommandingViewMode",(e=>{var t;const n=(0,d.cr)("mon-ribbon");let i=n?g(e):0;i=v(i,n),(0,s.b)().viewMode=i;const r=null===(t=e[2])||void 0===t?void 0:t.shyRibbon;r&&((0,s.b)().shyRibbon=r),h()})),g=e=>{var t;const n=null===(t=e.filter((e=>(null==e?void 0:e.feature)==a.Xm.Commanding))[0])||void 0===t?void 0:t.viewMode;if([void 0,0,1,2].includes(n))return n},v=(e,t)=>(void 0===e?(e=t?1:0,(0,u.X)("ribbonPersistDefault")&&c(e)):0===e&&t&&(e=1,(0,u.X)("ribbonPersistDefault")&&c(e)),e),y=()=>{const e=s.Z.viewMode;return 2===e||1===e},S=()=>{const e=s.Z.viewMode;return y()||0===e&&(0,d.cr)("mon-ribbon-toolbar")},b=()=>{const e=s.Z.viewMode;return y()||0===e&&(0,d.cr)("mon-ribbon-calendar-toolbar")},I=()=>{const e=s.Z.viewMode;return 2===e||1===e};function w(){return(0,d.cr)("mon-ribbon-shymode")&&s.Z.shyRibbon}var C=n(824829);function E(){return s.Z.viewMode}var P=n(874191);const T=(0,i.lr)("onShyRibbonChangedInternal",(e=>{(0,P.y8)("ShyRibbonChanged",{from:(0,s.b)().shyRibbon,to:e}),(0,s.b)().shyRibbon=e})),R=(0,i.lr)("onViewModeChangedInternal",(e=>{(0,P.y8)("ViewModeChanged",{from:(0,s.b)().viewMode,to:e}),(0,s.b)().viewMode=e,h()}));(0,i._F)(r,(async e=>{const{shyRibbon:t}=e;return T(t),function(e){l({shyRibbon:e})}(t)})),(0,i._F)(o,(async e=>{const{viewMode:t}=e;return R(t),c(t)}))},824829:(e,t,n)=>{"use strict";n.d(t,{m:()=>r});var i=n(411321);const r=e=>i.Z.viewMode===e},411321:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r,b:()=>o});const i=(0,n(371134).MT)("CommandRibbon",{viewMode:0,ribbonOWAMSITExperimentToolbarUser_DEPRECATED:!1,shyRibbon:!1})(),r=i,o=()=>i},604004:(e,t,n)=>{"use strict";n.d(t,{j:()=>o});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(52637),n.e(32557),n.e(19280),n.e(33615),n.e(17483),n.e(69390),n.e(11102),n.e(9152),n.e(3128),n.e(42440)]).then(n.bind(n,850496)))),o=(0,i.$y)(r,(e=>e.CommandingModeMenu))},849530:(e,t,n)=>{"use strict";n.d(t,{B:()=>o,D:()=>s});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(82120),n.e(57270),n.e(54437),n.e(92001)]).then(n.bind(n,483357)))),o=(0,i.$y)(r,(e=>e.ComposeRibbon)),s=new i.EF(r,(e=>e.showInsertLinkDialog))},679192:(e,t,n)=>{"use strict";var i;n.d(t,{w:()=>i}),function(e){e[e.ok=0]="ok",e[e.cancel=1]="cancel",e[e.dismiss=2]="dismiss",e[e.continue=3]="continue"}(i||(i={}))},951789:(e,t,n)=>{"use strict";n.d(t,{i:()=>a,w:()=>r.w});var i=n(717420),r=n(679192);const o=new i.nI((()=>Promise.all([n.e(25671),n.e(52637),n.e(32557),n.e(39006),n.e(18838),n.e(16025),n.e(19280),n.e(33615),n.e(17483),n.e(56337),n.e(75482),n.e(69390),n.e(11102),n.e(42106),n.e(56841),n.e(9152),n.e(90885),n.e(3128),n.e(5989),n.e(24134)]).then(n.bind(n,651586)))),s=new i.EF(o,(e=>e.confirmAction));function a(e,t,n,i){return s.import().then((r=>r(e,t,n,i)))}},472820:(e,t,n)=>{"use strict";n.d(t,{Yg:()=>i,kA:()=>E,Yz:()=>h,JE:()=>M,Q$:()=>S,q3:()=>C,Dr:()=>G,Bx:()=>X,jF:()=>$,NY:()=>y,Zt:()=>g,_O:()=>f,Re:()=>k,hE:()=>H,WJ:()=>O,E:()=>p,z1:()=>j,Wv:()=>v,S4:()=>r,eb:()=>o,Po:()=>D,zI:()=>_,Jq:()=>K,qw:()=>l,BM:()=>u,YE:()=>Z,Oy:()=>B,kI:()=>P,vJ:()=>a,Xs:()=>c,T6:()=>A});const i="";function r(e){return null==e?void 0:e.node}function o(e){return null==e?void 0:e.nodeType}let s=[];function a(e){return null==e?void 0:e.replace(new RegExp(d(),"g"),"")}function l(e){return!!e&&new RegExp(`^${d()}+$`).test(e)}function c(e){s=e}function d(){const e=s.length?"|"+s.join("|"):"";return`(${i}${e})`}function u(e){return e.nodeType===Node.TEXT_NODE}function p(e){let t=-1;for(;e;)t++,e=null==e?void 0:e.previousSibling;return t}const m="contenteditable";function h(e,t,n,i){e&&(e.className=`_Entity _EType_${t} ${i?`_ETextSel_${i} `:""}_EReadonly_${n?"1":"0"}`,n?e.contentEditable="false":e.getAttribute(m)&&e.removeAttribute(m))}function f(e){var t;let n=!1,i="",r="null",o=!1;return null===(t=null==e?void 0:e.className)||void 0===t||t.split(" ").forEach((e=>{"_Entity"==e?n=!0:0==e.indexOf("_EType_")?i=e.substr("_EType_".length):0==e.indexOf("_ETextSel_")?r=e.substr("_ETextSel_".length):0==e.indexOf("_EReadonly_")&&(o="1"==e.substr("_EReadonly_".length))})),n?{wrapper:e,textSelector:r,type:i,isReadonly:o}:null}function g(e){return e.core.contentDiv}function v(e,t){let n=t.node;if(n===e)return t.offset>=0&&t.offset<e.childNodes.length?e.childNodes[t.offset]:t.offset==e.childNodes.length?null:void 0;for(;n&&n.parentNode!==e;)n=n.parentNode;return e.contains(n)?n:void 0}function y(e,t){return v(g(e),t)}function S(e,t){const n=y(e,t);let i=0,r=null===n?g(e).lastChild:null==n?void 0:n.previousSibling;for(;r;)f(r)&&i++,r=null==r?void 0:r.previousSibling;return i}const b={wrapper:"okfX2",dragOverStyleLeft:"U5207",dragOverStyleRight:"Us5Ue"};var I=n(254712);const w=n.n(I)().bind(b);function C(e){const t=document.createElement("span");return t.appendChild(e.wrapper),t.draggable=!0,E(t),h(t,e.type,e.isReadonly,e.textSelector),t.className=w(t.className,b.wrapper),t}function E(e){e.addEventListener("dragover",T),e.addEventListener("dragleave",R),e.addEventListener("drop",R),e.addEventListener("dragstart",x)}function P(e){e.removeEventListener("dragover",T),e.removeEventListener("dragleave",R),e.removeEventListener("drop",R),e.removeEventListener("dragstart",x)}function T(e){!function(e){var t;const n=null===(t=e.currentTarget)||void 0===t?void 0:t.getBoundingClientRect();return!!(n&&e.clientX-n.left<n.right-e.clientX)}(e)?(e.currentTarget.classList.add(b.dragOverStyleRight),e.currentTarget.classList.remove(b.dragOverStyleLeft)):(e.currentTarget.classList.add(b.dragOverStyleLeft),e.currentTarget.classList.remove(b.dragOverStyleRight))}function R(e){e.currentTarget.classList.remove(b.dragOverStyleLeft),e.currentTarget.classList.remove(b.dragOverStyleRight)}function x(e){var t,n;const i=null===(n=null===(t=e.currentTarget)||void 0===t?void 0:t.ownerDocument)||void 0===n?void 0:n.getSelection(),r=e.currentTarget;if(i&&(i.isCollapsed||!i.containsNode(r,!0))){const e=p(r);i.setBaseAndExtent(r.parentNode,e,r.parentNode,e+1)}}function k(e,t){if(t){return f(y(e,t))}return null}var N=n(128358);function A(e,t,n){e.contains(t)&&(!n||e.hasFocus()?(0,N.addRangeToSelection)(t):e.core.domEvent.selectionRange=t)}function D(e,t){if(e.node==t.node)return e.isAtEnd&&!t.isAtEnd||e.offset>t.offset;{const n=t.node.compareDocumentPosition(e.node);if(n&Node.DOCUMENT_POSITION_FOLLOWING)return!0;if(n&Node.DOCUMENT_POSITION_CONTAINS)return!!e.isAtEnd||(0,N.createRange)(e.node,0,e.node,e.offset).toString().length>=(0,N.createRange)(e.node,0,t.node,t.offset).toString().length}return!1}function Z(e,t,n){const i=new N.Position(t.startContainer,t.startOffset),r=new N.Position(t.endContainer,t.endOffset),o=v(e,i);if(!o)return;const s=new N.Position(o,-1);if(n(o,{positionStart:i,positionEnd:D(s,r)?r:s,isFirstSelected:!0,isLastSelected:!1}))return;const a=v(e,r);if(a!==o){let e=o.nextSibling;for(;e&&e!==a;){if(n(e))return;e=e.nextSibling}a&&n(a,{positionStart:new N.Position(a,0),positionEnd:r,isFirstSelected:!1,isLastSelected:!0})}}function M(e,t){const n=g(e);return t&&t.node===n&&t.offset>=0&&t.offset<n.childNodes.length?new N.Position(n.childNodes[t.offset],0):t}function O(e,t,n,i){const r=y(e,n),o=g(e);if(-2==i){let e=r?r.previousSibling:o.lastChild;for(;e&&!t(e);)e=null==e?void 0:e.previousSibling;return e}if(-3==i){let e=null==r?void 0:r.nextSibling;for(;e&&!t(e);)e=null==e?void 0:e.nextSibling;return e}return null}function F(e){for(;e.previousSibling;)if(a((e=e.previousSibling).textContent))return!1;return!0}function _(e,t){var n;if(e){let i=e.node;if(e.isAtEnd||!a(null===(n=i.textContent)||void 0===n?void 0:n.slice(e.offset))){for(;i&&(0,N.contains)(t,i)&&L(i);)i=i.parentNode;return i==t}}return!1}function L(e){for(;e.nextSibling;)if(a((e=e.nextSibling).textContent))return!1;return!0}function z(e){return null!=f(e)}function B(e,t,n){if(k(e,t))return{text:null,textStartPos:t,textEndPos:t};let i,r;-2===n?(i=V(e,t),r=t):-3===n?(i=t,r=U(e,t)):(i=V(e,t),r=U(e,t));return{text:a((0,N.createRange)(i,r).toString()),textStartPos:i,textEndPos:r}}function V(e,t){const n=O(e,z,t,-2);if(n)return new N.Position(n,-3);const i=g(e);return new N.Position(i,0)}function U(e,t){const n=O(e,z,t,-3);if(n)return new N.Position(n,-2);const i=g(e);return new N.Position(i,-1)}function q(e){return(null==e?void 0:e[0])===i?1:0}function W(e,t,n){var i;const r=g(e);let o=v(r,t);return o?t.node===r&&(t=new N.Position(o,n)):(o=null!==(i=r.lastChild)&&void 0!==i?i:r,t=new N.Position(o,-1)),{rootChild:o,cursorPos:t}}function H(e,t){let{rootChild:n,cursorPos:i}=W(e,t,0);if(n)if(function(e,t){var n;if(e){let{node:i,offset:r}=e;if(0===r||!a(null===(n=i.textContent)||void 0===n?void 0:n.slice(0,e.offset))){for(;(0,N.contains)(t,i)&&F(i);)i=i.parentNode;return i==t}}return!1}(i,n)){let e=n.previousSibling;if(e&&u(n)&&l(e.textContent)&&(e=e.previousSibling),e){const t=f(e);i=t?t.isReadonly?new N.Position(t.wrapper,0):function(e){var t,n;const i=null===(t=e.wrapper.querySelector(e.textSelector))||void 0===t?void 0:t.firstChild;if(i)return new N.Position(i,(null===(n=i.nodeValue)||void 0===n?void 0:n.length)||q(i.nodeValue))}(t)||i:function(e){var t;const n=e.nodeType===Node.TEXT_NODE?e:e.firstChild;if(n)return new N.Position(n,(null===(t=n.nodeValue)||void 0===t?void 0:t.length)||q(n.nodeValue))}(e)||i}}else i=(r=i).offset==q(r.node.textContent)?r:new N.Position(r.node,r.offset-1);var r;return i}function j(e,t){let{rootChild:n,cursorPos:i}=W(e,t,-1);if(n)if(_(i,n)){let e=n.nextSibling;if(l(null==e?void 0:e.textContent)&&(null==e?void 0:e.nextSibling)&&u(e.nextSibling)&&(e=e.nextSibling),e){const t=f(e);i=t?t.isReadonly?new N.Position(t.wrapper,-1):function(e){var t;const n=null===(t=e.wrapper.querySelector(e.textSelector))||void 0===t?void 0:t.firstChild;if(n)return new N.Position(n,q(n.nodeValue))}(t)||i:function(e){const t=e.nodeType===Node.TEXT_NODE?e:e.firstChild;if(t)return new N.Position(t,q(t.nodeValue))}(e)||i}}else i=(r=i).isAtEnd?r:new N.Position(r.node,r.offset+1);var r;return i}function G(){const e=document.createElement("span");return e.id="sentinel",e.textContent=i,e}function K(e){return(null==e?void 0:e.nodeType)==Node.ELEMENT_NODE&&"sentinel"==e.id}function X(e,t){const n=g(e),r=B(e,t),o=y(e,r.textStartPos);if(!o)return;const s=f(null!=r.text?o.previousSibling:o);if(s&&!s.isReadonly){const e=null==s?void 0:s.wrapper.nextSibling,t=null!=e?e:o;if(t)if(K(t))!function(e){var t;if(!K(e))return;const n=null===(t=e.textContent)||void 0===t?void 0:t.charAt(0);n&&n===i||(e.textContent=i+a(e.textContent))}(t);else{const e=G();n.insertBefore(e,t)}}}function $(e,t,n){var i,r,o,s;const a=e.getDocument().elementFromPoint(t,n);let l,c;if(a)l=O(e,K,new N.Position(a,0),-2),c=O(e,K,new N.Position(a,0),-3);else{const t=g(e);l=t.firstChild,c=t.lastChild}return t-(null!==(r=null===(i=null==l?void 0:l.getBoundingClientRect())||void 0===i?void 0:i.right)&&void 0!==r?r:0)<(null!==(s=null===(o=null==c?void 0:c.getBoundingClientRect())||void 0===o?void 0:o.left)&&void 0!==s?s:0)-t?l:c}},631125:(e,t,n)=>{"use strict";n.d(t,{b:()=>r,R:()=>o});var i=n(522343);function r(e){return(0,i.default)(e,"HTMLAnchorElement")}function o(e){return(0,i.default)(e,"HTMLElement")}},514327:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(989526),r=n(846413);const o=i.createContext(r.m)},10033:(e,t,n)=>{"use strict";n.d(t,{b:()=>a});var i=n(371134),r=n(846413);const o={zoomIncrementIndex:r.i.indexOf(r.m)},s=(0,i.MT)("zoomStore",o)();const a=()=>s},846413:(e,t,n)=>{"use strict";n.d(t,{m:()=>i,i:()=>r});const i=1,r=[.5,.75,i,1.25,1.5,2]},915401:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(10033),r=n(846413),o=n(55461);function s(){return(0,o.cr)("rp-embiggen")?r.i[(0,i.b)().zoomIncrementIndex]:r.m}},820263:(e,t,n)=>{"use strict";n.d(t,{Mf:()=>d,QP:()=>o,rp:()=>f,YA:()=>u,mw:()=>h,c:()=>p,NU:()=>m,cl:()=>l});var i=n(717420),r=n(846413);function o(e){if(e===r.m)return;return{transform:`scale(${e})`,transformOrigin:"top left",height:`calc(100% / ${e})`,width:`calc(100% / ${e})`}}var s=n(874191),a=n(915401);function l(){(0,s.y8)("EmbiggenZoomSetting",{zoomScale:(0,a.Z)()})}const c=new i.nI((()=>n.e(70529).then(n.bind(n,170529)))),d=(0,i.$y)(c,(e=>e.ZoomButtons)),u=new i._5(c,(e=>e.overrideCustomZoomToDefault)),p=new i._5(c,(e=>e.overrideCustomZoomToDefaultScrollbar)),m=new i._5(c,(e=>e.overrideCustomZoomToDefaultSideMargins)),h=new i._5(c,(e=>e.overrideCustomZoomToDefaultInfoBar)),f=new i._5(c,(e=>e.getZoomSubMenu))},962726:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(989526),r=n(392414),o=n(79810),s=n(199052),a=n(180955);const l=i.forwardRef((function(e,t){i.useEffect((()=>()=>{n.onUnmount()}),[]);const n=(0,a.B)((()=>new r.S(e))),l=(0,a.B)((()=>new o.U(e)));return i.useImperativeHandle(t,(()=>({getDiv:()=>n.getDiv()})),[]),s.T?i.createElement("div",{draggable:!e.isDraggable||e.isDraggable(),className:e.classNames,ref:n.refCallback,onDragStart:n.onDragStart,onDragEnd:n.onDragEnd,onDrop:l.onDrop,onDragOver:l.onDragOver,onDragEnter:l.onDragEnter,onDragLeave:l.onDragLeave},e.children):i.createElement("div",{className:e.classNames,ref:n.refCallback,onDragEnd:n.onDragEnd,onDrop:l.onDrop,onDragOver:l.onDragOver,onDragEnter:l.onDragEnter,onDragLeave:l.onDragLeave},e.children)}))},392414:(e,t,n)=>{"use strict";n.d(t,{S:()=>u,Z:()=>p});var i=n(989526);const r=(0,n(371134).lr)("setDragState",(function(e,t){e.isBeingDragged=t}));var o=n(147255),s=n(199052),a=n(382717),l=n(448259),c=n(688002),d=n(180955);class u{constructor(e){this.props=e,this.initialPageX=0,this.initialPageY=0,this.dragHelperElement=null,this.isPotentialDrag=!1,this.isDragging=!1,this.onDragStart=e=>{e.dataTransfer.clearData(),this.isDragAllowed()?(e.stopPropagation(),this.setDragStateAndData(e),e.dataTransfer.effectAllowed="copyMove",this.onDragStartInternal(e.pageX,e.pageY),this.overrideDefaultDragPreviewImage(e.dataTransfer)):this.props.showDefaultNoDragImage&&(this.overrideDefaultNoDragImage(e.dataTransfer),e.dataTransfer.setData("text","nodrop"),e.dataTransfer.effectAllowed="none")},this.onDragEnd=e=>{if(this.isDragging){this.isDragging=!1;const{onDragEnd:t}=this.props,n=e?e.dataTransfer.dropEffect:null;t&&t(this.props.getDragData(),n)}this.resetDragStateAndData(),this.removeDragHelperElement()},this.onMouseDown=e=>{!s.T&&0==e.button&&this.isDragAllowed()&&(this.initialPageX=e.pageX,this.initialPageY=e.pageY,this.isPotentialDrag=!0,document.body.addEventListener("mousemove",this.onMouseMove),document.body.addEventListener("mouseup",this.onMouseUp)),this.props.onMouseDown&&this.props.onMouseDown(e)},this.refCallback=e=>{var t,n;null===(t=this.div)||void 0===t||t.removeEventListener("mousedown",this.onMouseDown),this.div=e,null===(n=this.div)||void 0===n||n.addEventListener("mousedown",this.onMouseDown)},this.onMouseMove=e=>{const t=e.pageX,n=e.pageY;(Math.abs(this.initialPageX-t)>=s.h||Math.abs(this.initialPageY-n)>=s.h)&&(this.removeMouseMoveAndUpEventListeners(),this.isPotentialDrag&&(this.isPotentialDrag=!1,this.isDragAllowed()&&(this.dragHelperElement=this.getDragHelperElement(),document.body.appendChild(this.dragHelperElement))),this.dragHelperElement&&(this.dragHelperElement.addEventListener("dragstart",(e=>{this.onDragStartHelperElement(e)})),this.dragHelperElement.addEventListener("dragend",(e=>{this.onDragEnd(e)})),this.dragHelperElement.dragDrop(),setTimeout(this.onDragEnd,0)))},this.onMouseUp=()=>{this.removeMouseMoveAndUpEventListeners()},this.onDragStartHelperElement=e=>{const t=e;t.stopPropagation(),t.dataTransfer.effectAllowed="copyMove",this.setDragStateAndData(t),this.onDragStartInternal(t.pageX,t.pageY)},this.removeMouseMoveAndUpEventListeners=()=>{document.body.removeEventListener("mousemove",this.onMouseMove),document.body.removeEventListener("mouseup",this.onMouseUp)},this.removeDragHelperElement=()=>{if(document.body)document.body.contains(this.dragHelperElement)&&(document.body.removeChild(this.dragHelperElement),this.dragHelperElement=null);else{const e=this.dragHelperElement?this.dragHelperElement.innerHTML:"null";l.rx("removeDragHelperElement: "+e)}}}updateProps(e){this.props=e}onUnmount(){var e;this.onDragEnd(null),s.T||this.removeMouseMoveAndUpEventListeners(),null===(e=this.div)||void 0===e||e.removeEventListener("mousedown",this.onMouseDown)}getDiv(){return this.div}onDragStartInternal(e,t){this.isDragging=!0;const{onDragStart:n}=this.props;n&&n(this.props.getDragData(),e,t)}setDragStateAndData(e){const{dragViewState:t}=this.props;t&&r(this.props.dragViewState,!0);const n=this.props.getDragData();try{e.dataTransfer.setData(n.itemType,JSON.stringify(n))}catch(t){e.dataTransfer.setData("text",JSON.stringify(n))}(0,o.qR)(n.itemType,n.itemData)}resetDragStateAndData(){const{dragViewState:e}=this.props;e&&r(this.props.dragViewState,!1),(0,o.qR)(null,null)}overrideDefaultDragPreviewImage(e){if(s.T){this.dragHelperElement=this.getDragHelperElement(),document.body.appendChild(this.dragHelperElement);const t=this.props.xOffset?this.props.xOffset:0,n=this.props.yOffset?this.props.yOffset:0;e.setDragImage(this.dragHelperElement,t,n)}}overrideDefaultNoDragImage(e){s.T&&(this.dragHelperElement=document.createElement("div"),this.dragHelperElement.style.display="none",document.body.appendChild(this.dragHelperElement),e.setDragImage(this.dragHelperElement,0,0))}getDragHelperElement(){const e=this.props.getDragPreview(this.props.getDragData());return e.style.zIndex="-1000",(0,a.Fo)()?(e.style.width="fit-content",e.style.height="fit-content"):(e.style.top="0px",e.style.left="0px",e.style.position="fixed"),e}isDragAllowed(){return!this.props.canDrag||this.props.canDrag()}}const p=i.forwardRef((function(e,t){i.useEffect((()=>()=>{n.onUnmount()}),[]);const n=(0,d.B)((()=>new u(e)));return n.updateProps(e),i.useImperativeHandle(t,(()=>({getDiv:()=>n.getDiv()})),[]),s.T?i.createElement("div",Object.assign({draggable:!e.isDraggable||e.isDraggable()},(0,c.WO)(e.ariaProps),{className:e.classNames,ref:n.refCallback,onDragStart:n.onDragStart,onDragEnd:n.onDragEnd}),e.children):i.createElement("div",Object.assign({className:e.classNames,ref:n.refCallback},(0,c.WO)(e.ariaProps)),e.children)}))},79810:(e,t,n)=>{"use strict";n.d(t,{U:()=>c,Z:()=>Droppable});var i=n(989526),r=n(937118);const o=(0,n(371134).lr)("setDropState",(function(e,t,n){e.isDragOver=t,e.draggableItemType=n}));var s=n(147255);const a="nothing",l="application/x-moz-file";class c{constructor(e){this.props=e,this.onDragEnter=e=>{e.preventDefault(),this.props.preventBubblingDragEvents&&e.stopPropagation();const t=this.getDragData(e);this.props.onDragEnter&&this.props.onDragEnter(t)},this.onDragLeave=e=>{if(this.props.preventBubblingDragEvents&&e.stopPropagation(),this.props.greedy&&!this.isReallyLeavingDroppable(e))return;let t=this.props.dropViewState.draggableItemType;t||(t=this.getDragType(e));const n={itemType:t,itemData:(0,s.MV)()};if("none"==this.getDesiredDropEffect(n))return;const i=t=>()=>{this.props.onDragLeave&&this.props.onDragLeave(t,e.currentTarget),o(this.props.dropViewState,!1,null),this.pendingDragLeaveHandler=null};this.props.shouldIgnoreTransientOnDragLeave?this.pendingDragLeaveHandler||(e.persist(),this.pendingDragLeaveHandler=setTimeout(i(n),50)):i(n)()},this.onDragOver=e=>{this.props.preventBubblingDragEvents&&e.stopPropagation();let t=this.props.dropViewState.draggableItemType;t||(t=this.getDragType(e));const n={itemType:t,itemData:(0,s.MV)()},i=this.getDesiredDropEffect(n);"none"!=i?(this.props.bypassActOnDrop||(e.preventDefault(),this.setDropEffectInternal(e,i)),this.props.shouldUseCopyAsDropEffect&&this.setDropEffectInternal(e,"copy"),this.props.onDragOver&&this.props.onDragOver(n,e.pageX,e.pageY,e.currentTarget),this.cancelPendingDragLeaveHandler(),this.props.dropViewState.isDragOver&&this.props.dropViewState.draggableItemType==t||o(this.props.dropViewState,!0,t)):this.props.bypassActOnDrop||this.setDropEffectInternal(e,"none")},this.onDrop=e=>{this.props.preventBubblingDragEvents&&e.stopPropagation();const t=this.getDragData(e);(null==t?void 0:t.itemType)!=a&&e.preventDefault(),"none"!=this.getDesiredDropEffect(t)&&(this.props.onDrop(t,e.pageX,e.pageY,e.currentTarget),this.props.onDragLeave&&this.props.onDragLeave(t,e.currentTarget),this.cancelPendingDragLeaveHandler(),(0,s.qR)(null,null),o(this.props.dropViewState,!1,null))},this.refCallback=e=>{this.div=e}}getDiv(){return this.div}cancelPendingDragLeaveHandler(){this.pendingDragLeaveHandler&&(clearTimeout(this.pendingDragLeaveHandler),this.pendingDragLeaveHandler=null)}isReallyLeavingDroppable(e){const t=document.elementFromPoint(e.pageX,e.pageY);return!this.isDescendantOrSelf(t,e.currentTarget)}isDescendantOrSelf(e,t){if(!e||!t)return!1;if(e==t)return!0;for(var n=e;n=n.parentElement;)if(n==t)return!0;return!1}getDesiredDropEffect(e){return e?this.props.canDrop?"boolean"==typeof this.props.canDrop(e)?this.props.canDrop(e)?"move":"none":this.props.canDrop(e):"move":"none"}getDragData(e){let t=null;if(e.dataTransfer.files&&e.dataTransfer.files.length>0&&(e.dataTransfer.types.includes(l)||1===e.dataTransfer.types.length))i=e.dataTransfer.files,t={itemType:r.X.LocalFile,files:i};else{const i=e.dataTransfer.types;let r=null,o=!1;for(var n=0;n<i.length;n++){const t=i[n];if("text"!=t){r=e.dataTransfer.getData(t),o=!0;break}}o||(r=e.dataTransfer.getData("text"));try{t=JSON.parse(r)}catch(e){t={itemType:a}}}var i;return t}getDragType(e){let t=(0,s.GK)();const n=e.dataTransfer?e.dataTransfer:e.nativeEvent.dataTransfer;if(!t&&n&&n.types&&n.types.length>0&&(n.types.includes(l)||1===n.types.length)){const n=Array.prototype.slice.apply(e.dataTransfer.types),i=Object.values(r.X),o=n.filter((e=>i.indexOf(e)>=0));o.length>0&&(t=o[0])}return t}setDropEffectInternal(e,t){e.dataTransfer&&(e.dataTransfer.dropEffect=t)}}const Droppable=i.forwardRef((function(e,t){const n=i.useRef(new c(e));return i.useImperativeHandle(t,(()=>({getDiv:()=>n.current.getDiv()})),[]),i.createElement("div",{ref:n.current.refCallback,className:e.classNames,style:e.style,onDrop:n.current.onDrop,onDragOver:n.current.onDragOver,onDragEnter:n.current.onDragEnter,onDragLeave:n.current.onDragLeave},e.children)}))},937118:(e,t,n)=>{"use strict";n.d(t,{X:()=>i});const i={FavoriteNode:"favoritenode",InboxRule:"inboxrule",MessageRule:"messagerule",LocalFile:"Files",MailFolderNode:"mailfoldernode",MailListItemPart:"maillistitempart",MailListRow:"maillistrow",MultiMailListConversationRows:"multimaillistconversationrows",MultiMailListMessageRows:"multimaillistmessagerows",ReadWriteRecipient:"recipient",RibbonCustomizerButton:"ribboncustomizerbutton",NoteFeedItem:"notefeeditem",Todo:"todo",Attachment:"attachment",CommandBarEditorButton:"commandbareditorbutton",CalendarNode:"calendarnode",CalendarGroupNode:"calendargroupnode",CalendarItem:"calendaritem",GroupFolderNode:"groupfoldernode",EventifyEventGroupItem:"eventifyeventgroupitem",SharePointFile:"sharepointfile"}},199052:(e,t,n)=>{"use strict";n.d(t,{h:()=>i,T:()=>r});const i=5,r="undefined"!=typeof window&&window.hasOwnProperty("DataTransfer")&&DataTransfer.prototype.setDragImage},178336:(e,t,n)=>{"use strict";function i(){return{isDragOver:!1,draggableItemType:null}}n.d(t,{Z:()=>i})},147255:(e,t,n)=>{"use strict";let i,r;function o(e,t){i=e,r=t}function s(){return i}function a(){return r}n.d(t,{qR:()=>o,GK:()=>s,MV:()=>a})},215375:(e,t,n)=>{"use strict";n.d(t,{p7:()=>o,IY:()=>s,go:()=>a});var i=n(717420);const r=new i.nI((()=>n.e(13192).then(n.bind(n,513192)))),o=(0,i.$y)(r,(e=>e.AccCheckerPane)),s=new i.EF(r,(e=>e.openChecker)),a=new i.EF(r,(e=>e.closeChecker))},756203:(e,t,n)=>{"use strict";n.d(t,{fL:()=>s,TB:()=>a});var i=n(717420),r=n(126573);const o=new i.nI((()=>Promise.all([n.e(72760),n.e(28358),n.e(29810)]).then(n.bind(n,429810)))),s=((0,i.$y)(o,(e=>e.AnnouncedComponent)),new i.EF(o,(e=>e.getAllFeatures))),a=(0,r.Z)(o,(e=>e.AccessibilityPlugin),"Accessibility",(function(e){return 11==e.eventType}))},960069:(e,t,n)=>{"use strict";n.d(t,{B:()=>l,t:()=>o});var i=n(717420),r=n(126573);function o(e){return{toRecipients:s(e[0]),ccRecipients:s(e[1]),bccRecipients:s(e[2])}}function s(e){return(null==e?void 0:e.recipients)?e.recipients.map((e=>e.persona.EmailAddress)):[]}const a=new i.nI((()=>Promise.all([n.e(52637),n.e(32557),n.e(64826),n.e(72760),n.e(28358),n.e(63816),n.e(48139),n.e(95397),n.e(63684),n.e(63673),n.e(60156),n.e(82502),n.e(78836),n.e(37716),n.e(36087),n.e(40179),n.e(11677),n.e(52922),n.e(24568),n.e(70012)]).then(n.bind(n,22495)))),l=(0,r.Z)(a,(e=>e.default),"AugLoop")},119672:(e,t,n)=>{"use strict";var i;n.d(t,{F:()=>i}),function(e){e[e.Mail=0]="Mail",e[e.CalendarFull=1]="CalendarFull"}(i||(i={}))},58515:(e,t,n)=>{"use strict";n.d(t,{E:()=>r});const i=(0,n(371134).MT)("dictationStore",{isDictationOn:!1,currentLanguage:"",languagePickerDropDown:[]})(),r=()=>i},992810:(e,t,n)=>{"use strict";n.d(t,{c:()=>r,Z:()=>o});var i=n(22046);const r="_ToggleDictationSource";function o(e){(0,i.G)(e,"triggerContentChangedEvent",r)}},803571:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var i=n(92894),r=n(371134);(0,r.lr)("updateDocking",((e,t,n,i,r,o)=>{e.isBottomDocking=t,e.dockingWidth=r,e.scrollLeft=n,e.scrollBarHeight=i,e.bottomDockingBottom=o}));const o=(0,r.lr)("updateStickyDocking",((e,t,n,i)=>{e.isTopDocking=t,e.isBottomDocking=n,e.dockingWidth=i}));var s=n(972288),a=n(833824),l=n(256548),c=n(989526);const d=(0,i.Pi)((function(e){const{editorViewState:t,dockingViewState:n,isBottom:i,scrollContainerSelector:r,className:d}=e,u=c.useRef(null),p=c.useRef(null),m=c.useRef(!1);c.useEffect((()=>(h(),()=>{h()})),[]);const h=()=>{const e=i?r&&u.current?u.current.closest(r):(0,s.Z)(t):void 0;!u.current||i&&!e?p.current&&(p.current.disconnect(),p.current=null):(p.current||(p.current=new IntersectionObserver((e=>{var r;if(e[0]){const s=1!=e[0].intersectionRatio,c=(0,l.Z)(null===(r=u.current)||void 0===r?void 0:r.ownerDocument,n,"DockingTriggerPart"),d=!i&&n.isTopDocking!=s,p=i&&n.isBottomDocking!=s;(d||p)&&o(n,d?s:n.isTopDocking,p?s:n.isBottomDocking,c?c.offsetWidth:n.dockingWidth),s&&!m.current&&(0,a.Z)(t,n),m.current=!0}}),{rootMargin:"0px",threshold:[1],root:i?e:null})),p.current.observe(u.current))};return c.createElement("div",{className:d,ref:e=>{u.current=e}})}))},598211:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(72760),n.e(28358),n.e(33777)]).then(n.bind(n,733777)))),o=new i.EF(r,(e=>e.scrollCursorIntoView));var s=n(476674);const a=[16,17,18,20,44,94,144,255];class l{constructor(e,t,n,i){this.adapter=e,this.editorAdapter=t,this.getBottomDockingHeight=n,this.getTopDockingHeight=i}getName(){return"Docking"}initialize(e){this.editor=e,this.viewState=(0,s.Z)(this.adapter),this.viewState&&o.import().then((e=>this.scrollCursorIntoViewFunc=e))}dispose(){this.editor=null,this.viewState=void 0}onPluginEvent(e){var t,n,i;((2==e.eventType||1==e.eventType)&&-1==a.indexOf(e.rawEvent.which)||7==e.eventType&&"SetContent"!=e.source)&&((null===(t=this.viewState)||void 0===t?void 0:t.isTopDocking)||(null===(n=this.viewState)||void 0===n?void 0:n.isBottomDocking))&&(null===(i=this.scrollCursorIntoViewFunc)||void 0===i||i.call(this,this.editor,this.viewState,this.getTopDockingHeight,this.getBottomDockingHeight))}}},256548:(e,t,n)=>{"use strict";function i(e,t,n){const i=r(t,n);return i&&e?e.getElementById(i):null}function r(e,t){return`docking_${t}_${e.dockingId}`}n.d(t,{Z:()=>i,k:()=>r})},833824:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(972288),r=n(256548);function o(e,t){const n=(0,i.Z)(e),o=(0,r.Z)(null==n?void 0:n.ownerDocument,t,"InitVisiblePart");if(n&&o){const e=n.getBoundingClientRect(),t=o.getBoundingClientRect();t.bottom>e.bottom&&(n.scrollTop+=t.bottom-e.bottom),t.top<e.top&&(n.scrollTop+=t.top-e.top)}}},165379:(e,t,n)=>{"use strict";n.d(t,{jB:()=>i,BA:()=>r,aS:()=>o,MD:()=>s,mb:()=>a,Hb:()=>l});const i="Emoji",r="EmojiPicker",o=":",s="emojiPickerSuggestions",a="emojiPickerSuggestion-",l=6},32281:(e,t,n)=>{"use strict";n.d(t,{R:()=>a});var i=n(165379);var r=n(717420),o=n(126573);const s=new r.nI((()=>Promise.all([n.e(72760),n.e(28358),n.e(63816),n.e(90908),n.e(4107),n.e(47241),n.e(80702)]).then(n.bind(n,780702)))),a=(0,o.Z)(s,(e=>e.EmojiPickerPlugin),"EmojiPicker",(function(e){if(1===e.eventType){return e.rawEvent.key==i.aS}return!1}))},180747:(e,t,n)=>{"use strict";n.d(t,{dK:()=>l,y8:()=>s,_u:()=>o._});var i=n(717420),r=n(126573);var o=n(508343);function s(){return{hasAttachmentTriggerWords:!1,attachmentKeywordsDetectedBeforeUserInput:null}}const a=new i.nI((()=>n.e(78276).then(n.bind(n,578276)))),l=(0,r.Z)(a,(e=>e.ForgottenAttachmentsPlugin),"ForgottenAttachments",(function(e){return 11===e.eventType||7===e.eventType||8===e.eventType}),!0)},508343:(e,t,n)=>{"use strict";n.d(t,{_:()=>o});var i=n(101060);var r=n(448259);function o(e){const t=((0,i.ZP)("Hhe")||"").split(",").concat(((0,i.ZP)("Ihe")||"").split(",")).filter((e=>""!==e));return n=e,t.reduce(((e,t)=>{const i=`(^|\\s)${t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(\\s|$)`;try{const t=new RegExp(i,"gi");e+=(n.match(t)||[]).length}catch(e){r.rx(`[ForgottenAttachments] Error parsing regex when counting trigger words. Regex: ${i}`,e)}return e}),0);var n}},990960:(e,t,n)=>{"use strict";n.d(t,{UT:()=>s,ND:()=>a,Rx:()=>l,C1:()=>c});var i=n(126573),r=n(717420);const o=new r.nI((()=>Promise.all([n.e(72760),n.e(28358),n.e(15422),n.e(50234)]).then(n.bind(n,250234)))),s=(0,i.Z)(o,(e=>e.InlineImagePlugin),"InlineImageV2",(e=>11==e.eventType)),a=new r.EF(o,(e=>e.insertInlineImages)),l=new r.EF(o,(e=>e.createObjectUrlsAsTempId)),c=new r.EF(o,(e=>e.insertInlineImageFromAttachmentWell))},384512:(e,t,n)=>{"use strict";n.d(t,{MM:()=>s,jt:()=>a,$B:()=>l,Hq:()=>c,le:()=>d,GB:()=>u,xV:()=>p,Tn:()=>m,ld:()=>h,rl:()=>f,El:()=>g,v9:()=>v,jS:()=>y,Tq:()=>S});var i=n(126573),r=n(717420);const o=new r.nI((()=>Promise.all([n.e(52637),n.e(32557),n.e(19280),n.e(33615),n.e(17483),n.e(69390),n.e(11102),n.e(56841),n.e(9152),n.e(90885),n.e(3128),n.e(45156),n.e(45961),n.e(8631),n.e(94109)]).then(n.bind(n,601660)))),s=(0,i.Z)(o,(e=>e.ContentEdit),"ContentEdit",b),a=(0,i.Z)(o,(e=>e.HyperLink),"HyperLink",b),l=(0,i.Z)(o,(e=>e.Paste),"Paste",b),c=(0,i.Z)(o,(e=>e.TableResize),"TableResize",b),d=(0,i.Z)(o,(e=>e.OwaWatermark),"Watermark",b),u=(0,i.Z)(o,(e=>e.OwaImageEdit),"ImageEdit",b),p=(0,i.Z)(o,(e=>e.OwaContextMenu),"ContextMenu",b),m=(0,i.Z)(o,(e=>e.OwaCustomReplace),"CustomReplace",b),h=(0,i.Z)(o,(e=>e.CutPasteListChain),"CutPasteListChain",b),f=(0,i.Z)(o,(e=>e.ListEdit),"ListEdit"),g=(0,i.Z)(o,(e=>e.TableCellSelection),"TableCellSelection",b),v=new r._5(o,(e=>e.addMonarchShortcuts)),y=(0,i.Z)(o,(e=>e.CopyCutPasteTelemetry),"CopyCutPasteTelemetry",b),S=(0,i.Z)(o,(e=>e.AutoFormat),"AutoFormat",b);function b(e){return 11==e.eventType}},126573:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(717420);function r(e,t,n,r,o){return class{constructor(...e){this.onImportedCallbacks=[],this.args=e,this.pluginName=n}initialize(e){this.editor=e,this.pendingEvents=[],this.pluginInstance?this.initializeAndCallback():r||this.internalImport()}dispose(){this.pluginInstance&&(this.pluginInstance.dispose(),o||(this.pluginInstance=null)),this.editor=null,this.importPluginPromise=null,this.onImportedCallbacks=[]}getName(){return this.isImported()?this.pluginInstance.getName():this.pluginName}getContextMenuItems(e){var t,n;return this.isImported()?null===(n=(t=this.pluginInstance).getContextMenuItems)||void 0===n?void 0:n.call(t,e):null}onPluginEvent(e){if(this.pluginInstance)this.pluginInstance.onPluginEvent&&this.pluginInstance.onPluginEvent(e);else if(null==r?void 0:r(e,this.editor))return this.internalImport(e)}willHandleEventExclusively(e){return!(!this.pluginInstance||!this.pluginInstance.willHandleEventExclusively)&&this.pluginInstance.willHandleEventExclusively(e)}getPlugin(){return this.pluginInstance?Promise.resolve(this.pluginInstance):this.internalImport()}isImported(){return!!this.pluginInstance}addOnImportedCallback(e){this.isImported()&&this.editor?e(this.pluginInstance):this.onImportedCallbacks&&this.onImportedCallbacks.push(e)}initializeAndCallback(){this.pluginInstance.initialize(this.editor),this.onImportedCallbacks.forEach((e=>e(this.pluginInstance)))}internalImport(n){return this.importPluginPromise||(this.importPluginPromise=new i.EF(e,t).import().then((e=>(this.pluginInstance=new e(...this.args),this.editor&&(this.initializeAndCallback(),this.pendingEvents.length>0&&this.pluginInstance.onPluginEvent&&this.pendingEvents.forEach((e=>{this.pluginInstance.onPluginEvent(e)})),this.pendingEvents=[]),this.pluginInstance))),this.importPluginPromise.catch((()=>{this.pendingEvents=[]}))),n&&this.pendingEvents.push(n),this.importPluginPromise}}}},82180:(e,t,n)=>{"use strict";n.d(t,{Q:()=>s});var i=n(717420),r=n(126573);const o=new i.nI((()=>n.e(62462).then(n.bind(n,462462)))),s=(0,r.Z)(o,(e=>e.LoremPlugin),"Lorem",(e=>1===e.eventType&&"="==e.rawEvent.key))},172845:(e,t,n)=>{"use strict";n.d(t,{F:()=>a,R:()=>o.Z});var i=n(126573),r=n(717420),o=n(45352);const s=new r.nI((()=>Promise.all([n.e(72760),n.e(28358),n.e(63816),n.e(90908),n.e(545),n.e(68452)]).then(n.bind(n,868452)))),a=(0,i.Z)(s,(e=>e.AtMentionPickerPlugin),"AtMentionsPicker",(e=>11==e.eventType))},45352:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(934371);function r(){return i.Z.mentions}},894490:(e,t,n)=>{"use strict";n.d(t,{x:()=>o});var i=n(126573);const r=new(n(717420).nI)((()=>n.e(33388).then(n.bind(n,933388)))),o=(0,i.Z)(r,(e=>e.PasteFilesPlugin),"PasteFiles",(e=>11===e.eventType))},527192:(e,t,n)=>{"use strict";n.d(t,{g:()=>s,u:()=>r});var i=n(126573);function r(){return{position:null,subMenuSelectionIndex:-1}}const o=new(n(717420).nI)((()=>Promise.all([n.e(72760),n.e(28358),n.e(22013)]).then(n.bind(n,656018)))),s=(0,i.Z)(o,(e=>e.PasteOptionPlugin),"PasteOption",(function(e){return 7===e.eventType&&"Paste"==e.source}))},868670:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).lr)("Picker_setIsSuggesting",((e,t)=>{e.isSuggesting=t}))},56909:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).lr)("Picker_SetTargetPoint",((e,t,n)=>{e.targetPoint=t,e.bufferZone=n}))},8130:(e,t,n)=>{"use strict";function i(){return{isSuggesting:!1,bufferZone:0,targetPoint:null}}n.d(t,{Z:()=>i})},581842:(e,t,n)=>{"use strict";function i(e,t){var n;null===(n=e.querySelector(t))||void 0===n||n.scrollIntoView({block:"nearest",inline:"nearest"})}n.d(t,{Z:()=>i})},442646:(e,t,n)=>{"use strict";n.d(t,{qv:()=>r,ac:()=>o,yN:()=>l,Vz:()=>c});var i=n(522343);const r="ctxMenu",o="ctxMenuSelectedImage",s=`img[${r}="${o}"]`,a=e=>e.queryElements(s),l=(e,t)=>()=>{var n,r;if(t.contains(e))return e;const o=a(t);return null!==(r=null!==(n=o.find((({src:t})=>(0,i.default)(e,"HTMLImageElement")&&t===e.src)))&&void 0!==n?n:o[0])&&void 0!==r?r:e},c=e=>{const t=a(e);return t.forEach((e=>e.removeAttribute(r))),t}},987648:(e,t,n)=>{"use strict";n.d(t,{V:()=>r});const i=Object.keys({virtualEdit:null,docking:null,dictation:null,ribbon:null,spellcheckPlugin:null,inlineImageV2:null,pasteFiles:null,tableEdit:null,smartSuggestions:null,linkPreview:null,pasteOption:null,link:null,mentionsPicker:null,topicPicker:null,emojiPicker:null,fluid:null,proofing:null,augLoop:null,forgottenAttachments:null,referenceAttachment:null,oa:null,sonoraMentions:null,messageExtensionCard:null,loremIpsum:null,accessibility:null,mailRibbon:null,autoFormatSettings:null});function r(e,...t){const n=Object.keys(e),r=i.filter((e=>n.indexOf(e)>=0)).map((t=>e[t])).filter((e=>!!e));return t&&Array.prototype.push.apply(r,t),r}},444377:(e,t,n)=>{"use strict";n.d(t,{g:()=>s,r:()=>r.Z});var i=n(717420),r=n(362051);const o=new i.nI((()=>n.e(80300).then(n.bind(n,880300)))),s=new i.EF(o,(e=>e.showEditorSettings))},321670:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).lr)("updateEditorPaneTelemetry",((e,t,n)=>{const{EditorPane:i}=e.sessionTelemetry;i[t]=n}))},8106:(e,t,n)=>{"use strict";n.d(t,{GJ:()=>r,XC:()=>o,Mz:()=>s,Ou:()=>a,HE:()=>l});var i=n(55461);function r(){return(0,i.cr)("mc-officeEditorDexLitePane")||c()}function o(){return(0,i.cr)("mc-editorIndicator")||c()}function s(){return(0,i.cr)("mc-defaultSettingsNoRefinements")||c()}function a(){return(0,i.cr)("mc-officeEditorSharedSettings")||c()}function l(){return(0,i.cr)("mc-officeEditorPaneSettingsUX")||c()}function c(){return(0,i.cr)("mc-dexPaneFeatures")&&(0,i.cr)("mc-proofingUserEditOnly")}},362051:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(55461),r=n(382717);function o(){return!!(0,i.cr)("mc-officeEditorProofingMasterFlight")&&((0,r.yp)()||(0,r.nb)()||(0,i.cr)("mc-officeEditorBXFirefoxSafari")&&((0,r.o2)()||(0,r.Fo)()))}},777391:(e,t,n)=>{"use strict";n.d(t,{B:()=>i,Z:()=>r});let i="";function r(e){i=e}},429461:(e,t,n)=>{"use strict";n.d(t,{D:()=>o,w:()=>s});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(52637),n.e(39006),n.e(18838),n.e(16025),n.e(52772),n.e(82502),n.e(78836),n.e(24568),n.e(30792),n.e(683)]).then(n.bind(n,946057)))),o=(0,i.$y)(r,(e=>e.DexPaneWrapper)),s=new i._5(r,(e=>e.closeDexPane))},793773:(e,t,n)=>{"use strict";n.d(t,{$N:()=>s,lS:()=>a,Wk:()=>l,LW:()=>c,Am:()=>d});var i=n(717420),r=n(126573);const o=new i.nI((()=>Promise.all([n.e(52637),n.e(32557),n.e(56337),n.e(9598),n.e(42106),n.e(36856),n.e(64826),n.e(72760),n.e(28358),n.e(63816),n.e(48139),n.e(7402),n.e(95397),n.e(63684),n.e(63673),n.e(60156),n.e(82502),n.e(78836),n.e(37716),n.e(87511)]).then(n.bind(n,653213)))),s=(0,r.Z)(o,(e=>e.ProofingPlugin),"Proofing",(function(e){return 2===e.eventType||6===e.eventType||7===e.eventType})),a=new i.EF(o,(e=>e.getEditorBxClient)),l=(0,i.$y)(o,(e=>e.ProofingTeachingCallout)),c=(0,i.$y)(o,(e=>e.EditorSkittle)),d=new i._5(o,(e=>e.getEditorContextMenuItems))},975671:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(117648),r=n(444377),o=n(448165);class s{getName(){return"spellcheckPlugin"}initialize(e){this.editor=e,(0,r.r)()&&(0,i.Z)((e=>{var t;(0,o.i)(null==e?void 0:e.proofingLocale)&&((null==e?void 0:e.spellCheckEnabled)||(null==e?void 0:e.grammarEnabled))&&(null===(t=this.editor)||void 0===t||t.setEditorDomAttribute("spellCheck","false"))}))}dispose(){this.editor=null}}},309256:(e,t,n)=>{"use strict";n.d(t,{b:()=>s});var i=n(717420),r=n(126573);const o=new i.nI((()=>Promise.all([n.e(72760),n.e(28358),n.e(46688),n.e(14773),n.e(45087),n.e(37330),n.e(47877),n.e(49792),n.e(95994),n.e(22107),n.e(92373)]).then(n.bind(n,667054)))),s=(0,r.Z)(o,(e=>e.ReferenceAttachmentPlugin),"ReferenceAttachment",(function(e){return 7===e.eventType||11===e.eventType||8===e.eventType}),!0)},340426:(e,t,n)=>{"use strict";n.d(t,{Z2:()=>o,_3:()=>s,xp:()=>a,Av:()=>l,ik:()=>c,K6:()=>d,nL:()=>u,pX:()=>p,FD:()=>m,SN:()=>h});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(25671),n.e(52637),n.e(56337),n.e(42106),n.e(62600),n.e(72760),n.e(28358),n.e(52772),n.e(7181),n.e(33995),n.e(87694),n.e(82120),n.e(3295)]).then(n.bind(n,785765)))),o=(0,i.$y)(r,(e=>e.TextColorPicker)),s=(0,i.$y)(r,(e=>e.BackColorPicker)),a=(0,i.$y)(r,(e=>e.FontPicker)),l=(0,i.$y)(r,(e=>e.FontNamePicker)),c=(0,i.$y)(r,(e=>e.FontSizePicker)),d=(0,i.$y)(r,(e=>e.CasePicker)),u=(0,i.$y)(r,(e=>e.InsertTableCallout)),p=new i.EF(r,(e=>e.displayInsertLinkDialog)),m=new i.EF(r,(e=>e.showImageAltTextDialog)),h=new i.EF(r,(e=>e.showCustomizedColorPickerDialog))},369037:(e,t,n)=>{"use strict";n.d(t,{t3:()=>s,NO:()=>a,xB:()=>l});var i=n(717420),r=n(126573);const o=new i.nI((()=>Promise.all([n.e(13595),n.e(6612)]).then(n.bind(n,906612)))),s=new i.EF(o,(e=>e.updateRibbonData)),a=new i.EF(o,(e=>e.clearContextualTabs)),l=(0,r.Z)(o,(e=>e.MailRibbonPlugin),"MailRibbon",(function(e){return 11===e.eventType}))},321907:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).lr)("setContextualFormatBarTarget",((e,t)=>{e.targetPoint=t}))},576421:(e,t,n)=>{"use strict";n.d(t,{TI:()=>o,h9:()=>s,NA:()=>a,wY:()=>l,Rk:()=>c,qP:()=>d,O2:()=>u});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(72760),n.e(28358),n.e(63816),n.e(75126)]).then(n.bind(n,788073)))),o=new i._5(r,(e=>e.updateRibbonWidth)),s=new i._5(r,(e=>e.setLastTextColor)),a=new i._5(r,(e=>e.setLastBackColor)),l=new i._5(r,(e=>e.setLastCellShadeColor)),c=new i._5(r,(e=>e.toggleFormatPainter)),d=new i._5(r,(e=>e.updateRibbonState)),u=new i._5(r,(e=>e.updateSecondClassState));new i._5(r,(e=>e.setButtonWidths))},388171:(e,t,n)=>{"use strict";n.d(t,{Vy:()=>a,$x:()=>l,ox:()=>c,DQ:()=>d,m3:()=>u,ju:()=>r.j,Q:()=>o.Q});var i=n(717420),r=n(886309),o=n(201392);const s=new i.nI((()=>Promise.all([n.e(52637),n.e(32557),n.e(56337),n.e(9598),n.e(42106),n.e(62600),n.e(99458),n.e(64826),n.e(72760),n.e(28358),n.e(52772),n.e(63816),n.e(96921),n.e(88928),n.e(62122),n.e(16255),n.e(45156),n.e(9458),n.e(47007),n.e(90965)]).then(n.bind(n,839160)))),a=(0,i.$y)(s,(e=>e.Ribbon)),l=(0,i.$y)(s,(e=>e.ContextualFormatBar)),c=new i.EF(s,(e=>e.formatPainterFinish)),d=new i.EF(s,(e=>e.showInsertLinkDialog)),u=new i.EF(s,(e=>e.displayContextFormatBar))},256918:(e,t,n)=>{"use strict";n.d(t,{Z:()=>g});var i=n(321907),r=n(388171),o=n(576421),s=n(382717),a=n(509636),l=n(522343);var c=n(340426),d=n(101060),u=n(55461),p=n(476674),m=n(22046),h=n(442646);const f=(0,s.V5)()?e=>e.metaKey:e=>e.ctrlKey;class g{constructor(e,t,n=!0,o){this.adapter=e,this.editorAdapter=t,this.allowCtrlK=n,this.expressionPaneId=o,this.ribbonStateJobId=0,this.contextMenuEventItems=null,this.updateRibbonStateInternal=()=>{var e;this.ribbonStateJobId=0,this.editorViewState&&this.ribbonViewState&&(null===(e=this.updateRibbonStateFunc)||void 0===e||e.call(this,this.editorViewState,this.ribbonViewState))},this.insertLinkFeature={keys:[75],allowFunctionKeys:!0,shouldHandleEvent:e=>{const t=e.rawEvent;return!t.altKey&&!t.shiftKey&&f(t)},handleEvent:e=>{const t=e.rawEvent;t.preventDefault(),t.stopPropagation(),r.DQ.import().then((e=>{this.editorViewState&&e(this.editorViewState,this.editor.getDocument().defaultView,r.ju.ShortKey,(0,a.ri)())}))}},this.closeContextualFormatBarFeature={keys:[27],shouldHandleEvent:()=>{var e;return!!(null===(e=this.ribbonViewState)||void 0===e?void 0:e.targetPoint)},handleEvent:e=>{const t=e.rawEvent;t.preventDefault(),t.stopPropagation(),(0,i.Z)(this.ribbonViewState,null)}},this.openContextMenuFeature={keys:[121],shouldHandleEvent:({rawEvent:{shiftKey:e}})=>e,handleEvent:({rawEvent:e})=>{e.preventDefault(),e.stopPropagation(),this.editorViewState&&this.editor.getElementAtCursor().dispatchEvent(new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0}))}}}getName(){return"Ribbon"}initialize(e){this.editor=e,this.ribbonViewState=(0,p.Z)(this.adapter),this.editorViewState=(0,p.Z)(this.editorAdapter),this.allowCtrlK&&this.editor.addContentEditFeature(this.insertLinkFeature),this.editor.addContentEditFeature(this.closeContextualFormatBarFeature),this.editor.addContentEditFeature(this.openContextMenuFeature),o.qP.import().then((e=>this.updateRibbonStateFunc=e)),r.m3.import().then((e=>this.displayContextFormatBarFunc=e))}updateRibbonState(e=!0){var t,n;const i=null===(n=null===(t=this.editor)||void 0===t?void 0:t.getDocument())||void 0===n?void 0:n.defaultView;i&&(this.ribbonStateJobId&&i.clearTimeout(this.ribbonStateJobId),this.ribbonStateJobId=i.setTimeout(this.updateRibbonStateInternal,e?500:0))}onPluginEvent(e){var t,n;6==e.eventType&&2===e.rawEvent.button||((2==e.eventType&&27!=e.rawEvent.keyCode&&16!=e.rawEvent.keyCode&&121!=e.rawEvent.keyCode||6==e.eventType||7==e.eventType||16==e.eventType)&&(this.updateRibbonState(!1),7!=e.eventType&&this.ribbonViewState&&(null===(t=this.displayContextFormatBarFunc)||void 0===t||t.call(this,this.editor,this.ribbonViewState,e)),(0,u.cr)("cmp-new-context-menu")&&16==e.eventType&&this.editorViewState&&(this.contextMenuEventItems=e.items,e.rawEvent.preventDefault())),6==e.eventType&&(null===(n=this.ribbonViewState)||void 0===n?void 0:n.formatViewState.formatPainterFormat)&&r.ox.import().then((e=>{this.ribbonViewState&&this.editorViewState&&e(this.editorViewState,this.ribbonViewState.formatViewState)})))}getContextMenuItems(e){if((0,l.default)(e,"HTMLImageElement")){const t=(0,h.yN)(e,this.editor);return[{name:(0,d.ZP)("RPc"),key:"addAltText",onClick:()=>{this.onAltText(t())}}]}return null}dispose(){this.editor=null,this.editorViewState=void 0,this.ribbonViewState=void 0,this.contextMenuEventItems=null}getUIComponentClass(){return r.$x}isDarkMode(){var e;return null===(e=this.editor)||void 0===e?void 0:e.isDarkMode()}getContextMenuEventItems(){return this.contextMenuEventItems}clearContextMenuEventItems(){return this.contextMenuEventItems=null}hideContextMenu(e=!0){this.ribbonViewState&&this.editorViewState&&(this.clearContextMenuEventItems(),(0,i.Z)(this.ribbonViewState,null),e&&(0,m.G)(this.editorViewState,"focus"))}onAltText(e){c.FD.import().then((t=>{var n;(null===(n=this.editor)||void 0===n?void 0:n.contains(e))&&t(e,this.editor.getDocument().defaultView,(t=>{e.alt=t}))}))}}},886309:(e,t,n)=>{"use strict";var i;n.d(t,{j:()=>i}),function(e){e.OriginalRibbon="OriginalRibbon",e.FilePickerLinkContextMenu="FilePickerLinkContextMenu",e.ShortKey="ShortKey",e.FlightedRibbon="FlightedRibbon"}(i||(i={}))},201392:(e,t,n)=>{"use strict";function i(e){let t="";if(null==e||"I"===e.nodeName)return"";if("#text"===e.nodeName)return e.textContent.trim();for(let n=0;n<e.childNodes.length;n++)t+=i(e.childNodes[n]);return t}n.d(t,{Q:()=>i})},450250:(e,t,n)=>{"use strict";n.d(t,{ZH:()=>i,K5:()=>r,L_:()=>o,yY:()=>s,D0:()=>a,D9:()=>l,RX:()=>c,Fi:()=>d,ib:()=>u,s5:()=>p,SR:()=>m,EI:()=>h,He:()=>f,W8:()=>g});const i=8,r=13,o=32,s=46,a=48,l=57,c=65,d=90,u=96,p=105,m=186,h=192,f=219,g=222},774136:(e,t,n)=>{"use strict";n.d(t,{i:()=>s});var i=n(717420),r=n(126573);const o=new i.nI((()=>Promise.all([n.e(72760),n.e(28358),n.e(63816),n.e(62599)]).then(n.bind(n,362599)))),s=(0,r.Z)(o,(e=>e.TableEditPlugin),"TableEdit",(function(e,t){return 7==e.eventType||11==e.eventType&&t.queryElements("TABLE").length>0}))},246997:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(56337),n.e(7181),n.e(60156),n.e(767),n.e(11677),n.e(46688),n.e(14773),n.e(45087),n.e(37330),n.e(47877),n.e(78159),n.e(49792),n.e(95994),n.e(22107),n.e(69939),n.e(13201),n.e(51704)]).then(n.bind(n,426797)))),o=new i.EF(r,(e=>e.getHandler));async function s(){return(await o.import())()}},567156:(e,t,n)=>{"use strict";n.d(t,{E:()=>c,c:()=>a});var i=n(717420),r=n(126573),o=n(55975);let s;function a(){return null==s&&(s=(0,o.Pd)()),s}const l=new i.nI((()=>Promise.all([n.e(3918),n.e(52637),n.e(72760),n.e(54964),n.e(28358),n.e(63816),n.e(90908),n.e(25324),n.e(67206)]).then(n.bind(n,826612)))),c=(0,r.Z)(l,(e=>e.TopicPickerPlugin),"TopicPicker",(e=>11==e.eventType))},807760:(e,t,n)=>{"use strict";n.d(t,{oW:()=>s,c3:()=>a});var i=n(717420),r=n(126573);const o=new i.nI((()=>Promise.all([n.e(52772),n.e(63816),n.e(57567)]).then(n.bind(n,57567)))),s=((0,i.$y)(o,(e=>e.VirtualEditPane)),(0,r.Z)(o,(e=>e.VirtualEditPlugin),"VirtualEdit",(e=>11==e.eventType))),a=new i.EF(o,(e=>e.stopVirtualEdit))},223992:(e,t,n)=>{"use strict";n.d(t,{l:()=>r,H:()=>o});var i=n(128358);const r="OWA_VirtualEdit_Placeholder",o=(0,i.getEntitySelector)(r)},323877:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).lr)("SetCachedSelection",((e,t)=>{e.selectionPath=t}))},240059:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).lr)("setForceLightMode",(function(e,t){e.forceInLightMode=t}))},651795:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).lr)("setIsDirty",((e,t)=>{e.isDirty=t}))},304450:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).lr)("SetShouldUpdateContentOnDispose",((e,t)=>{e.shouldUpdateContentOnDispose=t}))},813771:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(371134),r=n(651795);function o(e,t,n){e.content!=t&&(s(e,t),n||(0,r.Z)(e,!0))}const s=(0,i.lr)("Editor_UpdateContent",((e,t)=>{e.content=t}))},694786:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(989526),r=n(476674);function o(e){const t=(0,r.Z)(e.adapter),n=(0,r.Z)(e.editorAdapter);return t&&n?i.createElement(e.getUIComponentClass(),{viewState:e.adapter(),editorViewState:e.editorAdapter(),plugin:e,key:e.getName()}):null}function s(e){const{lazyPlugin:t}=e,[n,r]=i.useState(null);return i.useEffect((()=>{t.addOnImportedCallback((e=>{l(e)&&r(e)}))})),n?o(n):null}function a(e){return i.createElement(i.Fragment,null,(e.plugins||[]).map((e=>l(e)?o(e):function(e){return e&&!!e.addOnImportedCallback}(e)?i.createElement(s,{lazyPlugin:e,key:e.getName()}):null)))}function l(e){return e&&!!e.getUIComponentClass}},901189:(e,t,n)=>{"use strict";n.d(t,{Z:()=>B});var i=n(92894),r=n(284877),o=n(770538),s=n(452772),a=n.n(s),l=n(329492);function c(e){try{const t=a()(e||void 0),n=t.lab().array(),i=(0,l.Z)(n,21.247);e=a().lab(i,n[1],n[2]).rgb().alpha(t.alpha()).toString()}catch(e){}return e}var d=n(651795),u=n(323877),p=n(304450),m=n(371134);const h=(0,m.lr)("Editor_SetTextDirection",(function(e,t){e.textDirection=t}));var f=n(813771);class g{constructor(e,t,n){this.viewState=e,this.updateOnKeyPress=t,this.updateOnDispose=n,this.editor=null}getName(){return"ViewStateManage"}initialize(e){this.editor=e,this.viewState.shouldUpdateContentOnDispose!=this.updateOnDispose&&(0,p.Z)(this.viewState,this.updateOnDispose)}dispose(){this.editor=null}onPluginEvent(e){var t;if(3==e.eventType)this.updateOnKeyPress?this.updateContentToViewState():this.viewState.isDirty||(0,d.Z)(this.viewState,!0),this.clearCachedSelection();else if(7==e.eventType)this.clearCachedSelection();else if(12==e.eventType&&this.viewState.shouldUpdateContentOnDispose)this.updateContentToViewState(),(null===(t=this.editor)||void 0===t?void 0:t.getSelectionRange())&&(0,u.Z)(this.viewState,this.editor.getSelectionPath());else if(8==e.eventType){const e=this.getTextDirection();this.viewState.textDirection!=e&&h(this.viewState,e)}}updateContentToViewState(){this.editor&&(0,f.Z)(this.viewState,this.editor.getContent())}getTextDirection(){var e,t;const n=null===(t=null===(e=this.editor)||void 0===e?void 0:e.getEditorDomAttribute("dir"))||void 0===t?void 0:t.toLowerCase();return"ltr"==n||"rtl"==n?n:null}clearCachedSelection(){this.viewState.selectionPath&&(0,u.Z)(this.viewState,null)}}const v=(0,m.lr)("Editor_SetIsImageSelected",((e,t)=>{e.isImageSelected=t}));var y=n(897997);class S{constructor(e){this.viewState=e,this.editor=null}getName(){return"SelectImage"}initialize(e){this.editor=e,this.selectImage(null),this.editor.getDocument().execCommand("enableObjectResizing",!1,"false")}dispose(){this.editor=null}onPluginEvent(e){if(6===e.eventType&&0==e.rawEvent.button){const t=e.rawEvent.target;this.selectImage("IMG"==(null==t?void 0:t.nodeName)?t:null)}else 0===e.eventType&&this.selectImage(null)}selectImage(e){var t;if((e||this.viewState.isImageSelected)&&(v(this.viewState,!1),this.editor&&e&&"a"!==(null===(t=e.parentElement)||void 0===t?void 0:t.tagName.toLowerCase()))){const t=(0,y.t)(this.viewState);t&&(t.image=e),v(this.viewState,!0),this.editor.focus(),this.editor.select(e,-3)}}}var b=n(269769),I=n(989526),w=n(715386),C=n(128358),E=n(694786),P=n(384512);const T={getName:()=>"CtsWorkaround",initialize:()=>{},dispose:()=>{},onPluginEvent:function(e){if(10==e.eventType){const{htmlAttributes:t}=e;if("urn:schemas-microsoft-com:office:excel"==t["xmlns:x"]||"Excel.Sheet"==t.ProgId)return void(0,C.chainSanitizerCallback)(e.sanitizingOption.elementCallbacks,"TD",(e=>{if("nowrap"==e.style.whiteSpace){const t=(0,C.getStyles)(e);t["white-space"]="nowrap !important",(0,C.setStyles)(e,t)}return!0}));(0,C.chainSanitizerCallback)(e.sanitizingOption.cssStyleCallbacks,R,((e,t,n)=>(n["white-space"]=e,"pre"!=e)))}}},R="white-space",x=T;var k=n(193310),N=n(945422),A=n(101060),D=n(55461),Z=n(514327),M=n(984047),O=n(946316),F=n(254712);const _=n.n(F)().bind(O.Z);function L(e,t){return new w.M(e,t)}const z={TableAlignment:"cmp-set-alignment-for-tables",AdaptiveHandlesResizer:"cmp-image-resize-handles",ListItemAlignment:"cmp-align-list",AutoFormatList:"cmp-autoformat-list",PendingStyleBasedFormat:"cmp-no-zws",NormalizeList:"cmp-normalize-list"},B=(0,i.Pi)((function(e){const{onFocus:t,classNames:n,viewState:i,watermark:s,ariaLabel:a,isDarkMode:l,plugins:d,focusOnInit:u,composeFormat:p,watermarkFormat:m,doNotAdjustEditorColor:h,scrollContainerSelector:v,onBlur:y,updateOnKeyPress:w,updateOnDispose:T,coreApiOverride:R,supressPluginUI:F,persistUndoSnapshot:B,editorCreator:V}=e,U=I.useContext(Z.Z),q=I.useRef(),W=I.useRef(null),H=!!(null==d?void 0:d.some((e=>{var t;return"Accessibility"==(null===(t=null==e?void 0:e.getName)||void 0===t?void 0:t.call(e))}))),j=function(e,t){if(e)return t?e+(0,A.ZP)(M.ut):e;return e}(a||s,H),G=I.useRef(),K=(0,D.cr)("cmp-autoformat-options")&&(0,D.cr)("cmp-autoformat-list")&&(0,D.cr)("cmp-autoformat-hyphen")&&(0,D.cr)("cmp-autoformat-fractions"),X=I.useCallback((e=>{const t=G.current;t&&(e.focus(),1===t.type&&t.coordinates?e.select(t.table,t.coordinates):e.select(t.ranges[0]))}),[i.autoFormatOptions,G.current]),$=I.useCallback((e=>{const t=e.getSelectionRangeEx();G.current=t}),[i.autoFormatOptions,G.current]);I.useEffect((()=>(q.current=(V||L)(W.current,J()),(0,f.Z)(i,q.current.getContent(),!0),u&&q.current.focus(),(0,o.Yk)(i,q.current,null),(0,D.cr)("mon-win32-addl-shortcuts")&&P.v9.importAndExecute(q.current),K&&X(q.current),()=>{q.current&&(K&&$(q.current),(0,o.af)(i,q.current,null),q.current.dispose(),q.current=void 0)})),[i.editorId,i.autoFormatOptions,K]),I.useEffect((()=>{var e;null===(e=q.current)||void 0===e||e.setZoomScale(U)}),[U]),I.useEffect((()=>{var e;null===(e=q.current)||void 0===e||e.setDarkModeState(l)}),[l]);const J=I.useCallback((()=>{var e,t,n,o,a;const u=p||(0,r.Z)(l,i.rawComposeFormat),f=null==d?void 0:d.some((e=>{var t;return"InlineImageV2"==(null===(t=null==e?void 0:e.getName)||void 0===t?void 0:t.call(e))})),y=[...d||[],new P.MM({mergeInNewLineWhenBackspaceOnFirstChar:!0,autoBullet:!(0,D.cr)("cmp-autoformat-list"),autoBulletList:(0,D.cr)("cmp-autoformat-list")&&(null===(e=i.autoFormatOptions)||void 0===e?void 0:e.autoBulletEnabled),autoNumberingList:(0,D.cr)("cmp-autoformat-list")&&(null===(t=i.autoFormatOptions)||void 0===t?void 0:t.autoNumberingEnabled)}),new P.jt((e=>(0,N.R)(e))),new P.$B,new P.Hq,new P.Tn({autoFractionsEnabled:null===(n=i.autoFormatOptions)||void 0===n?void 0:n.autoFractionsEnabled,autoOrdinalsEnabled:null===(o=i.autoFormatOptions)||void 0===o?void 0:o.autoOrdinalsEnabled}),new P.ld,s&&new P.le(s,m),new S(i),new P.GB({borderColor:(0,D.cr)("cmp-image-resize-handles")?"#C6C6C6":(0,k.y$)().themePrimary,preserveRatio:!0,disableCrop:!f,disableRotate:!f}),new g(i,!!w,!!T),x,new P.rl,(0,D.cr)("cmp-autoformat-hyphen")&&(null===(a=i.autoFormatOptions)||void 0===a?void 0:a.autoHyphenEnabled)&&new P.Tq,new P.El].filter((e=>!!e));(0,D.cr)("cmp-new-context-menu")||y.push(new P.xV),(0,D.cr)("cmp-ccp-telemetry")&&y.push(new P.jS);const I=C.HtmlSanitizer.convertInlineCss(i.content),E=(0,C.getObjectKeys)(z).reduce(((e,t)=>((0,D.cr)(z[t])&&e.push(t),e)),[]);H&&E.push("TabKeyTextFeatures");return{plugins:y,defaultFormat:u,undoMetadataSnapshotService:B?(0,b.rp)(i):void 0,initialContent:I,inDarkMode:l,doNotAdjustEditorColor:h,experimentalFeatures:E,scrollContainer:v&&(0,C.findClosestElementAncestor)(W.current,W.current.ownerDocument.body,v)||void 0,getDarkColor:c,coreApiOverride:R,zoomScale:U}}),[i.editorId]),Q=I.useCallback((e=>{(0,f.Z)(i,q.current.getContent()),y&&y(e)}),[i.editorId]),Y=i.textDirection?"rtl"===i.textDirection:(0,A.fI)(),ee=I.useCallback((()=>I.createElement(E.Z,{plugins:d})),[i.editorId,i.autoFormatOptions]);return I.createElement(I.Fragment,null,I.createElement("div",{tabIndex:0,ref:W,dir:Y?"rtl":"ltr",className:_(n,O.Z.textSelectable,{resetColors:!l&&!h,anchorReset:l}),onBlur:Q,onFocus:t,"aria-multiline":"true","aria-label":j}),!F&&ee())}))},795307:(e,t,n)=>{"use strict";n.d(t,{F3:()=>ReactEditor,KI:()=>o,RX:()=>a});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(72760),n.e(28358),n.e(52772),n.e(63816),n.e(15386),n.e(99995)]).then(n.bind(n,864590)))),ReactEditor=(0,i.$y)(r,(e=>e.ReactEditor)),o=new i.EF(r,(e=>e.operateContent)),s=new i.EF(r,(e=>e.focusToEditor));function a(e){s.import().then((t=>t(e)))}},770538:(e,t,n)=>{"use strict";n.d(t,{Yk:()=>r,af:()=>o,ZP:()=>s,cr:()=>a});const i={};function r(e,t,n){i[e.editorId]={htmlEditor:t,plainTextEditor:n}}function o(e,t,n){const r=i[e.editorId];r&&(r.htmlEditor==t&&(r.htmlEditor=null),r.plainTextEditor==n&&(r.plainTextEditor=null),r.htmlEditor||r.plainTextEditor||delete i[e.editorId])}function s(e,t,n,r,o){if(e){const s=e.bodyType,a=void 0===s||"HTML"===s,l="Text"===s,{htmlEditor:c,plainTextEditor:d}=o||i[e.editorId]||{};a&&t&&(c&&!c.isDisposed()||r)?t(c):l&&n&&(d||r)&&n(d)}}function a(e,t){if(e){const{htmlEditor:n}=i[e]||{};n&&!n.isDisposed()&&t(n)}}},22046:(e,t,n)=>{"use strict";n.d(t,{G:()=>r});var i=n(770538);function r(e,t,...n){let r;const o=e=>{e&&(r=e[t].call(e,...n))};return"string"==typeof e?(0,i.cr)(e,(e=>o(e))):(0,i.ZP)(e,(e=>o(e)),void 0),r}},945422:(e,t,n)=>{"use strict";n.d(t,{R:()=>s});var i=n(984047),r=n(382717),o=n(101060);function s(e){return(0,o.WU)((0,o.ZP)(i.lC),(0,r.V5)()?(0,o.ZP)(i.kz):(0,o.ZP)(i.yp))+"\r\n"+e}},284877:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d,b:()=>u});var i=n(980998),r=n(788128);var o=n(937885),s=n(226362),a=n(55461),l=n(964659);const c={fontFamily:"Calibri,Arial,Helvetica,sans-serif",fontSize:"11pt",textColor:"#000000",bold:!1,italic:!1,underline:!1};function d(e,t){const n=t||(0,o.Z)((0,a.cr)("cmp-default-format-multi-account")?(0,l.pX)((0,s.zl)()):(0,l.c6)());return n?u(n.fontName,n.fontSize,n.fontColor,n.fontFlags,!!e):c}function u(e,t,n,o,s){const a=Object.assign({},c),l=e?(0,i.BN)(e):null;l&&(a.fontFamily=l);const d=t?(0,i.O)(t):null;if(d&&(a.fontSize=d),n){if(s){const e=(u=n,r.X[r.Hu.indexOf(u)]);e?a.textColors={lightModeColor:n,darkModeColor:e}:a.textColor=n}a.textColor=n}var u;return o&&(a.bold=1==(1&o),a.italic=2==(2&o),a.underline=4==(4&o)),a}},937885:(e,t,n)=>{"use strict";function i(e){const t=null==e?void 0:e.UserOptions;return t&&{fontName:t.ComposeFontName,fontSize:t.ComposeFontSize,fontColor:t.ComposeFontColor,fontFlags:t.ComposeFontFlags}}n.d(t,{Z:()=>i})},972288:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(770538);function r(e){let t;return(0,i.ZP)(e,(e=>{e&&(t=e.getScrollContainer())})),t}},897997:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r,t:()=>o});var i=n(22046);function r(e,t){var n;let r=e.isImageSelected?null===(n=o(e))||void 0===n?void 0:n.image:null;if(r&&!(0,i.G)(e,"contains",r)&&(r=null),!r&&t){const t=(0,i.G)(e,"queryElements","img",1);r=null==t?void 0:t[0]}return r}function o(e){return(0,i.G)(e,"getCustomData","SelectedImageHolder",(()=>({image:null})))}},951356:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(843784);function r(e){return!e.forceInLightMode&&(0,i.BR)()}},476674:(e,t,n)=>{"use strict";function i(e){try{return e()}catch(e){return}}n.d(t,{Z:()=>i})},269769:(e,t,n)=>{"use strict";n.d(t,{dt:()=>a,W$:()=>l,rp:()=>c});var i=n(128358),r=n(51793);const o=1e7,s={};function a(e){let t=s[e.editorId];t?(t.snapshots=[],t.totalSize=0,t.currentIndex=-1,t.autoCompleteIndex=-1):(t=(0,r.default)(o),s[e.editorId]=t)}function l(e){delete s[e.editorId]}function c(e){let t;return s[e.editorId]?t=s[e.editorId]:(t=(0,r.default)(o),s[e.editorId]=t),{canMove:e=>(0,i.canMoveCurrentSnapshot)(t,e),move:e=>(0,i.canMoveCurrentSnapshot)(t,e)?((0,i.moveCurrentSnapshot)(t,e),t.snapshots[t.currentIndex]):null,addSnapshot:(e,n)=>(0,i.addSnapshotV2)(t,e,n),clearRedo:()=>(0,i.clearProceedingSnapshotsV2)(t),canUndoAutoComplete:()=>(0,i.canUndoAutoComplete)(t)}}},553070:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(552542),r=n(954947),o=n(964659),s=n(226362);function a(e){var t;return(0,r.Z)(void 0,e)?(0,o.Wn)(e||(0,s.B6)()):null===(t=(0,i.Z)().SegmentationSettings)||void 0===t?void 0:t.Irm}},853947:(e,t,n)=>{"use strict";n.d(t,{R:()=>o});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(8631),n.e(4107),n.e(47241),n.e(67401)]).then(n.bind(n,951704)))),o=new i._5(r,(e=>e.closeExpressionPane))},276566:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(559621),r=n(371134),o=n(769367);const s={expressionPickerViewStates:new i.ObservableMap,selectedSkinTone:(0,o.Bb)(o.Xm.DiverseEmojis).diverseEmojisSelectedSkinTone,useFlexPane:null,isSxSDisplayed:null,primaryExpressionId:null},a=(0,r.MT)("expression",s)(),l=a},554254:(e,t,n)=>{"use strict";n.d(t,{dr:()=>i,Nv:()=>r,uD:()=>o,rh:()=>s,GX:()=>a});const i="ribbon",r="smartSuggestions",o="inlineSearch",s="contextualSearch",a="calendar"},765952:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(276566);function r(e){var t;return e&&(null===(t=i.Z.expressionPickerViewStates.get(e))||void 0===t?void 0:t.isOpen)}},661972:(e,t,n)=>{"use strict";n.d(t,{pu:()=>o,xS:()=>s,EH:()=>a});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(25671),n.e(52637),n.e(32557),n.e(39006),n.e(18838),n.e(16025),n.e(19280),n.e(33615),n.e(17483),n.e(33995),n.e(8631),n.e(4107),n.e(47241),n.e(73815)]).then(n.bind(n,762445)))),o=new i._5(r,(e=>e.showExpressionPane)),s=(0,i.$y)(r,(e=>e.ExpressionPane)),a=new i.EF(r,(e=>e.toggleExpressionPane))},252846:(e,t,n)=>{"use strict";n.d(t,{Z:()=>T});var i=n(333940),r=n(92894),o=n(989526),s=n(204673),a=n(752548),l=n(559621),c=n(188464),d=n(193310);const u="K0Wag",p="w0JIL",m="Byujg",h="G4VT6",f="jGtWM",g="hIrgM",v="k1E1B",y="pU_4m",S="tWY0g";var b=n(55461),I=n(843784),w=n(764403),C=n.n(w);function E(e){const t=(0,b.cr)("mon-tri-commandbarStyling");return{root:C()(u,t&&p,!((0,b.cr)("mon-densities")&&e)&&v),rootDisabled:(0,I.BR)()?S:m,rootExpanded:h,icon:f,iconDisabled:(0,I.BR)()?S:m,iconExpanded:h,menuIconDisabled:m,menuIconExpanded:h,menuIcon:t?g:null}}class P extends o.Component{constructor(e){super(e),this.onMenuOpened=()=>{this.props.onOverflowMenuVisibilityChanged(!0)},this.onMenuDismissed=()=>{this.props.onOverflowMenuVisibilityChanged(!1)},this.FilterableCommandBarButton=(0,r.Pi)((e=>{const t=o.createRef();return o.createElement(a.Q,Object.assign({},e,{styles:Object.assign(Object.assign(Object.assign({},e.styles),{menuIcon:g}),E(this.props.isMailModule)),componentRef:t,onAfterMenuDismiss:()=>{var e;null===(e=null==t?void 0:t.current)||void 0===e||e.focus()}}))})),this.CustomFilterableCommandBarButton=(0,r.Pi)((e=>{const t=o.createRef(),n=E(this.props.isMailModule);return o.createElement(a.Q,Object.assign({},e,{styles:Object.assign(Object.assign({},e.styles),n),componentRef:t,onAfterMenuDismiss:()=>{var e;null===(e=null==t?void 0:t.current)||void 0===e||e.focus()}}))})),(0,l.makeObservable)(this,{validLeftItems:l.computed.struct,validRightItems:l.computed.struct,validOverflowItems:l.computed.struct})}get validLeftItems(){return this.props.filterableItems?this.props.filterableItems.filter((e=>!e.shouldShow||e.shouldShow(0))):[]}get validRightItems(){return this.props.filterableItems?this.props.filterableItems.filter((e=>{var t;return null===(t=e.shouldShow)||void 0===t?void 0:t.call(e,1)})):[]}get validOverflowItems(){const{isOverflowMenuOpen:e,filterableItems:t}=this.props;if(t){const n=t.filter((e=>{var t;return null===(t=e.shouldShow)||void 0===t?void 0:t.call(e,2)}));if(n.length>0)return null==e||e?n:[{key:"dummyItem",text:""}]}}render(){const e=this.props,{elipisisAriaLabel:t,customMenuIconColor:n,overflowButtonProps:r,styles:a,overflowMenuProps:l}=e,c=(0,i.__rest)(e,["elipisisAriaLabel","customMenuIconColor","overflowButtonProps","styles","overflowMenuProps"]),u=Object.assign({ariaLabel:t,className:y,styles:n?{menuIcon:{color:n+"!important"}}:void 0,menuProps:this.props.onOverflowMenuVisibilityChanged?Object.assign({onMenuOpened:this.onMenuOpened,onMenuDismissed:this.onMenuDismissed,items:[]},l):l?Object.assign({items:[]},l):void 0},r),p=n?this.CustomFilterableCommandBarButton:this.FilterableCommandBarButton;return o.createElement(s.X,Object.assign({items:this.validLeftItems,farItems:this.validRightItems,overflowItems:this.validOverflowItems,overflowButtonProps:u,buttonAs:this.FilterableCommandBarButton,overflowButtonAs:p,styles:Object.assign({root:{paddingLeft:"0",background:(0,d.XN)().neutralLighter},primarySet:{"align-items":"center"}},a)},c))}}const T=(0,c.observer)(P)},867972:(e,t,n)=>{"use strict";var i;n.d(t,{U:()=>i}),function(e){e[e.BadItemType=-1]="BadItemType",e[e.AlwaysMoveToFocusedInbox=0]="AlwaysMoveToFocusedInbox",e[e.AlwaysMoveToOtherInbox=1]="AlwaysMoveToOtherInbox",e[e.AnySelection=2]="AnySelection",e[e.Archive=3]="Archive",e[e.AssignPolicy=4]="AssignPolicy",e[e.BlockNeverBlock=5]="BlockNeverBlock",e[e.Categories=6]="Categories",e[e.ClientOptOut=7]="ClientOptOut",e[e.CommandingModeMenu=8]="CommandingModeMenu",e[e.Copy=9]="Copy",e[e.CreateTask=10]="CreateTask",e[e.CustomizeToolbar=11]="CustomizeToolbar",e[e.Delete=12]="Delete",e[e.EmptyFolder=13]="EmptyFolder",e[e.EnterpriseOnly=14]="EnterpriseOnly",e[e.FindEmailFromSender=15]="FindEmailFromSender",e[e.Flag=16]="Flag",e[e.Forward=17]="Forward",e[e.Hamburger=18]="Hamburger",e[e.Ignore=19]="Ignore",e[e.InboxRule=20]="InboxRule",e[e.JunkEmailSafetyAction=21]="JunkEmailSafetyAction",e[e.MarkAllAsRead=22]="MarkAllAsRead",e[e.MarkAsJunk=23]="MarkAsJunk",e[e.MarkAsPhishing=24]="MarkAsPhishing",e[e.MarkAsRead=25]="MarkAsRead",e[e.MarkAsUnread=26]="MarkAsUnread",e[e.MeetNow=27]="MeetNow",e[e.Move=28]="Move",e[e.MoveMessage=29]="MoveMessage",e[e.MoveToFocusedInbox=30]="MoveToFocusedInbox",e[e.MoveToOtherInbox=31]="MoveToOtherInbox",e[e.NewMessage=32]="NewMessage",e[e.NewNote=33]="NewNote",e[e.NewOutlookToggle=34]="NewOutlookToggle",e[e.NoteActions=35]="NoteActions",e[e.OpenInNewTab=36]="OpenInNewTab",e[e.OverflowDivider=37]="OverflowDivider",e[e.Pin=38]="Pin",e[e.PlayThisConversation=39]="PlayThisConversation",e[e.Print=40]="Print",e[e.Reply=41]="Reply",e[e.ReplyAll=42]="ReplyAll",e[e.ReplyReplyAllForwardCommandBar=43]="ReplyReplyAllForwardCommandBar",e[e.ReplyWithMeeting=44]="ReplyWithMeeting",e[e.ReportAbuse=45]="ReportAbuse",e[e.Restore=46]="Restore",e[e.RestoreAll=47]="RestoreAll",e[e.Ribbon_AssignPolicy=48]="Ribbon_AssignPolicy",e[e.Ribbon_Delete=49]="Ribbon_Delete",e[e.Ribbon_FlagUnflag=50]="Ribbon_FlagUnflag",e[e.Ribbon_Forward=51]="Ribbon_Forward",e[e.Ribbon_IgnoreStopIgnore=52]="Ribbon_IgnoreStopIgnore",e[e.Ribbon_JunkNotJunk=53]="Ribbon_JunkNotJunk",e[e.Ribbon_NewMessage=54]="Ribbon_NewMessage",e[e.Ribbon_NewNote=55]="Ribbon_NewNote",e[e.Ribbon_PinUnpin=56]="Ribbon_PinUnpin",e[e.Ribbon_ReadUnread=57]="Ribbon_ReadUnread",e[e.Ribbon_Reply=58]="Ribbon_Reply",e[e.Ribbon_ReplyAll=59]="Ribbon_ReplyAll",e[e.Ribbon_Share=60]="Ribbon_Share",e[e.Ribbon_Sweep=61]="Ribbon_Sweep",e[e.Ribbon_Undo=62]="Ribbon_Undo",e[e.Schedule=63]="Schedule",e[e.SelectionNavigation=64]="SelectionNavigation",e[e.ShowInImmersiveReader=65]="ShowInImmersiveReader",e[e.SingleSelection=66]="SingleSelection",e[e.StopIgnoring=67]="StopIgnoring",e[e.Sweep=68]="Sweep",e[e.Translate=69]="Translate",e[e.Undo=70]="Undo",e[e.Unflag=71]="Unflag",e[e.Unpin=72]="Unpin",e[e.Unschedule=73]="Unschedule",e[e.ViewEmailFromNote=74]="ViewEmailFromNote",e[e.ViewMessageDetails=75]="ViewMessageDetails",e[e.ViewMessageSource=76]="ViewMessageSource"}(i||(i={}))},579549:(e,t,n)=>{"use strict";n.d(t,{dV:()=>i.Z,k_:()=>r,UI:()=>o.U});var i=n(252846);class r{constructor(e){const{0:t,1:n,2:i,3:r,4:o,5:s,6:a,7:l,8:c,9:d,10:u,11:p,12:m,13:h,14:f,15:g,16:v,17:y,18:S,19:b,20:I,21:w,22:C}=e;this.iconProps=n?{iconName:n}:void 0,this.disabled=s,this.id=l,this.key=c||(t||"")+(n||""),this.name=t,this.onClick=i,this.shouldShowBehavior=r||this.alwaysShow,this.displayOption=o||0,this.onRender=d,this.checked=u,this.ariaLabel=p,this.title=m,this.className=h,this.canCheck=f,this.iconOnly=g,this.onRenderIcon=v,this.href=y,this.split=b,this.subMenuProps=I,this.componentRef=w,this.cacheKey=S||void 0,this.buttonStyles=C,this.href&&(this.target="_blank"),this.ariaLabel||(this.ariaLabel=this.name),a&&null==I&&(Array.isArray(a)?this.subMenuProps={items:a,gapSpace:0}:this.subMenuProps=a)}shouldShow(e){return null!=e?this.displayOption==e&&this.shouldShowBehavior():this.shouldShowBehavior()}alwaysShow(){return!0}}var o=n(867972)},648172:(e,t,n)=>{"use strict";n.d(t,{q:()=>o,Y:()=>s});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(25671),n.e(94044),n.e(8631),n.e(44928),n.e(93310),n.e(94252),n.e(4049)]).then(n.bind(n,490824)))),o=new i._5(r,(e=>e.loadAndInitializeFloodgateEngine)),s=new i.EF(r,(e=>e.logFloodgateActivity))},434321:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});const i=(0,n(371134).aD)("onFluidComponentRendered",((e,t,n)=>({owaSource:e,isCreateNew:t,viewStateId:n})))},62447:(e,t,n)=>{"use strict";n.d(t,{u1:()=>d,So:()=>u,t$:()=>p,im:()=>m,TC:()=>h,BW:()=>f,NL:()=>g,EQ:()=>v,U3:()=>y,Et:()=>S,dm:()=>b,D:()=>I,k1:()=>s.k,zz:()=>a.zz,LO:()=>a.LO,fC:()=>a.fC,T8:()=>a.T8,B$:()=>l.B});var i=n(908907),r=n(126573),o=n(717420),s=n(434321),a=n(411344),l=n(117461);n(908916);const c=new o.nI((()=>Promise.all([n.e(52637),n.e(56337),n.e(9598),n.e(42106),n.e(62600),n.e(64826),n.e(72760),n.e(28358),n.e(50546),n.e(63816),n.e(48139),n.e(63684),n.e(47007),n.e(60927),n.e(26411),n.e(69986),n.e(31006),n.e(5956),n.e(8832),n.e(12480)]).then(n.bind(n,150247)))),d=(0,r.Z)(c,(e=>e.FluidPlugin),"Fluid",(e=>11==e.eventType)),u=new o.EF(c,(e=>e.mountExistingFluidComponent)),p=new o.EF(c,(e=>e.tryGetFluidDriverForUrl)),m=new o.EF(c,(e=>e.createNewFluidComponent)),h=new o.EF(c,(e=>e.getAgendaCodeDetails)),f=new o._5(c,(e=>e.getFluidMenuItems)),g=new o._5(c,(e=>e.createFluidForms)),v=new o._5(c,(e=>e.isLoopUrl)),y=new o.EF(c,(e=>e.LoopProviderCallbackStore));(0,o.Kv)(i.tT,c,(e=>e.preloadFluidOrchestrator)),(0,o.Kv)(i.Dq,c,(e=>e.preloadFluidScriptsOrchestrator));const S=new o._5(c,(e=>e.preloadFluidScripts)),b=new o._5(c,(e=>e.isPreloadFluidInCollabSpaceComplete)),I=(0,o.$y)(c,(e=>e.FluidContextualTeachingBubbleWrapper))},563278:(e,t,n)=>{"use strict";n.d(t,{I:()=>r});var i=n(748086);function r(e){let t=!1;if(void 0!==e){t=(0,i.Z)().viewStateWithLoopFocus===e}return t}},748086:(e,t,n)=>{"use strict";n.d(t,{b:()=>a,Z:()=>l});var i=n(559621),r=n(371134);const o={linkViewStates:new i.ObservableMap({}),isManifestLoaded:!1,viewStateWithLoopFocus:"",fluidMenuItems:void 0},s=(0,r.MT)("fluidLinkViewStore",o)(),a=()=>s,l=a},117461:(e,t,n)=>{"use strict";function i(e){if(!e)return!1;const t=!!e.closest("td")||!!e.closest("th"),n="TD"===e.tagName||"TH"===e.tagName;return t||n}n.d(t,{B:()=>i})},411344:(e,t,n)=>{"use strict";n.d(t,{lr:()=>i,$L:()=>r,fC:()=>o,FW:()=>s,CU:()=>a,Z7:()=>l,Tw:()=>c,c6:()=>d,fL:()=>u,y8:()=>p,LO:()=>m,zz:()=>h,T8:()=>f});const i="owaFluidKeepBodyOnSend",r="fluidPlaceholder",o="loopHydrated",s="Outlook",a="Outlook_Web_App",l="Outlook_Monarch",c="Web",d="OneNoteMeetings",u="OWAFluid",p="fluid",m="fluidContainer",h="FLUID_HERO_MENU_ID";var f;!function(e){e.Link="link",e.Embedded="embedded",e.Pill="pill"}(f||(f={}))},962569:(e,t,n)=>{"use strict";n.d(t,{v:()=>r});var i=n(808386);function r(){return(0,i.F)("loop.svg")}},364217:(e,t,n)=>{"use strict";n.d(t,{s4:()=>r,tT:()=>o,Dq:()=>s});var i=n(371134);const r=(0,i.aD)("ON_FLUID_ENABLED_FETCHED",(e=>({isFluidEnabled:e}))),o=(0,i.aD)("PRELOAD_FLUID"),s=(0,i.aD)("PRELOAD_FLUID_SCRIPTS")},908907:(e,t,n)=>{"use strict";n.d(t,{RK:()=>s,tT:()=>r.tT,Dq:()=>r.Dq,Rn:()=>a});var i=n(717420),r=n(364217);const o=new i.nI((()=>Promise.all([n.e(17553),n.e(38234),n.e(77456),n.e(99110),n.e(80)]).then(n.bind(n,525968)))),s=new i._5(o,(e=>e.updateTenantConfigForFluid)),a=new i._5(o,(e=>e.getBposNavBarDataHelper))},406979:(e,t,n)=>{"use strict";n.d(t,{n:()=>r});var i=n(55461);function r(){return(0,i.cr)("cal-cmp-fluidCollaborativeSpace")||(0,i.cr)("cal-fluid-collabSpaceRead")}},387500:(e,t,n)=>{"use strict";n.d(t,{U:()=>p});var i=n(874191),r=n(135726),o=n(55461),s=n(954947),a=n(769367),l=n(289446),c=n(676186),d=n(653798),u=n(406979);function p(e,t,n=!1){var p;const m=(0,a.Bb)(a.Xm.Bohemia);if((0,s.Z)(void 0,t)||!(null===(p=(0,c.Z)())||void 0===p?void 0:p.AttachmentDataProviderAvailable)||!function(){switch((0,l.S7)().browser){case"Chrome":case"Edge Anaheim":return(0,l.Js)([80]);case"Firefox":return(0,l.Js)([78]);case"Opera":return!0;case"Safari":return"Windows"!==(0,l.kA)()&&(0,l.Js)([13,4]);default:return!1}}()||!m.fluidEnabledForTenant&&!n)return(0,a.mj)().loadState!==a.jd.OptionsLoaded?(0,i.y8)("FluidEnabledNotFetchedWhenChecked",{source:e},{isCore:!0}):(0,c.Z)()||(0,i.y8)("FluidEnabledAttachmentPolicyUndefined",{source:e},{isCore:!0}),!1;switch(e){case"MailReadingPane":case"MailCompose":case"CalendarEventBody":case"None":return(0,o.cr)("cmp-prague");case"CalendarReadingPane":case"MailCalendarCard":case"CalendarCompose":return function(e){if((0,d.OS)())return!1;switch(e){case"CalendarReadingPane":case"MailCalendarCard":return(0,u.n)();case"CalendarCompose":return(0,o.cr)("cmp-prague")&&(0,o.cr)("cal-cmp-fluidCollaborativeSpace");default:return!1}}(e);case"CalendarBoard":return(0,o.cr)("cmp-prague")&&((0,o.cr)("cal-board-fluidAsset")||(0,o.cr)("cal-board-dev-createFluidAsset"));default:return(0,r.v)(e)}}},414691:(e,t,n)=>{"use strict";n.d(t,{V6:()=>i,d4:()=>r,Yo:()=>o,qx:()=>s,SO:()=>a,CJ:()=>l,Rg:()=>c,_r:()=>d,js:()=>u,L1:()=>p,Ht:()=>m,UU:()=>h,Rq:()=>f,Ac:()=>g,Ry:()=>v});const i=["journal","outbox","syncissues"],r=256,o="archivemsgfolderroot",s="msgfolderroot",a="archivedeleteditems",l="deleteditems",c="archiverecoverableitemsdeletions",d="recoverableitemsdeletions",u="msgfolderroot",p="sharedFolderTree",m="primaryFolderTree",h="archiveFolderTree",f="favorites",g="groups",v="searchfolders"},752097:(e,t,n)=>{"use strict";n.d(t,{$:()=>a,M:()=>o});var i=n(964659),r=n(55461);function o(e){var t;const n=(0,i.c6)().SegmentationSettings,o=null===(t=(0,i.c6)().SessionSettings)||void 0===t?void 0:t.IsShadowMailbox;return"junkemail"===e?!!(null==n?void 0:n.JunkEMail):"notes"!==e||!!(null==n?void 0:n.StickyNotes)&&(0,r.cr)("cal-stickyNotesFolder")&&!o}var s=n(954947);function a(){const e=(0,s.Z)()?["inbox","junkemail","drafts","sentitems","scheduled","deleteditems","archive"]:["inbox","drafts","sentitems","scheduled","deleteditems","junkemail","archive"];return(0,r.cr)("notes-folder-view")&&e.push("notes"),e}},841847:(e,t,n)=>{"use strict";n.d(t,{S:()=>i});const i=(0,n(371134).aD)("FETCH_ARCHIVE_DUMPSTER_FOLDER",(e=>({mailboxInfo:e})))},613979:(e,t,n)=>{"use strict";n.d(t,{P:()=>i});const i=(0,n(371134).aD)("FETCH_DUMPSTER_FOLDER",(e=>({mailboxInfo:e})))},609999:(e,t,n)=>{"use strict";n.d(t,{z:()=>i});const i=(0,n(371134).aD)("FETCH_SEARCH_FOLDERS",((e,t)=>({mailboxInfo:e,rootFolder:t})))},734634:(e,t,n)=>{"use strict";n.d(t,{D:()=>i});const i=(0,n(371134).aD)("ON_QUERY_FOLDERHIERARCHY",((e,t,n,i,r,o,s,a,l)=>({rootFolder:e,folders:t,distinguishedFolderId:n,principalSMTPAddress:i,displayName:r,folderTreeIdentifier:o,userIdentity:s,includesLastItemInRange:a,offset:l})))},197213:(e,t,n)=>{"use strict";n.d(t,{av:()=>r,p4:()=>o,a:()=>s,re:()=>a,Eu:()=>l,$v:()=>c,EH:()=>d,uE:()=>u,_J:()=>p,HI:()=>m});var i=n(371134);const r=(0,i.aD)("GET_ARCHIVE_FOLDERS",((e,t,n)=>({mailboxInfo:e,source:t,isLoadingMore:n}))),o=(0,i.aD)("INITIALIZE_ARCHIVE_FOLDER_TREE",(e=>({mailboxInfo:e}))),s=(0,i.aD)("GET_FOLDER_PERMISSIONS",(e=>({folderId:e}))),a=(0,i.aD)("GET_FOLDER_PERMISSIONS_SUCCESS"),l=(0,i.aD)("GET_FOLDER_PERMISSIONS_FAILED"),c=(0,i.aD)("UPDATE_FOLDER_PERMISSIONS",((e,t,n)=>({folderId:e,permissions:t,mailboxInfo:n}))),d=(0,i.aD)("UPDATE_FOLDER_PERMISSIONS_IN_STORE",((e,t)=>({folderId:e,permissions:t}))),u=(0,i.aD)("UPDATE_FOLDER_PERMISSIONS_SUCCESS"),p=(0,i.aD)("UPDATE_FOLDER_PERMISSIONS_FAILED"),m=(0,i.aD)("ADD_NEW_FOLDER_TO_STORE",((e,t,n,i,r)=>({folderStore:e,folder:t,parentFolderId:n,displayName:i,mailboxInfo:r})))},336867:(e,t,n)=>{"use strict";n.d(t,{O:()=>i});const i=(0,n(371134).aD)("SET_LOADING_STATE_FOR_FOLDER_TREE",((e,t,n)=>({folderTreeId:e,loadingState:t,userIdentity:n})))},933658:(e,t,n)=>{"use strict";n.d(t,{p0:()=>E.Z,SX:()=>w.S,HI:()=>I.HI,ZP:()=>ue,vc:()=>g,fM:()=>R.f,fL:()=>V.Z,mH:()=>j,Gg:()=>M,en:()=>ae.en,Eu:()=>I.Eu,re:()=>I.re,Xe:()=>l.Z,Yw:()=>q.Z,Bj:()=>U.Z,Op:()=>b.Z,rn:()=>ae.rn,_S:()=>s._,dh:()=>le.d,n_:()=>f.Z,t0:()=>ee,AC:()=>W.Z,bh:()=>i.Z,Hv:()=>Z,p4:()=>I.p4,cO:()=>K,T:()=>B,p$:()=>ae.p$,qS:()=>re.ZP,ap:()=>se,I7:()=>oe,tA:()=>ce.tA,Di:()=>re.Di,D8:()=>de.D8,cR:()=>de.cR,Mq:()=>de.Mq,Fy:()=>de.Fy,ku:()=>de.ku,EF:()=>de.EF,qb:()=>de.qb,j:()=>de.j,o1:()=>de.yo,aY:()=>de.aY,DJ:()=>S,DE:()=>x.D,vM:()=>a,jQ:()=>v,$b:()=>C,mt:()=>P,Oy:()=>o.O,Nz:()=>ie,_J:()=>I._J,uE:()=>I.uE});var i=n(993543),r=n(371134),o=n(336867),s=n(493783);(0,r.ed)(o.O,(e=>{const{folderTreeId:t,userIdentity:n}=e,i=(0,s.Z)(n).get(t);i&&(i.loadingState=e.loadingState)}));const a=(0,r.aD)("PERSONA_SEARCH_FOLDERS_LOADED",((e,t)=>({existingFolders:e,personFavorites:t})));var l=n(468849),c=n(973218),d=n(20408);(0,r.ed)(a,(e=>{e.existingFolders.forEach((t=>{var n;if(null===(n=null==t?void 0:t.FolderId)||void 0===n?void 0:n.Id){const n=t.FolderId.Id,i=e.personFavorites.filter((e=>e.searchFolderId===n));if(1===i.length){const e=i[0].displayName,n=Object.assign(Object.assign({},(0,c.h3)(t,(0,d.fF)())),{displayName:e});(0,l.Z)().set(t.FolderId.Id,n)}}}))}));var u=n(448259),p=n(572561),m=n(414691),h=n(136947),f=n(85615);const g=(0,h.aD)("removeFolderFromParentFolder")((function(e,t){const n=(null==t?void 0:t.folderTable)||(0,l.Z)();e.forEach((e=>{n.delete(e)}))})),v=(0,h.aD)("removeFolderFromParentFolder")((function(e,t){const n=(null==t?void 0:t.folderTable)||(0,l.Z)();if(!(null==e?void 0:e.parentFolderId))return;let i=n.get(e.parentFolderId);(0,p.U$)()&&(null==i?void 0:i.distinguishedFolderType)===m.qx&&(i=(0,f.Z)(e.mailboxInfo.mailboxSmtpAddress));const r=null==i?void 0:i.childFolderIds,o=null==r?void 0:r.indexOf(e.id);void 0!==o&&o>-1&&(null==r||r.splice(o,1))}));function y(e,t,n){let i=t.folderTable.get(n);(0,p.U$)()&&(null==i?void 0:i.distinguishedFolderType)===m.qx&&(i=(0,f.Z)(e.mailboxInfo.mailboxSmtpAddress));const r=(null==i?void 0:i.childFolderIds)||[];ie(j(e),e.id,n,r)}const S=(0,h.aD)("moveFolderToParentFolder")((function(e,t,n,r){const o=((null==r?void 0:r.folderTable)||(0,l.Z)()).get(e);o&&(v(o,r),y(o,r||i.p,t),o.parentFolderId=t,o.mailboxInfo=n)}));var b=n(598928),I=n(197213);(0,r.ed)(I.HI,(e=>{!function(e,t,n,i,r){const o=(0,b.Z)(n),s=(0,l.Z)().get(n);s||u.g4.warn("addFolderToStore: parent folder was not found");const a=Object.assign(Object.assign({},(0,c.h3)(t,r||s.mailboxInfo)),{displayName:i,childFolderIds:[]});e.folderTable.set(t.FolderId.Id,a),y(a,e,o)}(e.folderStore,e.folder,e.parentFolderId,e.displayName,e.mailboxInfo)}));var w=n(571667);const C=(0,r.aD)("REMOVE_FOLDERTREE_DATA",((e,t)=>({folderTreeId:e,userIdentity:t})));var E=n(695474);const P=(0,r.lr)("setFolderTreeData",((e,t,n,i=!1,r=0,o)=>{const a=(0,s.Z)(null!=o?o:t.mailboxInfo.userIdentity),l=a.get(e);l?(l.id=e,l.rootFolder=t,l.loadingState=n,l.hasMoreData=i,l.currentLoadedIndex=r):a.set(e,{id:e,rootFolder:t,loadingState:n,hasMoreData:i,currentLoadedIndex:r})}));var T=n(964659),R=n(635856);(0,r._F)(I.p4,(e=>{var t,n;const i=e.mailboxInfo,r=(0,T.pX)(i).SessionSettings,o={distinguishedFolderType:m.Yo,displayName:null==r?void 0:r.ArchiveDisplayName,mailboxInfo:{type:"ArchiveMailbox",userIdentity:i.userIdentity,mailboxSmtpAddress:(0,R.f)(null!==(t=null==r?void 0:r.ArchiveMailboxGuid)&&void 0!==t?t:"",null!==(n=null==r?void 0:r.OrganizationDomain)&&void 0!==n?n:"")}};P(m.Yo,o,E.Z.Uninitialized,!1,0,i.userIdentity)})),(0,r.ed)(C,(e=>{(0,s.Z)(e.userIdentity).delete(e.folderTreeId)}));var x=n(734634),k=n(101060),N=n(961081),A=n(907831);(0,r._F)(x.D,(e=>{const{displayName:t,folders:n,folderTreeIdentifier:i,includesLastItemInRange:r,offset:o,principalSMTPAddress:s,rootFolder:a,userIdentity:c}=e;(0,A.k)(t,a,n,(e=>(0,N.h)(e,s))),P(i,(0,l.Z)().get(a.id),E.Z.Loaded,!r,o,c);const d=a.mailboxInfo.type,u=a.id;if("UserMailbox"===d||"ArchiveMailbox"===d){for(let e=0;e<n.length;e++){const t=n[e],i=t.id,r=t.distinguishedFolderType,o=t.mailboxInfo;("UserMailbox"===d||t.parentFolderId==u)&&!(0,k.LP)(r)&&r&&(0,T.iE)(r,i,o)}a.distinguishedFolderType&&(0,T.iE)(a.distinguishedFolderType,u,a.mailboxInfo)}}));var D=n(168462);function Z(e){const t=(0,l.Z)().get(e);if(!(null==t?void 0:t.childFolderIds))return!1;return t.childFolderIds.map((e=>!!(0,l.Z)().get(e))).length>0}function M(e,t){return O(e,0,t)}function O(e,t,n){const i=[];if(0===t){const r=O(e,t+1,n);i.push(...r)}else e.forEach((e=>{const r=(0,l.Z)().get(e);if(r&&(i.push(Object.assign(Object.assign({},r),{depth:t})),Z(e)&&n(e)&&r.childFolderIds)){const e=O(r.childFolderIds,t+1,n);i.push(...e)}}));return i}var F=n(559621);let _,L={folderTable:new F.ObservableMap,mailboxFolderTreeData:new F.ObservableMap};let z=function(e){L.folderTable.set(e.id,e),e.parentFolderId&&L.folderTable.get(e.parentFolderId).childFolderIds.push(e.id),e.distinguishedFolderType&&(_[e.distinguishedFolderType]=e.id)};z=(0,h.aD)("addFolderToStore-TestMethod")(z);const B=(0,r.aD)("INITIALIZE_SHARED_FOLDERS",(e=>({mailboxInfo:e})));var V=n(281181),U=n(105755);var q=n(637466),W=n(913669),H=n(552542);function j(e){var t,n,i;return e?(null===(n=null===(t=(0,H.Z)())||void 0===t?void 0:t.SessionSettings)||void 0===n?void 0:n.IsShadowMailbox)&&(null===(i=e.remoteFolderInfo)||void 0===i?void 0:i.remoteFolderDisplayName)?e.remoteFolderInfo.remoteFolderDisplayName:e.displayName:""}const G=(0,r.lr)("setMailboxFolderTreeData",((e,t)=>{(0,i.Z)().mailboxFolderTreeData.set(e,t)}));function K(e){(0,s._)(e)||G(e,function(e){return{folderTreeTable:new F.ObservableMap({[m.qx]:{id:m.qx,rootFolder:{distinguishedFolderType:m.qx,displayName:m.qx,mailboxInfo:(0,d.fF)(e)},loadingState:E.Z.Uninitialized}}),sharedFolderUserEmails:[]}}(e))}var X=n(874191),$=n(717420);const J=new $.EF(new $.nI((()=>Promise.all([n.e(3918),n.e(1627),n.e(51741)]).then(n.bind(n,681805)))),(e=>e.fetchPrimaryMailFolders));var Q=n(55461),Y=n(981283);async function ee(e,t,n){var i;const r=(0,d.fF)(t);t||(t=r.userIdentity),K(t);const s=(0,U.Z)(m.qx,t);if(s==E.Z.Loading||s==E.Z.Loaded&&!e)return;(0,o.O)(m.qx,E.Z.Loading,t);let a=!(0,Q.cr)("tri-disableSDFolders")&&(0,Y.N)(n,r);try{if(!a){const e=await J.import();a=await e(r)}}catch(e){return void(0,o.O)(m.qx,E.Z.ErrorLoading,t)}if(!a)return void(0,o.O)(m.qx,E.Z.ErrorLoading,t);const c=(null===(i=(0,T.pX)(r).SessionSettings)||void 0===i?void 0:i.UserEmailAddress)===t?(0,H.Z)().SessionSettings.UserDisplayName:t;(0,x.D)(a.RootFolder,a.Folders,m.qx,t,c,m.qx,t,a.IncludesLastItemInRange,a.offset),function(e){var t,n;const i=null===(t=(0,l.Z)().get((0,D.Z)("inbox",e)))||void 0===t?void 0:t.childFolderIds.length,r=null===(n=(0,l.Z)().get((0,D.Z)("msgfolderroot",e)))||void 0===n?void 0:n.totalMessageCount;(0,X.y8)("TnS_LoadFolders",[i,r])}(r)}n(417771);var te=n(752097),ne=n(866371);function ie(e,t,n,r){if(!r.includes(t)){let o=!1;const s=e.toLowerCase(),a=(0,te.$)();let l=(0,ne.Z)(n)===m.qx?a.length:0;for(;l<r.length&&!o;l++){const e=i.p.folderTable.get(r[l]);if(e){j(e).toLowerCase()>s&&(r.splice(l,0,t),o=!0)}}o||r.push(t)}}var re=n(285880);function oe(e,t={folderTable:i.p.folderTable}){return(0,re.Di)(e,"msgfolderroot",t)}function se(e){return(0,re.ZP)(i.p.folderTable.get(e),"msgfolderroot")}var ae=n(900693),le=n(602565),ce=n(837844),de=n(709412);const ue=i.p},709412:(e,t,n)=>{"use strict";n.d(t,{ku:()=>l,EF:()=>c,yo:()=>d,aY:()=>u,Fy:()=>p,Mq:()=>m,cR:()=>h,D8:()=>f,qb:()=>g,j:()=>v});var i=n(717420),r=n(609999),o=n(613979),s=n(841847);const a=new i.nI((()=>Promise.all([n.e(3918),n.e(1627),n.e(51741)]).then(n.bind(n,681805)))),l=new i.EF(a,(e=>e.getArchiveFolders)),c=new i.EF(a,(e=>e.getFolderPermissions)),d=new i.EF(a,(e=>e.updateFolderPermissions)),u=new i.EF(a,(e=>e.updateFolderPermissionsInStore)),p=new i._5(a,(e=>e.fetchSearchFolders)),m=new i._5(a,(e=>e.fetchDumpsterFolder)),h=new i._5(a,(e=>e.fetchArchiveDumpsterFolder)),f=new i.EF(a,(e=>e.arePermissionArraysEqual)),g=(new i.EF(a,(e=>e.arePermissionsEqual)),new i.EF(a,(e=>e.getSharedFolders))),v=new i._5(a,(e=>e.updateFolder));(0,i.Kv)(r.z,a,(e=>e.fetchSearchFoldersOrchestrator)),(0,i.Kv)(o.P,a,(e=>e.fetchDumpsterFolderOrchestrator)),(0,i.Kv)(s.S,a,(e=>e.fetchArchiveDumpsterFolderOrchestrator))},571667:(e,t,n)=>{"use strict";n.d(t,{S:()=>a});var i=n(559621),r=n(371134),o=n(993543),s=n(468849);const a=(0,r.lr)("addFoldersToFolderTableMutator",(e=>{0==(0,s.Z)().size&&((0,o.Z)().folderTable=new i.ObservableMap),Object.keys(e).forEach((t=>{const n=JSON.stringify(e[t]);if(JSON.stringify((0,s.Z)().get(t))!=n){const e=JSON.parse(n);(0,s.Z)().set(t,e)}}))}))},961081:(e,t,n)=>{"use strict";n.d(t,{h:()=>r});var i=n(468849);function r(e,t){return(0,i.Z)().has(e.id)?(0,i.Z)().get(e.id):Object.assign({childFolderIds:[],principalSMTPAddress:t},e)}},907831:(e,t,n)=>{"use strict";n.d(t,{k:()=>l});var i=n(571667),r=n(371134),o=n(468849);const s=(0,r.lr)("updateFolder",((e,t,n,i)=>{t&&(e.displayName=t),i.forEach((e=>{const t=n[e],i=n[t.parentFolderId]||(0,o.Z)().get(t.parentFolderId);(null==i?void 0:i.childFolderIds)&&-1==i.childFolderIds.indexOf(e)&&i.childFolderIds.push(e)}))}));var a=n(752097);function l(e,t,n,r){const o={},l=o[t.id]=r(t),c=[];for(let e=0;e<n.length;e++){const t=n[e],i=t.id,s=t.distinguishedFolderType;(0,a.M)(s)&&(o[i]=r(t),c.push(i))}s(l,e,o,c),(0,i.S)(o)}},281181:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(557369),r=n(414691);function o(e){return(0,i.Z)(r.Yo,e)}},468849:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(993543);function r(){return(0,i.Z)().folderTable}},637466:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(493783);function r(e,t){const n=(0,i.Z)(t),r=n&&n.get(e);return(null==r?void 0:r.currentLoadedIndex)||0}},105755:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(695474),r=n(493783);function o(e,t){const n=(0,r.Z)(t),o=n&&n.get(e);return(null==o?void 0:o.loadingState)||i.Z.Uninitialized}},493783:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o,_:()=>s});var i=n(448259),r=n(993543);function o(e){const t=s(null!=e?e:"");return t||i.g4.warn(`getMailboxFolderTreeDataTable Failure:${(0,r.Z)().mailboxFolderTreeData.size} identities in store`),null==t?void 0:t.folderTreeTable}function s(e){return(0,r.Z)().mailboxFolderTreeData.get(e)}},85615:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(557369),r=n(414691);function o(e){return(0,i.Z)(r.qx,e)}},557369:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(493783);function r(e,t){const n=(0,i.Z)(t),r=n&&n.get(e);return null==r?void 0:r.rootFolder}},913669:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(557369);function r(e,t){return(0,i.Z)(e,t)}},695474:(e,t,n)=>{"use strict";var i;n.d(t,{Z:()=>r}),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.ErrorLoading=3]="ErrorLoading"}(i||(i={}));const r=i},993543:(e,t,n)=>{"use strict";n.d(t,{p:()=>o,Z:()=>s});var i=n(371134),r=n(559621);const o=(0,i.MT)("folderStore",{folderTable:new r.ObservableMap,mailboxFolderTreeData:new r.ObservableMap})(),s=()=>o},981283:(e,t,n)=>{"use strict";n.d(t,{N:()=>s});var i=n(179124),r=n(973218),o=n(752097);function s(e,t){var n,s,a,l;let c=null==e?void 0:e.folderHierarchy,d="s";if(!c){const u=null===(l=null===(a=null===(s=null===(n=null==e?void 0:e.findFolders)||void 0===n?void 0:n.Body)||void 0===s?void 0:s.ResponseMessages)||void 0===a?void 0:a.Items)||void 0===l?void 0:l[0];if(u)if("Error"==u.ResponseClass)d="e",(0,i.yI)("ffr_c",u.ResponseCode||"un");else try{c=(0,r.KV)(u,t,(0,o.M)("junkemail"),(0,o.M)("notes"))}catch(e){d="m",(0,i.yI)("ffr_c",e.message)}else d="nrm"}return(0,i.yI)("ffr",d),c}},900693:(e,t,n)=>{"use strict";n.d(t,{en:()=>u,rn:()=>p,p$:()=>m});var i=n(168462),r=n(866371),o=n(85615),s=n(468849),a=n(281181),l=n(913669),c=n(752097),d=n(20408);function u(e,t){const n=(0,s.Z)(),r=(0,i.Z)(e,(0,d.fF)(t));return r?n.get(r):void 0}function p(e){var t;if("SharedMailbox"===e.type&&!e.mailboxSmtpAddress)throw new Error("To get all the shared folders you must pass principalSMTPAddress");let n,i=[];const s=e.userIdentity;switch(e.type){case"ArchiveMailbox":n=(0,a.Z)(e.userIdentity);break;case"SharedMailbox":n=(0,l.Z)(e.mailboxSmtpAddress,e.userIdentity);break;default:n=(0,o.Z)(e.userIdentity)}const d=(0,c.$)();if("UserMailbox"==e.type&&n.distinguishedFolderType==(0,o.Z)(s).distinguishedFolderType&&n.id){const e=d.map((e=>u(e,s))).filter((e=>e&&e.parentFolderId===(null==n?void 0:n.id)));i=s?e.filter((e=>(null==e?void 0:e.mailboxInfo.userIdentity)===s)).map((e=>null==e?void 0:e.id)):e.map((e=>null==e?void 0:e.id))}const p=null!==(t=null==n?void 0:n.childFolderIds)&&void 0!==t?t:[];for(let e=0;e<p.length;e++){const t=p[e];t&&-1===d.indexOf((0,r.Z)(t))&&i.push(t)}return i}function m(e,t){const n=(0,s.Z)().get(e);return(null==n?void 0:n.mailboxInfo.type)===t}},532227:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(73325),r=n(964659),o=n(226362);function s(){var e;const t=(0,i.G2)();return t||(null===(e=(0,r.pX)((0,o.B6)()).SessionSettings)||void 0===e?void 0:e.UserEmailAddress)}},598928:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(168462),r=n(993543),o=n(899147);function s(e){let t=(0,i.Z)(e);if(t||(t=e),(0,r.Z)().folderTable.get(t))return(0,r.Z)().folderTable.get(t).id;return(0,o.Z)({Id:t,__type:"FolderId:#Exchange"}).Id}},602565:(e,t,n)=>{"use strict";n.d(t,{d:()=>d});var i=n(20408),r=n(468849),o=n(414691),s=n(552542),a=n(635856),l=n(964659),c=n(226362);function d(e,t){var n,d,u,p;const m=(0,r.Z)(),h=null==m?void 0:m.get(e),f=(0,s.Z)().SessionSettings;let g,v,y,S;const b=(0,i.fF)(null!==(n=null==h?void 0:h.mailboxInfo.userIdentity)&&void 0!==n?n:void 0);return"SharedMailbox"===(null==h?void 0:h.mailboxInfo.type)?(g=h.mailboxInfo.mailboxSmtpAddress,S="SharedMailbox"):e==o.Yo||e==o.Rg||"ArchiveMailbox"==(null==h?void 0:h.mailboxInfo.type)?(y=null===(d=null==h?void 0:h.replicaList)||void 0===d?void 0:d[0],y&&t?v=y:(v=null===(p=(0,l.pX)(null!==(u=null==h?void 0:h.mailboxInfo)&&void 0!==u?u:(0,c.B6)()).SessionSettings)||void 0===p?void 0:p.ArchiveMailboxGuid,y=void 0),S="ArchiveMailbox",g=(0,a.f)(v,f.OrganizationDomain)):(g=b.mailboxSmtpAddress,S="UserMailbox"),{type:S,userIdentity:b.userIdentity,mailboxSmtpAddress:g,auxiliaryMailboxGuid:y}}},837844:(e,t,n)=>{"use strict";n.d(t,{tA:()=>r});var i=n(448259);function r(e){if(!e)return!1;try{const t=atob(e);let n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);let i=0;return 1===n[0]?n=o(n):i=1,n&&1===n[i]}catch(e){return!1}}function o(e){const t=s(e,null);if(0==t)return i.rx("rleDecompress : Invalid id"),null;const n=new Uint8Array(t);return s(e,n),n}function s(e,t){let n=0;for(let r=1;r<e.length;++r)if(r==e.length-1||e[r]!=e[r+1])null!=t&&(t[n]=e[r]),n++;else{if(r==e.length-2)return i.rx("decompressEx : Invalid id"),null;const o=e[r+2];for(let i=0;i<o+2;i++)null!=t&&(t[n]=e[r]),n++;r+=2}return n}},285880:(e,t,n)=>{"use strict";n.d(t,{eI:()=>r,Di:()=>o,ZP:()=>s});var i=n(993543);function r(e){return"msgfolderroot"===e.distinguishedFolderType}const o=function(e,t,n={folderTable:i.p.folderTable}){const r=!!e&&e.parentFolderId;if(!r)return!1;let o=n.folderTable.get(r);for(;o;){if(o.distinguishedFolderType==t)return!0;if(!o.parentFolderId)return!1;o=n.folderTable.get(o.parentFolderId)}return!1};function s(e,t,n={folderTable:i.p.folderTable}){return function(e,t){return!!e&&e.distinguishedFolderType==t}(e,t)||o(e,t,n)}},635856:(e,t,n)=>{"use strict";n.d(t,{f:()=>r});var i=n(101060);n(837844),n(448259);function r(e,t){if(!e||!t)return null;return i.WU("{0}@{1}",e,t)}},417771:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(961081),r=n(907831),o=n(964659),s=n(532227);function a(e,t){const n=(0,s.Z)();(0,r.k)(null,e,t,(e=>(0,i.h)(e,n)));const a=e;a.distinguishedFolderType&&(0,o.iE)(a.distinguishedFolderType,a.id,a.mailboxInfo)}},980998:(e,t,n)=>{"use strict";function i(e){var t;return null!==(t=e.localizedName)&&void 0!==t?t:e.name}n.d(t,{kT:()=>r,HI:()=>o,um:()=>l,zk:()=>c,BN:()=>s,Rs:()=>d,O:()=>u,QC:()=>i});const r=[{name:"Arial",family:"Arial,Helvetica,sans-serif"},{name:"Arial Black",family:"'Arial Black',Arial,sans-serif"},{name:"Calibri",family:"Calibri,Helvetica,sans-serif"},{name:"Calibri Light",family:"'Calibri Light','Helvetica Light',sans-serif"},{name:"Cambria",family:"Cambria,Georgia,serif"},{name:"Candara",family:"Candara,Optima,sans-serif"},{name:"Century Gothic",family:"'Century Gothic',sans-serif"},{name:"Comic Sans MS",family:"'Comic Sans MS',Chalkboard,cursive"},{name:"Consolas",family:"Consolas,Courier,monospace"},{name:"Constantia",family:"Constantia,'Hoefler Text',serif"},{name:"Corbel",family:"Corbel,Skia,sans-serif"},{name:"Courier New",family:"'Courier New',monospace"},{name:"Franklin Gothic Book",family:"'Franklin Gothic Book','Avenir Next Condensed',sans-serif"},{name:"Franklin Gothic Demi",family:"'Franklin Gothic Demi','Avenir Next Condensed Demi Bold',sans-serif"},{name:"Franklin Gothic Medium",family:"'Franklin Gothic Medium','Avenir Next Condensed Medium',sans-serif"},{name:"Garamond",family:"Garamond,Georgia,serif"},{name:"Georgia",family:"Georgia,serif"},{name:"Impact",family:"Impact,Charcoal,sans-serif"},{name:"Lucida Console",family:"'Lucida Console',Monaco,monospace"},{name:"Lucida Handwriting",family:"'Lucida Handwriting','Apple Chancery',cursive"},{name:"Lucida Sans Unicode",family:"'Lucida Sans Unicode','Lucida Grande',sans-serif"},{name:"Palatino Linotype",family:"'Palatino Linotype','Book Antiqua',Palatino,serif"},{name:"Segoe UI",family:"'Segoe UI', 'Segoe UI Web (West European)', 'Helvetica Neue', sans-serif"},{name:"Sitka Heading",family:"'Sitka Heading',Cochin,serif"},{name:"Sitka Text",family:"'Sitka Text',Cochin,serif"},{name:"Tahoma",family:"Tahoma,Geneva,sans-serif"},{name:"Times",family:"Times,'Times New Roman',serif"},{name:"Times New Roman",family:"'Times New Roman',Times,serif"},{name:"Trebuchet MS",family:"'Trebuchet MS',Trebuchet,sans-serif"},{name:"TW Cen MT",family:"'TW Cen MT','Century Gothic',sans-serif"},{name:"Verdana",family:"Verdana,Geneva,sans-serif"},{name:"-",family:"-"},{name:"Microsoft YaHei",family:"'Microsoft YaHei','',STHeiti,sans-serif",localizedName:""},{name:"SimHei",family:"SimHei,'',STHeiti,sans-serif",localizedName:""},{name:"NSimSun",family:"NSimSun,'',SimSun,'',SimSun-ExtB,'-ExtB',STSong,serif",localizedName:""},{name:"FangSong",family:"FangSong,'',STFangsong,serif",localizedName:""},{name:"SimLi",family:"SimLi,'','Baoli SC',serif",localizedName:""},{name:"KaiTi",family:"KaiTi,'',STKaiti,serif",localizedName:""},{name:"-",family:"-"},{name:"Microsoft JhengHei",family:"'Microsoft JhengHei','','Apple LiGothic',sans-serif",localizedName:""},{name:"PMingLiU",family:"PMingLiU,'',PMingLiU-ExtB,'-ExtB','Apple LiSung',serif",localizedName:""},{name:"DFKai-SB",family:"DFKai-SB,'','BiauKai',serif",localizedName:""},{name:"-",family:"-"},{name:"Meiryo",family:"Meiryo,'','Hiragino Sans',sans-serif",localizedName:""},{name:"MS PGothic",family:"'MS PGothic',' ','MS Gothic',' ','Hiragino Kaku Gothic ProN',sans-serif",localizedName:" "},{name:"MS PMincho",family:"'MS PMincho',' ','MS Mincho',' ','Hiragino Mincho ProN',serif",localizedName:" "},{name:"Yu Gothic",family:"'Yu Gothic','','YuGothic',sans-serif",localizedName:""},{name:"Yu Mincho",family:"'Yu Mincho','','YuMincho',serif",localizedName:""},{name:"-",family:"-"},{name:"Malgun Gothic",family:"'Malgun Gothic',' ',AppleGothic,sans-serif",localizedName:" "},{name:"Gulim",family:"Gulim,'','Nanum Gothic',sans-serif",localizedName:""},{name:"Dotum",family:"Dotum,'',AppleGothic,sans-serif",localizedName:""},{name:"Batang",family:"Batang,'',AppleMyungjo,serif",localizedName:""},{name:"BatangChe",family:"BatangChe,'',AppleMyungjo,serif",localizedName:""},{name:"Gungsuh",family:"Gungsuh,'',GungSeo,serif",localizedName:""},{name:"-",family:"-"},{name:"Leelawadee UI",family:"'Leelawadee UI',Thonburi,sans-serif"},{name:"Angsana New",family:"'Angsana New','Leelawadee UI',Sathu,serif"},{name:"Cordia New",family:"'Cordia New','Leelawadee UI',Silom,sans-serif"},{name:"DaunPenh",family:"DaunPenh,'Leelawadee UI','Khmer MN',sans-serif"},{name:"-",family:"-"},{name:"Nirmala UI",family:"'Nirmala UI',sans-serif"},{name:"Gautami",family:"Gautami,'Nirmala UI','Telugu MN',sans-serif"},{name:"Iskoola Pota",family:"'Iskoola Pota','Nirmala UI','Sinhala MN',sans-serif"},{name:"Kalinga",family:"Kalinga,'Nirmala UI','Oriya MN',sans-serif"},{name:"Kartika",family:"Kartika,'Nirmala UI','Malayalam MN',sans-serif"},{name:"Latha",family:"Latha,'Nirmala UI','Tamil MN',sans-serif"},{name:"Mangal",family:"Mangal,'Nirmala UI','Devanagari Sangam MN',sans-serif"},{name:"Raavi",family:"Raavi,'Nirmala UI','Gurmukhi MN',sans-serif"},{name:"Shruti",family:"Shruti,'Nirmala UI','Gujarati Sangam MN',sans-serif"},{name:"Tunga",family:"Tunga,'Nirmala UI','Kannada MN',sans-serif"},{name:"Vrinda",family:"Vrinda,'Nirmala UI','Bangla MN',sans-serif"},{name:"-",family:"-"},{name:"Nyala",family:"Nyala,Kefa,sans-serif"},{name:"Sylfaen",family:"Sylfaen,Mshtakan,Menlo,serif"}],o=r.map((e=>({selectValue:e.name,displayValue:i(e),submitValue:e.family})));function s(e){const t=function(e){const t=e.toUpperCase();for(let e=0;e<r.length;e++){const n=r[e];if(n.name.toUpperCase()==t||n.localizedName&&n.localizedName.toUpperCase()==t)return n}}(e);return t?t.family:null}const a=[8,10,12,14,18,24,36],l=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],c=l.map((e=>e.toString())).map((e=>({selectValue:e,displayValue:e,submitValue:e})));function d(e){return"number"==typeof e&&e<=7?a[e-1]:e}function u(e){const t=d(e).toString();return t?t+"pt":t}},663629:(e,t,n)=>{"use strict";n.d(t,{fs:()=>o,vL:()=>s,xw:()=>a});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(52637),n.e(56337),n.e(9598),n.e(42106),n.e(56841),n.e(90885),n.e(36856),n.e(99458),n.e(94229),n.e(77456),n.e(99110),n.e(80964),n.e(63293),n.e(32724)]).then(n.bind(n,494076)))),o=(0,i.$y)(r,(e=>e.GALRecipientWellModal)),s=(0,i.$y)(r,(e=>e.GALRecipientWellModalFromViewstate)),a=(0,i.$y)(r,(e=>e.DeferredChangesGALRecipientWellModalFromViewstate))},733789:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(116965);const r=(0,n(136947).aD)("addInfoBarMessage")((function(e,t,n){if(e){-1==e.infoBarIds.indexOf(t)?e.infoBarIds.push(t):e.infoBarIds=[...e.infoBarIds];const r=e.infoBarHostKey;n&&(i.K[r]||(i.K[r]={}),i.K[r][t]=n)}}))},977643:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(116965),r=n(371134),o=n(448259);const s=(0,r.lr)("removeInfoBarMessages",((e,t,n)=>{e.infoBarIds.splice(t,1);const r=e.infoBarHostKey;i.K[r]&&(delete i.K[r][n],0===Object.keys(i.K[r]).length&&delete i.K[r])}));function a(e,t){try{if(e){const n=Array.isArray(t)?t:t?[t]:e.infoBarIds?[...e.infoBarIds]:[];for(const t of n){const n=e.infoBarIds?e.infoBarIds.indexOf(t):-1;n>=0&&s(e,n,t)}}}catch(e){o.rx("Error in removeInfoBarMessage",e)}}},116965:(e,t,n)=>{"use strict";n.d(t,{K:()=>i,Z:()=>r});const i={};function r(e,t){var n;const r=e.infoBarHostKey;return null===(n=i[r])||void 0===n?void 0:n[t]}},30811:(e,t,n)=>{"use strict";n.d(t,{mD:()=>i,pL:()=>r,b1:()=>o,l3:()=>s,V6:()=>a,pT:()=>l,R$:()=>c,vZ:()=>d,ww:()=>u,VW:()=>p,Ab:()=>m,Tu:()=>h,eI:()=>f,dk:()=>g,UL:()=>v,ik:()=>y,nr:()=>S,S0:()=>b,it:()=>I,Q8:()=>w,uW:()=>C});const i="LPNoLP",r="LPlnk",o="LPBorder",s="GT",a="BVT",l="LPContainer",c="LPImageContainer",d="LPImageAnchor",u="LPThumbnailImageId",p="LPTitle",m="LPUrlAnchor",h="LPMetadata",f="LPDescription",g="LPCloseButton",v="LPCloseButtonContainer",y="LPPlayButton",S="BingRTPLinkPreview:#Exchange",b="BingVideoLinkPreview:#Exchange",I="OWALinkPreview";function w(){return Math.floor(1e5+9e5*Math.random()).toString()}function C(e,t){return t+((n=e)&&n.slice(-6));var n}},833509:(e,t,n)=>{"use strict";n.d(t,{J:()=>d,l:()=>u});var i=n(874191),r=n(55461),o=n(77214),s=n(699110),a=n(954947),l=n(462480),c=n(233762);const d=async e=>{const t=(0,l.u)(),n=new i.Gn("OwaPeopleLoki_GetLokiAadAuthTokenOperation");n.addCustomProperty("RequestId",t);try{let l=null;if((0,a.Z)(e.userIdentity,e))l=await(0,s.getDelegationTokenForOwa)("liveprofilecard.access","loki",t,void 0,e);else{const n=(0,r.cr)("fwk-application-settings")?(0,o.Ry)("Loki").resourceUrl:u();l=await(0,s.getAccessTokenforResource)(n,"loki",t,void 0,void 0,void 0,e)}return l?(n.end(),l):(n.endWithError(i.SO.ServerError,Error("Token is empty.")),null)}catch(e){return n.endWithError(i.SO.ClientError,Error("Unexpected error.")),null}};function u(){switch((0,c.uD)()){case"BlackForest":return"https://loki.delve.office.de/";case"GccHigh":return"https://gcchigh.loki.office365.us/";case"DoD":return"https://dod.loki.office365.us/";case"Gallatin":return"https://loki.office365.cn/";case"AG08":case"AG09":return"https://loki.delve.office.com/";default:return(0,r.cr)("lpc-isInGccModerate")?"https://gcc.loki.delve.office.com/":"https://loki.delve.office.com/"}}},519316:(e,t,n)=>{"use strict";let i;n.d(t,{Ml:()=>s,Mf:()=>d,ld:()=>h,C3:()=>o,JN:()=>c,Kb:()=>m});const r=new Promise((e=>{i=e}));function o(e){null==i||i(e)}async function s(){return Promise.race([r,new Promise(((e,t)=>{setTimeout((()=>t()),45e3)}))])}let a;const l=new Promise((e=>{a=e}));function c(e){null==a||a(e)}async function d(){return Promise.race([l,new Promise(((e,t)=>{setTimeout((()=>t()),45e3)}))])}var u=n(329746),p=n(346357);function m(){const e=(0,p.D6)(),t=2===e||(0,u.X)("skipAwaitLpcConfig");return 262144===e||!t}function h(){o((e=>Promise.resolve({actionCallbacks:{composeMail:()=>{}},dataCallbacks:{}})))}},609076:(e,t,n)=>{"use strict";n.d(t,{h:()=>r});var i=n(989526);const r=({render:e,children:t,isAccountInitialized:n})=>e?i.createElement(e,{isAccountInitialized:n},t):i.createElement(i.Fragment,null,t)},826291:(e,t,n)=>{"use strict";n.d(t,{o:()=>r});var i=n(346357);function r(){const e=(0,i.D6)();return 4===e?"People":2===e?"Calendar":"Mail"}},856158:(e,t,n)=>{"use strict";n.d(t,{_:()=>o});var i=n(346357),r=n(325876);function o(){const e=(0,i.D6)();return(0,r.r0)()==r.B5?"OneOutlook":(0,r.r0)()==r.UV?"Teams_HUB":4===e?"OwaPeopleHub":2===e?"OwaCalendar":"OwaMail"}},779833:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(55461),r=n(78220);function o(){return{isLivePersonaCardV2Enabled:(0,i.cr)("lpc-isLPCV2Enabled"),isLokiContactDataDisabled:!!(0,r.ME)()}}},748895:(e,t,n)=>{"use strict";n.d(t,{v:()=>r});var i=n(325876);function r(){return(0,i.r0)()===i.B5||(0,i.r0)()===i.UV?"Desktop":"Web"}},859156:(e,t,n)=>{"use strict";n.d(t,{yD:()=>c,xQ:()=>d,wR:()=>u,oN:()=>r.o,vJ:()=>o.v,_v:()=>s._,ZB:()=>a.Z});var i=n(717420),r=n(826291),o=n(748895),s=n(856158),a=n(779833);const l=new i.nI((()=>n.e(99027).then(n.bind(n,499027)))),c=(0,i.$y)(l,(e=>e.SmartLPCHoverTarget)),d=(0,i.$y)(l,(e=>e.SmartEmbeddedExpandedViewForMailModule)),u=(0,i.$y)(l,(e=>e.SmartEmbeddedExpandedViewForPeopleHub))},391825:(e,t,n)=>{"use strict";n.d(t,{m:()=>r});var i=n(954947);function r(e,t,n){return!(0,i.Z)()&&("OneOff"==n||"Unknown"==n)&&(null==e?void 0:e.indexOf(t))<0}},162783:(e,t,n)=>{"use strict";function i(e){return"object"==typeof e&&null!==e&&e.hasOwnProperty("Text")&&e.hasOwnProperty("HTML")&&Object.keys(e).every((t=>a[e[t]]===t))}n.d(t,{on:()=>s,uc:()=>a,B9:()=>c});var r=n(165201);const o="compose.PREFERRED_EDITORS",s={Text:1,HTML:2},a={1:"Text",2:"HTML",3:"HTML"};let l=null;function c(){return null===l&&(l=function(){try{const e=JSON.parse((0,r.rV)(window,o));return i(e)?e:null}catch(e){return null}}()||Object.assign({},s)),Object.assign({},l)}},653348:(e,t,n)=>{"use strict";n.d(t,{s:()=>l});var i=n(72251),r=n(371134),o=n(563510),s=n(559621);const a=(0,r.MT)("signature-map",{entries:new s.ObservableMap})();function l(e){const t=(0,i.M4)(e),n=a.entries.get(t);return n||(a.entries.set(t,(0,o.Z)()),a.entries.get(t))}},563510:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(559621);function r(){return{legacySignature:{html:null,txt:null},roamingSignatureMap:new i.ObservableMap,defaultSignatureName:"",defaultReplySignatureName:""}}},805472:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).aD)("onMailTipRetrieved",((e,t)=>({composeId:e,fromAddress:t})))},680446:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).aD)("updateMailtips",((e,t,n)=>({composeId:e,fromEmailAddress:t,recipients:n})))},199215:(e,t,n)=>{"use strict";n.d(t,{AN:()=>i,MP:()=>r,Q1:()=>o,c7:()=>l,kg:()=>c,ib:()=>d,VK:()=>u,Sz:()=>p});var i,r,o,s=n(874191);function a(e){return[e.AutomaticReply,e.LargeAudience,e.ModeratedMailbox,e.PrefersAccessibility,e.MailboxFull,e.DeliveryRestricted,e.GuestMailtip,e.ExternalMembers,e.CustomMailtip]}!function(e){e[e.RemoveRecipient=0]="RemoveRecipient",e[e.ShowDetails=1]="ShowDetails",e[e.HideDetails=2]="HideDetails",e[e.RemoveAll=3]="RemoveAll",e[e.ShowMore=4]="ShowMore",e[e.ShowLess=5]="ShowLess",e[e.EmailClicked=6]="EmailClicked",e[e.AccCheckerClick=7]="AccCheckerClick"}(i||(i={})),function(e){e[e.None=0]="None",e[e.OutOfOffice=1]="OutOfOffice",e[e.LargeAudience=2]="LargeAudience",e[e.IsModerated=3]="IsModerated",e[e.CustomMailTip=4]="CustomMailTip",e[e.PreferAccessibleContent=5]="PreferAccessibleContent",e[e.MailboxFull=6]="MailboxFull",e[e.DeliveryRestricted=7]="DeliveryRestricted",e[e.GuestsDisabledGroupsWithGuests=8]="GuestsDisabledGroupsWithGuests",e[e.ExternalMemberCount=9]="ExternalMemberCount"}(r||(r={})),function(e){e[e.None=0]="None",e[e.SingleRecipient=1]="SingleRecipient",e[e.MultipleRecipients=2]="MultipleRecipients"}(o||(o={}));const l="MailtipsActionDatapoint";function c(e){Object.keys(e).some((t=>e[t]!=o.None))&&(0,s.y8)("RecipientRemovedFromRecipientWellDatapoint",a(e))}function d(e){Object.keys(e).some((t=>e[t]!=o.None))&&(0,s.y8)("SendActionMailTipsDatapoint",a(e))}function u(e){Object.keys(e).some((t=>e[t]!=o.None))&&(0,s.y8)("DiscardActionMailTipsDatapoint",a(e))}function p(e){return e>23?23:e}},117251:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(307997);function r(){return(0,i.b)().mailTips}},291995:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(114594),r=n(398327);function o(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"GetMailTipsJsonRequest:#Exchange"},n)),(0,r.S)("GetMailTips",e,t)}var s=n(802925),a=n(20408);function l(e,t){const n=(0,s.Z)((0,a.fF)(e));return o({Header:(0,i.F)(),Body:(r={MailTipsRequested:1,SendingAs:{EmailAddress:e},Recipients:t.map((e=>({EmailAddress:e})))},Object.assign({__type:"GetMailTipsRequest:#Exchange"},r))},n).then((e=>(null==e?void 0:e.Body)&&"Success"==e.Body.ResponseClass?e.Body:null)).catch((e=>Promise.resolve(null)));var r}},900055:(e,t,n)=>{"use strict";var i;n.d(t,{Y:()=>i}),function(e){e[e.None=0]="None",e[e.IsCalculated=1]="IsCalculated",e[e.GuestsEnabled=2]="GuestsEnabled",e[e.GroupHasGuests=4]="GroupHasGuests"}(i||(i={}))},764442:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(134432);class r extends i.c{constructor(e,t,n){super(t,n),this.value=e}}},307997:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h,b:()=>f});var i=n(371134),r=n(764442),o=n(134432),s=n(805472),a=n(680446),l=n(117251),c=n(291995);var d=n(37233),u=n(874191);(0,i._F)(a.Z,(async e=>{const{composeId:t,fromEmailAddress:n,recipients:i}=e;if(n&&i&&i.length){const e=(0,l.Z)(),o=i.filter((t=>t&&!e.containsValueForKey(n,t)));if(o.length){const e=await(0,c.Z)(n,o);if(e){const i=e.ResponseMessages.map((e=>(0,d.ZP)(e.MessageText))).filter((e=>!!e));i&&i.length>0&&(!function(e,t){if(e&&e.length>0&&t){const n=(0,l.Z)();e.map((e=>{n.add(t,new r.Z(e,t,e.RecipientAddress))}))}}(i,n),(0,s.Z)(t,n))}}const a=i.filter((e=>-1==o.indexOf(e)));(0,u.y8)("UpdateMailtipsDatapoint",{owa_1:a.length>0,rec:i.length,ca:a.length})}}));const p={mailTips:new o.m(r.Z.compareEntryCacheTime)},m=(0,i.MT)("mailTipsCacheStore",p)(),h=m,f=()=>m},585102:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(900055);function r(e,t,n){const r=e.map((e=>e.EmailAddress));return e.filter(((e,t)=>r.indexOf(e.EmailAddress)===t)).reduce(((e,r)=>{const o=t.get(n,r.EmailAddress),s=o?o.value:{};return s.DeliveryRestricted&&e.DeliveryRestricted.push(r),s.IsModerated&&e.IsModerated.push(r),s.MailboxFull&&e.MailboxFull.push(r),s.OutOfOffice&&e.OutOfOffice.push({recipient:r,message:s.OutOfOffice}),s.PreferAccessibleContent&&e.PreferAccessibleContent.push(r),s.GuestStatus&i.Y.IsCalculated&&s.GuestStatus&i.Y.GroupHasGuests?0==(s.GuestStatus&i.Y.GuestsEnabled)?e.GuestsDisabledGroupsWithGuests.push(r):e.ExternalMemberCount.push({recipient:r,count:1}):s.ExternalMemberCount&&e.ExternalMemberCount.push({recipient:r,count:s.ExternalMemberCount}),s.TotalMemberCount&&e.TotalMemberCount.push({recipient:r,count:s.TotalMemberCount}),s.CustomMailTip&&e.CustomMailTip.push({recipient:r,message:s.CustomMailTip}),e}),{CustomMailTip:[],DeliveryRestricted:[],ExternalMemberCount:[],IsModerated:[],MailboxFull:[],MaxMessageSize:[],OutOfOffice:[],PreferAccessibleContent:[],TotalMemberCount:[],GuestsDisabledGroupsWithGuests:[]})}},37233:(e,t,n)=>{"use strict";var i;n.d(t,{ZP:()=>l}),function(e){e.CustomMailTip="CustomMailTip",e.DeliveryRestricted="DeliveryRestricted",e.ExternalMemberCount="ExternalMemberCount",e.GuestMailTipStatus="GuestMailTipStatus",e.IsModerated="IsModerated",e.MailboxFull="MailboxFull",e.MaxMessageSize="MaxMessageSize",e.OutOfOffice="OutOfOffice",e.PreferAccessibleContent="PreferAccessibleContent",e.RecipientAddress="RecipientAddress",e.TotalMemberCount="TotalMemberCount"}(i||(i={}));const r=i;var o=n(900055);const s=/<!--((.|\n)*?)-->/gi,a=e=>{const t=[];for(let n=0;n<e.length;n++)t.push(e[n]);return t};function l(e){if(!e)return null;const t=(new DOMParser).parseFromString(e,"text/xml").firstChild.childNodes;return a(t).reduce(((e,t)=>{switch(t.localName){case r.RecipientAddress:t.childNodes.length>1&&(e.RecipientAddress=t.childNodes[1].textContent);break;case r.MailboxFull:e.MailboxFull="true"===t.textContent;break;case r.IsModerated:e.IsModerated="true"===t.textContent;break;case r.TotalMemberCount:e.TotalMemberCount=parseInt(t.textContent)||0;break;case r.ExternalMemberCount:e.ExternalMemberCount=parseInt(t.textContent)||0;break;case r.MaxMessageSize:e.MaxMessageSize=parseInt(t.textContent)||0;break;case r.DeliveryRestricted:e.DeliveryRestricted="true"===t.textContent;break;case r.PreferAccessibleContent:e.PreferAccessibleContent="true"===t.textContent;break;case r.OutOfOffice:e.OutOfOffice=c(t);break;case r.CustomMailTip:e.CustomMailTip=u(t);break;case r.GuestMailTipStatus:e.GuestStatus=d(t.textContent)}return e}),{})}const c=e=>{if(e.childNodes){return u(a(e.childNodes).filter((e=>"ReplyBody"===e.localName))[0])}return""},d=e=>{const t=e.split(" ");let n=o.Y.None;return t.map((e=>{n|=o.Y[e]})),n};function u(e){var t;if(e){const n=(e=>e.replace(s,""))(e.textContent).replace(/<\/a>/gi,"</a> "),i=(new DOMParser).parseFromString(n,"text/html");if((null===(t=null==i?void 0:i.childNodes)||void 0===t?void 0:t.length)&&i.childNodes[0].textContent)return i.childNodes[0].textContent.replace(/\s\s+/g," ").trim()}return""}},361346:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(199215),r=n(117251),o=n(585102),s=n(898482);function a(e,t){const n={},a=(0,o.Z)(e,(0,r.Z)(),t);return Object.keys(a).map((e=>{if(a[e].length>0){const t=a[e].length>1?i.Q1.MultipleRecipients:i.Q1.SingleRecipient;switch(e){case"TotalMemberCount":(0,s.Z)(a[e])&&(n.LargeAudience=t);break;case"CustomMailTip":n.CustomMailtip=t;break;case"DeliveryRestricted":n.DeliveryRestricted=t;break;case"ExternalMemberCount":n.ExternalMembers=t;break;case"GuestsDisabledGroupsWithGuests":n.GuestMailtip=t;break;case"IsModerated":n.ModeratedMailbox=t;break;case"MailboxFull":n.MailboxFull=t;break;case"OutOfOffice":n.AutomaticReply=t;break;case"PreferAccessibleContent":n.PrefersAccessibility=t}}})),n}},898482:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(552542);const r=e=>{const{totalRecipients:t,hasAGroup:n}=e.reduce(((e,t)=>({totalRecipients:e.totalRecipients+t.count,hasAGroup:e.hasAGroup||t.count>1})),{totalRecipients:0,hasAGroup:!1});return n&&t>=(0,i.Z)().MailTipsLargeAudienceThreshold}},836498:(e,t,n)=>{"use strict";n.d(t,{VL:()=>d,qb:()=>c,ar:()=>l,H:()=>o,PN:()=>a,KE:()=>s});var i=n(874191);const r="message_extension_logs",o=(e,t,n,o,s)=>{(0,i.y8)(r,Object.assign({LogLevel:"Error",LogModule:e,LogMessage:t,AppId:n,CorrelationId:o||""},s),{isCore:!0})},s=(e,t,n,o,s)=>{(0,i.y8)(r,Object.assign({LogLevel:"Warning",LogModule:e,LogMessage:t,AppId:n,CorrelationId:o||""},s),{isCore:!0})},a=(e,t,n,o,s)=>{(0,i.y8)(r,Object.assign({LogLevel:"Info",LogModule:e,LogMessage:t,AppId:n,CorrelationId:o||""},s),{isCore:!0})},l=(e,t,n,r,o)=>{(0,i.y8)("message_extension_actions",Object.assign({LogModule:e,Action:t,AppId:n,CorrelationId:r||""},o),{isCore:!0})};var c;!function(e){e.ServerError="ServerError",e.ClientError="ClientError",e.Timeout="Timeout"}(c||(c={}));class d extends i.Gn{constructor(e,t,n,i,r){super(`message_extension_metrics_${t}`,{isCore:!0}),this.addCustomData({LogModule:e,AppId:n,CorrelationId:i||"",source:r||""})}logMetricEnd(e){this.addCustomData(Object.assign({},e)),this.end()}logMetricEndWithError(e,t,n){this.addCustomData(Object.assign({ErrorMessage:t},n)),this.endWithError(e==c.ServerError?i.SO.ServerError:e==c.ClientError?i.SO.ClientError:i.SO.Timeout)}addMetricProps(e){this.addCustomData(Object.assign({},e))}}},286996:(e,t,n)=>{"use strict";n.d(t,{zX:()=>s,xz:()=>a,WT:()=>l,xq:()=>c,t0:()=>d});var i=n(126573),r=n(717420);const o=new r.nI((()=>Promise.all([n.e(25671),n.e(56337),n.e(42106),n.e(36856),n.e(64826),n.e(72760),n.e(54964),n.e(28358),n.e(52772),n.e(63816),n.e(53515),n.e(48139),n.e(95397),n.e(63684),n.e(63673),n.e(39053),n.e(57265),n.e(18669),n.e(52087),n.e(13771)]).then(n.bind(n,619532)))),s=(0,i.Z)(o,(e=>e.MessageExtensionCardPlugin),"MessageExtension",(e=>11==e.eventType)),a=new r.EF(o,(e=>e.hydrateCard)),l=new r.EF(o,(e=>e.insertCardFromJson)),c=new r._5(o,(e=>e.initializeMessageExtensionCards)),d=new r._5(o,(e=>e.handleCopyCardBySelection))},741279:(e,t,n)=>{"use strict";n.d(t,{Kz:()=>i,eH:()=>r,zQ:()=>o});const i="MessageExtensionCard",r="MessageExtensionCompose",o="MessageExtensionCardUpdate"},792456:(e,t,n)=>{"use strict";n.d(t,{P:()=>i});const i=(0,n(371134).aD)("onClickMessageExtensionFlyoutButton",(({flyoutButtonElementId:e,ribbonSurface:t,flyoutType:n,targetWindow:i,composeId:r})=>({flyoutButtonElementId:e,ribbonSurface:t,flyoutType:n,targetWindow:i,composeId:r})))},961235:(e,t,n)=>{"use strict";n.d(t,{kg:()=>d,r4:()=>u,mV:()=>p});var i=n(717420),r=n(157241),o=n(989526),s=n(367397);var a=n(792456),l=n(434951);const c=new i.nI((()=>Promise.all([n.e(3918),n.e(32557),n.e(64826),n.e(54964),n.e(16255),n.e(9458),n.e(94555),n.e(52087),n.e(48783),n.e(13595),n.e(21515)]).then(n.bind(n,121515)))),d=(0,i.$y)(c,(e=>e.MessageExtensionControl),(function(){return o.createElement(r.X,{appearance:"icon",iconProps:{iconName:s.Z,styles:{root:{display:"flex",fontSize:"20px",height:"auto"}}}})})),u=new i._5(c,(e=>e.launchAddinContextMenu)),p=new i._5(c,(e=>e.messageExtensionsRibbonButtonOnExecute));(0,i.Kv)(l.qQ,c,(e=>e.messageExtensionFlyoutCommandingOrchestrator)),(0,i.Kv)(a.P,c,(e=>e.onClickMessageExtensionFlyoutButtonOrchestrator))},672909:(e,t,n)=>{"use strict";n.d(t,{Q:()=>d,u:()=>r});var i=n(371134);const r=(0,i.aD)("SET_MODULE_CONTEXT_MAILBOXINFO",((e,t)=>({module:e,mailboxInfo:t})));var o=n(226362);const s={moduleContextMailboxInfos:new Map},a=(0,i.MT)("ModuleContextMailboxInfoData",s)(),l=()=>a;var c=n(500102);function d(){var e;const t=(0,c.u1)();return null!==(e=t&&l().moduleContextMailboxInfos.get(t))&&void 0!==e?e:(0,o.B6)()}(0,i.ed)(r,(e=>{l().moduleContextMailboxInfos.set(e.module,e.mailboxInfo)}))},821462:(e,t,n)=>{"use strict";n.d(t,{u:()=>a,k:()=>s});var i=n(371134);const r=(0,i.MT)("moduleDndStore",{draggedItemType:null})(),o=()=>r,s=(0,i.aD)("OWA_MODULE_SET_DRAGGED_ITEM_TYPE",(e=>({typeOfItemDragged:e})));(0,i.ed)(s,(e=>{o().draggedItemType=e.typeOfItemDragged}));function a(){return o().draggedItemType}},797819:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(436856),r=n(8457),o=n(833509);let s;function a(e,t,n){(0,o.J)(n).then((n=>{const i=r.Or;n?e(n,i):t("Failed to get auth token from Loki",i)}))}const l={getAuthToken:function(e){return s||(s=new i.BA((()=>r.Or),function(e){return function(t){a(((e,n)=>{t(e,"",n)}),((e,n)=>{t("",e,n)}),e)}}(e),null,null)),s.getAuthToken()},refreshAuthToken:a}},987017:(e,t,n)=>{"use strict";n.d(t,{v:()=>l});var i=n(994094),r=n(8457),o=n(797819),s=n(582478),a=n(226362);async function l(e,t,n,l,c){const d=(0,a.zl)(),u=await(0,i.y)(),p=(await o.Z.getAuthToken(d)).getValue(),m=r.l2(),h=r.Jv();c||(c=new Headers),c.set("Accept","application/json"),c.set("Content-Type","application/json"),c.set("authorization",(0,s.U)(p)),c.set("X-ClientCorrelationId",r.Or),c.set("X-ClientType",r.NV()),m&&c.set("X-HostAppApp",r.l2()),h&&c.set("X-HostAppPlatform",r.Jv()),c.set("X-ClientScenario",r.J),c.set("X-RefererUrl",""),c.set("X-ClientVersion",`16.${r.DV.substr(0,4)}.${r.DV.substr(4,4)}.${r.DV.substr(8)}`);const f=function(e,t){const n=Object.keys(t);if(0===n.length)return e;const i=[];return n.forEach((e=>{const n=t[e];i.push(e+"="+encodeURIComponent(n||""))})),e+"?"+i.join("&")}(u.LokiUrl+t,n);return fetch(f,{method:e,headers:c,body:l})}},599445:(e,t,n)=>{"use strict";n.d(t,{_:()=>p});var i=n(797819),r=n(8457),o=n(55461),s=n(552542),a=n(964659),l=n(233762),c=n(859156),d=n(329746),u=n(226362);function p(){var e,t,n,l,p,f;if(!r.dk)throw new Error("You must call initializeLoki!");const g=(0,s.Z)(),v=(0,u.zl)();return{culture:r.TG||r.rl,region:h(r.ww,r.mt),clientType:r.NV(),app:r.l2(),platform:r.Jv(),clientContextType:r.J,clientCorrelationId:r.Or,logMessage:(e,t,n)=>{r.cM(e,t,n)},getAuthToken:(e,t)=>i.Z.refreshAuthToken(e,t,v),complianceEnvironment:m(),isConsumer:(0,a.uf)(null==v?void 0:v.userIdentity,v),tenantAadObjectId:null!==(t=null===(e=g.SessionSettings)||void 0===e?void 0:e.ExternalDirectoryTenantGuid)&&void 0!==t?t:"",userAadObjectId:null!==(l=null===(n=g.SessionSettings)||void 0===n?void 0:n.ExternalDirectoryUserGuid)&&void 0!==l?l:"",userPuid:null!==(f=null===(p=g.SessionSettings)||void 0===p?void 0:p.UserPuid)&&void 0!==f?f:"",hostAppConfiguration:Object.assign(Object.assign({},(0,c.ZB)()),{isLivePersonaCardV2Enabled:(0,o.cr)("lpc-isLPCV2Enabled")||(0,d.X)("enableLPCv2")})}}function m(){switch((0,l.uD)()){case"BlackForest":return"Blackforest";case"GccHigh":return"GccHigh";case"DoD":return"DoD";case"Gallatin":return"Gallatin";case"AG08":return"AG08";case"AG09":return"AG09";default:return(0,o.cr)("lpc-isInGccModerate")?"GccModerate":"Prod"}}function h(e,t){return e?"df":t?"msit":""}},16562:(e,t,n)=>{"use strict";n.r(t),n.d(t,{fetchLokiConfigAsync:()=>s.y,fetchLokiConfigSync:()=>s.L,freeBootstrapperMemory:()=>c.IS,getLokiBootstrapperConfig:()=>i._,getMidgardBootstrapperAsync:()=>c.Zu,initializeLivePersonaCardAsync:()=>c.hn,initializeLoki:()=>r.Pt,invalidateLokiCachedContacts:()=>l,isLokiInitialized:()=>r.dk,lokiClientCorrelationId:()=>r.Or,lokiRequest:()=>o.v});var i=n(599445),r=n(8457),o=n(987017),s=n(994094),a=n(462480);async function l(e){const t=(0,a.u)(),n={RootCorrelationId:t,CorrelationId:t,ClientCorrelationId:r.Or},i=JSON.stringify(e);try{const e=await(0,o.v)("POST","/api/v1/contact/modified",n,i);return e.ok?Promise.resolve():Promise.reject(e.status)}catch(e){return Promise.reject(e)}}var c=n(512724)},8457:(e,t,n)=>{"use strict";n.d(t,{dk:()=>a,Or:()=>s,NV:()=>l,l2:()=>c,Jv:()=>d,J:()=>u,TG:()=>p,ww:()=>f,mt:()=>g,DV:()=>m,rl:()=>v,Pt:()=>S,cM:()=>b});var i=n(462480),r=n(325876),o=n(859156);let s,a=!1;const l=()=>(0,o._v)(),c=()=>(0,o.oN)(),d=()=>(0,o.vJ)();let u,p,m,h=!1,f=!1,g=!1;const v="en-us";let y;function S(e){if(!a){if(!e)throw new Error("Loki config object is mandatory!");u=e.isConsumer?"OwaConsumer":"OwaEnterprise",p=e.culture,h=e.isConsumer,f=e.useDogfood,y=e.logger,m=(0,r.VJ)();const t=e.tenantId&&e.tenantId.toLowerCase();g="72f988bf-86f1-41af-91ab-2d7cd011db47"===t||"626bd560-f1d8-4cf1-a7fa-91aae03cc409"===t,s=e.clientCorrelationId||(0,i.u)()}a=!0}function b(e,t,n){y(e,[t,n])}},833408:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(371134),r=n(2193);const o=(0,i.lr)("UPDATE_LOKI_IS_INITIALIZED",(function(e){r.Z.isInitialized=e}))},994094:(e,t,n)=>{"use strict";n.d(t,{y:()=>a,L:()=>l});var i=n(599445),r=n(2193),o=n(512724);let s;async function a(){if(s)return Promise.resolve(s);if(r.Z.isInitialized){const e=(0,i._)();return(0,o.Zu)().then((t=>t.fetchLokiConfigAsync(e))).then((e=>(s=e,s)))}return null}function l(){if(s)return s;try{a()}catch(e){}return null}},2193:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).MT)("loki",{isInitialized:!1})()},512724:(e,t,n)=>{"use strict";n.d(t,{Zu:()=>o,hn:()=>s,IS:()=>a});var i=n(874191),r=n(55461);const o=()=>n.e(10022).then(n.t.bind(n,710022,23)),s=async e=>{const t=e.targetWindow||window;l("initializeLivePersonaCard_Start",[e.app||"",void 0===t.LPC]);const n=await o();await n.initializeLivePersonaCardAsync(e),l("initializeLivePersonaCard_End",[e.app||"",void 0===t.LPC])},a=async(e=window)=>{const t=e;l("freeBootstrapperMemory_Start",[void 0===t.LPC]);(await o()).freeBootstrapperMemory(e),l("freeBootstrapperMemory_End",[void 0===t.LPC])};function l(e,t){(0,r.cr)("lpc-isBootstrapperLoggingEnabled")&&(0,i.y8)(e,t)}},606353:(e,t,n)=>{"use strict";n.d(t,{E:()=>r});var i=n(964659);function r(){const{IsExplicitLogon:e,ExternalDirectoryUserGuid:t}=(0,i.c6)().SessionSettings||{};return e?t:void 0}},161490:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(964659),r=n(226362),o=n(954947);function s(e){var t;if(!(0,o.Z)()||!e)return;const n=(0,i.pX)((0,r.B6)());return s=e,a=null===(t=n.SessionSettings)||void 0===t?void 0:t.UserEmailAddress,s&&a&&s.toLowerCase()==a.toLowerCase()?n.HexCID:void 0;var s,a}},629464:(e,t,n)=>{"use strict";n.d(t,{I4:()=>p,ZP:()=>m});var i=n(136947),r=n(913385),o=n(691695),s=n(448259),a=n(717420),l=n(752075),c=n(629804);const d=12e4,u=new a.nI((()=>n.e(47319).then(n.bind(n,247319)))),p=((0,i.aD)("resetLivePersonaCardStore")((function(){(0,c.d)(l.n.NotInitialized)})),(0,i.aD)("handleLivePersonaCardInitializationStatus")((function(e,t){(0,c.d)(e),t&&s.g4.info(t)}))),m=(0,i.aD)("initializeLivePersonaCard")((function(e){if(o.Z.livePersonaCardInitializationStatus.state===l.n.NotInitialized||o.Z.livePersonaCardInitializationStatus.state===l.n.Failed&&Date.now()-o.Z.livePersonaCardInitializationStatus.timestamp>d){const{Initializing:t,Initialized:n,Failed:i}=l.n;(0,c.d)(t),u.importModule("livePersonaStyles"),(0,r.Z)(e).then((()=>{p(n)})).catch((e=>p(i,e)))}}))},180964:(e,t,n)=>{"use strict";n.d(t,{p:()=>k});var i=n(996940),r=n(92894),o=n(874191),s=n(55461),a=n(16562),l=n(859156),c=n(333940),d=n(609076),u=n(778736),p=n(989526),m=n(691695);const h=(0,r.Pi)((function({personaSize:e,identifiers:t,styles:n,children:i,onPersonaInsightRingStateChange:r,displayPersonaHighlightRing:o}){const a="User"===t.PersonaType||"NotResolved"===t.PersonaType,l=window.PersonaInsightRing;return l&&((0,s.cr)("lpc-isLPCV2Enabled")||m.Z.isLivePersonaCardInitialized)&&a&&o?p.createElement(l,{identifiers:t,styles:n,personaSize:e,onPersonaInsightRingStateChange:r},i):p.createElement(p.Fragment,null,i)}));function f(e){return(0,r.Pi)((({children:t})=>(0,s.cr)("lpc-isPersonaInsightRingEnabled")&&e.displayPersonaHighlightRing?p.createElement(h,Object.assign({},e),t):p.createElement(p.Fragment,null,t)))}const g=(0,r.Pi)((e=>{var{children:t,render:n,size:i,displayPersonaHighlightRing:r,className:o,ariaLabel:s}=e,a=(0,c.__rest)(e,["children","render","size","displayPersonaHighlightRing","className","ariaLabel"]);const[l,h]=p.useState(!1),g=p.useCallback((e=>{h(e)}),[h]),v=a.cardParameters.personaInfo.identifiers,y=f({displayPersonaHighlightRing:r,personaSize:i||(0,u.m)(),identifiers:v,onPersonaInsightRingStateChange:g}),{isLivePersonaCardInitialized:S}=m.Z,b=!!window.LivePersonaCardHoverTargetV2,I=p.createElement(d.h,{isAccountInitialized:S,render:n},t);if(S&&b){const e=window.LivePersonaCardHoverTargetV2;return p.createElement(e,Object.assign({},a,{hasPersonaInsightRing:l}),p.createElement("span",{className:o,"aria-label":s},p.createElement(y,null,I)))}return p.createElement(p.Fragment,null,I)}));var v=n(601467),y=n(48856),S=n(629464),b=n(363091),I=n(170365);const w=(0,n(371134).lr)("SET_IS_PERSONA_CARD_OPEN",(e=>{m.Z.isPersonaCardOpen=e}));var C=n(723926);var E=n(363293),P=n(226362),T=n(629804),R=n(752075);const x=(0,r.Pi)((function({composeEmailOverride:e,isUnauthenticatedSender:t,mailBoxType:n,personaType:r,emailAddress:c,clientScenario:d,locationToOpen:u,focusReturnElement:h,tabIndex:f,olsPersonaId:x,topicId:k,name:N,disableHover:A,disableClick:D,ariaLabel:Z,className:M,children:O,render:F,size:_,aadObjectId:L,displayPersonaHighlightRing:z,disableAccessibilityDefaults:B,onCardOpenCallback:V,onCardCloseCallback:U,topicMetadata:q,cardPlacementMode:W,viewerMailboxInfo:H}){const j=(0,s.cr)("lpc-isLPCV2Enabled");p.useEffect((()=>{j||(0,S.ZP)(e),(0,b.Z)()}),[]);const G=p.useMemo((()=>(0,I.EM)(!!t,n,r,c)),[t,n,r,c,m.Z.brandListLoadState]),K=p.useCallback((()=>{w(!0),V&&V(),function(e,t,n,i,r){if((0,s.cr)("grp-TransferOwnership")){const e=document.getElementById("TransferOwnershipGroupDialog");e&&(y.uy(e),document.body.removeChild(e))}e.isBrand&&(0,o.y8)(e.personaType===I.s9.Brand?"BrandCardDisplayed":"BrandDetectedButNotDisplayed");e.personaType===I.s9.Topic&&v.zi.importAndExecute("Cortex.TopicAnnotations.TopicCard.Open",{topicId:i,source:null==r?void 0:r.source,requestId:null==r?void 0:r.clientRequestId});const a=t||"No Client Scenario",l=n||"LPC";(0,o.y8)("LPCRenderedFromHoverTarget",{clientScenario:a,locationToOpen:l})}(G,d,u,k,q)}),[G,d,u,k]),X=p.useCallback((()=>{w(!1),U&&U(),h instanceof HTMLElement?h.focus():(null==h?void 0:h.current)&&h.current.focus()}),[h]),$=(0,i.g)({text:N}),J=j?l.yD:g,Q={disableAccessibilityDefaults:B,externalAppSessionCorrelationId:a.lokiClientCorrelationId,personaInfo:{identifiers:{Smtp:c,PersonaType:G.personaType,OlsPersonaId:x,AadObjectId:L,TopicId:k},isUnauthenticatedSender:t,displayName:N,isTier3Brand:G.isTier3Brand,personaCoinColor:$,topicMetadata:q},behavior:{disableHover:A,disableClick:D,onCardOpen:K,onCardClose:X,locationToOpen:u,cardPlacementMode:W},clientScenario:d,ariaLabel:Z,app:(0,l.oN)()},Y=H||(0,P.zl)(),ee=j?t=>async function(e,t,n){return C.nZ.importAndExecute(e,t,n)}(t,Y,e):void 0;return p.createElement(J,{viewerMailboxInfo:Y,tabIndex:f,cardParameters:Q,render:F,callbacksEnhancer:ee,onLPCModuleLoad:()=>{(0,E.e)(),(0,T.d)(R.n.Initialized)},ariaLabel:Z,className:M,displayPersonaHighlightRing:z,size:_},O)}));function k(e){return(0,r.Pi)((function({children:t}){return m.Z.isPersonaCardDisabled?p.createElement(p.Fragment,null,t):p.createElement(x,Object.assign({},e),t)}))}},936552:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var i=n(161490),r=n(691695),o=n(949358),s=n(92894),a=n(989526),l=n(351198),c=n(146465),d=n(309598),u=n(717420);const p={persona:"dPG_a"};var m=n(254712),h=n.n(m);const f=new u.nI((()=>Promise.all([n.e(25671),n.e(77456),n.e(99110),n.e(72254)]).then(n.bind(n,748664)))),g=new u._5(f,(e=>e.getPersonaPhoto)),v=h().bind(p),y=(0,s.Pi)((function(e){var t;e=Object.assign({emailAddress:"",name:"",size:l.Ir.regular,secondaryText:"",showPresence:!1,mailboxType:""},e);const n=(0,o.Z)(e.emailAddress,e.personaId,e.size,e.mailboxType,e.name);a.useEffect((()=>{!function(e){(e.emailAddress||e.name||e.personaId)&&g.importAndExecute(e.name,e.emailAddress,e.personaId,e.size,e.hexConsumerIdForUser||(0,i.Z)(e.emailAddress),e.mailboxType,e.skipLoadingPhoto)}(e)}),[n]);const s=r.Z.viewStates.get(n);if(!s)return null;const{className:u,size:m,name:h,statusText:f,showPersonaDetails:y,secondaryText:S,showSecondaryText:b,presence:I,isOutOfOffice:w,onRenderPrimaryText:C,onRenderCoin:E,initialsColor:P,onRenderInitials:T,styleProps:R,coinProps:x,showUnknownPersonaCoin:k,imageInitials:N}=e,A=(null===(t=s.personaBlob)||void 0===t?void 0:t.blobUrl)?{imageUrl:s.personaBlob.blobUrl,imageShouldFadeIn:!1,imageShouldStartVisible:!0}:{};return y||b||f?a.createElement(c.I,Object.assign({className:v(u,p.persona),presence:I||l.H_.none,isOutOfOffice:w,hidePersonaDetails:!y,size:m,text:h,secondaryText:S,showSecondaryText:b,tertiaryText:f,onRenderPrimaryText:C,onRenderCoin:E,onRenderInitials:T},A,{initialsColor:P,showUnknownPersonaCoin:k,styles:R,coinProps:x,imageInitials:N})):a.createElement(d.t,Object.assign({},x,{className:v(u,p.persona),presence:I||l.H_.none,isOutOfOffice:w,size:m,text:h,onRenderCoin:E,onRenderInitials:T},A,{initialsColor:P,showUnknownPersonaCoin:k,showInitialsUntilImageLoads:!0,imageInitials:N}))}))},723926:(e,t,n)=>{"use strict";n.d(t,{pO:()=>o,lq:()=>s,nZ:()=>a,XD:()=>l,u9:()=>c});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(25671),n.e(3918),n.e(36856),n.e(54964),n.e(94044),n.e(49520),n.e(9466),n.e(77456),n.e(99110),n.e(27415),n.e(15879),n.e(99712),n.e(61979)]).then(n.bind(n,399258)))),o=new i._5(r,(e=>e.enhanceLpcConfigForOffline)),s=new i._5(r,(e=>e.makeOfflineEnhancedLpeOnCloseCallback)),a=new i._5(r,(e=>e.getLPCAccountCallbacks)),l=new i._5(r,(e=>e.isCAPIv3Enabled)),c=new i._5(r,(e=>e.makeAddOrEditContactV3Callback))},629804:(e,t,n)=>{"use strict";n.d(t,{d:()=>s});var i=n(691695),r=n(752075),o=n(833408);function s(e){i.Z.livePersonaCardInitializationStatus={state:e,timestamp:Date.now()},i.Z.isLivePersonaCardInitialized=e===r.n.Initialized,(0,o.Z)(e===r.n.Initialized)}},363091:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var i=n(371134),r=n(691695);const o=(0,i.lr)("SET_BRAND_LIST",(e=>{r.Z.brandList=e})),s=(0,i.lr)("SET_BRAND_LIST_LOAD_STATE",(e=>{r.Z.brandListLoadState=e}));var a=n(171922),l=n(448259),c=n(325876);const d=e=>{if(200!==e.status)throw new Error(`error fetching brand list: request for '${e.url}' resolved with status ${e.status}`);return e.json()};async function u(){if(r.Z.brandListLoadState==a.P.unloaded){s(a.P.loading);try{const e=await(()=>{const e=`${(0,c.t9)()}resources/json/brandList.json`;return fetch(e).then(d)})();e?(o(e),s(a.P.loadSucceeded)):(s(a.P.loadFailed),l.g4.info("error fetching brand list. Empty response"))}catch(e){s(a.P.loadFailed),l.g4.info("error fetching brand list. Exception: "+e)}}}},913385:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var i=n(874191),r=n(55461),o=n(16562),s=n(606353),a=n(964659),l=n(226362),c=n(519316),d=n(723926),u=n(363293);async function p(e){let t={};const n=(0,l.zl)();try{if((0,c.Kb)()){const e=await(0,c.Ml)();t=await e(n)}}catch(e){(0,i.y8)("LpcCallbacksWereNotInitialized")}return(0,o.initializeLivePersonaCardAsync)(await async function(e,t,n){const i=function(e,t){var n,i,l,c;(0,u.e)();const d=(0,a.c6)(),p=(0,a.pX)(t),m=(0,o.getLokiBootstrapperConfig)(),h=null===(n=null==d?void 0:d.UserOptions)||void 0===n?void 0:n.TimeFormat,f=null===(i=null==d?void 0:d.UserOptions)||void 0===i?void 0:i.DateFormat,g=!!(null===(l=null==p?void 0:p.SegmentationSettings)||void 0===l?void 0:l.SetPhoto),v=-1===(null==h?void 0:h.indexOf("tt")),y=(0,s.E)(),S=(0,r.cr)("people-contact-categories");return Object.assign(Object.assign(Object.assign({},m),e),{options:{isSetPhotoEnabled:g,isLinkedInIntegrationEnabled:!1,timeFormat:h,dateFormat:f,is24HourFormat:v,sharedMailboxAadObjectId:y,isContactCategoriesEnabled:S,isRelatedTopicsEnabledFromHostApp:!0,isLokiContactDataDisabled:(null===(c=m.hostAppConfiguration)||void 0===c?void 0:c.isLokiContactDataDisabled)||!1},targetWindow:window})}(await d.nZ.importAndExecute(e,t,n),t);return i.dataCallbacks.addOrEditContactV3=await d.u9.importAndExecute(t),i.dataCallbacks.isCAPIv3Enabled=await d.XD.import(),i}(t,n,e))}},363293:(e,t,n)=>{"use strict";n.d(t,{e:()=>u});var i=n(226362),r=n(874191),o=n(325876),s=n(55461),a=n(101060),l=n(16562),c=n(964659),d=n(954947);function u(){var e,t;if(l.isLokiInitialized)return;const n=(0,i.zl)(),u=(0,c.pX)(n),p=(0,d.Z)(),m=(0,a.gG)(),h=null!==(t=null===(e=u.SessionSettings)||void 0===e?void 0:e.TenantGuid)&&void 0!==t?t:"",f=(0,o.MQ)(),g=(0,s.cr)("peo-lokiDogfood");(0,l.initializeLoki)({culture:m,isConsumer:p,useDogfood:g,logger:(e,t)=>{(0,r.y8)(e,t)},tenantId:h,clientCorrelationId:f})}},691695:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(752075),r=n(171922),o=n(371134),s=n(559621),a={viewStates:new s.ObservableMap,livePersonaCardInitializationStatus:{state:i.n.NotInitialized,timestamp:Date.now()},livePersonaEditorInitializationStatus:{state:i.d.NotInitialized,timestamp:Date.now()},isLivePersonaCardInitialized:!1,isLivePersonaEditorInitialized:!1,isPersonaCardDisabled:!1,isPersonaCardOpen:!1,brandList:null,brandListLoadState:r.P.unloaded,dynamicBrandSets:{unverifiedBrands:new s.ObservableMap,verifiedBrands:new s.ObservableMap}};const l=(0,o.MT)("personacontrol",a)()},171922:(e,t,n)=>{"use strict";var i;n.d(t,{P:()=>i}),function(e){e[e.unloaded=0]="unloaded",e[e.loading=1]="loading",e[e.loadSucceeded=2]="loadSucceeded",e[e.loadFailed=3]="loadFailed"}(i||(i={}))},752075:(e,t,n)=>{"use strict";var i,r;n.d(t,{n:()=>i,d:()=>r}),function(e){e.NotInitialized="NotInitialized",e.Initializing="Initializing",e.Initialized="Initialized",e.Failed="Failed"}(i||(i={})),function(e){e.NotInitialized="NotInitialized",e.Initializing="Initializing",e.Initialized="Initialized",e.Failed="Failed"}(r||(r={}))},778736:(e,t,n)=>{"use strict";n.d(t,{m:()=>s});var i=n(351198),r=n(843784),o=n(55461);function s(){if(!(0,o.cr)("mon-densities"))return i.Ir.size40;switch((0,r.iT)()){case"medium":return i.Ir.size32;case"compact":return i.Ir.size24;default:return i.Ir.size40}}},170365:(e,t,n)=>{"use strict";n.d(t,{s9:()=>a,EM:()=>l,iz:()=>c});var i=n(55461),r=n(775390),o=n(146589),s=n(954947);const a={NotResolved:"NotResolved",User:"User",Group:"Group",External:"External",DistributionList:"DistributionList",PrivateDistributionList:"PrivateDistributionList",Location:"Location",Room:"Room",Meeting:"Meeting",Brand:"Brand",Topic:"Topic"};function l(e,t,n,l){if(e)return{personaType:a.User,isBrand:!1,isTier3Brand:!1};if((0,i.cr)("rp-brandCards")&&!(0,r.T)(l)&&(0,o.T)(l)){const e=(0,o.X)(l);return{personaType:a.Brand,isBrand:!0,isTier3Brand:e}}return(0,r.T)(t)?!(0,r.T)(n)&&Object.keys(a).indexOf(n)>-1?{personaType:n,isBrand:!1,isTier3Brand:!1}:(null==(d=l)?void 0:d.endsWith("@groups.outlook.com"))?{personaType:"Group",isBrand:!1,isTier3Brand:!1}:(0,s.Z)()?{personaType:"User",isBrand:!1,isTier3Brand:!1}:{personaType:"NotResolved",isBrand:!1,isTier3Brand:!1}:{personaType:c(t),isBrand:!1,isTier3Brand:!1};var d}function c(e){switch(e){case"PublicDL":return a.DistributionList;case"PrivateDL":return a.PrivateDistributionList;case"GroupMailbox":return a.Group;case"Mailbox":case"Contact":default:return a.User;case"OneOff":case"Unknown":return a.NotResolved}}},949358:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(655280);function r(e,t,n,r,o){let s="";const a=(0,i.Z)();return e?s+=e.toLowerCase():t?s+=t:o&&(s+=o.toLowerCase()),r&&a&&(s+=r),n&&!a&&(s+=n),s}},146589:(e,t,n)=>{"use strict";n.d(t,{T:()=>u,X:()=>p});var i=n(363091),r=n(691695),o=n(559621);const s=(0,o.computed)((()=>{const e=new Set;return r.Z.brandList.smtps.forEach((t=>e.add(t.toLowerCase()))),r.Z.brandList.tier3Smtps.forEach((t=>e.add(t.toLowerCase()))),e})),a=(0,o.computed)((()=>{const e=new Set;return r.Z.brandList.tier3Smtps.forEach((t=>e.add(t.toLowerCase()))),e}));var l=n(171922),c=n(346357),d=n(655280);function u(e){return(0,d.Z)()?r.Z.dynamicBrandSets.verifiedBrands.get(e)||r.Z.dynamicBrandSets.unverifiedBrands.get(e)||!1:!(1!==(0,c.D6)()||!m())&&h(e,s)}function p(e){return(0,d.Z)()?r.Z.dynamicBrandSets.verifiedBrands.get(e)||!1:!(1!==(0,c.D6)()||!m())&&h(e,a)}function m(){return r.Z.brandListLoadState===l.P.unloaded&&(0,i.Z)(),!(r.Z.brandListLoadState!=l.P.loadSucceeded||!r.Z.brandList||!r.Z.brandList.smtps)}function h(e,t){if(e){return-1!==(e=e.toLowerCase()).indexOf("@")&&t.get().has(e)}return!1}},655280:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s,M:()=>a});var i=n(892382),r=n(487616),o=n(552542);function s(){var e;return!(null===(e=(0,o.Z)().SessionSettings)||void 0===e?void 0:e.IsShadowMailbox)}function a(e,t){if(!t)return!1;if(e)return!1;if(null===r.Z.getRecipientCache())return!1;return 0==(0,i.d)((e=>"PersonalContact"===e.PeopleSubtype&&"SMTP"===e.EmailAddress.RoutingType&&e.EmailAddress.EmailAddress&&e.EmailAddress.EmailAddress.toLowerCase()===t.toLowerCase()),1).length}},559181:(e,t,n)=>{"use strict";function i(e){return e.policyMatchDetails.slice().sort(((e,t)=>{const n=r(t.Action)-r(e.Action);return 0==n?null==e.MatchPriority?null==t.MatchPriority?n:1:null==t.MatchPriority?-1:e.MatchPriority-t.MatchPriority:n}))[0]}function r(e){switch(e){case 1:return 0;case 4:case 2:case 3:return 1;case 5:return 2;default:return 3}}n.d(t,{z:()=>i})},679539:(e,t,n)=>{"use strict";n.d(t,{T:()=>r});var i=n(552542);function r(){return(0,i.Z)().PolicyTipsEnabled}},658980:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=n(989526).createContext(window)},978710:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r,b:()=>o});const i=(0,n(371134).MT)("popoutParent",{projections:[],isAvailable:!1})(),r=i,o=()=>i},918822:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(978710);function r(e){return i.Z.projections.filter((t=>t.tabId==e||t.window==e))[0]}},262548:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(918822);function r(e){const t=(0,i.Z)(e);return t?t.tabId:null}},308785:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(297462);function r(e){const t=e&&e!==window;return(0,i.I3)()||!!t}},937729:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(989526),r=n(5989),o=n(705563),s=n(55461),a=n(843784);const l=(0,n(92894).Pi)((function(e){const t=(0,s.cr)("mon-densities")?(0,a.iT)():"";return i.createElement(r.J,{iconName:o.Z,style:function(){let e="4px";return"medium"==t?e="3px":"compact"==t&&(e="2px"),{color:"#979593",verticalAlign:"top",fontSize:"full"==t?"12px":"10px",marginRight:e}}()})}))},444835:(e,t,n)=>{"use strict";n.d(t,{e:()=>s});var i=n(717420),r=n(937729);const o=new i.nI((()=>Promise.all([n.e(3918),n.e(54964),n.e(14922)]).then(n.bind(n,41102)))),s=(0,i.$y)(o,(e=>e.PersonaPresenceBadge),r.Z)},81333:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).aD)("ADD_PUBLIC_FOLDER_TO_STORE",((e,t)=>({state:e,item:t})))},206426:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).aD)("POPULATE_PUBLIC_FOLDER_FAVORITE_STORE_V1")},990086:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).aD)("POPULATE_PUBLIC_FOLDER_OUTLOOK_FAVORITE_STORE",(e=>({mailboxInfo:e})))},864558:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).aD)("REMOVE_FAVORITE_FROM_PUBLIC_FOLDER_STORE",(e=>({folderId:e})))},133688:(e,t,n)=>{"use strict";n.d(t,{O5:()=>p,lM:()=>d.Z});var i=n(990086),r=n(206426),o=n(717420),s=n(936823),a=n(81333),l=n(371134);(0,l.ed)(a.Z,(e=>{const{state:t,item:n}=e,i=n.id;t.folderTable.has(i)||t.folderTable.set(i,n)}));var c=n(864558),d=n(29953);(0,l.ed)(c.Z,(e=>{const{folderId:t}=e;d.Z.folderTable.has(t)&&d.Z.folderTable.delete(t)}));n(711414);const u=new o.nI((()=>Promise.all([n.e(52542),n.e(46651),n.e(63601)]).then(n.bind(n,93014))));(0,o.Kv)(s.Z,u,(e=>e.loadPublicFolderFavoritesOchestrator)),(0,o.Kv)(i.Z,u,(e=>e.populatePublicFolderOutlookFavoriteStoreOrchestrator)),(0,o.Kv)(r.Z,u,(e=>e.populatePublicFolderFavoriteStoreV1Orchestrator));const p=(0,o.$y)(u,(e=>e.PostedToLine))},711414:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(20408);function r(e){return{type:"PublicMailbox",userIdentity:(0,i.fF)().userIdentity,mailboxSmtpAddress:e}}},29953:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(559621),r=n(371134);const o={folderTable:new i.ObservableMap,rootFolder:null},s=(0,r.MT)("publicFolderFavoriteStore",o)()},60795:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var i=n(92894),r=n(742026),o=n(62557),s=n(989526);const a="x3aoo";var l=n(764403),c=n.n(l);const d=(0,i.Pi)((e=>{const t=[];return(0,o.Z)(e.toRecipientWell,t),(0,o.Z)(e.ccRecipientWell,t),(0,o.Z)(e.bccRecipientWell,t),s.createElement("div",{key:"compactRecipientWellDiv",className:c()(a,e.className),onFocus:e.onSwitchToReadWriteWell,tabIndex:0},s.createElement(r.Z,{recipientType:e.recipientType,recipients:t,totalRecipientCount:t.length,onToggleIsTruncated:e.onSwitchToReadWriteWell,disableHover:!0,showPresence:e.showPresence}))}))},28163:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var i=n(101060),r=n(989526),o=n(180964),s=n(92894),a=n(444835),l=n(55461),c=n(843784),d=n(812402),u=n(254712);const p=n.n(u)().bind(d.Z),m=(0,s.Pi)((function(e){let t;e.onlyShowEmail?t=e.viewState.email.EmailAddress:(t=e.renderSelf?(0,i.ZP)("A4c"):e.viewState.email.Name||e.viewState.email.EmailAddress,e.viewState.showFullEmail&&e.viewState.email.EmailAddress&&(t+=" <"+e.viewState.email.EmailAddress+">"),e.isLast||(t+=";")),t=t||"";const n=p(d.Z.recipientContent,e.recipientContentClassName,e.viewState.isGroupOrDl?d.Z.groupOrDl:null);return e.showPlainText?r.createElement("li",{className:n},t):r.createElement(h,Object.assign({},e,{recipientContent:t,recipientContentClassName:n}))})),h=(0,s.Pi)((function(e){const t=(0,o.p)(e),n=(0,l.cr)("mon-densities")?(0,c.iT)():"",i=e.showPresence;return r.createElement("li",{className:p(e.recipientContentClassName,e.className,n,d.Z.recipientPillPadding,i&&d.Z.recipientPillDisplay),ref:e.recipientPersonaRef,"aria-label":e.ariaLabel},r.createElement(t,null,r.createElement(r.Fragment,null,i&&r.createElement(a.e,{email:e.viewState.email}),r.createElement("div",{className:p(d.Z.recipientContent)},e.recipientContent))))}))},899974:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var i=n(92894);const r="wQc",o="xQc",s="yQc";var a=n(101060),l=n(28163),c=n(800559),d=n(964659),u=n(226362),p=n(55461),m=n(989526),h=n(843784),f=n(252810),g=n(254712);const v=n.n(g)().bind(f.Z),y=(0,i.Pi)(m.forwardRef((function(e,t){let{recipients:n,allowRenderEmptyWell:i,wellLabelText:g,recipientType:y,className:S,renderSelf:b,disableHover:I,trailingComponent:w,showPlainText:C,recipientPersonaRef:E}=e;if(n&&(i||n.length>0)){g=g||function(e){switch(e){case c.C.To:return(0,a.ZP)(r);case c.C.Cc:return(0,a.ZP)(o);case c.C.Bcc:return(0,a.ZP)(s);default:return""}}(y);const i=v(f.Z.label,f.Z.wellLabelTextNormalWeight),P=y!=c.C.None?m.createElement("label",{className:i},g):null;return m.createElement("div",{className:v((0,p.cr)("mon-densities")&&(0,h.iT)(),f.Z.wellWrapper,S),key:"readOnlyRecipientWellDiv"},P,m.createElement("ul",{className:v(f.Z.recipientsContainer,e.recipientContainerClassName),ref:t},n.map(((t,i)=>{var r;const o=0==i&&t.email.EmailAddress==(null===(r=(0,d.pX)((0,u.B6)()).SessionSettings)||void 0===r?void 0:r.UserEmailAddress)&&b,s=i+1==n.length;return m.createElement(l.Z,{recipientContentClassName:e.recipientClassName,key:`${t.email.EmailAddress}_${i}`,viewState:t,name:t.email.Name,emailAddress:t.email.EmailAddress,renderSelf:o,isLast:s,disableHover:I,mailBoxType:t.email.MailboxType,clientScenario:"ReadOnlyRecipient",showPlainText:C,showPresence:e.showPresence,recipientPersonaRef:E})}))),w&&m.createElement("div",{className:f.Z.wellTrailingComponent,key:"wellTrailingComponentDiv"},w))}return null})))},742026:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var i=n(899974);var r=n(92894),o=n(101060),s=n(989526),a=n(306130);const l={truncatedRecipientsContainer:"uCLpU",hideContainer:"wVafh",truncatedOnlyChildRecipient:"y2bnf",noTruncatedRecipients:"doiLk",separateRecipientWells:"nVdaz",clickableTrailingComponent:"kQlQP"};var c=n(254712);const d=n.n(c)().bind(l),u=(0,r.Pi)((function(e){const t=s.useRef(),n=s.useRef(),r=s.useRef(),{renderSelf:c,showPresence:u,recipientType:p,disableHover:m,recipients:h,trailingComponent:f,className:g,totalRecipientCount:v,onToggleIsTruncated:y,useButtonForTruncatedCount:S}=e;s.useLayoutEffect((()=>{C()}),[c,h,v]);const b=()=>({recipientsShown:h?h.slice():[],truncatedCount:v,showRecipientContainer:!1}),[I,w]=s.useState(b()),C=s.useCallback((()=>{t&&n&&w(b())}),[c,h,v]);s.useLayoutEffect((()=>{I.showRecipientContainer||E()}),[I]);const E=()=>{var e,i,o,s;const a=(null===(e=r.current)||void 0===e?void 0:e.offsetWidth)||0,l=(null===(i=t.current)||void 0===i?void 0:i.offsetWidth)||0;let c=(null===(o=t.current)||void 0===o?void 0:o.scrollWidth)||0;if(l>0&&c-a>l)for(let e=I.recipientsShown.length-1;e>0;e--){if(c-=(null===(s=n.current)||void 0===s?void 0:s.children[e]).offsetWidth,I.recipientsShown.splice(e,1),c<=l||1==e)break}w({recipientsShown:I.recipientsShown,truncatedCount:v-I.recipientsShown.length,showRecipientContainer:!0})};(0,a.y)(t,C);const P=s.useMemo((()=>1==I.truncatedCount?(0,o.WU)((0,o.ZP)("zQc"),I.truncatedCount):(0,o.WU)((0,o.ZP)("AQc"),I.truncatedCount)),[I]),T=s.useMemo((()=>s.createElement("span",{ref:r},S?I.truncatedCount?s.createElement("button",{className:d(l.clickableTrailingComponent,I.showRecipientContainer?void 0:l.hideContainer),onClick:y},P):void 0:s.createElement("span",{className:I.showRecipientContainer?void 0:l.hideContainer},I.truncatedCount?s.createElement("span",{onClick:y},P):"",f))),[S,y,I,f]);return s.createElement("div",{className:d(l.truncatedRecipientsContainer,g),key:"readOnlyTruncatedRecipientWellDiv",ref:t},s.createElement(i.Z,{ref:n,recipientType:p,recipients:I.recipientsShown,trailingComponent:T,renderSelf:c,disableHover:m,showPresence:u,recipientContainerClassName:I.showRecipientContainer?void 0:l.hideContainer,recipientClassName:d({[l.truncatedOnlyChildRecipient]:1===I.recipientsShown.length,[l.noTruncatedRecipients]:1===I.recipientsShown.length&&0==I.truncatedCount,[l.separateRecipientWells]:!!S})}))}))},62557:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(690992);function r(e,t){if(null==e?void 0:e.recipients){const n=e.recipients.map((e=>e.persona.EmailAddress)),r=(0,i.Z)(n);void 0!==r&&t.push(...r)}}},534467:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(136947).aD)("setCommonWellItemSelectedState")((function(e,t){e.isSelected=t}))},557282:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var i=n(989526),r=n(80351),o=n(188464),s=n(352932);const a={input:"kSbYc"};var l=n(254712);const c=n.n(l)().bind(a);class d extends i.Component{constructor(){super(...arguments),this.targetDocument=this.props.targetWindow.document||document,this.focus=()=>{this.input.focus()},this.clearInput=()=>{this.input.clear()},this.showPicker=()=>{this.picker&&this.picker.showPicker(!0)},this.hidePicker=()=>{this.picker&&this.picker.hidePicker()},this.onQueryStringChanged=e=>{this.picker&&this.picker.onQueryStringChanged(e)},this.getFloatingPicker=()=>this.picker,this.getInput=()=>this.input,this.onItemSelected=e=>{this.props.onItemSelected(e),this.input.clear(),this.hidePicker()},this.onInputChanged=e=>{this.props.onInputChanged&&this.props.onInputChanged(e),this.onQueryStringChanged(this.input.value)},this.onPaste=e=>{if(this.props.onPaste){const t=e.clipboardData.getData("Text");e.preventDefault(),this.props.onPaste(t)}},this.onBlurIfPossible=()=>e=>{this.onBlur(e.relatedTarget,!1)},this.onBlur=(e,t)=>{const n=e,i=this.targetDocument.getElementById("suggestionHeader-list"),r=this.targetDocument.getElementById("suggestionFooter-list"),o=this.targetDocument.getElementsByClassName("ms-Suggestions-closeButton")&&this.targetDocument.getElementsByClassName("ms-Suggestions-closeButton")[0];!this.props.onBlur||n&&(-1!==n.className.indexOf("ms-Suggestions-itemButton")||-1!==n.className.indexOf("ms-Suggestions-sectionButton")||o&&-1!==n.className.indexOf(o.className)||r&&(t||0==n.tabIndex?r.contains(n):n.contains(r))||i&&(t||0==n.tabIndex?i.contains(n):n.contains(i))||o&&(t||0==n.tabIndex?o.contains(n):n.contains(o)))||this.props.onBlur()},this.onClick=e=>{e.preventDefault(),e.stopPropagation(),this.showPicker()},this.onInputKeyDown=e=>{this.props.onInputKeyDown&&this.props.onInputKeyDown(e)},this.getInputRef=e=>{this.input||(this.input=e,this.input.inputElement.value=this.props.defaultVisibleQueryString,this.forceUpdate((()=>{this.props.openPickerAutomatically&&(this.props.onOpenPickerAutomatically?this.props.onOpenPickerAutomatically():this.showPicker()),this.props.focusAutomatically&&this.input.focus()})))},this.getPickerRef=e=>{this.picker||(this.picker=e,this.forceUpdate())}}render(){const e=this.props.getPickerProps(),t=this.picker&&-1!==this.picker.currentSelectedSuggestionIndex?"sug-"+this.picker.currentSelectedSuggestionIndex:void 0,n=!!this.picker&&this.picker.isSuggestionsShown;return i.createElement("div",{className:this.props.className},i.createElement(s.G,{className:c("ms-BasePicker-input",a.input,this.props.inputClassName),"aria-label":this.props.inputAriaLabel,"aria-activedescendant":t,"aria-owns":n?"suggestion-list":void 0,ref:this.getInputRef,onClick:this.onClick,onInputValueChange:this.onInputChanged,onFocus:this.props.onInputFocus,onPaste:this.onPaste,onBlur:this.onBlurIfPossible(),defaultVisibleValue:this.props.defaultVisibleQueryString,onKeyDown:this.onInputKeyDown,placeholder:this.props.placeholder}),i.createElement(r.sJ,Object.assign({},e,{componentRef:this.getPickerRef,inputElement:this.input?this.input.inputElement:null,onChange:this.onItemSelected,suggestionItems:this.props.suggestionItems})))}}const u=(0,o.observer)(d)},461128:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var i=n(92894),r=n(989526),o=n(843784),s=n(287130);const a=()=>({container:[{height:"48px",maxWidth:"100%",overflow:"hidden",position:"relative"}],personaContainer:[{marginLeft:"12px",marginTop:"8px",display:"flex",alignItems:"center",tableLayout:"fixed",overflow:"hidden",textOverflow:"ellipsis"}],personaImage:[{position:"relative",display:"inline-block",verticalAlign:"middle",width:"32px",flexShrink:0}],personaText:[{paddingLeft:"12px",display:"inline-block",verticalAlign:"middle",flexShrink:1,minWidth:0,overflow:"hidden"}]}),l=(0,s.y)(),c=(0,i.Pi)((function(e){const{isHighlighted:t,personaControl:n,firstLineElement:i,secondLineElement:s,theme:c=(0,o.Pl)()}=e,d=l(a,{theme:c,isHighlighted:t});return r.createElement("div",{className:d.container,onClick:t=>{t.preventDefault(),e.addPickerItemAction&&e.addPickerItemAction(e.pickerItemData)}},r.createElement("div",{className:d.personaContainer},r.createElement("div",{className:d.personaImage},n),r.createElement("div",{className:d.personaText},i,s)))}))},53279:(e,t,n)=>{"use strict";n.d(t,{h:()=>m});var i=n(989526),r=n(178336),Droppable=n(79810),o=n(745549);const s=(0,n(136947).aD)("updateItemListOnDrop")((function(e,t,n){e.splice(t,0,n)}));var a=n(80351),l=n(293923);const c=(0,n(371134).lr)("setDidDragStart",((e,t)=>{e.didDragStart=t})),d={wellContainer:"SvGB9",well:"UvnRr",divContainer:"W0fIA"};var u=n(254712);const p=n.n(u)().bind(d);class m extends i.Component{constructor(e){super(e),this.focus=()=>{this.picker&&(this.picker.focus(),this.picker.floatingPicker.current&&0!==this.picker.floatingPicker.current.inputText.length&&this.picker.floatingPicker.current.showPicker())},this.canDrop=e=>e.itemType===this.props.draggableItemType,this.onDrop=e=>{if(this.canDrop(e)){c(this.dropViewState,!1);const t=e.item,n=this.dropViewState.dropItemIndex,i=this.getItemIndex(t);this.dropViewState.shouldRemoveFromRight=!1,n>=0?(this.dropViewState.shouldRemoveFromRight=!(i<n),s(this.state.items,n,t),this.onItemsChanged()):this.onItemsAdded([t])}},this.onDragEnter=()=>{c(this.dropViewState,!0),this.forceUpdate()},this.removeItems=(e,t)=>{if(this.props.onItemsRemoved)this.props.onItemsRemoved(e,t);else{const t=this.state.items.filter((t=>-1===e.indexOf(t)));this.setState({items:t},this.onItemsChanged)}},this.getSelectedItemsListProps=()=>Object.assign({onRenderItem:this.renderSelectedItem,onChange:this.onSelectedItemsChanged},this.getExtendedSelectedItemsListProps()),this.renderWell=()=>i.createElement("div",{className:this.getWellClassname()},i.createElement(o.x,Object.assign({defaultSelectedItems:this.convertInitialItemsToWellItems(this.props.defaultSelectedItems),selectedItems:this.state.items,floatingPickerProps:this.getFindControlProps(),selectedItemsListProps:this.getSelectedItemsListProps(),onRenderFloatingPicker:h,onRenderSelectedItems:f,onItemsRemoved:this.onItemsRemoved,componentRef:this.extendedPickerRef,onItemAdded:this.onItemAdded},this.extendedPickerProps(),{onItemSelected:this.onItemSelected}))),this.onItemAdded=e=>{this.onItemsAdded([this.convertSuggestionItemToWellItem(e)])},this.extendedPickerRef=e=>{this.picker=e},this.processItemsToAdd=(e,t)=>e,this.onItemsAdded=(e,t)=>{const n=this.processItemsToAdd(e,t);if(this.props.onItemsAdded)this.props.onItemsAdded(n);else{const e=this.state.items.concat(n);this.setState({items:e},this.onItemsChanged)}},this.onItemsRemoved=e=>{this.removeItems(e,!1)},this.onItemsExpanded=(e,t)=>{this.removeItems(e,!0),this.onItemsAdded(t)},this.onItemsChanged=()=>{this.props.onItemsChanged&&this.props.onItemsChanged(this.state.items)},this.onItemSelected=e=>this.props.onItemSelected?this.props.onItemSelected(e):e,this.dropViewState=this.props.dropViewState,this.state={items:[]}}componentDidMount(){var e,t;const n=this.convertInitialItemsToWellItems(this.props.defaultSelectedItems);this.setState({items:n}),this.textElement=null===(t=null===(e=null==this?void 0:this.picker)||void 0===e?void 0:e.inputElement)||void 0===t?void 0:t.parentElement}componentDidUpdate(){var e,t;0===this.state.items.length?null===(e=this.textElement)||void 0===e||e.setAttribute("role","presentation"):null===(t=this.textElement)||void 0===t||t.setAttribute("role","list")}UNSAFE_componentWillReceiveProps(e){if(e.selectedItems){const t=this.convertInitialItemsToWellItems(e.selectedItems);this.setState({items:t})}}render(){const e=this.props.containerClassName?this.props.containerClassName:d.divContainer;return this.dropViewState?i.createElement(Droppable.Z,{classNames:e,dropViewState:this.dropViewState,onDragEnter:this.onDragEnter,canDrop:this.canDrop,onDrop:this.onDrop},i.createElement("div",{className:d.wellContainer,onClick:this.focus,onKeyDown:this.onKeyDown},this.renderWell())):i.createElement("div",{className:e},i.createElement("div",{className:d.wellContainer,onClick:this.focus,onKeyDown:this.onKeyDown},this.renderWell()))}getWellClassname(){return p(d.well,this.props.wellClassName)}}function h(e){return i.createElement(a.sJ,Object.assign({},e))}function f(e){return i.createElement(l.I,Object.assign({},e))}m.defaultProps={dropViewState:(0,r.Z)()}},719573:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var i=n(157241),r=n(989526),o=n(101060),s=n(534467),a=n(136947);const l=(0,a.aD)("setShouldBlockSelection")((function(e,t){e.shouldBlockSelection=t})),c=(0,a.aD)("setContextMenuVisibility")((function(e,t){e.isContextMenuOpen=t}));var d=n(382717),u=n(764403),p=n.n(u);const m={iconName:"Cancel"};class h extends r.Component{constructor(){super(...arguments),this.personaSpan=r.createRef(),this.onContextMenu=e=>{this.props.useContextMenu&&(e.stopPropagation(),e.preventDefault(),c(this.props.viewState,!0),l(this.props.viewState,!1))},this.onDismissContextMenu=e=>{e.stopPropagation(),c(this.props.viewState,!1)},this.removeItem=e=>{e.stopPropagation(),e.preventDefault(),(0,s.Z)(this.props.viewState,!1),this.props.removeOperation(this.props.viewState)},this.getLeadingElement=()=>null,this.getContextMenu=()=>null,this.getDisplayTextFromItem=e=>null,this.copyItemContent=()=>null,this.getWellItemContent=()=>r.createElement("div",{className:this.classNames.wellItemBox,ref:e=>this.wellItemBox=e,onFocusCapture:this.onFocusCapture,onBlur:this.onFocusOut,onMouseOut:this.onFocusOut},this.getLeadingElement(),r.createElement("span",{className:p()(this.classNames.wellItem),ref:this.personaSpan,tabIndex:-1,onMouseDown:this.onMouseDown,onBlur:this.onBlur,onFocus:this.onFocus,onContextMenu:this.onContextMenu,role:"button","aria-haspopup":"true"},this.getPersonaControl(),!this.props.viewState.blockWellItemRemoval&&r.createElement(i.X,{appearance:"icon","data-is-focusable":!1,onClick:this.removeItem,iconProps:m,styles:this.removeButtonStyle,title:this.getStringForRemoveButton(),"aria-label":this.getStringForRemoveButton()}),this.getContextMenu())),this.getRenderResult=()=>this.getWellItemContent(),this.onFocus=()=>{this.props.viewState.shouldBlockSelection||(0,s.Z)(this.props.viewState,!0)},this.onFocusCapture=()=>{},this.onFocusOut=()=>{},this.getCanDragItem=e=>!1,this.onBlur=()=>{(0,s.Z)(this.props.viewState,!1)},this.onKeyDown=e=>{switch(e.keyCode){case 8:return e.stopPropagation(),void(this.props.viewState.blockWellItemRemoval||this.props.removeOperation(this.props.viewState));case 46:return e.stopPropagation(),void(this.props.viewState.blockWellItemRemoval||this.props.removeOperation(this.props.viewState,!0));case 37:return void(this.props.focusNextOperation&&(e.stopPropagation(),this.props.focusNextOperation(this.props.viewState,(0,o.fI)()?1:-1)));case 39:return void(this.props.focusNextOperation&&(e.stopPropagation(),this.props.focusNextOperation(this.props.viewState,(0,o.fI)()?-1:1)));case 67:return void((0,d.yp)()&&((0,d.V5)()&&e.metaKey||e.ctrlKey)&&this.copyItemContent());case 9:return void(!e.shiftKey&&this.props.focusNextOperation&&(e.preventDefault(),this.props.focusNextOperation(this.props.viewState,(0,o.fI)()?-1:1)))}},this.onMouseDown=e=>{this.props.useContextMenu&&(e.stopPropagation(),2==e.button&&0==this.props.viewState.isContextMenuOpen&&l(this.props.viewState,!0))}}get removeButtonStyle(){return{root:this.classNames.removeWellItemButton,rootHovered:this.classNames.actionButtonHovered,rootPressed:this.classNames.actionButtonPressed,icon:this.classNames.actionButtonIcon}}componentDidMount(){this.setFocusIfSelected()}componentDidUpdate(){this.setFocusIfSelected()}setFocusIfSelected(){this.props.viewState.isSelected&&(this.personaSpan.current?this.personaSpan.current.focus():setTimeout((()=>{throw new Error("Persona span not bound in readWriteCommonWellItem on setFocusIfSelected")}),0))}render(){return this.classNames=this.getCustomizedClassName(),this.renderWellItem()}}},167133:(e,t,n)=>{"use strict";n.d(t,{W:()=>r});var i=n(564229);const r=e=>{const{theme:t,isSmallSize:n,isRegularSize:r,isItemAligned:o,isCompactVerticalSpacing:s,isSelected:a,isValid:l,isExpandable:c,isExpanding:d,isFadedOut:u,maxItemWidth:p}=e,{palette:m}=t;return{wellItem:[{cursor:"pointer",display:"flex",alignItems:"center",whiteSpace:"nowrap",opacity:u?.2:1,maxWidth:"100%"}],removeWellItemButton:[{borderRadius:"50%",display:"inline-block"},n&&{height:24,width:24},r&&{height:32,width:32}],wellItemImage:[{display:"inline-block",verticalAlign:"top"}],wellItemText:["ReadWriteCommonWell-wellItemText",{margin:"0 8px",fontWeight:i.lq.regular,color:m.themeDark,fontSize:i.TS.medium,overflow:"hidden",textOverflow:"ellipsis"},!l&&{color:m.red},a&&{color:m.white},n&&{display:"inline-block",maxWidth:"240px",overflow:"hidden",textOverflow:"ellipsis"},r&&{padding:"8px 0",lineHeight:"1em"}],copyInput:[{position:"fixed",top:"0",left:"0",width:"2em",height:"2em",padding:"0",border:"none",outline:"none",boxShadow:"none",background:"transparent"}],expandGroupButton:[{borderRadius:"15px 0 0 15px",width:"48px",display:"none",textAlign:"center",position:"absolute",left:"0",opacity:u?.2:1},n&&{height:24,lineHeight:24,paddingRight:12},r&&{height:32,lineHeight:"1em",paddingRight:16},c&&{display:"inline-block"}],actionButtonHovered:[!d&&{backgroundColor:m.themeLight},!d&&a&&{backgroundColor:m.themeDark}],actionButtonPressed:[{backgroundColor:m.themeDark}],actionButtonIcon:["ReadWriteCommonWell-actionButtonIcon",{fontSize:i.TS.medium},{color:m.themeDark},a&&{color:m.white}],wellItemBox:[{backgroundColor:m.themeLighterAlt,borderRadius:"16px",position:"relative",display:"inline-block",verticalAlign:"bottom",maxWidth:"100%"},a&&{backgroundColor:m.themePrimary},n&&{margin:"2px"},r&&!o&&{margin:"10px 4px 0 4px"},r&&o&&{margin:"10px 4px 0 0"},r&&s&&{marginTop:"5px"},c&&{paddingLeft:"30px"},[!a&&{selectors:{":hover":{backgroundColor:m.themeLighter},":active":{backgroundColor:m.themePrimary},":active .ReadWriteCommonWell-wellItemText":{color:m.white},":active .ReadWriteCommonWell-actionButtonIcon":{color:m.white}}}]],personaInfoWrapper:[{display:"flex",alignItems:"center",maxWidth:p}],focusedWellItemBox:[{backgroundColor:m.themePrimary,selectors:{".ReadWriteCommonWell-wellItemText":{color:m.themeDark},":hover .ReadWriteCommonWell-wellItemText":{color:m.themeDark},":active .ReadWriteCommonWell-wellItemText":{color:m.themeDark},".ReadWriteCommonWell-actionButtonIcon":{color:"white"},":hover .ReadWriteCommonWell-actionButtonIcon":{color:m.themeDark},":active .ReadWriteCommonWell-actionButtonIcon":{color:"white"}}}]}}},690518:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var i=n(92894),r=n(989526),o=n(877611),s=n(291360),a=n(906233),l=n(557282),c=n(658980);const d=(0,i.Pi)(r.forwardRef((function(e,t){const n=r.useRef(null),i=()=>{n.current.focus()},d=()=>{n.current.clearInput()},u=()=>{n.current&&n.current.showPicker()},p=()=>{n.current&&n.current.hidePicker()},m=()=>n.current?n.current.getFloatingPicker():null,h=r.useContext(c.Z);r.useImperativeHandle(t,(()=>({focus:i,clearInput:d,showPicker:u,hidePicker:p,getFloatingPicker:m})),[]);const f=()=>e.viewState;return r.createElement(l.Z,{ref:n,className:e.className,inputAriaLabel:e.inputAriaLabel,inputClassName:e.editingRecipientInputClassName,onBlur:e.onBlur,onPaste:e.onPaste,defaultVisibleQueryString:f().queryString,onInputKeyDown:e.onInputKeyDown,getPickerProps:()=>(0,o.Z)(f,m,!0,e.theme,e.onPickerHidden,e.scenario,null,e.searchDirectory),targetWindow:h,onInputChanged:t=>{(0,a.Z)(e.viewState,t),e.onInputChanged&&e.onInputChanged(t)},suggestionItems:e.viewState.findResultSet.slice(),onItemSelected:e.onItemSelected,theme:e.theme,onOpenPickerAutomatically:()=>{e.viewState.inForceResolve?(0,s.Z)(f,n.current.getFloatingPicker()):u()},focusAutomatically:e.focusAutomatically,openPickerAutomatically:e.openPickerAutomatically,placeholder:e.placeholder})})))},509949:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>b});var i=n(461128),r=n(936552),o=n(989526),s=n(351198),a=n(5989);const l="NpNPp",c="ljkdP",d="INCCw",u="OBAnP",p="lfenR",m="rbCbX",h="vT7j2";var f=n(764403),g=n.n(f);const v=({persona:e})=>{const t=e.EmailAddress;return o.createElement("span",{className:g()(c,d)},o.createElement("span",{className:h},t.Name),"LinkedIn"==t.MailboxType&&o.createElement(a.J,{className:u,iconName:"LinkedInLogo"}))},y=({persona:e,isImplicitGroupPersona:t})=>{if(!t)return o.createElement("span",{className:g()(p,d)},e.EmailAddress.EmailAddress);const n=e.Members.map((t=>o.createElement("div",{className:m,key:t.EmailAddress},o.createElement(r.Z,{key:t.EmailAddress,name:t.Name,emailAddress:t.EmailAddress,size:s.Ir.size16,showPersonaDetails:!1,mailboxType:e.EmailAddress.MailboxType}))));return o.createElement(o.Fragment,null,n)},S=({persona:e,isImplicitGroupPersona:t})=>{const n=e.EmailAddress.EmailAddress,i=e.EmailAddress.Name,a=e.EmailAddress.MailboxType;return t?o.createElement(r.Z,{name:"Implicit Group",emailAddress:n,size:s.Ir.size32,showPersonaDetails:!1,initialsColor:s.z5.lightBlue,mailboxType:a}):o.createElement(r.Z,{name:i,emailAddress:n,size:s.Ir.size32,showPersonaDetails:!1,mailboxType:a})},b=e=>{const{itemProps:t,persona:n,theme:r}=e,s=n.PersonaTypeString&&"ImplicitGroup"==n.PersonaTypeString&&n.Members&&n.Members.length>0;return o.createElement("div",{className:l},o.createElement(i.Z,{key:n.EmailAddress.EmailAddress,pickerItemData:n,isHighlighted:t.suggestionModel.selected,personaControl:o.createElement(S,{persona:n,isImplicitGroupPersona:s}),firstLineElement:o.createElement(v,{persona:n}),secondLineElement:o.createElement(y,{persona:n,isImplicitGroupPersona:s}),addPickerItemAction:()=>{},theme:r}))}},10365:(e,t,n)=>{"use strict";n.d(t,{i:()=>Q,w:()=>Y});var i=n(101060),r=n(989526),o=n(55461);function s(e){return(0,o.cr)("cmp-implicitgroups")&&e&&e.persona&&"ImplicitGroup"==e.persona.PersonaTypeString&&e.persona.Members&&e.persona.Members.length>0}var a=n(136743),l=n(690518),c=n(906233),d=n(371134),u=n(933635);const p=(0,d.lr)("resetFindControl",(()=>{f().viewState=Object.assign(Object.assign({},m),{findResultSet:[...m.findResultSet]})})),m={userIdentity:"",mailboxSmtpAddress:null,queryString:"",shouldShowFindResult:!1,findResultSet:[],findResultType:u.m.None,findResultHightlightIndex:-1,isSearching:!1,directorySearchType:u.r.None,inForceResolve:!1,numberOfCacheResults:0},h=(0,d.MT)("FindControl",{viewState:m})(),f=()=>h;const g=function(){return p(),f()};var v=n(188464),y=n(919051),S=n(468305);const b=(0,d.lr)("updateUserIdentity",((e,t)=>{e.userIdentity=t})),I="yJZl_";class w extends r.Component{constructor(e){super(e),this.onItemSelected=e=>{if(e){const t=(0,a.C)(e);this.props.onEditingFinished(this.props.recipient,t)}},this.onInputChanged=e=>{(0,i.LP)(e)&&this.props.removeOperation(this.props.recipient)},this.onBlur=()=>{(0,i.LP)(this.store.viewState.queryString)||this.props.recipient.displayText===this.store.viewState.queryString?(0,S.Z)(this.props.recipient,!1):this.findControl.getFloatingPicker().forceResolveSuggestion()},this.store=g(),(0,c.Z)(this.store.viewState,e.recipient.displayText),(0,y.Z)(this.store.viewState,e.inForceResolve),b(this.store.viewState,e.userIdentity)}render(){return r.createElement(l.Z,{ref:e=>this.findControl=e,viewState:this.store.viewState,onItemSelected:this.onItemSelected,focusAutomatically:!0,openPickerAutomatically:!0,onBlur:this.onBlur,onInputChanged:this.onInputChanged,className:I,editingRecipientInputClassName:this.props.editingRecipientInputClassName})}}const C=(0,v.observer)(w);var E=n(504276);const P=(0,n(92894).Pi)((function(e){const{viewState:t,inForceResolve:n,removeOperation:i,onEditingFinished:o,index:s,editingRecipientInputClassName:a,userIdentity:l}=e;return t.isEditing?r.createElement(C,{recipient:t,onEditingFinished:o,removeOperation:i,inForceResolve:n,editingRecipientInputClassName:a,userIdentity:l}):r.createElement(E.Z,Object.assign({key:`${t.persona.EmailAddress.EmailAddress}_${s}`,canEdit:!0,showPresence:!0},e))}));var T=n(546120),R=n(928563),x=n(877611);var k=n(690187),N=n(291360),A=n(330683),D=n(762978),Z=n(775390);var M=n(995388),O=n(53279),F=n(355689),_=n(631401),L=n(166337),z=n(404596),B=n(336829),V=n(462480),U=n(620638);function q(e,t){return Promise.all(e.map((async e=>{var n;if(!e.isPendingResolution)return e;const i=(0,L.Z)(e.persona.EmailAddress),r=(0,U.Z)(t),o=await B.Zk.import().then((e=>e(t?t.userIdentity:null,i,r)));if(r&&null==o){const i=(null===(n=t.findPeopleFeedbackManager)||void 0===n?void 0:n.conversationId)||(0,V.u)();B.$8.import().then((t=>t(e.persona,i))),t.findPeopleFeedbackManager&&(t.findPeopleFeedbackManager.conversationId=(0,V.u)())}return o?Object.assign(Object.assign({},e),{persona:o,isPendingResolution:!1,isValid:!0,displayText:(0,z.Z)(o.EmailAddress)}):Object.assign(Object.assign({},e),{isPendingResolution:!1})})))}const W=(e,t)=>e.persona.id===t.persona.id&&null!=e.persona.id||null!=e.persona.EmailAddress&&null!=e.persona.EmailAddress.EmailAddress&&e.persona.EmailAddress.EmailAddress===t.persona.EmailAddress.EmailAddress;var H=n(658980);const j="bcHGQ";var G=n(764403),K=n.n(G),X=n(487616);class $ extends O.h{constructor(e){super(e),this.addItem=e=>{this.onItemsAdded(e)},this.forceResolveQueryString=async()=>{const e=this.props.shouldPreResolveRecipients;await async function(e,t){const n=e().queryString;(0,Z.T)(n)||(await(0,A.Z)(e(),n,!0),t([1==e().findResultSet.length?(0,a.C)(e().findResultSet[0]):(0,D.K)(n)]))}(this.getViewState,(async t=>{const n=(e?await q(t,this.getViewState()):t).filter((e=>this.state.items.every((t=>!W(e,t)))));n.length&&this.onItemsAdded(n)})),this.picker&&this.picker.clearInput()},this.clearQueryString=()=>{this.picker.clearInput(),this.picker.inputElement.value="",(0,c.Z)(this.getViewState(),"")},this.getFindControlProps=()=>{const e=(0,x.Z)(this.getViewState,this.getFindControl,this.props.useAsControlledComponent,this.props.theme,this.props.onPickerHidden,this.props.scenario,this.getAdditionalRecipientEmailAddresses);return Object.assign(Object.assign({},e),{onInputChanged:this.onInputChanged})},this.getExtendedSelectedItemsListProps=()=>({onCopyItems:_.Z,canRemoveItem:this.canRemoveItem}),this.onPaste=async e=>{const t=this.parsePastedTextForItems(e),n=this.props.shouldPreResolveRecipients?await q(t,this.getViewState()):t;this.onItemsAdded(n,5),this.clearQueryString()},this.processItemsToAdd=(e,t)=>{const{processItemToAdd:n}=this.props;let i=[];return e.forEach((e=>{n&&!(null==n?void 0:n(e,t))||(s(e)?i=i.concat(function(e){return s(e)?e.persona.Members.map((e=>(0,a.C)({EmailAddress:e}))):[(0,a.C)(e.persona)]}(e)):i.push(e))})),this.props.enableSingleSelection&&(this.picker.inputElement.hidden=!0),i},this.getItemIndex=e=>{var t,n,i,r;for(let o=0;o<this.state.items.length;o++){const s=this.state.items[o];if((null===(n=null===(t=s.persona)||void 0===t?void 0:t.PersonaId)||void 0===n?void 0:n.Id)&&(null===(r=null===(i=e.persona)||void 0===i?void 0:i.PersonaId)||void 0===r?void 0:r.Id)&&e.persona.PersonaId.Id===s.persona.PersonaId.Id)return o}return-1},this.renderSelectedItem=e=>{const{theme:t,recipientSize:n,showAvailability:i,editingRecipientInputClassName:o,canDrag:s,isItemAligned:a,wellItemStyles:l}=this.props,c=this.getViewState(),d=void 0!==n?n:1,u=e.item;return r.createElement(P,{isSelected:e.selected,inForceResolve:c.inForceResolve,dropViewState:this.props.dropViewState,index:e.index,theme:t,size:d,expandGroupOperation:this.expandGroup,viewState:u,useContextMenu:!0,onEditingFinished:this.onEditingFinished,draggableItemType:this.props.draggableItemType,removeOperation:(e,t)=>{this.onItemsRemoved([e],t),this.focus()},showAvailability:i,editingRecipientInputClassName:o,canDrag:s,isItemAligned:a,wellItemStyles:l,scenario:this.props.scenario,maxItemWidth:"calc(100% - 32px)",userIdentity:c.userIdentity})},this.convertSuggestionItemToWellItem=e=>(0,a.C)(e),this.convertInitialItemsToWellItems=e=>this.props.convertInitialItemsToWellItems(e),this.onSelectedItemsChanged=e=>{const t=this.getViewState();(0,c.Z)(t,this.picker.inputElement.value)},this.onKeyDown=e=>{const t=this.context;if(e.ctrlKey&&75==e.which){e.preventDefault();const n=this.getViewState();(0,i.LP)(n.queryString)?(0,k.Z)(n,this.state.items,t):((0,y.Z)(n,!0),(0,N.Z)(this.getViewState,this.getFindControl()))}if(13===e.which){const t=e.target.querySelector("span.LPCWrapper");t&&t.click()}},this.onItemsRemoved=(e,t)=>{if(this.props.onItemsRemoved)this.props.onItemsRemoved(e,!1);else{const n=this.filterItems(e,t);this.setState({items:n},this.onItemsChanged)}this.props.enableSingleSelection&&(this.picker.inputElement.hidden=!1)},this.getViewState=()=>this.props.findControlViewState?this.props.findControlViewState:this.state.findControlViewState,this.getFindControl=()=>this.picker?this.picker.floatingPicker.current:null,this.getAdditionalRecipientEmailAddresses=()=>{var e,t;return null===(t=(e=this.props).getAdditionalRecipientEmailAddresses)||void 0===t?void 0:t.call(e,this.props.recipientType)},this.expandGroup=e=>{(0,T.Z)(e).then((t=>{t.length&&(this.onItemsExpanded([e],t),this.focus())}))},this.onInputChanged=e=>{let t=!1;const n=e.length-1,i=e[n],r=this.getViewState();if(";"==i||","==i){const i=e.substring(0,n);if(i.length>0){const e=(0,D.K)(i);this.onItemsAdded([e],4),this.picker.clearInput(),t=!0}}(0,c.Z)(r,t?"":e)},this.onEditingFinished=(e,t)=>{const n=this.getViewState(),i=this.context;if(this.props.onItemEdited)this.props.onItemEdited(e,t);else{const n=this.state.items,i=n.indexOf(e);n.splice(i,1,t),this.setState({items:n},this.onItemsChanged)}n.inForceResolve?(0,k.Z)(n,this.state.items,i):this.focus()};const t=e.findControlViewState?null:(0,R.Z)();this.state={items:[],findControlViewState:t}}extendedPickerProps(){const{inputProps:e,useAsControlledComponent:t,recipientType:n,peoplePickerClassName:i}=this.props,r=this.getViewState(),o=r.currentRenderedQueryString?r.currentRenderedQueryString:"";return{headerComponent:this.props.onRenderWellLabel&&this.props.onRenderWellLabel(n),inputProps:Object.assign(Object.assign({},e),{onFocus:t=>{var n;X.Z.setUserIdentity(r.userIdentity),null===(n=null==e?void 0:e.onFocus)||void 0===n||n.call(e,t)}}),currentRenderedQueryString:t?o:void 0,focusZoneProps:{handleTabKey:M.J.all,shouldInputLoseFocusOnArrowKey:()=>!0},suggestionItems:t?r.findResultSet.slice():null,className:i,onPaste:e=>(this.onPaste(e),[])}}getWellClassname(){return K()(super.getWellClassname(),0===this.props.recipientSize&&j)}parsePastedTextForItems(e){return(0,F.Z)(e)}filterItems(e,t){const n=e.reduce(((e,t)=>{if(t.persona){const n=this.getPersonaKeyForDedup(t.persona);null!==n&&(e[n]=!0)}return e}),{}),i=(t?this.state.items.reverse():this.state.items).filter((e=>{const t=this.getPersonaKeyForDedup(e.persona);return!(!e.persona||null===t||n[t])}));return t?i.reverse():i}getPersonaKeyForDedup(e){var t;return(null===(t=e.PersonaId)||void 0===t?void 0:t.Id)?e.PersonaId.Id:e.EmailAddress?e.EmailAddress.EmailAddress:null}canRemoveItem(e){return!e.blockWellItemRemoval}}$.contextType=H.Z;const J=(0,v.observer)($),Q=J,Y=J},861840:(e,t,n)=>{"use strict";n.d(t,{S:()=>s,i:()=>r.w});var i=n(717420),r=n(10365);const o=new i.nI((()=>n.e(50093).then(n.bind(n,850093)))),s=(0,i.$y)(o,(e=>e.UncontrolledExtendedRecipientWell))},486682:(e,t,n)=>{"use strict";n.d(t,{J:()=>o,A:()=>r});var i=n(989526);const{useComponentRegistration:r,getInstancesFromRegistry:o}=(()=>{const e=new Map;return{useComponentRegistration:(t,n)=>{let r,o;return t instanceof Function?(r=i.createRef(),o=e=>{r.current=e,t(e)}):r=o=null==t?i.createRef():t,i.useEffect((()=>{e.has(n)||e.set(n,[]);const t=e.get(n);return t.push(r),()=>{if(null==t)return;const i=t.indexOf(r);-1!=i&&(t.splice(i,1),t.length||e.delete(n))}}),[r,n]),o},getInstancesFromRegistry:t=>e.get(t)||[]}})()},546120:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var i=n(136743),r=n(136947);const o=(0,r.aD)("processGetGroupInfoResult")((function(e,t){t.Members&&t.Members.forEach((t=>{e.push({EmailAddress:t.EmailAddress,PersonaId:t.PersonaId,ADObjectId:t.ADObjectId})}))})),s=(0,r.aD)("updateIsExpanding")((function(e,t){e.isExpanding=t}));var a=n(841186);var l=n(101060),c=n(951789);const d=async(e,t)=>{const n=e<=100;return await(0,c.i)((0,l.ZP)("cmc"),(0,l.ZP)("dmc"),n,{delayCallbackAfterAnimation:!0,okText:(0,l.ZP)("emc"),targetWindow:t})===c.w.ok};var u=n(874191),p=n(531016),m=n(959070);async function h(e,t){var n,r,l;s(e,!0);let c=e.persona.PersonaId;if(!c){let t=null===(r=null===(n=e.persona.EmailAddress)||void 0===n?void 0:n.PersonaId)||void 0===r?void 0:r.Id;if(t||(t=e.persona.Id),!t){const n=(0,m.Y)(e.persona.EmailAddress.EmailAddress);t=null===(l=null==n?void 0:n.PersonaId)||void 0===l?void 0:l.Id}c={Id:t}}const h=await(0,a.y)(c,e.persona.ADObjectId,e.persona.EmailAddress);s(e,!1);const f=(null==h?void 0:h.MembersCount)?h.MembersCount:0,g=[],v=await d(f,t);return v&&o(g,h),(0,u.y8)("RWRecipientGroupExpand",{size:(0,p.Ht)({value:f,exactMatches:[],buckets:[25,50,75,100,125,150,175,200]}),shouldExpand:v}),g.map(i.C)}},631401:(e,t,n)=>{"use strict";function i(e){let t;return e.forEach(((n,i)=>{const r=n.persona.EmailAddress;if("SMTP"===r.RoutingType)if(r.Name){const e="OneOff"==r.MailboxType?r.Name:`"${r.Name.replace('"','\\"')}"`;t=t?t+`${e} <${r.EmailAddress}>`:`${e} <${r.EmailAddress}>`}else t=t?t+r.EmailAddress:r.EmailAddress;else t="PDL"===r.RoutingType?t?t+r.Name:r.Name:t?t+`${r.Name} [${r.RoutingType}:${r.EmailAddress}]`:`${r.Name} [${r.RoutingType}:${r.EmailAddress}]`;i<e.length-1&&(t+=", ")})),t}n.d(t,{Z:()=>i})},877611:(e,t,n)=>{"use strict";n.d(t,{Z:()=>te});var i=n(101060),r=n(466644),o=n(972406);function s(e,t){if((0,i.LP)(e))return{selected:!1,item:null};{const t=(0,o.Z)(e),n=(0,r.Z)(t.address,t.displayName);return n?{selected:!1,item:{EmailAddress:n}}:{selected:!1,item:null}}}const a=e=>e.EmailAddress.Name&&e.EmailAddress.EmailAddress?`${e.EmailAddress.Name} (${e.EmailAddress.EmailAddress})`:e.EmailAddress.Name||e.EmailAddress.EmailAddress||null;var l=n(906233),c=n(509949),d=n(386207),u=n(564229);const p=e=>{const{theme:t}=e,{palette:n}=t;return{container:[{height:"48px",width:"100%",overflow:"hidden",display:"table"}],textContainer:[{fontSize:u.TS.small,width:"calc(100% - 46px)",textAlign:"left",display:"table-cell",verticalAlign:"middle",paddingLeft:"12px"}],centered:[{width:"100%",textAlign:"center",padding:0}],iconContainer:[{paddingLeft:"12px",paddingTop:"14px",width:"32px",display:"table-cell",textAlign:"center"}],searchIcon:[{fontSize:u.TS.xLarge,color:n.themePrimary}],useAddressContainer:[{height:"36px"}],suggestedContactsText:[{fontSize:u.TS.small,color:n.themePrimary}],suggestedContactsHeaderBox:[{height:"30px"}],headerBorder:[{borderBottom:"1px solid",borderColor:n.neutralLight}],footerBorder:[{borderTop:"1px solid",borderColor:n.neutralLight}],feedbackContainer:[{display:"block",width:"100%",padding:"5px 5px 5px 12px",color:n.themePrimary}],verticalCenter:[{position:"absolute",top:"50%",transform:"translateY(-50%)"}],cancelIcon:[{fontSize:u.TS.small,color:n.neutralPrimary,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}]}};var m=n(287130),h=n(5989),f=n(106147),g=n(843784),v=n(484982),y=n(252936),S=n(670366),b=n(178815),I=n(73263),w=n(570338),C=n(430647),E=n(781540),P=n(453083),T=n(874668),R=n(954947),x=n(989526),k=n(764403),N=n.n(k);const A=(0,m.y)(),D=e=>{const{infoType:t,queryString:n,numberOfResults:r,theme:o=(0,g.Pl)()}=e,s=A(p,{theme:o});switch(t){case T.k.SuggestedContacts:return x.createElement("div",{className:N()(s.textContainer,s.suggestedContactsHeaderBox)},x.createElement("span",{className:s.suggestedContactsText},(0,i.ZP)(E.o)));case T.k.Searching:return x.createElement("div",{className:N()(s.footerBorder,s.container)},x.createElement("div",{className:s.iconContainer},x.createElement(f.$,{theme:o})),x.createElement("div",{className:s.textContainer},(0,i.WU)((0,i.ZP)(S.U),n)));case T.k.TypeToSearch:return x.createElement("div",{className:s.container},x.createElement("div",{className:N()(s.textContainer,s.centered)},(0,i.ZP)(w.e)));case T.k.SearchDirectory:return x.createElement("div",{className:N()(s.footerBorder,s.container)},x.createElement("div",{className:s.iconContainer},x.createElement(h.J,{className:s.searchIcon,iconName:"Search"})),x.createElement("div",{className:s.textContainer},(0,R.Z)()?(0,i.ZP)(b.W):(0,i.ZP)(y.c)));case T.k.TopNResults:return x.createElement("div",{className:N()(s.footerBorder,s.container)},x.createElement("div",{className:N()(s.textContainer,s.centered)},r?(0,i.WU)((0,i.ZP)(I.e),r):(0,i.ZP)(v.z)));case T.k.UseAddress:return x.createElement("div",{className:N()(s.headerBorder,s.textContainer,s.useAddressContainer)},(0,i.WU)((0,i.ZP)(C.E),n));case T.k.FindPeopleFeedback:return x.createElement(P.Z,{className:N()(s.footerBorder,s.textContainer,s.feedbackContainer)});default:return null}};var Z=n(55461),M=n(233762),O=n(329746),F=n(299518),_=n(777870),L=n(213029),z=n(933635);function B(e,t){return function(){switch(e){case T.k.Searching:return V(t)&&t.isSearching;case T.k.TypeToSearch:return!V(t)&&(0,F.Z)()&&0==t.findResultSet.length;case T.k.SearchDirectory:return V(t)&&!t.isSearching&&t.directorySearchType==z.r.None;case T.k.TopNResults:return V(t)&&!t.isSearching&&t.directorySearchType!=z.r.None;case T.k.UseAddress:return V(t)&&t.directorySearchType!=z.r.None&&0==t.findResultSet.length&&(0,_.Z)(t.queryString);case T.k.SuggestedContacts:return!V(t)&&t.findResultSet.length>0;case T.k.FindPeopleFeedback:return((0,M.sj)()||(0,Z.cr)("cmp-3SPeopleFeedback"))&&(0,L.Z)()&&(0,O.X)("use3SPeopleSuggestions");default:return!1}}}const V=e=>!(0,i.LP)(e.queryString);var U=n(49516),q=n(330683);const W="Y0bwA";function H(e,t,n,r,o){const s={className:W,suggestionsAvailableAlertText:(0,i.ZP)("hmc")};return Object.assign(Object.assign({},s),{showRemoveButtons:!0,headerItemsProps:j(e,t,r),footerItemsProps:G(e,t,n,r,o),shouldSelectFirstItem:()=>!(0,i.LP)(e().queryString)&&e().findResultSet.length>0})}function j(e,t,n){return[{renderItem:K(e(),T.k.TypeToSearch,n),shouldShow:B(T.k.TypeToSearch,e())},{renderItem:K(e(),T.k.SuggestedContacts,n),shouldShow:B(T.k.SuggestedContacts,e())},{renderItem:K(e(),T.k.UseAddress,n),shouldShow:B(T.k.UseAddress,e()),onExecute:()=>{t()&&t().forceResolveSuggestion()}}]}function G(e,t,n,r,o){return[{renderItem:K(e(),T.k.Searching,r),shouldShow:B(T.k.Searching,e())},{renderItem:K(e(),T.k.SearchDirectory,r),shouldShow:B(T.k.SearchDirectory,e()),onExecute:()=>{(0,q.Z)(e(),e().queryString,!0,null,null,null,"forceOff",o).then((()=>{!n&&t().updateSuggestions(e().findResultSet.slice(),!0)}))},ariaLabel:(0,R.Z)()?(0,i.ZP)(b.W):(0,i.ZP)(y.c)},{renderItem:K(e(),T.k.TopNResults,r),shouldShow:B(T.k.TopNResults,e())},{renderItem:K(e(),T.k.FindPeopleFeedback,r),shouldShow:()=>n&&B(T.k.FindPeopleFeedback,e())(),onExecute:()=>{const t=()=>e().peopleFeedbackState;d.cL.import().then((e=>{e(t)}))},ariaLabel:(0,i.ZP)(U.N)}]}function K(e,t,n){return function(){return D({queryString:e.queryString,numberOfResults:e.findResultSet.length,infoType:t,theme:n})}}var X=n(874191),$=n(399101),J=n(361130),Q=n(618391),Y=n(30491),ee=n(903054);function te(e,t,n,i,r,o,l,c){return{suggestionsStore:new ee.$({getAriaLabel:a}),onValidateInput:_.Z,onRenderSuggestionsItem:ie(i),createGenericItem:s,onResolveSuggestions:n?oe(e(),o,c):re(e(),o,c),onZeroQuerySuggestion:n?ae(e(),o,l):se(e(),o,l),calloutWidth:300,resolveDelay:150,onRemoveSuggestion:ne(t,e,n),getTextFromItem:e=>e.EmailAddress.Name,pickerSuggestionsProps:H(e,t,n,i,o),onSuggestionsShown:(d=e(),function(){(0,J.Z)(d.findPeopleFeedbackManager)}),onSuggestionsHidden:le(e(),r)};var d}function ne(e,t,n){return function(i){(0,X.y8)("RWFindPeopleMasking");const r=t();(0,Q.Z)(r,i),n||e().updateSuggestions(r.findResultSet.slice(),!0)}}function ie(e){return function(t,n){return(0,c.ZP)({itemProps:n,persona:t,theme:e})}}function re(e,t,n){return async function(i,r){return e.queryString===i?(await(0,q.Z)(e,i,!!n,null,null,null,"forceOff",t),e.findResultSet.slice()):null}}function oe(e,t,n){return function(i,r){return e.queryString===i&&(0,q.Z)(e,i,!!n,null,null,null,null,t),null}}function se(e,t,n){return async function(i){(0,l.Z)(e,"");const r=await Y.I.import();return await r(e,i,t,null==n?void 0:n()),e.findResultSet.slice()}}function ae(e,t,n){return function(i){return(0,l.Z)(e,""),Y.I.import().then((r=>{r(e,i,t,null==n?void 0:n())})),null}}function le(e,t){return function(){null==t||t(),(0,$.Z)(e.findPeopleFeedbackManager)}}},355689:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(762978);const r=new RegExp(";|,|\\n|\n","g");function o(e){return e.split(r).map((e=>e.trim())).filter((e=>!!e)).map(i.K)}},291360:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(330683);async function r(e,t){await(0,i.Z)(e(),e().queryString,!0),t.showPicker(!1),1==e().findResultSet.length&&t.forceResolveSuggestion()}},453083:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(49516),r=n(101060),o=n(989526);const s=e=>o.createElement("div",{className:e.className},(0,r.ZP)(i.N))},386207:(e,t,n)=>{"use strict";n.d(t,{xR:()=>o,iI:()=>s,cL:()=>a});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(52637),n.e(56337),n.e(42106),n.e(56841),n.e(62600),n.e(90885),n.e(77456),n.e(99110),n.e(60830)]).then(n.bind(n,394366)))),o=new i._5(r,(e=>e.removePendingRequestCorrelationId)),s=new i._5(r,(e=>e.addPendingRequestCorrelationId)),a=new i.EF(r,(e=>e.openFeedbackDialog))},330683:(e,t,n)=>{"use strict";n.d(t,{Z:()=>Q});var i=n(136947),r=n(336829),o=n(302512),s=n(582395),a=n(699983),l=n(198251),c=n(629762),d=n(78718),u=n(509636),p=n(933635),m=n(378e3),h=n(734427),f=n(213029),g=n(620638);const v=(0,i.aD)("autoSearchDirectory")((function(e,t,n,i,v,y){const S=(0,u.zO)();return(0,a.XN)(e,S,n,!0),r.uR.import().then((i=>i(e.userIdentity,t,!0,n,e.findPeopleFeedbackManager,null,y))).then((y=>{var b;if((0,l.Z)(e,!1),!y)return;const I=(0,d.Z)(y),w=(0,f.Z)(),C=w?void 0:"PeopleSearchProvider",E=(0,g.Z)(e);E&&r.nA.import().then((e=>e(I,(0,u._Q)((0,u.zO)(),S),void 0,C,w?void 0:t.length)));if(e.queryString.trim()==t){const l=20;if((0,c.Z)(e,t),(0,s.Z)(e.findResultSet,y,n,null!=v&&v,l,!0,E),(0,a.$E)(e,!0,I,y),(0,m.Z)(e.findResultSet,e,S,I),E){if(!w){const t=(null===(b=e.findPeopleFeedbackManager)||void 0===b?void 0:b.conversationId)||"";r.fV.import().then((e=>e(I,t,n,C)))}r.fH.import().then((e=>e(n,I,(0,u._Q)((0,u.zO)(),S)))),(0,h.Z)(n)}e.directorySearchType=p.r.Auto,0==e.findResultSet.length&&(e.findResultSet=[]),(0,o.Z)(e,p.m.SearchDirectory,0,i)}}))}));var y=n(437578),S=n(15668),b=n(642293),I=n(548838),w=n(519951),C=n(669034),E=n(695828),P=n(964659),T=n(874191);async function R(e,t,n,i,o,l,R,x=!1){(0,y.i)(o);const k=(0,u.zO)();(0,a.XN)(e,k,o,!1);let N="";(0,c.Z)(e,t);const A=(0,g.Z)(e);try{const c=await r.uR.import().then((n=>n(e.userIdentity,t,!1,o,e.findPeopleFeedbackManager,null,R)));N=(0,d.Z)(c),A&&r.nA.import().then((e=>e(N,(0,u._Q)((0,u.zO)(),k))));const g=function(e,t){if((0,f.Z)()){const n=[];return(0,b.Z)(n,e,t,!1),n}return e.ResultSet}(c,o);if(n&&(0,S.Z)(g),e.queryString!=t)return;let I="";const D=function(e){var t;if((0,f.Z)()){const n=e;return!(null===(t=null==n?void 0:n.Groups)||void 0===t?void 0:t.length)}{const t=e;return"Success"!=t.ResponseClass||0==t.ResultSet.length}}(c);if((0,E.a)()&&i&&!D)try{I=await C.dr.import().then((t=>t(e.findResultSet,c)))}catch(e){(0,T.y8)("compareFeatureData",[e.Name])}(0,a.$E)(e,!1,N,c,I),(0,s.Z)(e.findResultSet,c,o,i,5,!1,A);let Z=!1;D&&!x&&((0,P.uf)()?((0,w.Z)(e,p.r.Auto),0==e.findResultSet.length&&(e.findResultSet=[])):(Z=!0,await v(e,t,o,l,i,R))),A&&!Z&&(r.fH.import().then((e=>e(o,N,(0,u._Q)((0,u.zO)(),k)))),(0,h.Z)(o)),(0,m.Z)(g,e,k,N)}catch(t){throw A&&r.nA.import().then((e=>e(o,(0,u._Q)((0,u.zO)(),k),t.responseCode))),(0,I.Z)(e,k,N),t}finally{(0,y.R)(o)}}var x=n(808429),k=n(737047),N=n(448857);var A=n(521480),D=n(462480),Z=n(959869);const M=(0,i.aD)("processCacheResult")((function(e,t,n,i,r,s,a){if(n){const n=new Map;e.findResultSet.forEach((e=>{n[e.EmailAddress.EmailAddress]=e})),t=function(e,t){return t.filter((t=>null==e[t.EmailAddress?t.EmailAddress.EmailAddress:""]))}(n,t),(t=[...e.findResultSet,...t]).splice(5)}(0,l.Z)(e,!1);const c=n||t.length>0;(0,g.Z)(e)&&(t.forEach((e=>{const t=e;t.TransactionId=r,t.LogicalId=s,t.ReferenceId||(t.ReferenceId="client-"+(0,D.u)())})),c&&Z.Z.setResults(r,t)),c&&(0,N.Z)(e,t),(0,A.Z)(e,i),(0,o.Z)(e,p.m.Cache,t.length,a)}));var O=n(211938),F=n(844312);var _=n(446808);async function L(e,t,n){var i;let r;if((0,E.a)()&&!await C.fG.importAndExecute(e))try{r=await function(e,t,n,i,r){return C.PZ.import().then((o=>o(e,t,n,(e=>(0,F.l)(i,e,r)))))}(e,t,5,n)}catch(e){return new T.Gn(_.Z.SearchSuggestionTrie.name).endWithError(T.SO.ClientError,new Error("Could not search suggestion Trie: "+e.Name)),[]}else r=(0,O.Z)(t,5,n);if((0,T.y8)("peopleCache_NumberOfContacts",[null!==(i=null==r?void 0:r.length)&&void 0!==i?i:0]),0==r.length)return[];const o=r.map((e=>{const t=e;return{EmailAddress:e.EmailAddress,PersonaId:e.PersonaId,ADObjectId:e.ADObjectId,PersonaTypeString:e.PersonaTypeString,FeatureData:e.FeatureData,Id:t.Id,PersonId:t.PersonId,ReferenceId:t.ReferenceId,TransactionId:t.TransactionId}}));return Promise.resolve(o)}var z=n(286316),B=n(102543),V=n(371134);const U=(0,V.lr)("updateRecipientWellDirectorySearchType",((e,t,n=!1)=>{e.directorySearchType=t,n&&(e.findResultSet=[])}));async function q(e,t,n,i,s,d,m=!1){const f=(0,D.u)();let v=p.m.Cache;const y=new T.Gn(x.Z.SearchCacheFirst.name);U(e,p.r.None),(0,l.Z)(e,!0);const S=(0,u.zO)(),b=(0,D.u)(),I=await(async(e,t,n,i,o,s,l,d)=>{var p;const m=await L(n.userIdentity,e,(0,z.Z)(t));if((0,g.Z)(n)&&r.nA.import().then((t=>t(s,0,200,"LocalPeopleProvider",e.length))),(0,c.Z)(n,e),(0,a.WB)(n,o,m,s),M(n,m,i,o,s,l,d),(0,g.Z)(n)){const e=(null===(p=n.findPeopleFeedbackManager)||void 0===p?void 0:p.conversationId)||"";r.fV.import().then((t=>t(s,e,l))),r.fH.import().then((e=>e(l,s,(0,u._Q)((0,u.zO)(),o)))),(0,h.Z)(l)}return m})(t,n,e,i,S,b,f,s),w=I.length,C=i||w>0;(0,T.y8)("CacheFirstFindPeopleRequestCount",[k.Z.pendingFindPeopleRequests]);try{C&&k.Z.pendingFindPeopleRequests<B.LN?(R(e,t,!(0,E.a)(),C,f,s,d,m),v=p.m.MixedCacheLive):C||(await R(e,t,!(0,E.a)(),C,f,s,d,m),v=e.findResultType==p.m.SearchDirectory?p.m.SearchDirectory:p.m.FindPeople)}catch(t){C||(0,N.Z)(e,[]),y.endWithError(T.SO.ServerError,t)}e.findResultSet.length>0&&(0,o.Z)(e,v,w,s),(0,l.Z)(e,!1),y.addCustomData([v,t==e.queryString]),y.end()}var W=n(879471),H=n(55461),j=n(299518),G=n(553497),K=n(45879);const X=(0,V.lr)("updateRecipientWellFindResultSet",((e,t)=>{e.findResultSet=t}));var $=n(487616);const J=async function(e,t,n,i,o,s,l,d){var m;if(e.queryString.trim()==t.trim()){const f=(0,u.zO)(),v=(0,D.u)(),y=await L(e.userIdentity,t,(0,z.Z)(n));if((0,g.Z)(e)&&r.nA.import().then((e=>e(v,0,200,"LocalPeopleProvider",t.length))),(0,a.WB)(e,f,y,v,!0),(0,c.Z)(e,t),U(e,d?p.r.Manual:p.r.None),y.length>0){if(M(e,y,i,f,v,o,s),(0,g.Z)(e)){const t=(null===(m=e.findPeopleFeedbackManager)||void 0===m?void 0:m.conversationId)||"";r.fV.import().then((e=>e(v,t,o))),r.fH.import().then((e=>e(o,v,(0,u._Q)((0,u.zO)(),f)))),(0,h.Z)(o)}}else l&&(l.isCacheEmpty=!0)}};async function Q(e,t,n,i,S,b,w,R,N={store:k.Z},A=!1){var Z;n||(0,a.zF)(e);const M=(0,W.Z)(e,S);let O=!1;if(b&&b.length>0){const n=function(e,t){const n=[];if(t){let i=0;for(e=e.toLowerCase();n.length<5&&i<t.length;){const r=t[i].persona.EmailAddress;(r.EmailAddress&&0==r.EmailAddress.toLowerCase().indexOf(e)||r.Name&&0==r.Name.toLowerCase().indexOf(e))&&n.push({EmailAddress:r}),i++}}return n}(t,b);n&&n.length>0&&(X(e,n),O=!0)}const F=!((0,j.Z)()||(0,E.a)()&&await C.fG.importAndExecute(e.userIdentity)),_=!(null==e?void 0:e.userIdentity)||!$.Z.getUserIdentity()||e.userIdentity==$.Z.getUserIdentity();if("forceOff"!=w&&("forceOn"==w||(0,K.i)())&&!n&&F&&_)return void await q(e,t,M,O,i,R,A);let L=!1;const z=(0,D.u)();if(N.store.pendingFindPeopleRequests<B.LN){const S=(0,f.Z)(),b=new T.Gn(x.Z.SearchPeopleIndex.name);(0,l.Z)(e,!0),X(e,[...e.findResultSet]);const{currentRenderedQueryString:w,directorySearchType:C}=e;if((0,H.cr)("rp-optimizeAutoSearchDirectory")&&""!=w&&!n&&C==p.r.Auto&&w.length<t.length&&0==t.indexOf(e.currentRenderedQueryString)&&!A)await v(e,t,z,i,null,R),L=!0,b.addCustomData([!1,!0,!0,!1,!0,S]),b.end();else{(0,c.Z)(e,t);const f={isTimedOut:!1,isCacheEmpty:!1},w=n||(0,j.Z)()?null:setTimeout(((e,t,n,i,r,o,s)=>async()=>{r.isTimedOut=!0,await J(e,n,t,i,o,s,r)})(e,M,t,O,f,z,i),(0,G.R)()),C=(0,u.zO)();let E="";const x=S?void 0:"PeopleSearchProvider",k=S?void 0:t.length,N=(0,g.Z)(e);try{(0,y.i)(z);const c=[];M.forEach((e=>{c.push(e.persona.EmailAddress.EmailAddress)})),(0,a.XN)(e,C,z,n);const g=await r.uR.import().then((i=>i(e.userIdentity,t,n,z,e.findPeopleFeedbackManager,c,R,F)));(0,y.R)(z),clearTimeout(w),E=(0,d.Z)(g),N&&(f.isTimedOut?r.nA.import().then((e=>e(E,(0,G.R)(),408,x,k))):r.nA.import().then((e=>e(E,(0,u._Q)((0,u.zO)(),C),200,x,k))));const I=e.queryString==t;if((!f.isTimedOut||f.isCacheEmpty)&&I){(0,a.$E)(e,n,E,g),U(e,n?p.r.Manual:p.r.None);const c=n?B.Wm:B.ji;if((0,s.Z)(e.findResultSet,g,z,O,c,n,N),(0,m.Z)(e.findResultSet,e,C,E),e.findResultSet.length>0){(0,l.Z)(e,!1);const t=n?p.m.SearchDirectory:p.m.FindPeople;if((0,o.Z)(e,t,0,i),N){if(!S){const t=(null===(Z=e.findPeopleFeedbackManager)||void 0===Z?void 0:Z.conversationId)||"";r.fV.import().then((e=>e(E,t,z,x)))}r.fH.import().then((e=>e(z,E,(0,u._Q)((0,u.zO)(),C)))),(0,h.Z)(z)}}else await J(e,t,M,O,z,i,void 0,n),0!==e.findResultSet.length||A||((0,P.uf)()?U(e,p.r.Auto,!0):(L=!0,await v(e,t,z,i,null,R)))}b.addCustomData([f.isTimedOut,I,n,f.isCacheEmpty,L,S]),b.end()}catch(n){(0,y.R)(z),b.endWithError(T.SO.ServerError,n),N&&r.nA.import().then((e=>e(z,(0,u._Q)((0,u.zO)(),C),n.responseCode,x,k))),(0,I.Z)(e,C,E),await J(e,t,M,O,z,i)}}}else{const n=new T.Gn("FindPeopleThresholdHit");await J(e,t,M,O,z,i),n.end()}(0,l.Z)(e,!1),X(e,[...e.findResultSet])}},618391:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var i=n(782634),r=n(376982),o=n(628454),s=n(213029);function a(e){if((0,s.Z)()){const t=`/search/api/v1/Masking?MaskedEntities=${encodeURIComponent(e)}&scenario=owa.react.compose`;(0,i.xe)(t)}else{const t=function(e){return(0,r.Z)({EmailAddress:e})}(e);(0,o.Z)(t)}}var l=n(487616),c=n(916094);var d=n(136947),u=n(874191);const p=(0,d.aD)("maskRecipientFromFindControl")((function(e,t){e.findResultSet=e.findResultSet.filter((e=>e.EmailAddress.EmailAddress!==t.EmailAddress.EmailAddress)),function(e){let t=0,n=!1;const i=l.Z.getRecipientCache();if(i)for(;!n&&t<i.length;){const r=i[t].EmailAddress;r.EmailAddress&&r.EmailAddress==e.EmailAddress||r.Name&&r.Name==e.Name?(n=!0,i.splice(t,1)):t++}e.EmailAddress?(0,c.I)(e.EmailAddress):e.Name&&(0,c.I)(e.Name)}(t.EmailAddress);const n=t.EmailAddress.EmailAddress;n&&a(n),(0,u.y8)("MaskRecipient")}))},276257:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).aD)("onRecipientsChanged",((e,t,n)=>({targetWindow:e,recipientWellRecipients:t,recipientData:n})))},553497:(e,t,n)=>{"use strict";n.d(t,{R:()=>r});var i=n(55461);function r(){return(0,i.cr)("rp-peopleTrieOnTimeoutLow")?100:(0,i.cr)("rp-peopleTrieOnTimeoutMed")?250:(0,i.cr)("rp-peopleTrieOnTimeoutHigh")?500:1e3}},45879:(e,t,n)=>{"use strict";n.d(t,{i:()=>r});var i=n(55461);function r(){return(0,i.cr)("rp-cacheFirstPeopleTrieSize300")||(0,i.cr)("rp-cacheFirstPeopleTrieSize500")||(0,i.cr)("rp-cacheFirstPeopleTrieSize700")}},302512:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(136947),r=n(215191),o=n(547300),s=n(136743);const a=(0,i.aD)("postProcessSuggestionsResult")((function(e,t,n,i){1==e.findResultSet.length&&i&&(0,o.Z)(e)?(0,r.Z)(e.findResultSet.map(s.C),e):(e.findResultType=t,e.numberOfCacheResults=n)}))},582395:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(642293),r=n(213029),o=n(55461);function s(e,t,n){t&&((0,r.Z)()?function(e,t,n){const i={};for(const n of t.Groups)if("People"===n.Type){n.Suggestions.forEach((e=>{var t,n,r;i[null!==(n=(null===(t=null==e?void 0:e.EmailAddresses)||void 0===t?void 0:t.length)>0?e.EmailAddresses[0]:null==e?void 0:e.PersonaId)&&void 0!==n?n:""]=null!==(r=e.ReferenceId)&&void 0!==r?r:""}));const t=n.Suggestions.filter((t=>null==e[t.EmailAddresses?t.EmailAddresses[0]:""]));n.Suggestions=t;break}!function(e,t,n){var i,r,s;for(const a of e){const e=n[(null===(i=a.EmailAddress)||void 0===i?void 0:i.EmailAddress)||(null===(r=a.PersonaId)||void 0===r?void 0:r.Id)];if(e&&(a.ReferenceId=e,(0,o.cr)("rp-3STelemetryEvents"))){const e=(null===(s=t.Instrumentation)||void 0===s?void 0:s.TraceId)||a.TransactionId;a.TransactionId=e}}}(n,t,i)}(e,t,n):function(e,t){const n=t.ResultSet.filter((t=>null==e[t.EmailAddress?t.EmailAddress.EmailAddress:""]));t.ResultSet=n}(e,t))}var a=n(269917);const l=(0,n(136947).aD)("processResponseResults")((function(e,t,n,o,l,c,d){if(o){const n=new Map;e.forEach((e=>{n[e.EmailAddress.EmailAddress]=e})),s(n,t,e)}(0,r.Z)()?(0,i.Z)(e,t,n,o,l,c,d):(0,a.Z)(e,t,o,l,n,d)}))},242968:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).aD)("removePersonaFromWell",((e,t,n,i=!1)=>({targetRecipientWell:e,personaToRemove:t,targetWindow:n,shouldRemoveAllOccurrences:i})))},115167:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var i=n(276257),r=n(510481),o=n(534467),s=n(136947),a=n(816958),l=n(678356),c=n(620638);const d=(0,s.aD)("removeReadWriteRecipients")((function(e,t,n,o=!0){let s=!1;for(const n of t){let t=-1;if(t="number"==typeof n?n:e.recipients.findIndex((e=>{const t=n;return t.editKey?t.editKey===e.editKey:t.persona.EmailAddress===e.persona.EmailAddress})),t>=0){const n=e.recipients[t];if(n.blockWellItemRemoval)return;(0,c.Z)(e)&&void 0!==n.persona.ReferenceId&&l.dm.importAndExecute(a.C.MailCompose,null,null,n.persona.LogicalId,null,n.persona.ReferenceId,"EntityActionTaken",new Map([["entityactiontakentype","Remove"]])),(0,r.Z)(t,e,u),s=!0}}o&&s&&(0,i.Z)(n,e)}));function u(e,t,n){e[0].isSelected&&n.recipients.length>0&&(0,o.Z)(n.recipients[Math.max(0,t-1)],!0)}},809852:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).aD)("removeRecipientsFromRecipientWells",((e,t,n)=>({emailAddresses:e,recipientWells:t,targetWindow:n})))},690187:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(874191),r=n(515570),o=n(919051),s=n(468305);const a=(0,n(371134).lr)("trimRecipientWellQueryString",(e=>{e.queryString=e.queryString.trim()}));async function l(e,t,n,l){var c;if((0,o.Z)(e,!0),a(e),e.recipients&&e.queryString)null==l||l(),await(0,r.Z)(e,n,!1,!0,!0);else{let n=-1;for(var d=0;d<t.length;d++){if((null===(c=t[d].persona)||void 0===c?void 0:c.EmailAddress)&&!t[d].persona.EmailAddress.EmailAddress){const e=t[d].persona;"PrivateDL"!=e.EmailAddress.MailboxType&&(0,i.y8)("EmptyEmailAddress",[e.EmailAddress.MailboxType,e.EmailAddress.RoutingType])}if(!t[d].isValid){n=d;break}}-1!=n?(0,s.Z)(t[n],!0):(0,o.Z)(e,!1)}}},515570:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var i=n(215191),r=n(330683),o=n(519951),s=n(198251),a=n(933635),l=n(762978),c=n(906233);async function d(e,t,n,d,u){(0,o.Z)(e,d?a.r.Manual:a.r.None);const p=e.queryString.trim();p?n||e.inForceResolve?((0,c.Z)(e,""),(0,s.Z)(e,!1),(0,i.Z)([(0,l.K)(p)],e,t)):((0,s.Z)(e,!0),await(0,r.Z)(e,e.queryString,d,u)):(0,s.Z)(e,!1)}},519951:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(136947).aD)("setDirectorySearchType")((function(e,t){e.directorySearchType=t}))},448857:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(136947).aD)("setFindResultSet")((function(e,t){e.findResultSet=t}))},919051:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(136947).aD)("setForceResolveState")((function(e,t){e.inForceResolve=t}))},198251:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(136947).aD)("setIsSearching")((function(e,t){e.isSearching!=t&&(e.isSearching=t)}))},629762:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(136947).aD)("updateCurrentRenderedQueryString")((function(e,t){e.currentRenderedQueryString=t}))},151530:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(136947).aD)("updateIsEditing")((function(e,t){e.persona=t.persona,e.displayText=t.displayText,e.isValid=t.isValid,e.isEditing=!1}))},468305:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(136947).aD)("updateIsEditing")((function(e,t){e.isEditing=t}))},437578:(e,t,n)=>{"use strict";n.d(t,{i:()=>r,R:()=>o});var i=n(371134);const r=(0,i.aD)("addPendingRequest",(e=>({correlationId:e}))),o=(0,i.aD)("removePendingRequest",(e=>({correlationId:e})))},906233:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).lr)("updateQueryString",((e,t)=>{e.queryString=t}))},504276:(e,t,n)=>{"use strict";n.d(t,{Z:()=>H});var i=n(157241),r=n(705807),o=n(101060),s=n(468305),a=n(612384),l=n(564229),c=n(287130),d=n(559621),u=n(188464),p=n(5989),m=n(843784),h=n(55461),f=n(936552),g=n(534467),v=n(719573),y=n(167133),S=n(6566),b=n(825355),I=n(525437),w=n(989526),C=n(967318),E=n(180964),P=n(92894),T=n(962726),R=n(178336);const x=e=>{const{isItemDraggedOver:t,didDragStart:n}=e;return{draggableContainer:[{display:"inline-block",position:"relative",maxWidth:"100%"},[n&&{selectors:{":not(.draggedItem) *":{pointerEvents:"none"}}},t&&{selectors:{":not(.draggedItem)":{borderLeftWidth:"1px",borderLeftStyle:"solid",borderLeftColor:l.UK.neutralTertiary}}}]]}};var k=n(764403),N=n.n(k);const A=(0,c.y)(),D=(0,P.Pi)((function(e){const t=w.useRef({itemType:e.draggableItemType,item:e.item,displayText:e.displayText}),n=w.useRef(e.dropViewState?e.dropViewState:(0,R.Z)()),i=w.useRef(),[r,o]=w.useState(!1),s=A(x,{isItemDraggedOver:r,didDragStart:!!n.current&&n.current.didDragStart});return w.createElement(T.Z,{classNames:N()(s.draggableContainer,""),dragViewState:e.dragViewState,dropViewState:e.dropViewState,canDrag:()=>{const{item:t}=e;return e.canDrag(t)},onDrop:()=>{i.current=!0,n.current.dropItemIndex=e.itemIndex},onDragLeave:()=>{i.current||(n.current.dropItemIndex=-1),o(!1)},onDragOver:()=>{i.current=!1,o(!0)},onDragStart:()=>{n.current.didDragStart=!0},getDragData:()=>t.current,getDragPreview:Z,xOffset:-10,yOffset:5,onDragEnd:(t,i)=>{n.current.didDragStart=!1,i&&"move"==i&&e.removeDroppedItemAction(e.item,n.current.shouldRemoveFromRight)}},e.children)}));function Z(e){const t=document.createElement("div");return t.innerText=e.displayText,t}var M=n(166337);const O={persona:"ppPPy",freeBusyStatus:"DgMgU",free:"tXzI5",unknown:"yshrX",freeBusyIcon:"vZQ6o",regularSizePaddingTop:"p6PPN",containerMaxWidth:"dS1cs"};var F=n(254712),_=n.n(F);const L=(0,c.y)(),z=_().bind(O),B={isBeingDragged:!1},V={iconName:"Add"};class U extends v.Z{constructor(e){super(e),this.getCustomizedClassName=()=>{const{viewState:e,theme:t=(0,m.Pl)(),size:n,isSelected:i,isItemAligned:r,maxItemWidth:o,wellItemStyles:s}=this.props,a=e.persona.EmailAddress,c=0==n,d=1==n,u=null!==this.props.expandGroupOperation&&"AdvancedSearch"!==this.props.scenario&&("PrivateDL"==a.MailboxType||"PublicDL"==a.MailboxType||"GroupMailbox"==a.MailboxType),p=s?e=>(0,l.E$)((0,y.W)(e),s):y.W;return L(p,{isSmallSize:c,isRegularSize:d,isSelected:i,isValid:e.isValid,isExpanding:e.isExpanding,isExpandable:u,theme:t,isFadedOut:e.isFadedOut,isItemAligned:r,maxItemWidth:o})},this.getStringForRemoveButton=()=>(0,o.ZP)(r.Y4),this.getRenderResult=()=>{const{viewState:e}=this.props,t=e.persona.EmailAddress,n=e.persona.PersonaId?e.persona.PersonaId.Id:void 0;return e.isValid?w.createElement(q,{emailAddress:(0,M.Z)(t),olsPersonaId:n,name:e.displayText,mailBoxType:t.MailboxType,disableHover:!0,focusReturnElement:this.focusWrapper,clientScenario:"ReadWriteRecipient"},this.getWellItemContent()):w.createElement("div",{onClick:this.onInvalidRecipientClicked},this.getWellItemContent())},this.getPersonaControl=()=>{const{viewState:e,size:t}=this.props,n=e.persona.EmailAddress,i=(0,I.j)(t),r=this.props.showAvailability&&void 0!==e.persona.PersonaAvailability,o=e.persona.PersonaAvailability,s=o===a.Z.Unknown,l=o===a.Z.Available,c=s?"Help":l?"Accept":"Cancel";return w.createElement(w.Fragment,null,w.createElement("div",{className:this.classNames.personaInfoWrapper},w.createElement(f.Z,{className:this.classNames.wellItemImage,name:e.displayText,emailAddress:(0,M.Z)(n),size:i,presence:this.presence,mailboxType:n.MailboxType}),w.createElement("span",{className:this.classNames.wellItemText},e.displayText)),r&&w.createElement("div",{className:z(O.freeBusyStatus,{free:l,unknown:s})},w.createElement(p.J,{iconName:c,className:O.freeBusyIcon})))},this.getLeadingElement=()=>w.createElement(i.X,{appearance:"icon",onClick:this.expandGroup,iconProps:V,"aria-label":(0,o.ZP)(r.L5),title:(0,o.ZP)(r.L5),styles:this.addButtonStyle}),this.getDisplayTextFromItem=e=>e.displayText,this.getCanDragItem=e=>{const{canDrag:t=!0}=this.props;if(!t)return!1;const n=e;return!(n.blockWellItemRemoval&&n.shouldBlockSelection)},this.renderWellItem=()=>w.createElement("div",{className:z(O.containerMaxWidth),key:`rw_draggable_item_${this.props.index}`,ref:e=>this.focusWrapper=e,"data-is-focusable":!0,"data-is-sub-focuszone":!0,onKeyDown:this.onKeyDown,"data-selection-index":this.props.index,"aria-label":this.props.viewState.displayText,role:"listitem"},w.createElement(D,{dragViewState:B,dropViewState:this.props.dropViewState,item:this.props.viewState,itemIndex:this.props.index,displayText:this.getDisplayTextFromItem(this.props.viewState),draggableItemType:this.props.draggableItemType,removeDroppedItemAction:this.props.removeOperation,canDrag:this.getCanDragItem},this.getRenderResult())),this.expandGroup=e=>{e.stopPropagation(),e.preventDefault(),(0,g.Z)(this.props.viewState,!1),this.props.viewState.isExpanding||this.props.expandGroupOperation(this.props.viewState)},this.copyItemContent=()=>{const e=this.props.viewState.persona.EmailAddress;let t;if("SMTP"===e.RoutingType)if(e.Name){t=`${"OneOff"==e.MailboxType?e.Name:`"${e.Name.replace('"','\\"')}"`} <${(0,M.Z)(e)}>`}else t=(0,M.Z)(e);else t="PDL"===e.RoutingType?e.Name:`${e.Name} [${(0,M.Z)(e)}]`;var n=document.createElement("input");n.className=this.classNames.copyInput,document.body.appendChild(n);try{if(n.value=t,n.select(),!document.execCommand("copy"))throw new Error}catch(e){window.prompt((0,o.ZP)(r.mT),t)}finally{document.body.removeChild(n)}},this.onInvalidRecipientClicked=()=>{this.props.canEdit&&this.editRecipient()},this.editRecipient=()=>{(0,s.Z)(this.props.viewState,!0)},this.getContextMenu=()=>w.createElement(W,{isOpen:this.props.viewState.isContextMenuOpen,personaSpan:this.personaSpan,canEdit:this.props.canEdit,blockRemoval:this.props.viewState.blockWellItemRemoval,onDismissContextMenu:this.onDismissContextMenu,editRecipient:this.editRecipient,removeItem:this.removeItem,copyItemContent:this.copyItemContent}),(0,d.makeObservable)(this,{presence:d.computed})}get addButtonStyle(){return{root:this.classNames.expandGroupButton,rootHovered:this.classNames.actionButtonHovered,rootPressed:this.classNames.actionButtonPressed,icon:this.classNames.actionButtonIcon}}componentDidMount(){!(0,h.cr)("fwk-skype-deprecation")&&(0,h.cr)("fwk-skypeBusinessV2")&&this.props.showPresence&&S.K_.import().then((e=>{e(this.props.viewState.persona.EmailAddress.EmailAddress)}))}get presence(){return this.props.showPresence?(0,b.Z)(this.props.viewState.persona.EmailAddress.EmailAddress):void 0}}function q(e){const t=(0,E.p)(e);return w.createElement(t,null,w.createElement("span",{className:"LPCWrapper"},e.children))}const W=w.memo((({isOpen:e,personaSpan:t,canEdit:n,blockRemoval:s,onDismissContextMenu:a,editRecipient:l,removeItem:c,copyItemContent:d})=>{const[u,p]=w.useState(t.current);w.useEffect((()=>{u!==t.current&&p(t.current)}));const m=w.useMemo((()=>{const e=[];return n&&e.push({key:"edit",name:(0,o.ZP)(r.Zv),onClick:l}),s||e.push({key:"remove",name:(0,o.ZP)(r.rl),onClick:c}),e.push({key:"copyAddress",name:(0,o.ZP)(r.IZ),onClick:d}),e}),[n,s]);return!!u&&e&&w.createElement(i.l,{items:m,onDismiss:a,target:u,directionalHint:C.b.bottomLeftEdge})})),H=(0,u.observer)(U)},808429:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={SearchPeopleIndex:{name:"SearchPeopleIndex"},AddRecipientFromFindControl:{name:"AddRecipientFromFindControl",customData:(e,t)=>({index:(e>23?23:e).toString(),source:t.toString()})},SearchCacheFirst:{name:"SearchCacheFirst"}}},841186:(e,t,n)=>{"use strict";n.d(t,{y:()=>a});var i=n(723999),r=n(283491),o=n(619165);function s(e){return(0,r.Z)({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:e})}function a(e,t,n,r=200,a=!1){const l=new Headers;"GroupMailbox"==n.MailboxType&&(l.append("X-AnchorMailbox",n.EmailAddress),l.append("x-owa-explicitlogonuser",n.EmailAddress));const c=function(e,t,n,r,o){return(0,i.Z)({ItemId:e,AdObjectId:t,EmailAddress:n,Paging:s(r),ResultSet:2,ShouldUseDeepExpansion:o})}(e,t,n,r,a);return(0,o.Z)({getGroupInfoRequest:c},{headers:l}).then((e=>e))}},612384:(e,t,n)=>{"use strict";var i;n.d(t,{Z:()=>r}),function(e){e.Unknown="Unknown",e.Available="Available",e.Unavailable="Unavailable"}(i||(i={}));const r=i},737047:(e,t,n)=>{"use strict";n.d(t,{Z:()=>v});var i=n(371134),r=n(242968),o=n(356465),s=n(115167);(0,i._F)(r.Z,(e=>{const{targetRecipientWell:t,personaToRemove:n,shouldRemoveAllOccurrences:i,targetWindow:r}=e,a=t.recipients.filter((e=>(0,o.Z)(e.persona,n)));if(a&&a.length>0){const e=i?a.length-1:0,n=[];for(let t=0;t<=e;t++)a[t]&&!a[t].blockWellItemRemoval&&n.push(a[t]);n.length>0&&(0,s.Z)(t,n,r)}}));var a=n(809852);(0,i._F)(a.Z,(e=>{const t=e.recipientWells;if(!t||0===t.length)return;e.emailAddresses.forEach((n=>{const i={EmailAddress:n};t.filter((e=>!!e)).forEach((t=>(0,r.Z)(t,i,e.targetWindow,!0)))}))}));var l=n(215191),c=n(15668),d=n(276257),u=n(690187),p=n(547300);(0,i._F)(l.Z,(e=>{const{newRecipients:t}=e;t.forEach((e=>{e.isValid&&(0,c.Z)([e.persona])}))})),(0,i._F)(l.Z,(e=>{const{recipientWell:t,targetWindow:n}=e;t&&(0,p.Z)(t)&&t.inForceResolve&&(0,u.Z)(t,t.recipients,n)})),(0,i._F)(l.Z,(e=>{const{recipientWell:t,newRecipients:n,targetWindow:i}=e;(0,d.Z)(i,t,n.map((e=>({isValid:e.isValid,newPersona:e.persona,newEmailAddress:e.persona.EmailAddress.EmailAddress}))))}));var m=n(437578),h=n(386207),f=n(233762);(0,i._F)(m.i,(e=>{v.pendingFindPeopleRequests++,(0,f.sj)()&&h.iI.importAndExecute(e.correlationId)})),(0,i._F)(m.R,(e=>{v.pendingFindPeopleRequests--,(0,f.sj)()&&h.xR.importAndExecute(e.correlationId)}));var g=n(953510);(0,i._F)(g.Z,(e=>{const{newRecipients:t}=e;t.forEach((e=>{e.isValid&&(0,c.Z)([e.persona])}))})),(0,i._F)(g.Z,(e=>{const{recipientWell:t,newRecipients:n,targetWindow:i}=e;(0,d.Z)(i,t,n.map((e=>({isValid:e.isValid,newPersona:e.persona,newEmailAddress:e.persona.EmailAddress.EmailAddress}))))}));const v=(0,i.MT)("readwriterecipientwell",{pendingFindPeopleRequests:0})()},102543:(e,t,n)=>{"use strict";n.d(t,{LN:()=>i,ji:()=>r,Wm:()=>o});const i=3,r=5,o=20},226807:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(178336),r=n(933635),o=n(157767);let s=0;function a(e,t,n){return{userIdentity:e,recipientWellId:"rw-"+ ++s,queryString:"",recipients:[],isDirty:!1,shouldShowContactPicker:!1,findResultSet:[],findResultType:r.m.None,isSearching:!1,directorySearchType:r.r.None,dropViewState:(0,i.Z)(),findPeopleFeedbackManager:t,numberOfCacheResults:0,recipientEditorViewState:(0,o.Z)(e,t,n),searchScenario:n}}},575398:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(624335),r=n(226807),o=n(559621);function s(e,t,n,s,a){const l=(0,r.Z)(e,t,a);if(s&&(l.recipients=(0,o.toJS)(s)),n)for(const e of n)l.recipients.push((0,i.w)(e));return l}},525437:(e,t,n)=>{"use strict";n.d(t,{j:()=>r});var i=n(351198);const r=e=>{switch(e){case 0:return i.Ir.size24;case 1:return i.Ir.size32}}},604135:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(101060),r=n(800559);function o(e){switch(e){case r.C.To:return(0,i.ZP)("C4c");case r.C.Cc:return(0,i.ZP)("D4c");case r.C.Bcc:return(0,i.ZP)("B4c");case r.C.RequiredAttendee:return(0,i.ZP)("E4c");case r.C.OptionalAttendee:return(0,i.ZP)("F4c");default:throw new Error(`There is no localized string for RecipientType.${r.C[e]}`)}}},547300:(e,t,n)=>{"use strict";function i(e){return void 0!==e.recipients&&void 0!==e.findResultSet}n.d(t,{Z:()=>i})},699983:(e,t,n)=>{"use strict";n.d(t,{WB:()=>l,XN:()=>s,zF:()=>o,$E:()=>a});var i=n(213029);const r="Cache";function o(e){e.peopleFeedbackState={live:null,cache:null,directory:null}}function s(e,t,n,r){if((0,i.Z)()&&e.peopleFeedbackState){const i={CorrelationId:"",QueryString:"",SuggestionSource:"",RawResponse:""};i.TimeStamp=t,i.QueryString=e.queryString,i.SuggestionSource=r?"Directory":"Mailbox",i.RawResponse="pending",n&&(i.CorrelationId=n),r?e.peopleFeedbackState.directory=i:e.peopleFeedbackState.live=i}}function a(e,t,n,r,o){if((0,i.Z)()&&e.peopleFeedbackState){let i=r?JSON.stringify(r):"no response";(null==e?void 0:e.peopleFeedbackState)&&(t&&e.peopleFeedbackState.directory?(e.peopleFeedbackState.directory.RawResponse=i,e.peopleFeedbackState.directory.TraceId=n):!t&&e.peopleFeedbackState.live&&(o&&(i+=o),e.peopleFeedbackState.live.RawResponse=i,e.peopleFeedbackState.live.TraceId=n))}}function l(e,t,n,o,s){if((0,i.Z)()&&e.peopleFeedbackState){const i={CorrelationId:"",QueryString:"",SuggestionSource:"",RawResponse:""};i.QueryString=e.queryString,i.TimeStamp=t,i.SuggestionSource=s?"Cache Fallback":r,i.RawResponse=n?JSON.stringify(n):"no response",o&&(i.CorrelationId=o),e.peopleFeedbackState.cache=i}}},879471:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(547300);function r(e,t){return(0,i.Z)(e)?e.recipients:t||[]}},30491:(e,t,n)=>{"use strict";n.d(t,{I:()=>o});var i=n(717420);const r=new i.nI((()=>n.e(24497).then(n.bind(n,424497)))),o=new i.EF(r,(e=>e.getZeroQueryResults))},165956:(e,t,n)=>{"use strict";n.d(t,{u:()=>P});var i=n(92894),r=n(55461),o=n(861840),s=n(486682),a=n(115167),l=n(215191),c=n(953510),d=n(955597),u=n(101060),p=n(118336),m=n(669038),h=n(136947),f=n(448259);const g=(0,h.aD)("removeEntity")((function(e,t){if(e){if(!t)return f.g4.warn((0,u.WU)("{0} - Attempting to remove entity without recipientEmailAddresses",e.entityScenarioName)),null;if(e.hasSessionStarted){const n=JSON.stringify(t),i=(0,m.Z)(e,"","EntityRemoved",n,0,"");(0,p.Z)(e,i,!1),f.g4.info((0,u.WU)("{0} Removed Entity {1}. Session id: {2}",e.entityScenarioName,n,e.clientSessionId))}}}));var v=n(537860),y=n(989526);const S=(0,n(371134).lr)("setIsDirty",((e,t)=>{e.isDirty=t}));var b=n(151530),I=n(812557);const w=(0,i.Pi)(y.forwardRef(((e,t)=>{const{viewState:n}=e,i=y.useCallback((()=>{n.isDirty||S(n,!0)}),[n]),r=y.useCallback(((t,n)=>{var i;(0,b.Z)(t,n),null===(i=e.onItemEdited)||void 0===i||i.call(e,t,n)}),[n]),o=y.useCallback((()=>{n.recipientEditorViewState&&(0,I.Z)(n.recipientEditorViewState)}),[n]);return y.createElement(v.Z,{ref:t,recipients:n.recipients,recipientType:e.recipientType,recipientEditorViewState:n.recipientEditorViewState,scenario:e.scenario,ariaLabel:e.inputAriaLabel,onEditorModified:i,onRenderWellLabel:e.onRenderWellLabel,processItemToAdd:e.processItemToAdd,onItemsRemoved:e.internalOnItemsRemoved,onItemEdited:r,dropItemsAt:e.internalDropItemsAt,useAsUncontrolledComponent:!0,getAdditionalRecipientEmailAddresses:e.getAdditionalRecipientEmailAddresses,containerClassName:e.containerClassName,showPresence:e.showPresence,forceSync:o})})));var C=n(658980),E=n(390895);const P=(0,i.Pi)(y.forwardRef(((e,t)=>{const n=y.useContext(C.Z),i=(0,s.A)(t,e.viewState.recipientWellId),u=y.useCallback((t=>{var i;(0,l.Z)(t,e.viewState,n),null===(i=e.onItemsAdded)||void 0===i||i.call(e,t)}),[e.viewState]),p=y.useCallback(((t,i)=>{var r;(0,a.Z)(e.viewState,t,n,!i),e.viewState.findPeopleFeedbackManager&&t.forEach((t=>{var n,i;n=e.viewState.findPeopleFeedbackManager,(null==(i=t)?void 0:i.isValid)&&g(n,(0,d.Z)([i.persona]))})),null===(r=e.onItemsRemoved)||void 0===r||r.call(e,t,i)}),[e.viewState]),m=y.useCallback(((t,i,r)=>{var o;(0,c.Z)(e.viewState,t,i,r,n);const s=e.viewState.recipientEditorViewState;s&&(0,E.Y)(e.viewState.recipients,s),null===(o=e.onItemsAdded)||void 0===o||o.call(e,i)}),[e.viewState]);return(0,r.cr)("mon-rp-recipientEdit")?y.createElement(w,Object.assign({ref:i},e,{internalDropItemsAt:m,internalOnItemsRemoved:p})):y.createElement(o.S,Object.assign({ref:i},e,{internalOnItemsAdded:u,internalOnItemsRemoved:p}))})))},15668:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(487616),r=n(410716);function o(e){e&&0!=e.length&&null!==i.Z.getRecipientCache()&&e.forEach((e=>{var t;if("LinkedIn"!=e.PersonaTypeString){const n=(0,r.Z)(e);if(n&&!i.Z.getAllKeys()[n]){const r=Object.assign(Object.assign({},e),{sessionAdd:!0});null===(t=i.Z.getRecipientCache())||void 0===t||t.push(r),i.Z.getAllKeys()[n]=!0}}}))}},446808:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={RecipientCacheInitialization:{name:"RecipientCacheInitialization",custonData:(e,t)=>[e,t]},SearchSuggestionTrie:{name:"SearchSuggestionTrie"}}},284323:(e,t,n)=>{"use strict";n.d(t,{D:()=>o});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(16293),n.e(47719),n.e(52711),n.e(10056)]).then(n.bind(n,208730)))),o=new i._5(r,(e=>e.initializeCache))},959070:(e,t,n)=>{"use strict";n.d(t,{Y:()=>o});var i=n(487616),r=n(296459);const o=e=>{const t=function(e,t){const n=[];let o=0;const s=i.Z.getAllIdentities();for(;n.length<t&&o<s.length;)n.push(...(0,r.q)(e,t,void 0,void 0,s[o])),o++;return n}((t=>{var n,i,r;return"SMTP"===(null===(n=t.EmailAddress)||void 0===n?void 0:n.RoutingType)&&(null===(r=null===(i=t.EmailAddress)||void 0===i?void 0:i.EmailAddress)||void 0===r?void 0:r.toLowerCase())===e.toLowerCase()}),1);return t.length?t[0]:null}},211938:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r,G:()=>o});var i=n(296459);function r(e,t,n,r,s){const a=o(e);return(0,i.q)(a,t,n,r,s)}const o=e=>t=>{const n=t.EmailAddress;if((null==n?void 0:n.EmailAddress)&&0==n.EmailAddress.toLowerCase().indexOf(e))return!0;if(null==n?void 0:n.Name){if(0==n.Name.toLowerCase().indexOf(e))return!0;const t=n.Name.toLowerCase().split(" ");for(let n=0;n<t.length;n++)if(0==t[n].indexOf(e))return!0}return!1}},296459:(e,t,n)=>{"use strict";n.d(t,{q:()=>o});var i=n(487616),r=n(844312);function o(e,t,n,o,s){const a=[];let l=0;const c=i.Z.getRecipientCache(s);for(;a.length<t&&c&&l<c.length;){const t=c[l];if(e(t)&&t.EmailAddress){const e=t.EmailAddress;(0,r.l)(null!=n?n:[],e,null!=o?o:[])||a.push(t)}l++}return a}},892382:(e,t,n)=>{"use strict";n.d(t,{d:()=>r});var i=n(296459);function r(e,t,n,r,o){return(0,i.q)(e,t,n,r,o)}},844312:(e,t,n)=>{"use strict";function i(e,t,n){let i=!1;return e&&function(e,t){for(var n=0;n<t.length;n++)if(e.EmailAddress==t[n].EmailAddress.EmailAddress)return!0;return!1}(t,e)&&(i=!0),n&&(null==t?void 0:t.MailboxType)&&n.indexOf(null==t?void 0:t.MailboxType)>=0&&(i=!0),i}n.d(t,{l:()=>i})},487616:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(964659);function r(e){return e||(0,i.FL)()||""}const o=new class{constructor(){this.recipientCache=new Map,this.allKeys=new Map,this.userIdentity=""}getRecipientCache(e){var t;return null!==(t=this.recipientCache.get(r(e||this.userIdentity)))&&void 0!==t?t:null}setRecipientCache(e,t){this.recipientCache.set(r(e),t)}getAllKeys(){var e;return null!==(e=this.allKeys.get(this.userIdentity))&&void 0!==e?e:{}}setAllKeys(e){this.allKeys.set(this.userIdentity,e)}getUserIdentity(){return this.userIdentity}setUserIdentity(e){this.userIdentity=r(e)}getAllIdentities(){return Array.from(this.recipientCache.keys())}}},299518:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(487616);function r(){const e=i.Z.getRecipientCache();return null===e||0==e.length}},406505:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(487616);function r(e){return null!==i.Z.getRecipientCache(e)}},874668:(e,t,n)=>{"use strict";n.d(t,{k:()=>y,Z:()=>b});var i=n(430647),r=n(484982),o=n(73263),s=n(252936),a=n(178815),l=n(570338),c=n(670366),d=n(101060),u=n(5989),p=n(106147),m=n(954947),h=n(989526);const f={container:"hP27p",textContainer:"wHWbw",centered:"Sd9GA",iconContainer:"HLWXi",hoverable:"PVEjy",isHighlighted:"L2fyA",searchIcon:"LysGE",useAddressContainer:"Rp4ZT"};var g=n(254712);const v=n.n(g)().bind(f);var y;!function(e){e[e.Default=0]="Default",e[e.Searching=1]="Searching",e[e.TypeToSearch=2]="TypeToSearch",e[e.SearchDirectory=3]="SearchDirectory",e[e.TopNResults=4]="TopNResults",e[e.UseAddress=5]="UseAddress",e[e.SuggestedContacts=6]="SuggestedContacts",e[e.FindPeopleFeedback=7]="FindPeopleFeedback"}(y||(y={}));const S=e=>{switch(e.infoType){case y.Searching:return h.createElement("div",{className:f.container},h.createElement("div",{className:f.iconContainer},h.createElement(p.$,{className:f.loadingSpinner})),h.createElement("div",{className:f.textContainer},(0,d.WU)((0,d.ZP)(c.U),e.queryString)));case y.TypeToSearch:return h.createElement("div",{className:f.container},h.createElement("div",{className:v(f.textContainer,f.centered)},(0,d.ZP)(l.e)));case y.SearchDirectory:if(e.searchDirectoryAction)return h.createElement("div",{className:v(f.container,f.hoverable,{isHighlighted:e.highlighted}),onClick:e.searchDirectoryAction},h.createElement("div",{className:f.iconContainer},h.createElement(u.J,{className:f.searchIcon,iconName:"Search"})),h.createElement("div",{className:f.textContainer},(0,m.Z)()?(0,d.ZP)(a.W):(0,d.ZP)(s.c)));break;case y.TopNResults:return h.createElement("div",{className:f.container},h.createElement("div",{className:v(f.textContainer,f.centered)},e.numberOfResults?(0,d.WU)((0,d.ZP)(o.e),e.numberOfResults):(0,d.ZP)(r.z)));case y.UseAddress:if(e.useTypedAddressAction)return h.createElement("div",null,h.createElement("div",{className:v(f.hoverable,{isHighlighted:e.highlighted})},h.createElement("div",{className:v(f.textContainer,f.useAddressContainer),onClick:e.useTypedAddressAction},(0,d.WU)((0,d.ZP)(i.E),e.queryString))),h.createElement(S,{infoType:y.TopNResults,highlighted:!1,queryString:e.queryString,numberOfResults:e.numberOfResults}))}return h.createElement(h.Fragment,null)},b=S},215191:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var i=n(20408),r=n(166337),o=n(336829),s=n(102803),a=n(371134),l=n(462480),c=n(620638);const d=(0,a.aD)("addRecipientsToRecipientWell",((e,t,n=window)=>({newRecipients:e,recipientWell:t,targetWindow:n}))),u=d;(0,a.ed)(d,(e=>{const{recipientWell:t}=e;t.recipients.splice(t.recipients.length,0,...e.newRecipients),t.isDirty=!0})),(0,a._F)(d,(e=>{const{newRecipients:t,recipientWell:n}=e;t.forEach((async e=>{var t;if(!e.isPendingResolution)return;const a=(0,r.Z)(e.persona.EmailAddress);let d=n.userIdentity;d||(d=(0,i.fF)().userIdentity);const u=(0,c.Z)(n),p=await o.Zk.import().then((e=>e(d,a,u)));if(u&&null===p){const i=n,r=(null===(t=i.findPeopleFeedbackManager)||void 0===t?void 0:t.conversationId)||(0,l.u)();o.$8.import().then((t=>t(e.persona,r))),i.findPeopleFeedbackManager&&(i.findPeopleFeedbackManager.conversationId=(0,l.u)())}(0,s.Z)(e,p,a)}))}))},269917:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(136947);var r=n(462480),o=n(959869);const s=(0,i.aD)("processFindPeopleResult")((function(e,t,n,i,s,l){if("Success"!=t.ResponseClass||!t.ResultSet)throw new Error("Response resultSet should not be null");{i=i||20,i=n?i-e.length:i,i=t.ResultSet.length>i?i:t.ResultSet.length;const d=t.TransactionId,u=[];for(let e=0;e<i;e++){const n=t.ResultSet[e],i="client-"+(0,r.u)();n.EmailAddress?u.push({EmailAddress:(c=n.EmailAddress,c.RoutingType&&"EX"===c.RoutingType.toUpperCase()?Object.assign(Object.assign({},c),{EmailAddress:c.OriginalDisplayName}):c),PersonaId:n.PersonaId,ADObjectId:n.ADObjectId,PersonaTypeString:n.PersonaTypeString,DisplayName:n.DisplayName,TransactionId:d,LogicalId:s,ReferenceId:i}):"ImplicitGroup"==n.PersonaTypeString&&u.push({EmailAddress:a(n),PersonaId:n.PersonaId,ADObjectId:n.ADObjectId,Members:n.Members,PersonaTypeString:n.PersonaTypeString,DisplayName:n.DisplayName,TransactionId:d,LogicalId:s,ReferenceId:i})}n?e.push(...u):e.splice(0,e.length,...u),d&&l&&o.Z.setResults(d,e)}var c})),a=e=>({EmailAddress:e.FeedbackId,OriginalDisplayName:e.FeedbackId,Name:e.DisplayName,MailboxType:"GroupMailbox",RoutingType:"SMTP"})},642293:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(577598),r=n(462480),o=n(959869);function s(e,t,n,s,a,l,c){var d;if(!t||!t.Groups){const e=new Error("Response groups should not be null");throw e.networkError=!0,e}{const u=[];a=a||20,a=s?a-e.length:a;const p=null===(d=t.Instrumentation)||void 0===d?void 0:d.TraceId;for(const e of t.Groups)if("People"===e.Type){e.Suggestions.forEach((e=>{if(u.length<a){const t=(0,i.Z)(e,p,l,n);t&&(t.ReferenceId||(t.ReferenceId="temp-"+(0,r.u)()),u.push(t))}}));break}s?e.push(...u):e.splice(0,e.length,...u),p&&c&&o.Z.setResults(p,e)}}},812557:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).lr)("refreshRecipients",(e=>{e.recipientsChangedStamp=Date.now()}))},510481:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(371134);const r=(0,i.aD)("removeRecipientFromRecipientWell",((e,t,n,i)=>({recipientIndex:e,recipientWellRecipients:t,onRecipientDeletedCallback:n,deletedRecipient:t.recipients[e],newRecipients:i}))),o=r;(0,i.ed)(r,(e=>{e.recipientWellRecipients.isDirty=!0,e.recipientWellRecipients.recipients.splice(e.recipientIndex,1,...e.newRecipients||[])})),(0,i._F)(r,(e=>{e.onRecipientDeletedCallback([e.deletedRecipient],e.recipientIndex,e.recipientWellRecipients)}))},953510:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(371134),r=n(812557);const o=(0,i.aD)("reorderRecipientsInRecipientWell",((e,t,n,i,r)=>({recipientWell:e,insertIndex:t,newRecipients:n,indicesToRemove:i,targetWindow:r})));(0,i._F)(o,(e=>{const{recipientWell:t,insertIndex:n,newRecipients:i,indicesToRemove:o}=e;if(n>-1){const e=[...t.recipients],s=[];for(let t=0;t<e.length;t++){const r=e[t];t===n&&i.forEach((e=>{s.push(e)})),o.includes(t)||s.push(r)}n===e.length&&i.forEach((e=>{s.push(e)})),t.recipients.splice(0,e.length,...s),t.isDirty=!0,t.recipientEditorViewState&&(0,r.Z)(t.recipientEditorViewState)}}));const s=o},102803:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(166337),r=n(404596),o=n(323804),s=n(371134);const a=(0,s.aD)("resolvePendingPersonaOnRecipient",((e,t,n)=>({recipient:e,nextPersona:t,searchedString:n})));(0,s.ed)(a,(({recipient:e,nextPersona:t,searchedString:n})=>{(0,i.Z)(e.persona.EmailAddress)===n&&(e.isPendingResolution=!1,t&&(e.persona=t,e.isValid=!0,e.displayText=(0,r.Z)(t.EmailAddress),e.editKey=(0,o.h)()))}));const l=a},521480:(e,t,n)=>{"use strict";n.d(t,{Z:()=>g});var i=n(955597),r=n(101060),o=n(118336),s=n(669038),a=n(509636),l=n(444928),c=n(775390),d=n(448259),u=n(136947),p=n(462480);const m=(0,u.aD)("localCacheTransactionCompleted")((function(e,t,n,i,u,m,h=(0,a.zO)()){if(null==e?void 0:e.hasSessionStarted){const f={TransactionRequestTime:(0,l.dd)(h),TransactionRequestDuration:(0,a._Q)((0,a.zO)(),h),QueryString:(0,r.LP)(t)?"":t,QueryStringLength:(0,c.T)(t)?0:t.length,FeatureData:null!=i?i:void 0,personaTypeList:u,ImpressionId:(0,p.u)(),Cvid:e.conversationId,CacheCorrelationId:m},g=JSON.stringify(f),v=JSON.stringify(n),y=(0,s.Z)(e,"","LocalCacheTransactionCompleted",v,0,g);(0,o.Z)(e,y,!1),d.g4.info((0,r.WU)("{0} LocalCacheTransactionCompleted. Session id: {1}",e.entityScenarioName,e.clientSessionId))}}));var h=n(241505),f=n(55461);function g(e,t){var n,r;if(e.findResultSet&&e.findResultSet.length>0){const o=[];e.findResultSet.forEach((e=>{o.push(h.Z[e.PersonaTypeString])})),m(e.findPeopleFeedbackManager,e.queryString,(0,i.Z)(e.findResultSet),(0,f.cr)("rp-cacheFirstFeatureDataLogging")?e.findResultSet.map((e=>e.FeatureData?e.FeatureData:"")):null,o,null===(r=null===(n=e.peopleFeedbackState)||void 0===n?void 0:n.cache)||void 0===r?void 0:r.CorrelationId,t)}}},378e3:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var i=n(101060),r=n(118336),o=n(669038),s=n(509636),a=n(444928),l=n(775390),c=n(448259);const d=(0,n(136947).aD)("transactionCompleted")((function(e,t,n,d,u,p,m,h=null){if(null==e?void 0:e.hasSessionStarted){const f={TransactionRequestTime:(0,a.dd)(u),TransactionRequestDuration:(0,s._Q)((0,s.zO)(),u),QueryString:(0,i.LP)(t)?"":t,QueryStringLength:(0,l.T)(t)?0:t.length,PersonaTypeList:m,ImpressionId:d,Cvid:e.conversationId};h&&Object.keys(h).forEach((e=>{f[e]=h[e]})),p&&(f.Context=p);const g=JSON.stringify(f),v=JSON.stringify(n),y=(0,o.Z)(e,d,"TransactionCompleted",v,0,g);(0,r.Z)(e,y,!1),c.g4.info((0,i.WU)("{0} TransactionComplete. Session id: {1}",e.entityScenarioName,e.clientSessionId))}}));var u=n(955597),p=n(241505);function m(e,t,n,i){var r,o;const s=e.map((e=>p.Z[e.PersonaTypeString]));d(t.findPeopleFeedbackManager,t.queryString,(0,u.Z)(e),i,n,{Action:"Type Down"},s,{CacheCorrelationId:null===(o=null===(r=t.peopleFeedbackState)||void 0===r?void 0:r.cache)||void 0===o?void 0:o.CorrelationId})}},548838:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(267662);function r(e,t,n){(0,i.Z)(e.findPeopleFeedbackManager,e.queryString,n,t,{Action:"Type Down"})}},356465:(e,t,n)=>{"use strict";function i(e,t){return null!=e&&null!=t&&(e==t||e.EmailAddress&&t.EmailAddress&&null!=e.EmailAddress.EmailAddress&&null!=t.EmailAddress.EmailAddress&&e.EmailAddress.EmailAddress.toLowerCase()==t.EmailAddress.EmailAddress.toLowerCase()||e.ADObjectId&&t.ADObjectId&&e.ADObjectId==t.ADObjectId||e.PersonaId&&t.PersonaId&&e.PersonaId==t.PersonaId)}n.d(t,{Z:()=>i})},928563:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(20408),r=n(933635);function o(e,t,n,o){return{userIdentity:e||(0,i.fF)().userIdentity,queryString:t||"",findResultSet:[],findResultType:r.m.None,isSearching:!1,directorySearchType:r.r.None,findPeopleFeedbackManager:n,inForceResolve:o,currentRenderedQueryString:"",numberOfCacheResults:0}}},955597:(e,t,n)=>{"use strict";function i(e){const t=[];return e&&e.forEach(((e,n)=>{t[n]=e.Id||e.EmailAddress.EmailAddress||e.EmailAddress.Name})),t}n.d(t,{Z:()=>i})},286316:(e,t,n)=>{"use strict";function i(e){let t=[];return e&&(t=e.map((e=>e.persona))),t}n.d(t,{Z:()=>i})},716141:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=e=>e&&0!==e.length?e.filter((e=>!!e)).reduce(((e,t)=>{return[...e,...(n=t,(null==n?void 0:n.recipients)?n.recipients.slice():[])];var n}),[]):[]},78718:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(213029);function r(e){let t="";if(e)if((0,i.Z)()){const n=e;n.Groups&&n.Instrumentation&&(t=n.Instrumentation.TraceId)}else{const n=e;"Success"==n.ResponseClass&&n.ResultSet&&(t=n.TransactionId)}return t}},323804:(e,t,n)=>{"use strict";n.d(t,{v:()=>i,h:()=>o});const i="REK";let r=0;function o(){return i+("000000"+(r++).toString(16)).slice(-6)}},390895:(e,t,n)=>{"use strict";n.d(t,{Y:()=>c});var i=n(812557),r=n(166337),o=n(336829),s=n(102803),a=n(462480),l=n(620638);async function c(e,t){const n=t.recipientPickerPluginViewState,c=n.userIdentity;return Promise.all(e.map((async e=>{var d;if(e.isPendingResolution){const u=(0,r.Z)(e.persona.EmailAddress),p=(0,l.Z)(n),m=await o.Zk.import().then((e=>e(c,u,p)));if(p&&null===m){const t=(null===(d=n.findPeopleFeedbackManager)||void 0===d?void 0:d.conversationId)||(0,a.u)();o.$8.import().then((n=>n(e.persona,t))),n.findPeopleFeedbackManager&&(n.findPeopleFeedbackManager.conversationId=(0,a.u)())}if((0,s.Z)(e,m,u),m)return(0,i.Z)(t),!0}return!1})))}},690992:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(391825),r=n(774676);function o(e,t){if(e){const n=[];for(let o=0;o<e.length;o++){const s={email:e[o],showFullEmail:t||(0,i.m)(e[o].Name,e[o].EmailAddress,e[o].MailboxType)||(0,r.H)(e[o].Name)||null!=e[o].RoutingType&&"SMTP"!==e[o].RoutingType,isGroupOrDl:"PublicDL"==e[o].MailboxType||"GroupMailbox"==e[o].MailboxType};n.push(s)}return n}}},157767:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(933635),r=n(8130);function o(e,t,n){return Object.assign(Object.assign({},(0,r.Z)()),{userIdentity:e,queryString:"",wordBeforeCursor:"",findResultSet:[],isSearching:!1,directorySearchType:i.r.None,selectedRecipientIndex:-1,selectedHeaderIndex:-1,selectedFooterIndex:-1,findResultType:i.m.None,findPeopleFeedbackManager:t,currentRenderedQueryString:"",numberOfCacheResults:0,searchScenario:n})}let s=0;function a(e,t,n){return{editorId:(s++).toString(),recipientPickerPluginViewState:o(e,t,n),recipientsChangedStamp:0}}},635886:(e,t,n)=>{"use strict";n.d(t,{i:()=>a,D:()=>l});var i=n(88922),r=n(404596),o=n(717606),s=n(323804);const a={isContextMenuOpen:!1,isSelected:!1,isExpanding:!1,isEditing:!1,isFadedOut:!1,expansionStatus:i.X.None,members:[]};function l(e,t){return Object.assign(Object.assign({},a),{editKey:(0,s.h)(),isValid:(0,o.Z)(e),displayText:(0,r.Z)(e,t)})}},948330:(e,t,n)=>{"use strict";n.d(t,{f:()=>a});var i=n(55461),r=n(136743),o=n(959070),s=n(448259);function a(e){if((0,i.cr)("cmp-resolveRecipsFromCache")&&"SMTP"===e.RoutingType&&e.EmailAddress){const t=(0,o.Y)(e.EmailAddress);if(t&&(e=>{const t=void 0!==e.EmailAddress;return t||s.g4.warn("Recipient cache contained a persona that had no EmailAddress"),t})(t))return(0,r.C)(t)}return null}},624335:(e,t,n)=>{"use strict";n.d(t,{w:()=>o});var i=n(635886),r=n(948330);function o(e){const t=(0,r.f)(e);if(t)return t;const n=(0,i.D)(e);return Object.assign(Object.assign({},n),{isPendingResolution:!0,persona:{EmailAddress:e,PersonaId:e.ItemId}})}},136743:(e,t,n)=>{"use strict";n.d(t,{C:()=>r,Z:()=>o});var i=n(635886);function r(e){const t=(0,i.D)(e.EmailAddress,e.DisplayName);return Object.assign(Object.assign({},t),{isPendingResolution:!1,persona:e})}const o=r},762978:(e,t,n)=>{"use strict";n.d(t,{K:()=>c});var i=n(972406),r=n(466644),o=n(522787),s=n(635886),a=n(948330),l=n(323804);function c(e){const t=(0,i.Z)(e),n=(0,r.Z)(t.address,t.displayName);if(null===n)return Object.assign(Object.assign({},s.i),{editKey:(0,l.h)(),isValid:!1,isPendingResolution:!0,displayText:e,persona:{EmailAddress:(0,o.Z)(e),queryLength:e.length}});const c=(0,a.f)(n);if(c)return c;const d=(0,s.D)(n);return Object.assign(Object.assign({},d),{isPendingResolution:!0,persona:{EmailAddress:n,queryLength:e.length}})}},388352:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var i=n(919051),r=n(136947),o=n(41333),s=n(128358),a=n(472820),l=n(565355);const c=(0,r.aD)("resolveAllUnresolvedRecipientsInEdit")((function(e,t,n,r){(0,i.Z)(t,!0);let c=-1;for(let t=r||0;t<e.length;t++){if(!e[t].isValid){c=t;break}}-1!==c&&n?function(e,t){var n,i;const r=t.queryElements("#"+e.editKey),c=null===(i=null===(n=r[0])||void 0===n?void 0:n.querySelector((0,l.Kj)()))||void 0===i?void 0:i.firstChild;if(c){const e=new s.Position(c,-1),n=(0,s.createRange)(e);t.focus(),(0,a.T6)(t,n),(0,o.Z)(t,!0)}}(e[c],n):(0,i.Z)(t,!1)}))},537860:(e,t,n)=>{"use strict";n.d(t,{I:()=>dn,Z:()=>un});var i=n(989526),r=n(92894),o=n(715386),s=n(128358),a=n(345961),l=n(101060),c=n(384512);var d=n(647565);class u{getName(){return"EmptyPlugin"}initialize(e){}dispose(){}}class p extends u{getState(){return{allowedCustomPasteType:[""]}}}class m extends u{getState(){return{knownEntityElements:[],shadowEntityCache:{}}}}var h=n(565355),f=n(61745),g=n(249531),v=n(440752),y=n(817044),S=n(48856),b=n(332865),I=n(180964),w=n(472820),C=n(564070),E=n(444835),P=n(323804),T=n(722410),R=n(254712),x=n.n(R);const k=x().bind(T.Z);function N(e,t,n){const r=document.createElement("span");if(r.className=k(f.Rp),e.editKey)r.id=e.editKey;else{const t=(0,P.h)();e.editKey=t,r.id=t}const o=document.createElement("span");o.className=k(T.Z.pill,e.isValid?T.Z.validPill:T.Z.invalidPill,t?T.Z.darkMode:"");const s=e.persona.EmailAddress,a="PrivateDL"==s.MailboxType||"PublicDL"==s.MailboxType||"GroupMailbox"==s.MailboxType;if(a){const e=A(k(T.Z.iconContainer),f.ds);o.appendChild(e),S.sY(i.createElement(b.xu,{iconName:g.Z,className:T.Z.expandIconContainer}),e)}if(!e.isValid){const e=A(k(T.Z.iconContainer),f.JE);o.appendChild(e),S.sY(i.createElement(b.xu,{iconName:v.Z,className:T.Z.invalidIconContainer}),e)}if(n&&e.isValid&&!a){const t=A(k(T.Z.presenceContainer),f.O5);o.appendChild(t),S.sY((0,C.cf)((()=>i.createElement(E.e,{email:s,mri:e.persona.MRI,styleProps:T.Z.presenceIcon})))(),t)}const l=document.createElement("span");if(l.className=k(T.Z.textContainer,a?T.Z.groupText:T.Z.individualText),l.textContent=e.displayText,o.appendChild(l),!e.blockWellItemRemoval){const e=A(k(T.Z.iconContainer),f.gR);o.appendChild(e),S.sY(i.createElement(b.xu,{iconName:y.Z,className:T.Z.removeIconContainer}),e)}if(e.isValid){const t=A((0,h.wz)().slice(1)),n=i.createElement(D,{recipient:e});S.sY(n,t),o.appendChild(t)}return r.appendChild(o),(0,w.q3)({type:f.xq,wrapper:r,isReadonly:e.isValid,textSelector:(0,h.Kj)()})}function A(e,t){const n=document.createElement("span");return n.className=e,n.contentEditable="false",t&&(n.id=t),n}function D({recipient:e}){const t=(0,I.p)({olsPersonaId:e.persona.Id,emailAddress:e.persona.EmailAddress.EmailAddress,name:e.displayText,mailBoxType:e.persona.EmailAddress.MailboxType,disableAccessibilityDefaults:!0,disableHover:!0,clientScenario:"RecipientEntity"});return i.createElement(t,null,i.createElement("span",{className:(0,h.MQ)().slice(1)}))}function Z(e){const t=(0,w._O)(e);return(null==t?void 0:t.type)===f.xq}var M=n(448259);function O(e,t,n,i,r,o){let a=(0,w.JE)(e,e.getFocusedPosition());const l=null===a||!n.hasChildNodes()||(0,w.zI)(a,n),c=[];c.length=t.length;for(let e=0;e<c.length;e++)c[e]={recipientNode:void 0,sentinelNode:void 0};let d;const u={};u.length=t.length,t.forEach(((e,t)=>{u[e.editKey]=t}));let p=L(n,n.firstChild,a);const m=p.sentinel;let f;a=p.cursorPos;const g=[];let v,y=n.firstChild;for(;y;){let t=y.nextSibling;const i=(0,h.Ct)(y);if(i&&null!=u[i])p=L(n,t,a),f=p.sentinel,t=p.nextNode,a=p.cursorPos,c[u[i]]={recipientNode:y,sentinelNode:f};else if((0,w._O)(y))(0,w.kI)(y),n.removeChild(y);else{const n=(0,w.Oy)(e,new s.Position(y,0));let i;if(n.text){const t=new s.Position(y,0);i=_(y),g.push({text:n.text,node:i||document.createTextNode(""),refNodeBefore:(0,w.WJ)(e,Z,t,-2),refNodeAfter:(0,w.WJ)(e,Z,t,-3)})}a=F(e,n,f||m,i,a),t=(0,w.NY)(e,n.textEndPos);(0,s.createRange)(n.textStartPos,n.textEndPos).deleteContents()}y=t}if(t.length>0&&n.insertBefore(m,n.firstChild),c.length>0)for(let i=c.length-1;i>=0;i--){const{recipientNode:r,sentinelNode:s}=c[i],a=c[i+1]&&c[i+1].recipientNode;let l;if(r&&s)l=document.createDocumentFragment(),l.appendChild(r),l.appendChild(s);else if(r||s)!r||s&&e.contains(s)||n.insertBefore(null!=s?s:(0,w.Dr)(),r.nextSibling);else{l=document.createDocumentFragment();const n=N(t[i],e.isDarkMode(),o),r=(0,w.Dr)();c[i]={recipientNode:n,sentinelNode:r},d||(d=n),l.appendChild(n),l.appendChild(r)}l&&(a&&e.contains(a)?n.insertBefore(l,a):n.appendChild(l))}g.forEach((t=>{const{node:i,refNodeAfter:r,refNodeBefore:o}=t;if(t.node.textContent=t.text,r){let t;t=e.contains(r)?r:o&&e.contains(o)&&o.nextSibling?o.nextSibling.nextSibling:n.firstChild,n.insertBefore(i,t)}else n.appendChild(i)}));try{const t=null==d?void 0:d.nextSibling;if(r&&a){const n=(0,w.Re)(e,a);n&&!n.isReadonly?v=(0,s.createRange)(a):t&&(v=(0,s.createRange)(new s.Position(t,-1)))}else t&&!i?v=(0,s.createRange)(new s.Position(t,-1)):l?v=(0,s.createRange)(new s.Position(n,n.childNodes.length)):a&&(v=(0,s.createRange)(a))}catch(e){M.rx(`Could not create range on position ${a}\nError: ${e}`),v=(0,s.createRange)(new s.Position(n,n.childNodes.length))}finally{v&&e.hasFocus()&&(0,w.T6)(e,v,i),n.normalize()}}function F(e,t,n,i,r){var o,a;const l=(0,w.NY)(e,t.textStartPos),c=(0,w.NY)(e,t.textEndPos);let d=l,u=0;const p=_(null==r?void 0:r.node),m=!!(null===(o=t.text)||void 0===o?void 0:o.length);for(;d&&d!==c;){if(_(d)===p){if(m&&i){const e=(0,w.Jq)(null==r?void 0:r.element)&&(null==r?void 0:r.isAtEnd)&&1===(null==r?void 0:r.offset)?0:(null==r?void 0:r.offset)||0;return new s.Position(i,u+e)}return new s.Position(n,-1)}u+=(null===(a=(0,w.vJ)(d.textContent))||void 0===a?void 0:a.length)||0,d=d.nextSibling}return r}function _(e){let t;return e&&((0,w.BM)(e)?t=e:e.nextSibling&&(0,w.BM)(e.nextSibling)?t=e.nextSibling:e.firstChild&&(0,w.BM)(e.firstChild)&&(t=e.firstChild)),t}function L(e,t,n){var i;let r;if(t&&(0,w.Jq)(t))if(r=t,(0,w.qw)(r.textContent))t=r.nextSibling;else if(r.firstChild&&(null===(i=r.firstChild.textContent)||void 0===i?void 0:i.length)){const i=r.firstChild.textContent.charAt(0)==w.Yg,o=r.firstChild.splitText(i?1:0);i||(r.textContent=w.Yg),e.insertBefore(o,r.nextSibling),t=r.nextSibling,(null==n?void 0:n.element)==r&&(n=new s.Position(o,i?n.offset-1:n.offset))}else r.textContent=w.Yg;else r=(0,w.Dr)();return{sentinel:r,nextNode:t,cursorPos:n}}var z=n(764403),B=n.n(z);class V{constructor(){this.lastSelectedNodes=[]}static getInstance(){return V.instance||(V.instance=new V),V.instance}onSelectionChange(){const e=this.getSelection();if(e){V.instance.clearSelectionStyling();const t=e.rangeCount>0?e.getRangeAt(0):null;if(t){const n=t.commonAncestorContainer.nodeType===Node.TEXT_NODE?t.commonAncestorContainer.parentElement:t.commonAncestorContainer,i=null==n?void 0:n.closest("."+W(q.recipientEditor));i&&(function(e,t){let n=new s.Position(e.focusNode,e.focusOffset),i=new s.Position(e.anchorNode,e.anchorOffset);const r=U(t,n),o=U(t,i),a=r>-1,l=o>-1;if(a||l)return(0,w.Po)(n,i)?(a&&(n=new s.Position(t,r+1)),l&&(i=new s.Position(t,o))):(a&&(n=new s.Position(t,r)),l&&(i=new s.Position(t,o+1))),e.setBaseAndExtent(i.node,i.offset,n.node,n.offset),!0;return!1}(e,i)||V.instance.setSelectionStyling(i,t))}}}clearSelectionStyling(){V.instance.lastSelectedNodes.length&&(V.instance.lastSelectedNodes.forEach((e=>{!function(e){const t=(0,w._O)(e),n=null==t?void 0:t.wrapper.querySelector((0,h.nW)());t&&n&&n.classList.remove(B()(t.isReadonly?T.Z.selectedValidPill:T.Z.selectedInvalidPill))}(e)})),V.instance.lastSelectedNodes=[])}setSelectionStyling(e,t){(0,w.YE)(e,t,((e,t)=>(function(e,t){const n=(0,w._O)(e),i=null==n?void 0:n.wrapper.querySelector((0,h.nW)());n&&i&&(n.isReadonly?i.classList.add(B()(T.Z.selectedValidPill)):t&&(0,w.vJ)(e.textContent)!==(0,w.vJ)((0,s.createRange)(t.positionStart,t.positionEnd).toString())||i.classList.add(B()(T.Z.selectedInvalidPill)))}(e,t),V.instance.lastSelectedNodes.push(e),!1)))}}function U(e,t){const n=(0,w.Wv)(e,t),i=(0,w._O)(n);return(null==i?void 0:i.isReadonly)&&t.node!==e?(0,w.E)(i.wrapper):-1}const q={recipientEditor:"VOlRn"},W=x().bind(q);const H=(0,r.Pi)(i.forwardRef(((e,t)=>{const n=i.useRef(),r=i.useRef(null),{recipients:g,recipientEditorViewState:v,inForceResolve:y,plugins:S,onFocus:b,onBlur:I,ariaLabel:C,scrollContainerSelector:E,isDarkMode:P,focusOnInit:R,externalEdit:x,resetExternalEdit:k,showPresence:N,placeholder:A}=e;function D(e,t,n){return{winKey:e,macKey:t,action:n}}i.useImperativeHandle(t,(()=>({focus:()=>{var e;n&&(null===(e=n.current)||void 0===e||e.focus())}})),[]);const Z={allowFunctionKeys:!0,keys:[66,73,85,89,90,188,190,191],shouldHandleEvent:M,handleEvent:(e,t)=>{const n=M(e);n&&(n.action(t),e.rawEvent.preventDefault(),e.rawEvent.stopPropagation())}};function M(e){return(0,s.cacheGetEventData)(e,"DEFAULT_SHORT_COMMAND",(()=>{const t=e.rawEvent,n=0!=e.eventType||t.altKey?0:t.which|(t.metaKey?8192:0)|(t.shiftKey?16384:0)|(t.ctrlKey?4096:0);return n&&_.filter((e=>(s.Browser.isMac?e.macKey:e.winKey)==n))[0]}))}function F(){}const _=[D(4162,8258,F),D(4169,8265,F),D(4181,8277,F),D(4186,8282,(e=>e.undo())),D(4185,24666,(e=>e.redo())),D(4286,8382,F),D(4287,8383,F),D(20670,24766,F),D(20668,24764,F)];i.useEffect((()=>{const e=null==r?void 0:r.current,t=()=>{n.current&&((0,d.s7)(v.editorId),n.current.dispose(),n.current=void 0)};if(!e)return t;(0,w.Xs)([f.oj,f.q3,f.Qs]),n.current=new o.M(e,L()),(0,d.ER)(v.editorId,n.current),n.current.addContentEditFeature(Z);const i=(0,a.getAllFeatures)(),s=["noCycleCursorMove"];for(const e of s)n.current.addContentEditFeature(i[e]);return R&&n.current.focus(),()=>{O(n.current,[],e,!1),t()}}),[v.editorId]);const L=()=>{const e=[...S||[],new c.xV];if(void 0===v)return;return{plugins:e,undoSnapshotService:{canMove:e=>!1,move:e=>"",addSnapshot:(e,t)=>{},clearRedo:()=>{},canUndoAutoComplete:()=>!1},inDarkMode:P,allowKeyboardEventPropagation:!0,scrollContainer:null===(null==r?void 0:r.current)||void 0===E?void 0:(0,s.findClosestElementAncestor)(r.current,r.current.ownerDocument.body,E),doNotAdjustEditorColor:!0,corePluginOverride:{typeInContainer:new u,copyPaste:new p,entity:new m,normalizeTable:new u},coreApiOverride:{ensureTypeInContainer:()=>{},addUndoSnapshot:()=>{},restoreUndoSnapshot:()=>{}}}};i.useEffect((()=>(n.current&&(n.current.getDocument().removeEventListener("selectionchange",V.getInstance().onSelectionChange),n.current.getDocument().addEventListener("selectionchange",V.getInstance().onSelectionChange)),()=>{n.current&&n.current.getDocument().removeEventListener("selectionchange",V.getInstance().onSelectionChange)})),[]),i.useEffect((()=>{n.current&&(n.current.setDarkModeState(P),function(e){(0,w.Zt)(e).childNodes.forEach((t=>{const n=(0,w._O)(t);if(n){const t=null==n?void 0:n.wrapper.querySelector((0,h.nW)());e.isDarkMode()?null==t||t.classList.add(B()(T.Z.darkMode)):null==t||t.classList.remove(B()(T.Z.darkMode))}}))}(n.current))}),[P]);return i.useEffect((()=>{(null==r?void 0:r.current)&&n.current&&(O(n.current,g,r.current,x,y,N),null==k||k())}),[v.recipientsChangedStamp,g,g.length]),i.createElement(i.Fragment,null,i.createElement("div",{ref:r,dir:(0,l.fI)()?"rtl":"ltr",onBlur:e=>{null==I||I(e)},onFocus:e=>{null==b||b(e)},role:"textbox","aria-multiline":"true","aria-label":C,tabIndex:0,className:W(e.classNames,q.recipientEditor),spellCheck:!1,"data-placeholder":A}),null==S?void 0:S.map((e=>function(e){return e&&!!e.getUIComponentClass}(e)?i.createElement(e.getUIComponentClass(),{viewState:e.adapter(),plugin:e}):null)))})));var j=n(843784),G=n(762978),K=n(487616),X=n(355689);function $(e,t,n,i,r){if((0,w.S4)(n))return J(e,t,n,i,r);if((0,w.eb)(n)||null===n){const o=(0,w.Zt)(e);return J(e,new s.Position(t||o,0),new s.Position(n||o,-1),i,r)}if(t){const r=t;return J(e,new s.Position(r.startContainer,r.startOffset),new s.Position(r.endContainer,r.endOffset),n,i)}return!1}function J(e,t,n,i,r){let o;t=Q(t),n=Q(n);try{o=(0,s.createRange)(t,n)}catch(e){return!1}if(!o||o.collapsed)return!1;const a=(0,w.Re)(e,t),l=(0,w.Re)(e,n);let c=[];let d=(0,w.Q$)(e,t);const u=d,p=o.toString(),m=(0,w.qw)(p);if(p.length&&!m){const e=o.extractContents();if(e.childNodes.forEach((e=>{(0,w._O)(e)&&c.push(d++)})),a&&!a.isReadonly){const n=Y(a,e.firstChild,c,i,t,!0);c=n.removeRecipients,t=n.position}if(l&&!l.isReadonly){const t=Y(l,e.lastChild,c,i,n,!1);c=t.removeRecipients,n=t.position}}r&&!r.dontUpdateCursor&&((null==r?void 0:r.collapseToStart)?o=(0,s.createRange)(t):m&&(o=(0,s.createRange)(n)),(0,w.T6)(e,o)),t.node===n.node&&a&&!a.isReadonly&&i.updateRecipientIndexInWell(u,(0,w.vJ)(a.wrapper.textContent));let h=t,f=a;if(f||(h=n,f=l),f&&!(0,w.vJ)(f.wrapper.textContent)){const t=(0,w.Q$)(e,h);c.includes(t)||c.push(t),e.deleteNode(f.wrapper)}return c.length>0?i.removeRecipientIndicesFromWell(c):(0,w.Bx)(e,h),!0}function Q(e){var t;return(0,w.Jq)(e.element)&&(0,w.qw)(e.element.textContent)&&0!==e.offset&&(0,w.BM)(e.node)&&(null===(t=e.element.nextSibling)||void 0===t?void 0:t.textContent)&&(0,w.BM)(e.element.nextSibling)?new s.Position(e.element.nextSibling,e.offset-1):e}function Y(e,t,n,i,r,o){var a;if((0,h.Ct)(e)===(0,h.Ct)(t)){const l=null===(a=e.wrapper.querySelector(e.textSelector))||void 0===a?void 0:a.firstChild;if(l){r=new s.Position(l,r.offset);const a=(0,w.vJ)(e.wrapper.textContent),c=(0,w.vJ)(null==t?void 0:t.textContent);if((null==a?void 0:a.length)&&a!==c){const r=o?n.shift():n.pop();void 0!==r&&c&&i.updateRecipientIndexInWell(r,a),function(e,t){var n,i;const r=null==t?void 0:t.querySelector((0,h.Kj)());if(r){const o=null==e?void 0:e.querySelector((0,h.K_)()),s=null==e?void 0:e.querySelector((0,h.M4)()),a=null==t?void 0:t.querySelector((0,h.K_)()),l=null==t?void 0:t.querySelector((0,h.M4)());o&&!a&&(null===(n=r.parentNode)||void 0===n||n.insertBefore(o.cloneNode(!0),r)),s&&!l&&(null===(i=r.parentNode)||void 0===i||i.appendChild(s.cloneNode(!0)))}}(t,e.wrapper)}}}return{removeRecipients:n,position:r}}var ee=n(874191);function te(e,t,n,i,r){var o,a,l;const c=e.getSelectionRange();c&&!c.collapsed&&$(e,c,r),n.forEach((e=>{e.editKey=(0,P.h)()}));let d=e.getFocusedPosition();const u=(0,w.Zt)(e);d||(d=new s.Position(u,u.childNodes.length));const p=(0,w.Q$)(e,d);let m,h,g=document.createTextNode(t);const v=(0,w.NY)(e,d),y=(0,w._O)(v);if(y)if(y.isReadonly&&v)m=new s.Position(v,-2),h=new s.Position(v,0),d=h,u.insertBefore(g,v),ne(null==v?void 0:v.previousSibling,n,!0);else{const e=d.node.nodeType===Node.TEXT_NODE?d.node:null;if(e)e.textContent=(null===(o=e.textContent)||void 0===o?void 0:o.slice(0,d.offset))+t+(null===(a=e.textContent)||void 0===a?void 0:a.slice(d.offset)),d=new s.Position(e,d.offset+t.length);else{const e=y.wrapper.querySelector(y.textSelector),n=new s.Position(e,0);(0,w.Po)(d,n)?(e.insertAdjacentText("beforeend",t),d=new s.Position(e,-1)):(e.insertAdjacentText("afterbegin",t),d=new s.Position(e.firstChild,d.offset+t.length))}n.length=0}else{if(n.length&&(g=function(){const e=document.createElement("span");return(0,w.Yz)(e,f.xq,!0),e}()),v){const t=function(e,t,n){var i,r,o,a,l;const c=t.node.nodeType===Node.TEXT_NODE?t.node:null;if(!c)return t;const d=c.splitText(t.offset);if(n&&t.node.parentNode!==(0,w.Zt)(e)){const e=null===(i=t.node.parentNode)||void 0===i?void 0:i.nextSibling;e?null===(o=null===(r=t.node.parentNode)||void 0===r?void 0:r.parentNode)||void 0===o||o.insertBefore(d,e):null===(l=null===(a=t.node.parentNode)||void 0===a?void 0:a.parentNode)||void 0===l||l.appendChild(d)}return new s.Position(d,0)}(e,d,!0);m=t;const i=(0,w.NY)(e,t);h=function(e,t,n){const i=function(e){var t;if(e.nodeType===Node.TEXT_NODE){const n=document.createElement("span");return null===(t=e.parentNode)||void 0===t||t.replaceChild(n,e),n.appendChild(e),n}return}(e);if(i){const e=t(i,n);return function(e){var t,n;const i=e.firstChild;i&&i.nodeType===Node.TEXT_NODE&&i.textContent?null===(t=e.parentNode)||void 0===t||t.replaceChild(i,e):null===(n=e.parentNode)||void 0===n||n.removeChild(e)}(i),e}return t(e)}(i,((e,t)=>(u.insertBefore(g,e),new s.Position(e,null!=t?t:0)))),ne(null==i?void 0:i.previousSibling,n,!0)}else u.appendChild(g),h=new s.Position(null!==(l=u.lastChild)&&void 0!==l?l:u,-1),m=new s.Position(u,0),ne(u.lastChild,n,!1);d=null!=h?h:d}m&&((0,w.Bx)(e,m),h&&!h.equalTo(m)&&(0,w.Bx)(e,h)),(0,w.T6)(e,(0,s.createRange)(d)),u.normalize(),n.length>0&&r.addRecipientsToWell(n,p,i)}function ne(e,t,n){let i=0,r=e;for(;r&&i<t.length;){const e=(0,w._O)(r);e&&(re(e),ie(e,t[i]),i++),r=n?null==r?void 0:r.previousSibling:null==r?void 0:r.nextSibling}}function ie(e,t){if(e.isReadonly&&e.type===f.xq){const n=e.wrapper.querySelector((0,h.wz)()),r=e.wrapper.querySelector(e.textSelector);if((0,w.vJ)(null==r?void 0:r.textContent)===t.displayText){const e=i.createElement(D,{recipient:t});S.sY(e,n)}}}function re(e){(0,w.kA)(e.wrapper)}var oe=n(631401);function se(e,t,n){if(!t||t.collapsed)return;const i=t.cloneContents();if(!i)return;const r=[];let o="";const a=new s.Position(t.startContainer,t.startOffset);let l=(0,w.Q$)(e,a);return i.childNodes.forEach(((e,t)=>{var s;const a=(0,w._O)(e);if(a){let c=l>=0&&l<n.length?n[l++]:void 0;if(!c||!a.isReadonly&&(e===i.firstChild||e===i.lastChild)){const t=(0,w.vJ)(e.textContent)||"";c=t?(0,G.K)(t):void 0,c&&(c.editKey=null!==(s=(0,h.Ct)(a))&&void 0!==s?s:(0,P.h)())}t>=1&&t!=i.childNodes.length&&(o+=", "),c&&(r.push(c),o+=(0,oe.Z)([c]))}else{const n=(0,w.vJ)(e.textContent);if(n){(0,X.Z)(n).forEach((e=>{r.push(e)})),t>=1&&t!=i.childNodes.length&&(o+=", "),o+=n}}})),{copyText:o,recipients:r}}class ae{constructor(e,t){this.recipients=e,this.modifyWell=t}setRecipients(e){this.recipients=e}addRecipientsToWell(e,t,n,i){var r,o,s,a;if(this.modifyWell.handleAsAddRemoveUpdate)null===(o=(r=this.modifyWell).addItemsToWell)||void 0===o||o.call(r,e,t,n,i);else{const r=this.calculateNewRecipients(this.recipients,e,t,i);null===(a=(s=this.modifyWell).changedWellItems)||void 0===a||a.call(s,r,e,n)}}removeRecipientsFromWell(e){var t,n,i,r,o,s;const a=e.filter((e=>e&&!e.blockWellItemRemoval));if(a.length)if(this.modifyWell.handleAsAddRemoveUpdate)null===(n=(t=this.modifyWell).removeItemsFromWell)||void 0===n||n.call(t,a);else{const e=this.recipients.filter((e=>-1===a.indexOf(e)));null===(r=(i=this.modifyWell).changedWellItems)||void 0===r||r.call(i,e,void 0,void 0,a)}a.length!=e.length&&(null===(s=(o=this.modifyWell).syncItems)||void 0===s||s.call(o))}removeRecipientIndicesFromWell(e){const t=e.map((e=>this.recipients[e])).filter((e=>null!=e));this.removeRecipientsFromWell(t)}updateRecipientInWell(e,t){var n,i,r,o;if(this.modifyWell.handleAsAddRemoveUpdate)null===(i=(n=this.modifyWell).updateWellItem)||void 0===i||i.call(n,e,t);else{const n=this.recipients.findIndex((t=>{t.editKey,e.editKey})),i=(0,G.K)(t);this.recipients[n]=i,null===(o=(r=this.modifyWell).changedWellItems)||void 0===o||o.call(r,this.recipients)}}updateRecipientIndexInWell(e,t){this.updateRecipientInWell(this.recipients[e],t)}calculateNewRecipients(e,t,n,i){const r=[];for(let o=0;o<e.length;o++){const s=e[o];o===n&&t.forEach((e=>{r.push(e)})),(null==i?void 0:i.includes(o))||r.push(s)}return n===e.length&&t.forEach((e=>{r.push(e)})),r}}class le{constructor(e,t){this.setRecipients=e=>{var t;this.recipients=e,null===(t=this.modifyRecipients)||void 0===t||t.setRecipients(e)},this.setModifyWell=e=>{this.modifyRecipients=new ae(this.recipients,e)},this.recipients=e,this.modifyRecipients=new ae(e,t)}getName(){return"RecipientPlugin"}initialize(e){}dispose(){this.recipients=[],this.modifyRecipients=void 0}}class ce extends le{constructor(e,t,n,i){super(e,t),this.onEditorModified=i,this.setClipboardData=e=>{var t,n;if(!this.editor)return;const i=this.editor.getSelectionRange(),r=se(this.editor,i,this.recipients);return r?(null===(t=e.clipboardData)||void 0===t||t.setData(f._t,r.copyText),r.recipients.length>0&&(null===(n=e.clipboardData)||void 0===n||n.setData(f.C0,JSON.stringify(r.recipients))),{selectionRange:i,recipientsToCopy:r.recipients}):void 0},this.handleCut=e=>{const t=this.setClipboardData(e);t&&(e.preventDefault(),$(this.editor,t.selectionRange,this.modifyRecipients),(0,ee.y8)("RecipientEdit_Cut",[t.recipientsToCopy.length]))},this.handleCopy=e=>{const t=this.setClipboardData(e);t&&(e.preventDefault(),(0,ee.y8)("RecipientEdit_Copy",[t.recipientsToCopy.length]))},this.handlePaste=async e=>{var t,n;null===(t=this.onEditorModified)||void 0===t||t.call(this);const{clipboardData:i}=e;if(this.editor&&i&&(e.preventDefault(),i.types.length))if(i.types.includes(f.C0)){const e=i.getData(f._t),t=i.getData(f.C0),n=JSON.parse(t);te(this.editor,e,n,5,this.modifyRecipients),(0,ee.y8)("RecipientEdit_Paste_CustomType")}else{const e=i.getData(f._t);if(e){const t=(0,w.Re)(this.editor,this.editor.getFocusedPosition());if(t&&!t.isReadonly)this.pasteText(e);else{const t=(0,X.Z)(e);t.length>1||(null===(n=t[0])||void 0===n?void 0:n.isValid)?this.pasteParsedItems(t):this.pasteText(e)}}}},this.pasteText=e=>{te(this.editor,e,[],5,this.modifyRecipients),(0,ee.y8)("RecipientEdit_Paste_Text")},this.pasteParsedItems=e=>{te(this.editor,"",e,5,this.modifyRecipients),(0,ee.y8)("RecipientEdit_Paste_FromText")},this.disposer=null,this.adapter=n}initialize(e){this.editor=e;const t={cut:this.handleCut,copy:this.handleCopy,paste:this.handlePaste};this.disposer=this.editor.addDomEventHandler(t)}dispose(){super.dispose(),this.disposer&&(this.disposer(),this.disposer=null),this.editor=void 0}getName(){return"CopyPastePlugin"}onPluginEvent(e){}}class de extends le{initialize(e){this.editor=e}dispose(){super.dispose(),this.editor=void 0}getName(){return"CreateRecipientPlugin"}onPluginEvent(e){if(3===e.eventType)null!==e.rawEvent.data&&f.VD.includes(e.rawEvent.data)&&this.createRecipient()}createRecipient(){var e;if(void 0===this.editor)return;const t=this.editor.getSelectionRange();if(!t)return;const n=new s.Position(t.endContainer,t.endOffset);if((0,w.Re)(this.editor,n))return;const i=(0,w.Q$)(this.editor,n),r=(0,w.Oy)(this.editor,n,-2);let o=r.text;if(o&&(o=o.slice(0,o.length-1),$(this.editor,r.textStartPos,r.textEndPos,this.modifyRecipients),""!==o)){const t=(0,G.K)(o);null===(e=this.modifyRecipients)||void 0===e||e.addRecipientsToWell([t],i,4)}}}const ue="dragEvent",pe="mouseEvent",me=(e,t,n,i)=>{if(null==e?void 0:e.target){let r;return r=n===ue?new DragEvent(t):new MouseEvent(t),i&&e.target.addEventListener(t,i),e.target.dispatchEvent(r),r.defaultPrevented}return!1};class he extends le{constructor(e,t,n){super(e,t),this.onEditorModified=n,this.onDragStart=e=>{const{dataTransfer:t}=e,n=this.editor.getSelectionRange();if(!n)return;this.rangeStart=(0,w.JE)(this.editor,new s.Position(n.startContainer,n.startOffset)),this.rangeEnd=(0,w.JE)(this.editor,new s.Position(n.endContainer,n.endOffset));const i=se(this.editor,n,this.recipients);i&&t&&(t.clearData(),t.setData(f._t,i.copyText),this.draggedRecipients=i.recipients,i.recipients.length>0&&t.setData(f.C0,JSON.stringify(i.recipients)),t.effectAllowed="copyMove",this.dropCancelled=!1,(0,ee.y8)("RecipientEdit_DragDrop_Drag"))},this.onDragOver=e=>{e.preventDefault()},this.onDrop=e=>{var t,n,i;const{dataTransfer:r,target:o}=e;if(this.editor&&r){if(e.preventDefault(),this.editor.contains(o)){const t=(0,w.jF)(this.editor,e.clientX,e.clientY);if(t&&((0,w.T6)(this.editor,(0,s.createRange)(t,0)),this.rangeStart&&this.rangeEnd)){if((0,s.createRange)(this.rangeStart,this.rangeEnd).intersectsNode(t))return void(this.dropCancelled=!0)}}else{const e=(0,w.Zt)(this.editor);(0,w.T6)(this.editor,(0,s.createRange)(e,e.childNodes.length))}if(r.types.includes(f.C0)){const e=r.getData(f._t),t=r.getData(f.C0),n=JSON.parse(t);te(this.editor,e,n,void 0,this.modifyRecipients),(0,ee.y8)("RecipientEdit_DragDrop_Drop_Recipients")}else{const e=r.getData(f._t),n=(0,X.Z)(e);n.length>1||(null===(t=n[0])||void 0===t?void 0:t.isValid)?this.dropParsedItems(n):this.dropText(e)}"copy"!==(null===(n=e.dataTransfer)||void 0===n?void 0:n.dropEffect)&&this.removeDraggedElements(),this.dragCompleted(),null===(i=this.onEditorModified)||void 0===i||i.call(this)}},this.dropText=e=>{te(this.editor,e,[],void 0,this.modifyRecipients),(0,ee.y8)("RecipientEdit_DragDrop_Drop_Text")},this.dropParsedItems=e=>{te(this.editor,"",e,void 0,this.modifyRecipients),(0,ee.y8)("RecipientEdit_DragDrop_Drop_FromText")},this.onDragEnd=e=>{var t;"move"===(null===(t=e.dataTransfer)||void 0===t?void 0:t.dropEffect)&&this.removeDraggedElements(),this.dragCompleted()},this.removeDraggedElements=()=>{var e;if(!this.dropCancelled){let t=!1;if(this.rangeStart&&this.rangeEnd&&(t=$(this.editor,this.rangeStart,this.rangeEnd,this.modifyRecipients,{dontUpdateCursor:!0})),!t&&this.draggedRecipients.length){const t=0;this.fixupDraggedInvalidRecipients(this.draggedRecipients[t],t);const n=this.draggedRecipients.length-1;this.fixupDraggedInvalidRecipients(this.draggedRecipients[n],n),null===(e=this.modifyRecipients)||void 0===e||e.removeRecipientsFromWell(this.draggedRecipients)}}},this.dragCompleted=()=>{this.rangeStart=null,this.rangeEnd=null,this.draggedRecipients=[]},this.fixupDraggedInvalidRecipients=(e,t)=>{var n,i;if(!e.isValid){const r=(0,w.Zt)(this.editor).querySelector("#"+e.editKey);r&&(null===(n=this.modifyRecipients)||void 0===n||n.updateRecipientInWell(e,(0,w.vJ)(null===(i=r.querySelector((0,h.Kj)()))||void 0===i?void 0:i.textContent)||""),this.draggedRecipients.splice(t,1))}},this.onTouchMove=e=>{me(e,"dragstart",ue,this.onDragStart),me(e,"dragover",ue,this.onDragOver)},this.onTouchEnd=e=>{me(e,ue,"dragend",this.onDragEnd)&&e.preventDefault()},this.disposer=null,this.rangeStart=null,this.rangeEnd=null,this.draggedRecipients=[],this.dropCancelled=!1}initialize(e){this.editor=e;const t={dragstart:this.onDragStart,dragover:this.onDragOver,drop:this.onDrop,dragend:this.onDragEnd,touchmove:this.onTouchMove,touchend:this.onTouchEnd};this.disposer=this.editor.addDomEventHandler(t)}dispose(){super.dispose(),this.disposer&&(this.disposer(),this.disposer=null),this.editor=void 0}getName(){return"DragDropPlugin"}}var fe=n(546120);function ge(e,t){if(!t)return(0,ee.y8)("RecipientEdit_InvalidID"),-1;let n=-1;for(let i=0;e&&i<e.length;i++)if(e[i].editKey===t){n=i;break}return-1===n&&(0,ee.y8)("RecipientEdit_RecipientNotFoundInArray"),n}var ve=n(41333),ye=n(213029),Se=n(678356),be=n(816958);function Ie(e,t){const n=e.wrapper.querySelector((0,h.MQ)());n&&(n.click(),function(e){(0,ye.Z)()&&void 0!==(null==e?void 0:e.persona.ReferenceId)&&Se.dm.importAndExecute(be.C.MailCompose,"","",(null==e?void 0:e.persona.LogicalId)||"",(null==e?void 0:e.persona.TransactionId)||"",(null==e?void 0:e.persona.ReferenceId)||"","EntityActionTaken",new Map([["entityactiontakentype","OpenContactCard"]]))}(t))}class we extends le{constructor(e,t){super(e,t),this.onTouchStart=e=>{me(e,"mousedown",pe)&&e.preventDefault()},this.onTouchEnd=e=>{me(e,"mouseup",pe)&&e.preventDefault()},this.onClick=e=>{var t;if(!this.editor||!e.isTrusted)return;const n=e.target,i=(0,w.Re)(this.editor,new s.Position(n,0));if(i)if(n.id===f.gR)$(this.editor,(0,s.createRange)(i.wrapper),this.modifyRecipients);else if(i.isReadonly)if(n.id===f.ds)this.expandRecipient(i.wrapper.firstElementChild);else{Ie(i,this.recipients[ge(this.recipients,(0,h.Ct)(i))])}!(null==i?void 0:i.isReadonly)&&(null===(t=this.editor.getSelectionRange())||void 0===t?void 0:t.collapsed)&&(0,ve.Z)(this.editor)},this.disposer=null}initialize(e){var t;this.editor=e,this.targetWindow=(null===(t=null==e?void 0:e.getDocument())||void 0===t?void 0:t.defaultView)||window;const n={click:this.onClick,touchstart:this.onTouchStart,touchend:this.onTouchEnd};this.disposer=this.editor.addDomEventHandler(n)}dispose(){super.dispose(),this.disposer&&(this.disposer(),this.disposer=null),this.editor=void 0}getName(){return"RecipientClickPlugin"}onPluginEvent(e){}expandRecipient(e){if(void 0===this.editor)return;let t=ge(this.recipients,e.id);const n=this.recipients[t];(0,fe.Z)(n,this.targetWindow).then((e=>{var i,r;e.length&&this.editor&&(n.blockWellItemRemoval?t++:null===(i=this.modifyRecipients)||void 0===i||i.removeRecipientsFromWell([n]),null===(r=this.modifyRecipients)||void 0===r||r.addRecipientsToWell(e,t))}))}}var Ce=n(705807),Ee=n(763754);class Pe extends le{constructor(e,t){super(e,t),this.getTargetNodeFromRange=()=>{if(!this.editor)return;const e=this.editor.getSelectionRange();if(e){if(e.collapsed)return e.startContainer;{const t=new s.Position(e.startContainer,e.startOffset),n=(0,w.NY)(this.editor,t);if((0,w.vJ)((0,s.createRange)(t,new s.Position(n,-1)).toString()))return n;const i=new s.Position(e.endContainer,e.endOffset),r=(0,w.NY)(this.editor,i);let o=null==n?void 0:n.nextSibling;for(;o&&o!==r;){if((0,w.vJ)(o.textContent))return o;o=o.nextSibling}return r}}},this.onContextMenuEvent=e=>{if(!this.editor)return;let t=e.target;(e.button<0||!e.target)&&(t=this.getTargetNodeFromRange()),t&&this.editor.triggerPluginEvent(16,{rawEvent:e,items:this.getContextMenuItems(t)}),e.stopImmediatePropagation()},this.getContextMenuItems=e=>{var t;if(!this.editor)return[];const n=[],i=(0,w.Re)(this.editor,new s.Position(e,0));if(i){let e=null===(t=this.editor)||void 0===t?void 0:t.getSelectionRange();e&&!e.collapsed&&e.intersectsNode(i.wrapper)||(e=(0,s.createRange)(i.wrapper),(0,w.T6)(this.editor,e)),i.wrapper.querySelector((0,h.Br)())&&n.push({key:"expand",text:(0,l.ZP)(Ce.L5),onClick:()=>{this.expandGroup(i.wrapper)}},{key:"groupDivider",itemType:Ee.n.Divider});const r=this.recipients[ge(this.recipients,(0,h.Ct)(i))];(null==r?void 0:r.blockWellItemRemoval)||n.push({key:"remove",text:(0,l.ZP)(Ce.rl),onClick:()=>{e&&this.onDelete(e,!0)}}),n.push({key:"copy",text:(0,l.ZP)(Ce.IZ),onClick:()=>{e&&this.onCopy(e,!1)}},{key:"cut",text:(0,l.ZP)("SPd"),onClick:()=>{e&&(this.onCopy(e,!0),this.onDelete(e,!1))}},{key:"lpcDivider",itemType:Ee.n.Divider},{key:"lpc",text:(0,l.ZP)("RPd"),onClick:()=>{Ie(i,r)}})}return n},this.onCopy=(e,t)=>{const n=se(this.editor,e,this.recipients),i=null==n?void 0:n.recipients.length,r=null==n?void 0:n.copyText;return t?(0,ee.y8)("RecipientEdit_ContextMenu_Cut",[i]):(0,ee.y8)("RecipientEdit_ContextMenu_Copy",[i]),r&&this.targetWindow&&this.targetWindow.navigator.clipboard.writeText(r).then((()=>{}),(()=>{var e;null===(e=this.targetWindow)||void 0===e||e.prompt((0,l.ZP)(Ce.mT),r)})),!0},this.onDelete=(e,t)=>{const n=e.cloneContents().children.length;$(this.editor,e,this.modifyRecipients),t&&(0,ee.y8)("RecipientEdit_ContextMenu_Delete",[n])},this.expandGroup=e=>{const t=ge(this.recipients,e.firstElementChild.id),n=this.recipients[t];(0,fe.Z)(n,this.targetWindow).then((e=>{var i,r;e.length&&this.editor&&(null===(i=this.modifyRecipients)||void 0===i||i.removeRecipientsFromWell([n]),null===(r=this.modifyRecipients)||void 0===r||r.addRecipientsToWell(e,t))}))},this.disposer=null}initialize(e){var t;this.editor=e,this.targetWindow=(null===(t=null==e?void 0:e.getDocument())||void 0===t?void 0:t.defaultView)||window;const n={contextmenu:this.onContextMenuEvent};this.disposer=this.editor.addDomEventHandler(n)}dispose(){this.disposer&&(this.disposer(),this.disposer=null),this.editor=void 0}getName(){return"RecipientContextMenuPlugin"}}var Te=n(56909),Re=n(868670),xe=n(330683);const ke=(0,n(136947).aD)("setIsSearching")((function(e,t,n){e.isSearching=t,null!=n&&(e.queryString=n)}));var Ne=n(136743),Ae=n(371134);const De=-2;function Ze(e){const t=Array(e.length);for(let e=0;e<t.length;e++)t[e]=De;return t}function Me(e,t){for(let n=e.length-1;n>=0;n--)if(e[n].index>De){const i=e[n].getPreviousSelectableIndex(e[n].index);if(i>De)return t[n]=i,!0;n>0&&(e[n-1].index=e[n-1].getItemsLength())}return!1}function Oe(e,t){for(let n=0;n<e.length;n++)if(e[n].index>De){const i=e[n].getNextSelectableIndex(e[n].index);if(i>De)return t[n]=i,!0;n+1<e.length&&(e[n+1].index=-1)}return!1}const Fe=(0,Ae.lr)("setSelectedRecipientHeaderFooterIndex",((e,t=-2,n=-2,i=-2)=>{e.selectedRecipientIndex=t,e.selectedHeaderIndex=n,e.selectedFooterIndex=i}));var _e=n(30491),Le=n(399101),ze=n(361130);function Be(e,t,n,i,r,o){const s=[];return s.push({index:t,getItemsLength:()=>e.length,getPreviousSelectableIndex:t=>{for(let n=t-1;n>=0;n--)if(e[n].onExecute&&e[n].shouldShow())return n;return De},getNextSelectableIndex:t=>{for(let n=t+1;n<e.length;n++)if(e[n].onExecute&&e[n].shouldShow())return n;return De}}),s.push({index:i,getItemsLength:()=>n.length,getPreviousSelectableIndex:e=>--e>=0&&e<n.length?e:De,getNextSelectableIndex:e=>++e>=0&&e<n.length?e:De}),s.push({index:o,getItemsLength:()=>r.length,getPreviousSelectableIndex:e=>{for(let t=e-1;t>=0;t--)if(r[t].onExecute&&r[t].shouldShow())return t;return De},getNextSelectableIndex:e=>{for(let t=e+1;t<r.length;t++)if(r[t].onExecute&&r[t].shouldShow())return t;return De}}),s}function Ve(e,t,n,i,r,o){return function(e){if(!e||e.length<1)return[];const t=Ze(e);if(Me(e,t))return t;const n=e.length-1;return e[n].index=e[n].getItemsLength(),Me(e,t),t}(Be(e,t,n,i,r,o))}function Ue(e,t,n,i,r,o){return function(e){if(!e||e.length<1)return[];const t=Ze(e);return Oe(e,t)||(e[0].index=-1,Oe(e,t)),t}(Be(e,t,n,i,r,o))}var qe=n(581842),We=n(453083),He=n(5989),je=n(287130),Ge=n(564229);const Ke=({extTheme:e})=>{const t=null!=e?e:(0,Ge.gh)(),n=t.palette.themePrimary,i=t.fonts.small,r=t.fonts.medium,o=t.fonts.xLarge;return{container:{width:"100%",overflow:"hidden",display:"table"},tallContainer:{height:"48px"},shortContainer:{height:"36px"},executable:{cursor:"pointer"},textContainer:{fontSize:i.fontSize,textAlign:"left",display:"table-cell",verticalAlign:"middle",paddingLeft:"12px"},boldText:{fontWeight:"600"},searchIcon:{fontSize:o.fontSize,color:n},feedbackIcon:{fontSize:r.fontSize,color:n},smallIconContainer:{padding:"10px 0px 10px 12px",display:"table-cell",width:" 14px"},iconContainer:{paddingLeft:"12px",paddingTop:"14px",width:"32px",display:"table-cell",textAlign:"center"},centered:{width:"100%",textAlign:"center",padding:0},feedback:{display:"block",padding:"10px 5px 10px 10px",fontSize:r.fontSize},themePrimaryText:{color:n}}},Xe=(0,je.y)(),$e=(0,r.Pi)((({theme:e})=>{const t=Xe(Ke({extTheme:e}));return i.createElement("div",{className:B()(t.container,t.executable)},i.createElement("div",{className:t.smallIconContainer},i.createElement(He.J,{className:t.feedbackIcon,iconName:"Feedback"})),i.createElement(We.Z,{className:B()(t.textContainer,t.feedback,t.themePrimaryText)}))}));var Je=n(106147),Qe=n(670366);const Ye=(0,je.y)(),et=(0,r.Pi)((e=>{const t=Ye(Ke({extTheme:e.theme}));return i.createElement("div",{className:B()(t.container,t.tallContainer)},i.createElement("div",{className:t.iconContainer},i.createElement(Je.$,null)),i.createElement("div",{className:t.textContainer},(0,l.WU)((0,l.ZP)(Qe.U),e.viewState.currentRenderedQueryString)))}));var tt=n(252936),nt=n(178815),it=n(954947);const rt=(0,je.y)(),ot=(0,r.Pi)((({theme:e})=>{const t=rt(Ke({extTheme:e}));return i.createElement("div",{className:B()(t.container,t.tallContainer,t.executable)},i.createElement("div",{className:t.iconContainer},i.createElement(He.J,{className:t.searchIcon,iconName:"Search"})),i.createElement("div",{className:t.textContainer},(0,it.Z)()?(0,l.ZP)(nt.W):(0,l.ZP)(tt.c)))}));var st=n(484982),at=n(73263);const lt=(0,je.y)(),ct=(0,r.Pi)((e=>{const t=lt(Ke({extTheme:e.theme}));return i.createElement("div",{className:B()(t.container,t.tallContainer)},i.createElement("div",{className:B()(t.textContainer,t.centered)},e.viewState.findResultSet.length?(0,l.WU)((0,l.ZP)(at.e),e.viewState.findResultSet.length):(0,l.ZP)(st.z)))}));var dt=n(430647);const ut=(0,je.y)(),pt=(0,r.Pi)((e=>{const t=ut(Ke({extTheme:e.theme}));return i.createElement("div",{className:B()(t.container,t.shortContainer,t.executable)},i.createElement("div",{className:B()(t.textContainer)},(0,l.WU)((0,l.ZP)(dt.E),e.viewState.queryString)))})),mt=e=>!(0,l.LP)(e.queryString);var ht=n(233762),ft=n(329746),gt=n(933635),vt=n(386207);var yt=n(336829),St=n(154535),bt=n(620638);var It=n(777870);function wt(e){return!e.isSearching&&mt(e)&&e.directorySearchType!==gt.r.None&&(0,It.Z)(e.queryString)&&0===e.findResultSet.length}var Ct=n(55461);function Et(e,t,n,r){return[{renderItem:()=>i.createElement(et,{viewState:e,theme:r}),shouldShow:()=>e.isSearching&&mt(e)},{renderItem:()=>i.createElement(ot,{theme:r}),shouldShow:()=>!e.isSearching&&mt(e)&&e.directorySearchType===gt.r.None,onExecute:()=>function(e,t){if((0,bt.Z)(e)){const e=St.Z.sessionIds.latestQFRequestId;yt.Ln.import().then((t=>t(e,null,"ExpandLinkClicked",new Map([["ExpansionType","PeopleSuggestion"]]))))}(0,xe.Z)(e,e.queryString,!0,null,null,null,null,t)}(e,n)},{renderItem:()=>i.createElement(pt,{viewState:e,theme:r}),shouldShow:()=>wt(e),onExecute:()=>t()},{renderItem:()=>i.createElement(ct,{viewState:e,theme:r}),shouldShow:()=>!e.isSearching&&mt(e)&&e.directorySearchType!==gt.r.None},{renderItem:()=>i.createElement($e,{theme:r}),shouldShow:()=>void 0!==e.findPeopleFeedbackManager&&((0,ht.sj)()||(0,Ct.cr)("cmp-3SPeopleFeedback"))&&(0,ye.Z)()&&(0,ft.X)("use3SPeopleSuggestions"),onExecute:()=>function(e){vt.cL.import().then((t=>{t((()=>e.peopleFeedbackState))}))}(e)}]}var Pt=n(570338);const Tt=(0,je.y)(),Rt=(0,r.Pi)((({theme:e})=>{const t=Tt(Ke({extTheme:e}));return i.createElement("div",{className:B()(t.container,t.tallContainer)},i.createElement("div",{className:B()(t.textContainer,t.centered)},(0,l.ZP)(Pt.e)))}));var xt=n(781540);const kt=(0,je.y)(),Nt=(0,r.Pi)((({theme:e})=>{const t=kt(Ke({extTheme:e}));return i.createElement("div",{className:B()(t.container,t.shortContainer)},i.createElement("div",{className:B()(t.textContainer,t.boldText)},(0,l.ZP)(xt.o)))}));var At=n(299518);function Dt(e,t){return[{renderItem:()=>i.createElement(Nt,{theme:t}),shouldShow:()=>!mt(e)&&!e.isSearching&&e.findResultSet.length>0},{renderItem:()=>i.createElement(Rt,{theme:t}),shouldShow:()=>!mt(e)&&(0,At.Z)()}]}function Zt(e,t,n){const i=t?Ue(Dt(e),e.selectedHeaderIndex,e.findResultSet,e.selectedRecipientIndex,Et(e,(()=>{})),e.selectedFooterIndex):Ve(Dt(e),e.selectedHeaderIndex,e.findResultSet,e.selectedRecipientIndex,Et(e,(()=>{})),e.selectedFooterIndex);Fe(e,i[1],i[0],i[2]),n&&e.selectedRecipientIndex>=0&&e.selectedRecipientIndex<e.findResultSet.length&&(0,qe.Z)(n,"#FloatingSuggestionsItemId-"+e.selectedRecipientIndex.toString())}var Mt=n(388352),Ot=n(906233);class Ft{constructor(e,t,n,i,r,o){this.adapter=e,this.recipients=t,this.modifyWell=n,this.onEditorModified=i,this.scenario=r,this.getAdditionalRecipientEmailAddresses=o,this.setRecipients=e=>{var t;this.recipients=e,null===(t=this.modifyRecipients)||void 0===t||t.setRecipients(e)},this.setModifyWell=e=>{this.modifyRecipients=new ae(this.recipients,e)},this.onIsSuggestingChanged=e=>{var t;const n=this.adapter();(0,Re.Z)(n,e),null===(t=this.setShowPickerCallback)||void 0===t||t.call(this,e),e?((0,Te.Z)(this.adapter(),this.targetPoint,this.buffer),(0,ze.Z)(n.findPeopleFeedbackManager),Fe(n)):((0,Te.Z)(n,null,0),(0,Le.Z)(n.findPeopleFeedbackManager))},this.queryStringUpdated=e=>{var t;const n=this.adapter();null===(t=this.onEditorModified)||void 0===t||t.call(this),this.timer&&(clearTimeout(this.timer),this.timer=null),this.onIsSuggestingChanged(!0),e?this.timer=setTimeout((()=>{ke(n,!0,e),(0,xe.Z)(n,n.queryString,!1,void 0,void 0,void 0,void 0,this.scenario).then((()=>{var e;Fe(n,0),null===(e=this.setAriaActiveDescendantCallback)||void 0===e||e.call(this,n.selectedRecipientIndex)})),this.timer=null}),150):_e.I.import().then((t=>{var i;ke(n,!1,e),t(n,this.recipients,this.scenario,null===(i=this.getAdditionalRecipientEmailAddresses)||void 0===i?void 0:i.call(this)).then((()=>{var e;Fe(n),null===(e=this.setAriaActiveDescendantCallback)||void 0===e||e.call(this,n.selectedRecipientIndex)}))}))},this.onRemove=(e,t)=>null,this.setCursorPoint=(e,t)=>{this.targetPoint=e,this.buffer=t},this.onScroll=()=>{},this.shiftHighlight=e=>{var t;Zt(this.adapter(),e,null===(t=this.editor)||void 0===t?void 0:t.getDocument())},this.selectOption=()=>{const e=this.adapter(),t=()=>{this.addRecipientHelper((0,G.K)(e.queryString))},n=Dt(e),i=Et(e,t);e.selectedHeaderIndex>=0&&e.selectedHeaderIndex<n.length?(n[e.selectedHeaderIndex].onExecute(),Fe(e,e.queryString?0:void 0)):e.selectedFooterIndex>=0&&e.selectedFooterIndex<i.length?(i[e.selectedFooterIndex].onExecute(),Fe(e,e.queryString?0:void 0)):e.isSearching||0!=e.findResultSet.length?this.addRecipient():(e.selectedFooterIndex<0&&wt(e)&&(t(),Fe(e,e.queryString?0:void 0)),this.onIsSuggestingChanged(!1))},this.addRecipientHelper=e=>{var t;if(void 0===this.editor)return;const n=this.adapter();let i=this.editor.getSelectionRange();if(!i)return;i.collapsed||($(this.editor,i,this.modifyRecipients),i=this.editor.getSelectionRange());const r=new s.Position(i.endContainer,i.endOffset),o=(0,w.Q$)(this.editor,r),a=!!(0,w.Re)(this.editor,r);if(!a){const e=(0,w.Oy)(this.editor,r);e.text&&$(this.editor,e.textStartPos,e.textEndPos,this.modifyRecipients)}this.onIsSuggestingChanged(!1),ke(n,!1,""),this.editor.focus(),null===(t=this.modifyRecipients)||void 0===t||t.addRecipientsToWell([e],o,void 0,a?[o]:[]),this.adapter().inForceResolve&&(0,Mt.Z)(this.recipients,this.adapter(),this.editor,o+1)},this.addRecipient=(e=null)=>{const t=this.adapter();if(e||(e=t.findResultSet[t.selectedRecipientIndex]),e){const t=(0,Ne.Z)(e);this.addRecipientHelper(t)}},this.getSelectedIndex=()=>this.adapter().selectedRecipientIndex,this.timer=null,this.modifyRecipients=new ae(this.recipients,this.modifyWell),this.targetPoint={x:0,y:0},this.buffer=0}onInitalize(e,t,n){this.setShowPickerCallback=t,this.editor=n}onInitialize(e,t,n,i){this.setShowPickerCallback=t,this.setAriaActiveDescendantCallback=n,this.editor=i}onDispose(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.editor=void 0,this.recipients=[],this.modifyRecipients=void 0}clearQueryString(){this.timer&&(clearTimeout(this.timer),this.timer=null),(0,Ot.Z)(this.adapter(),"")}}function _t(e){return(e.ctrlKey||e.altKey)&&75==e.which}var Lt=n(336934);const zt=s.Browser.isIE?"Esc":"Escape",Bt=s.Browser.isIE?"Left":"ArrowLeft",Vt=s.Browser.isIE?"Up":"ArrowUp",Ut=s.Browser.isIE?"Right":"ArrowRight",qt=s.Browser.isIE?"Down":"ArrowDown",Wt=s.Browser.isIE?"Del":"Delete";class Ht extends le{constructor(e,t,n,i){super(e,t),this.dataProvider=n,this.pickerOptions=i,this.setRecipients=e=>{var t;this.recipients=e,null===(t=this.modifyRecipients)||void 0===t||t.setRecipients(e),this.dataProvider.setRecipients(e)},this.setModifyWell=e=>{this.modifyRecipients=new ae(this.recipients,e),this.dataProvider.setModifyWell(e)},this.closePicker=()=>{this.isSuggesting&&this.dataProvider.onIsSuggestingChanged(!1)},this.tryUpdateInvalid=(0,Lt.Z)(((e,t)=>{var n,i;if(this.editor){if(null===(n=null==e?void 0:e.rawEvent)||void 0===n?void 0:n.target){const e=this.editor.getFocusedPosition(),n=(0,w.Re)(this.editor,e);n&&!n.isReadonly&&(null===(i=this.modifyRecipients)||void 0===i||i.updateRecipientIndexInWell((0,w.Q$)(this.editor,e),t))}}}),100),this.editor=null,this.isSuggesting=!1,this.disposer=null}getName(){return"Picker"}initialize(e){this.editor=e,this.dataProvider.onInitialize((()=>{}),(e=>{this.isSuggesting=e,this.setAriaOwns(e)}),this.setAriaActiveDescendant,e);const t={paste:this.closePicker,contextmenu:this.closePicker,compositionstart:this.closePicker};this.disposer=this.editor.addDomEventHandler(t)}dispose(){this.disposer&&(this.disposer(),this.disposer=null),this.editor=null,this.dataProvider.onDispose()}willHandleEventExclusively(e){return this.isSuggesting&&(3==e.eventType&&!this.isDelimiter(e.rawEvent.data)||0==e.eventType&&!_t(e.rawEvent))}isDelimiter(e){return!!e&&this.pickerOptions.delimiterCharacters.includes(e)}onPluginEvent(e){var t,n;switch(e.eventType){case 7:if("SetContent"==e.source&&this.dataProvider.onContentChanged){this.closePicker();const e=[];null===(t=this.editor)||void 0===t||t.queryElements("[id^='"+this.pickerOptions.elementIdPrefix+"']",(t=>{t.id&&e.push(t.id)})),this.dataProvider.onContentChanged(e)}e.source==f.JK&&((null===(n=e.data)||void 0===n?void 0:n.isResolve)&&this.closePicker(),this.updatePicker(e));break;case 1:this.onKeyPressEvent(e);break;case 3:this.onInputEvent(e),this.updatePicker();break;case 0:this.onKeyDownEvent(e);break;case 6:this.closePicker();break;case 14:this.dataProvider.onScroll&&this.dataProvider.onScroll(e.scrollContainer);break;case 4:this.updatePicker()}}cancelDefaultKeyDownEvent(e){e.rawEvent.preventDefault(),e.rawEvent.stopImmediatePropagation()}updatePicker(e){var t,n;if(null===(t=this.editor)||void 0===t?void 0:t.isInIME())return;const i=this.getEditText();let r=null==i?void 0:i.text;r||(r="");const o=r.trim(),a=r==o,l=()=>{this.dataProvider.queryStringUpdated(o,a)};if(this.isSuggesting){const e=this.isDelimiter(r.slice(-1));!e&&o&&o.length>0&&o.split(" ").length<=4?l():(o&&!e||this.dataProvider.clearQueryString(),this.closePicker())}else if((r.length>0||(null==e?void 0:e.source)===f.JK)&&r.split(" ").length<=4){if(this.dataProvider.setCursorPoint){if(!this.editor)return;const e=this.editor.getFocusedPosition();if(e){const t=(0,w.Zt)(this.editor),i=t,r=(0,w.Wv)(t,e),o=(r?(0,s.createRange)(r):(0,s.createRange)(null!==(n=t.lastChild)&&void 0!==n?n:t)).getClientRects(),a=i.getClientRects();if((null==o?void 0:o.length)&&(null==a?void 0:a.length)){const e=window.getComputedStyle(i),t={x:o[0].left,y:a[0].bottom},n=Number.parseInt(e.marginBottom,10)+1;this.dataProvider.setCursorPoint(t,n)}}}l()}}onInputEvent(e){var t;if(!this.editor)return;let n=null===(t=this.getEditText())||void 0===t?void 0:t.text;n||(n=""),this.tryUpdateInvalid(e,n)}onKeyPressEvent(e){!this.editor||e.rawEvent.altKey||e.rawEvent.ctrlKey||e.rawEvent.metaKey||e.rawEvent.shiftKey||this.clearSelection()}clearSelection(){const e=this.editor.getSelectionRange();e&&!e.collapsed&&$(this.editor,e,this.modifyRecipients,{collapseToStart:!0})}getRangeForBackspaceDelete(e){if(!this.editor)return;const t=this.editor.getSelectionRange();if(!t)return;if(!t.collapsed)return t;const n=new s.Position(t.endContainer,t.endOffset),i=e?(0,w.hE)(this.editor,n):(0,w.z1)(this.editor,n);return i?e?(0,s.createRange)(i,n):(0,s.createRange)(n,i):(0,s.createRange)(n)}onKeyDownEvent(e){if(!this.editor)return;const t=e.rawEvent,n="Backspace"===t.key,i=t.key===Wt,r=t.key==Bt||t.key==Ut;if(n||i){t.preventDefault(),t.stopImmediatePropagation();const e=this.getRangeForBackspaceDelete(n);e&&($(this.editor,e,this.modifyRecipients,{collapseToStart:n}),this.updatePicker())}this.isSuggesting?t.key==zt?(this.closePicker(),this.cancelDefaultKeyDownEvent(e)):this.dataProvider.shiftHighlight&&(this.pickerOptions.isHorizontal?r:t.key==Vt||t.key==qt)?(this.dataProvider.shiftHighlight(this.pickerOptions.isHorizontal?t.key==Ut:t.key==qt),this.dataProvider.getSelectedIndex&&this.setAriaActiveDescendant(this.dataProvider.getSelectedIndex()),this.cancelDefaultKeyDownEvent(e)):!this.dataProvider.selectOption||"Enter"!=t.key&&"Tab"!=t.key?(r||t.key==Vt||t.key==qt)&&(this.closePicker(),r&&(this.setSelectionForArrowKey(t.key,t.shiftKey),this.cancelDefaultKeyDownEvent(e))):"Tab"===t.key&&t.shiftKey||(this.dataProvider.selectOption(),this.cancelDefaultKeyDownEvent(e)):r&&(this.setSelectionForArrowKey(t.key,t.shiftKey),this.cancelDefaultKeyDownEvent(e))}setSelectionForArrowKey(e,t){const n=this.editor.getDocument().getSelection();if((null==n?void 0:n.focusNode)&&n.anchorNode){const i=e===Bt;if(t||n.isCollapsed){const e=new s.Position(n.focusNode,n.focusOffset);let r=i?(0,w.hE)(this.editor,e):(0,w.z1)(this.editor,e);const o=(0,w.Re)(this.editor,r);(null==o?void 0:o.isReadonly)&&(r=i?(0,w.hE)(this.editor,r):(0,w.z1)(this.editor,r)),t?n.setBaseAndExtent(n.anchorNode,n.anchorOffset,r.node,r.offset):n.setBaseAndExtent(r.node,r.offset,r.node,r.offset)}else i?n.collapseToStart():n.collapseToEnd()}}getEditText(){if(this.editor){const e=this.editor.getSelectionRange();if(e){const t=new s.Position(e.endContainer,e.endOffset),n=(0,w.Re)(this.editor,t);return n?{text:(0,w.vJ)(n.wrapper.textContent),textStartPos:new s.Position(n.wrapper,0),textEndPos:new s.Position(n.wrapper,-1)}:(0,w.Oy)(this.editor,t)}}return null}setAriaOwns(e){var t;const n=e&&this.pickerOptions.suggestionsLabel?this.pickerOptions.suggestionsLabel:null;n&&(null===(t=this.editor)||void 0===t||t.setEditorDomAttribute("aria-owns",n))}setAriaActiveDescendant(e){var t,n;if(this.editor){const i=null!=e&&e>=0?((null===(t=this.pickerOptions)||void 0===t?void 0:t.suggestionLabelPrefix)?null===(n=this.pickerOptions)||void 0===n?void 0:n.suggestionLabelPrefix:f.KH)+e.toString():null;this.editor.setEditorDomAttribute("aria-activedescendant",i||"")}}}var jt=n(509949),Gt=n(920053);const Kt=(e,t)=>{const{EmailAddress:n}=e;return{item:Object.assign(Object.assign({},e),{text:n.Name,secondaryText:n.EmailAddress}),isSelected:!1,key:n.EmailAddress,showRemoveButton:!0,ariaLabel:`${n.Name} - ${n.EmailAddress}`,theme:t}};var Xt=n(618391),$t=n(440655);const Jt={pickerVisible:"Y1M4f",pickerHidden:"FDBA7",infoContainer:"Xlyyw",shimmerContainer:"yhsDm",picturePlaceholder:"RXUMc",emailPlaceholder:"Pz_Lr",namePlaceholder:"DWgZj",shimmer:"sC2wN",loading:"AKQmG"},Qt=x().bind(Jt),Yt=i.memo((()=>i.createElement("div",{className:Qt(Jt.shimmerContainer)},i.createElement("div",{className:Qt(Jt.picturePlaceholder)}),i.createElement("div",{className:Qt(Jt.infoContainer)},i.createElement("div",{className:Qt(Jt.namePlaceholder)}),i.createElement("div",{className:Qt(Jt.emailPlaceholder)})),i.createElement("div",{className:Qt(Jt.shimmer)}))));var en=n(406505);const tn=x().bind(Jt),nn={headerItemsProps:void 0,footerItemsProps:void 0},rn=Array(5).fill({item:void 0,isSelected:!1,showRemoveButton:!1}),on=(0,r.Pi)((function(e){const{viewState:t,plugin:n}=e,r=i.useCallback(((e,t)=>{t.item&&n.dataProvider.addRecipient(t.item)}),[t,n]),o=i.useCallback((()=>{const e=(0,G.K)(t.queryString);n.dataProvider.addRecipientHelper(e)}),[t]),s=n.getTheme(),a=i.useCallback((e=>{const t={suggestionModel:{selected:e.isSelected}};return e.item?(0,jt.ZP)({itemProps:t,persona:e.item,theme:s}):i.createElement(Yt,null)}),[s]),l=i.useCallback(((e,n)=>{(0,Xt.Z)(t,n.item)}),[t]),c=(0,en.Z)(t.userIdentity)&&(t.findResultSet.length||t.isSearching||t.queryString.length)?t.findResultSet.map((e=>Kt(e,s))):rn;nn.headerItemsProps=Dt(t,s),nn.footerItemsProps=Et(t,o,void 0,s);const d=i.useCallback((e=>{n.dataProvider.onIsSuggestingChanged(!1)}),[n]),{targetPoint:u,bufferZone:p}=t,m=i.useCallback((e=>{const n=e.which,{headerItemsProps:i,footerItemsProps:r}=nn;switch(n){case $t.m.enter:t.selectedHeaderIndex>=0&&i&&t.selectedHeaderIndex<i.length?(i[t.selectedHeaderIndex].onExecute(),Fe(t,t.queryString?0:void 0)):t.selectedFooterIndex>=0&&r&&t.selectedFooterIndex<r.length&&(r[t.selectedFooterIndex].onExecute(),Fe(t,t.queryString?0:void 0)),e.preventDefault(),e.stopPropagation();break;case $t.m.up:Zt(t,!1,document),e.preventDefault(),e.stopPropagation();break;case $t.m.down:Zt(t,!0,document),e.preventDefault(),e.stopPropagation()}}),[t,nn]);return i.useEffect((()=>(u?n.onSuggestionsShown():n.onSuggestionsHidden(),()=>n.onSuggestionsHidden())),[u]),i.createElement("div",{className:tn(u?Jt.pickerShow:Jt.pickerHide)},i.createElement(Gt._,{onFloatingSuggestionsDismiss:d,gapSpace:p,isSuggestionsVisible:!!u,targetElement:u,onKeyDown:m,suggestions:c,onRenderSuggestion:a,onSuggestionSelected:r,pickerSuggestionsProps:nn,selectedSuggestionIndex:t.selectedRecipientIndex,selectedHeaderIndex:t.selectedHeaderIndex,selectedFooterIndex:t.selectedFooterIndex,onRemoveSuggestion:l,pickerWidth:"300px"}))}));class sn extends Ht{constructor(e,t,n,i,r,o,s,a,l){super(t,n,new Ft(e,t,n,i,r,o),{elementIdPrefix:P.v,changeSource:f.tx,delimiterCharacters:f.VD,suggestionsLabel:"suggestionHeader-list",suggestionLabelPrefix:"FloatingSuggestionsItemId-"}),this.onPickerShown=s,this.onPickerHidden=a,this.adapter=e,this.theme=l}getUIComponentClass(){return on}getName(){return"RecipientPicker"}onSuggestionsShown(){var e;null===(e=this.onPickerShown)||void 0===e||e.call(this)}onSuggestionsHidden(){var e;null===(e=this.onPickerHidden)||void 0===e||e.call(this)}getTheme(){return this.theme}setTheme(e){this.theme=e}}class an extends le{constructor(e,t,n){super(t,n),this.adapter=e}initialize(e){this.editor=e}dispose(){this.editor=void 0}getName(){return"SaveRecipientsPlugin"}onPluginEvent(e){switch(e.eventType){case 8:this.convertToRecipients();break;case 0:if(_t(e.rawEvent)){e.rawEvent.preventDefault(),this.tryResolve();break}}}convertToRecipients(){var e;if(!this.editor)return;const t=(0,w.Zt)(this.editor);let n=t.firstChild,i=0;for(;n;){let r=n.nextSibling;const o=(0,w._O)(n);if(o){if(!o.isReadonly){const e=this.recipients[i];if(null==e?void 0:e.isValid){const n=N(e,this.editor.isDarkMode());t.replaceChild(n,o.wrapper)}}i++}else{const t=(0,w.Oy)(this.editor,new s.Position(n,0));if(t.text){const n=(0,G.K)(t.text);r=(0,w.NY)(this.editor,t.textEndPos),$(this.editor,t.textStartPos,t.textEndPos,this.modifyRecipients),null===(e=this.modifyRecipients)||void 0===e||e.addRecipientsToWell([n],i,4),i++}}n=r}}tryResolve(){const e=mt(this.adapter());e?this.tryForceResolve():(this.convertToRecipients(),(0,Mt.Z)(this.recipients,this.adapter(),this.editor)),(0,ee.y8)("RecipientEdit_ForceResolve",[e])}async tryForceResolve(){var e;const t=this.adapter();await(0,xe.Z)(t,t.queryString,!0),1==t.findResultSet.length&&((0,ee.y8)("RecipientEdit_ForceResolve_SingleResult"),Fe(t,0),null===(e=this.editor)||void 0===e||e.triggerPluginEvent(0,{rawEvent:new KeyboardEvent("keydown",{key:"Enter"})},!0))}}const ln={editContainer:"AALfT",recipientEdit:"QdX2d"},cn=x().bind(ln),dn=(0,r.Pi)(i.forwardRef(((e,t)=>{const{processItemToAdd:n,dropItemsAt:r,onItemsRemoved:o,getAdditionalRecipientEmailAddresses:s,recipientEditorViewState:a,recipients:l,onEditorModified:c,onItemEdited:d,onItemsChanged:u,containerClassName:p,processItemsToRemove:m,useAsUncontrolledComponent:h,onEditorBlur:f,onEditorFocus:g,forceSync:v,scenario:y,ariaLabel:S,placeholder:b,onRenderWellLabel:I,recipientType:w,showPresence:C,onFloatingPickerShown:E,onFloatingPickerHidden:P,theme:T}=e,[R,x]=i.useState(!0),[k,N]=i.useState(a.recipientPickerPluginViewState.inForceResolve),A=i.useRef();i.useImperativeHandle(t,(()=>Object.assign({focus:()=>{A.current&&A.current.focus()}},A.current)),[]);const D=i.useCallback(((e,t)=>{e.forEach((e=>null==n?void 0:n(e,t,a.recipientPickerPluginViewState)))}),[n]),Z=i.useCallback(((e,t,n,i)=>{x(!1),D(e,n),null==r||r(t,e,i||[])}),[n,r]),M=i.useCallback((e=>{x(!1),null==m||m(e),null==o||o(e)}),[o,m]),O=i.useCallback(((e,t)=>{const n=(0,G.K)(t);null==d||d(e,n)}),[d]),F=i.useCallback(((e,t,n,i)=>{x(!1),t&&D(t,n),i&&(null==m||m(i)),null==u||u(e)}),[u,n,m,d]),_=i.useCallback((()=>{const e=k;N(!0),null==v||v(),N(e)}),[v]),L=i.useMemo((()=>({handleAsAddRemoveUpdate:!!h,addItemsToWell:Z,removeItemsFromWell:M,updateWellItem:O,changedWellItems:F,syncItems:_})),[h,Z,M,O,F,_]),z=i.useMemo((()=>new sn((()=>a.recipientPickerPluginViewState),l,L,c,y,(()=>null==s?void 0:s(w)),E,P,T)),[]),B=i.useMemo((()=>[z,new Pe(l,L),new we(l,L),new de(l,L),new ce(l,L,(()=>a.recipientPickerPluginViewState),c),new he(l,L,c),new an((()=>a.recipientPickerPluginViewState),l,L)]),[]);i.useEffect((()=>z.setTheme(T)),[T]),i.useEffect((()=>{B.forEach((e=>{e.setRecipients(l)}))}),[l]),i.useEffect((()=>{B.forEach((e=>{e.setModifyWell(L)}))}),[L]),i.useEffect((()=>{N(a.recipientPickerPluginViewState.inForceResolve)}),[a.recipientPickerPluginViewState.inForceResolve]);const V=i.useCallback((()=>{x(!0)}),[]);return i.createElement("div",{className:cn(ln.editContainer,p)},null==I?void 0:I(w),i.createElement(H,{ref:A,classNames:cn(ln.recipientEdit),recipients:l,recipientEditorViewState:a,inForceResolve:k,plugins:B,ariaLabel:S,isDarkMode:(0,j.BR)(),scenario:y,onFocus:e=>{K.Z.setUserIdentity(a.recipientPickerPluginViewState.userIdentity),null==g||g(e)},externalEdit:R,resetExternalEdit:V,showPresence:C,placeholder:b,onBlur:f}))}))),un=dn},61745:(e,t,n)=>{"use strict";n.d(t,{JK:()=>i,xq:()=>r,C0:()=>o,_t:()=>s,Rp:()=>a,ds:()=>l,gR:()=>c,JE:()=>d,O5:()=>u,VD:()=>p,tx:()=>m,KH:()=>h,Qs:()=>f,q3:()=>g,oj:()=>v});const i="InputClick",r="RECIPIENT_ENTITY",o="recipient/custom",s="text/plain",a="recipientClass",l="expandButton",c="removeButton",d="invalidIcon",u="presenceIcon",p=[";",","],m="RecipientPicker",h="FloatingSuggestionsItemId-",f="",g="",v=""},565355:(e,t,n)=>{"use strict";n.d(t,{nW:()=>c,Br:()=>d,M4:()=>u,K_:()=>p,Kj:()=>m,wz:()=>h,MQ:()=>f,Ct:()=>g});var i=n(472820),r=n(722410),o=n(254712),s=n.n(o),a=n(61745);const l=s().bind(r.Z);function c(){return"."+l(r.Z.pill)}function d(){return"#"+a.ds}function u(){return"#"+a.gR}function p(){return"#"+a.JE}function m(){return"."+l(r.Z.textContainer)}function h(){return".lpcWrapper"}function f(){return".lpcCard"}function g(e){var t,n;let r;return r=(0,i.eb)(e)?(0,i._O)(e):e,null===(n=null===(t=null==r?void 0:r.wrapper)||void 0===t?void 0:t.firstElementChild)||void 0===n?void 0:n.id}},41333:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(61745);function r(e,t){null==e||e.triggerPluginEvent(7,{source:i.JK,data:{isResolve:!!t}})}},647565:(e,t,n)=>{"use strict";n.d(t,{Bs:()=>r,ER:()=>o,s7:()=>s,Vk:()=>a});const i={};function r(e){var t;for(const n of e)null===(t=i[n])||void 0===t||t.getContent()}function o(e,t){i[e]=t}function s(e){delete i[e]}function a(e){return i[e]}},522787:(e,t,n)=>{"use strict";function i(e,t){return{MailboxType:"OneOff",RoutingType:"SMTP",EmailAddress:e,Name:t||e}}n.d(t,{Z:()=>i})},972406:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});const i=/^"?(.*?)"?\s*\(([^\(]*?)\)$/,r=/^"?(.*?)"?\s*<([^<]*?)>$/,o=/^"?(.*?)"?\s*\[([^\[]*?)\]$/,s=/^"?(.*?)"?\s*{([^\{]*?)}$/;function a(e){if("string"!=typeof e)return e;const t=e.trim(),n=t.match(i)||t.match(r)||t.match(o)||t.match(s);return n?n[1].length?{displayName:n[1],address:n[2]}:{address:n[2]}:{address:t}}},404596:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(774676),r=n(166337),o=n(954947);const s=(e,t)=>{const n=t||e.Name;if(!n)return!0;const r=(0,i.H)(n),s=(a=n,l=e.EmailAddress,a==l||a&&l&&a.toLowerCase()==l.toLowerCase());var a,l;const c=-1!==n.indexOf("@"),d=!(0,o.Z)()&&("ExternalMailbox"===e.MailboxType||"LinkedIn"===e.MailboxType),u="OneOff"===e.MailboxType||"Unknown"===e.MailboxType;return e.EmailAddress&&!("SMTP"===e.RoutingType&&s)&&(r||c||d||u)};const a=function(e,t){const n=t||e.Name,o=(0,i.H)(n);return s(e,t)?o?(0,r.Z)(e):`${n} <${(0,r.Z)(e)}>`:n}},166337:(e,t,n)=>{"use strict";function i(e){var t;if("SMTP"===e.RoutingType||void 0===e.RoutingType)return e.EmailAddress;const n="MAPIPDL"===e.RoutingType&&(null===(t=e.ItemId)||void 0===t?void 0:t.Id)||e.EmailAddress;return`${e.RoutingType}:${n}`}n.d(t,{Z:()=>i})},777870:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(983351),r=n(972406);function o(e){const t=(0,r.Z)(e);return(0,i.ZP)(t.address)}},717606:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(983351);function r(e){return"SMTP"!=e.RoutingType||null!=e.EmailAddress&&(0,i.ZP)(e.EmailAddress)}},983351:(e,t,n)=>{"use strict";n.d(t,{J4:()=>c,DA:()=>d,kR:()=>u,bM:()=>p,ZP:()=>m});const i="A-Za-z------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------0-9------------------------------------",r=new RegExp("^(["+i+"!#$%&'*+/=?^_`{|}~-](?:["+i+".!#$%&'*+/=?^_`{|}~-]*["+i+"!#$%&'*+/=?^_`{|}~-])?)(?=@)"),o=new RegExp('^("['+i+'.!#$%&\'*+\\/=?^_`{|}~\\-(),:;<>@[\\\\\\]" ]*")(?=@)'),s=new RegExp("^["+i+"-]+(?:\\.["+i+"-]+)*$"),a=/[^\\]"/,l=/^[A-Za-z0-9_-]+:.*$/,c=e=>{const t=e.match(r);if(t)return-1!==t[0].indexOf("..")?null:t[0];const n=e.match(o);if(n){const e=a.exec(n[0]);return e&&e.index!==n[0].length-2?null:n[0]}return null};function d(e){if(!e)return!1;const t=c(e);if(!t)return!1;return!!e.substring(t.length+1).match(s)}function u(e){return l.test(e)}function p(e){return!c(e)}function m(e){return d(e)||u(e)}},466644:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(983351);function r(e,t){if((0,i.DA)(e))return{MailboxType:"OneOff",RoutingType:"SMTP",EmailAddress:e,Name:t||e};if((0,i.kR)(e)){const[n,i]=e.split(":",2);return{MailboxType:"OneOff",RoutingType:n.toUpperCase(),EmailAddress:i,Name:t||i}}return null}},734427:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(371134),r=n(154535);const o=(0,i.lr)("setLatestQFRequestId",(e=>{r.Z.sessionIds.latestQFRequestId=e}))},336829:(e,t,n)=>{"use strict";n.d(t,{Zk:()=>o,uR:()=>s,nA:()=>a,fH:()=>l,fV:()=>c,Ln:()=>d,$8:()=>u});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(16293),n.e(52711),n.e(79127)]).then(n.bind(n,432912)))),o=new i.EF(r,(e=>e.searchSuggestionsForSinglePersona)),s=new i.EF(r,(e=>e.searchSuggestions)),a=new i.EF(r,(e=>e.logResponseReceived)),l=new i.EF(r,(e=>e.logRenderLayout)),c=new i.EF(r,(e=>e.logClientDataSource)),d=new i.EF(r,(e=>e.logSearchActions)),u=new i.EF(r,(e=>e.logManuallyAddedContact))},959869:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(964659);const r=new class{constructor(){this.cvid=new Map,this.results=new Map}getCvid(e){return this.cvid.get(e)}setCvid(e,t){this.cvid.set(function(e){return e||(0,i.FL)()||""}(e),t)}getResults(e){return this.results.get(e)}setResults(e,t){this.results.set(e,function(e){return e.map((e=>({ReferenceId:e.ReferenceId||"",TransactionId:e.TransactionId||""})))}(t))}clearResults(){this.results.clear()}}},154535:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).MT)("recipientcommon",{fallbackToFindPeople:!1,sessionIds:{latestQFRequestId:"",latestCvid:""}})()},577598:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(101060),r=n(325404);const o="MkU4MDBGNDUtMEY3OS00MzM4LTg3RUUtNENFOTFBRURCODcx",s=e=>e?{Id:e,__type:"ItemId:#Exchange"}:void 0;function a(e,t,n,o){const{EmailAddresses:a,DisplayName:m,Text:h,PDLItemId:f,ADObjectId:g,PersonaId:v,FeatureData:y,Id:S,ReferenceId:b,ImAddress:I,JobTitle:w,PeopleType:C,PeopleSubtype:E,GivenName:P,Surname:T,Alias:R,Phones:x,Department:k,OfficeLocation:N,AdditionalNames:A,PersonId:D,MRI:Z,ExternalDirectoryObjectId:M}=e,O=a?a[0]:void 0;if(!n&&O&&(0,r.Z)(O))return null;const F={EmailAddress:O,Name:(0,i.LP)(m)?h:m,MailboxType:d(E),RoutingType:l(E),ItemId:s(f)};var _;return{DisplayName:m,ADObjectId:g,FeatureData:y,Id:S,ImAddress:I,EmailAddress:F,EmailAddresses:[F],PersonaTypeString:c(E),PersonaId:s(v),Title:w,ReferenceId:b,PeopleType:C,PeopleSubtype:E,GivenName:P,Surname:T,TransactionId:t,LogicalId:o,Alias:R,PhoneNumber:u(x),Department:k,Location:N,AdditionalNames:A,PersonId:(_=D,_&&p(_)?_:void 0),MRI:Z,ExternalDirectoryObjectId:M}}function l(e){return"PersonalDistributionList"==e?"MAPIPDL":"SMTP"}function c(e){switch(e){case"PublicDistributionList":case"PersonalDistributionList":return"DistributionList";case"UnifiedGroup":return"ModernGroup";case"OrganizationUser":case"PersonalContact":case"ImplicitContact":case"OrganizationContact":return"Person";case"LinkedIn":return"LinkedIn";case"ImplicitGroup":return"ImplicitGroup";default:return"Unknown"}}function d(e){switch(e){case"PublicDistributionList":return"PublicDL";case"PersonalDistributionList":return"PrivateDL";case"UnifiedGroup":return"GroupMailbox";case"ImplicitGroup":return"RecommendedGroup";case"OrganizationUser":return"InternalMailbox";case"LinkedIn":return"LinkedIn";case"PersonalContact":case"OrganizationContact":case"ImplicitContact":case"Guest":case"Unknown":return"ExternalMailbox";default:return e}}function u(e){return(null==e?void 0:e.length)?{Number:e[0].Number,Type:e[0].Type}:{Number:""}}function p(e){return-1==(null==e?void 0:e.indexOf("@"))&&!(0==(null==(t=e)?void 0:t.indexOf(o)));var t}},620638:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(816958),r=n(55461);function o(e){const t=e.searchScenario;return(0,r.cr)("rp-3STelemetryEvents")&&void 0!==t&&t===i.C.MailCompose}},213029:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(964659),r=n(55461),o=n(154535);function s(){const e=(0,i.c6)(),t=null==e?void 0:e.SessionSettings,n=null==t?void 0:t.IsExplicitLogon,s=null==t?void 0:t.IsSubstrateSearchServiceAvailable;return!(o.Z.fallbackToFindPeople||!(0,r.cr)("rp-3SPeopleSuggestions")||n||!s)}},933635:(e,t,n)=>{"use strict";var i,r;n.d(t,{m:()=>i,r:()=>r}),function(e){e[e.None=0]="None",e[e.Cache=1]="Cache",e[e.FindPeople=2]="FindPeople",e[e.SearchDirectory=3]="SearchDirectory",e[e.MixedCacheLive=4]="MixedCacheLive"}(i||(i={})),function(e){e[e.None=0]="None",e[e.Auto=1]="Auto",e[e.Manual=2]="Manual"}(r||(r={}))},88922:(e,t,n)=>{"use strict";var i;n.d(t,{X:()=>i,Z:()=>r}),function(e){e[e.None=0]="None",e[e.InProgress=1]="InProgress",e[e.Failed=2]="Failed",e[e.SucceededWithDLOrGroupMembers=3]="SucceededWithDLOrGroupMembers",e[e.SucceededWithoutDLOrGroupMembers=4]="SucceededWithoutDLOrGroupMembers"}(i||(i={}));const r=i},800559:(e,t,n)=>{"use strict";var i;n.d(t,{C:()=>i,Z:()=>r}),function(e){e[e.None=0]="None",e[e.To=1]="To",e[e.Cc=2]="Cc",e[e.Bcc=3]="Bcc",e[e.RequiredAttendee=4]="RequiredAttendee",e[e.OptionalAttendee=5]="OptionalAttendee"}(i||(i={}));const r=i},262013:(e,t,n)=>{"use strict";n.d(t,{B:()=>p});var i=n(989526),r=n(287130),o=n(843784),s=n(564229);const a=e=>{var t;const{theme:n,isClickable:i,isDarkMode:r,classname:o}=e,{palette:a}=n,l=null!==(t=e.recipientSize)&&void 0!==t?t:32;return{label:["RecipientWellLabelWithContactPicker-label",{display:"inline-block",position:"relative",height:l,lineHeight:l,margin:"11px 10px 1px 1px",minWidth:"52px",padding:"0 4px",textAlign:"center",fontWeight:s.lq.semibold,color:a.themeDark,borderRadius:"2px",border:"1px solid ",borderColor:a.neutralTertiaryAlt},o,i&&{selectors:{":hover":{backgroundColor:a.themeLighter},":active":{backgroundColor:a.themeLight}},cursor:"pointer"}],button:["RecipientWellLabelWithContactPicker-label",{display:"inline-block",position:"relative",height:l,lineHeight:l,margin:"4px 10px 1px 1px",minWidth:"52px",padding:"0 4px",textAlign:"center",fontWeight:s.lq.semibold,color:"#242424",borderRadius:"4px",border:"1px solid",borderColor:"#e0e0e0"},o,r&&{backgroundColor:"#292929",borderColor:"#525252",color:"#ffffff"},i&&!r&&{selectors:{":hover":{backgroundColor:"#f5f5f5"},":active":{backgroundColor:"#ebebeb"}},cursor:"pointer"},i&&r&&{selectors:{":hover":{backgroundColor:"#3d3d3d"},":active":{backgroundColor:"#383838"}},cursor:"pointer"}]}};var l=n(800559),c=n(604135),d=n(688002);const u=(0,r.y)(),p=i.forwardRef((({onClick:e,recipientType:t,theme:n=(0,o.Pl)(),roleDesc:r,useKeyActivate:s,styleAsButton:p,recipientSize:m,classname:h},f)=>{const g=u(a,{theme:n,isClickable:void 0!==e,recipientSize:m,isDarkMode:(0,o.BR)(),classname:h}),v=i.useCallback((t=>{13!==t.which&&32!==t.which||e()}),[]);return t!=l.C.None?i.createElement("div",{ref:f,"data-is-focusable":!0,tabIndex:0,onClick:e,onKeyDown:s?v:void 0,className:p?g.button:g.label,role:d.ce.button,"aria-roledescription":r},(0,c.Z)(t)):null}))},584064:(e,t,n)=>{"use strict";n.d(t,{dy:()=>s,jy:()=>l,Zs:()=>p});var i=n(420983),r=n(55461),o=n(954947);function s(e){return!((0,r.cr)("tri-reporting-improvements")&&!(0,o.Z)(void 0,e))||"true"===(0,i.nM)().nativereporting}var a=n(552542);function l(e){var t,n,s,l;if((0,o.Z)())return!e;if(!(null===(n=null===(t=(0,a.Z)())||void 0===t?void 0:t.SegmentationSettings)||void 0===n?void 0:n.ReportJunkEmailEnabled))return!1;if((0,r.cr)("tri-reporting-improvements")){if(!("true"===(0,i.nM)().prereport))return!1}return!(null===(l=null===(s=(0,a.Z)())||void 0===s?void 0:s.UserOptions)||void 0===l?void 0:l.CheckForReportJunkDialog)}var c=n(951789),d=n(650222),u=n(101060);function p(e,t){return new Promise((n=>{var s,l;(0,c.i)((0,u.ZP)("uKc"),e?(0,u.ZP)("vKc"):(0,u.ZP)("wKc"),!!(!(0,r.cr)("tri-reporting-improvements")||(0,o.Z)()||!(null===(l=null===(s=(0,a.Z)())||void 0===s?void 0:s.SegmentationSettings)||void 0===l?void 0:l.ReportJunkEmailEnabled)||"true"!==(0,i.nM)().postreport),{okText:(0,u.ZP)(d.v),hideCancelButton:!0,targetWindow:t}).then((e=>{n(e)}))}))}},702542:(e,t,n)=>{"use strict";n.d(t,{Ej:()=>o,JW:()=>s,Rs:()=>a});var i=n(717420);const r=new i.nI((()=>n.e(17218).then(n.bind(n,117218)))),o=new i._5(r,(e=>e.subscribe)),s=new i._5(r,(e=>e.unsubscribe)),a=new i._5(r,(e=>e.trigger));new i._5(r,(e=>e.removeResizeEventEmitter))},6566:(e,t,n)=>{"use strict";n.d(t,{lv:()=>m,Tq:()=>a,vw:()=>c,Jl:()=>p,KJ:()=>u,K_:()=>d});var i=n(717420),r=n(194992),o=n(598692),s=n(55461);function a(){if(!(0,s.cr)("fwk-skype-deprecation")){const e=(0,o.b)().chatProvider;return(0,r.Z)()&&(3==e||4==e)}return!1}const l=new i.nI((()=>Promise.all([n.e(52637),n.e(32557),n.e(39006),n.e(18838),n.e(16025),n.e(19280),n.e(33615),n.e(17483),n.e(9598),n.e(56841),n.e(62600),n.e(90885),n.e(91402),n.e(77456),n.e(99110),n.e(52711),n.e(48703)]).then(n.bind(n,334194)))),c=new i._5(l,(e=>e.initializeSkypeForBusiness)),d=new i.EF(l,(e=>e.tryRegisterForPresenceUpdates)),u=new i.EF(l,(e=>e.startChat)),p=new i._5(l,(e=>e.setIsSkypeShown)),m=(0,i.$y)(l,(e=>e.UcmaChatView))},825355:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(951660),r=n(458128),o=n(351198),s=n(55461);function a(e){if(!(0,s.cr)("fwk-skypeBusinessV2")||!e||(0,s.cr)("fwk-skype-deprecation"))return;const t=(0,i.Z)(e),n=function(e){switch(e){case"Offline":return o.H_.offline;case"Away":case"BeRightBack":return o.H_.away;case"Busy":case"IdleBusy":return o.H_.busy;case"DoNotDisturb":return o.H_.dnd;case"Online":case"IdleOnline":return o.H_.online;case"None":return o.H_.none}}(r.Z.presences.get(t));return n||void 0}},951660:(e,t,n)=>{"use strict";n.d(t,{X:()=>i,Z:()=>r});const i="sip:";function r(e){if(!e)return null;let t=e.toLowerCase();return 0!=t.indexOf(i)&&(t=i+t),t}},194992:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(458128),r=n(55461);function o(){return!(0,r.cr)("fwk-skype-deprecation")&&3==i.Z.signInState}},598692:(e,t,n)=>{"use strict";n.d(t,{b:()=>r});const i=(0,n(371134).MT)("chatStore",{isChatCalloutShown:!1,chatProvider:0})();const r=()=>i},458128:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a,b:()=>l});var i=n(559621),r=n(371134);const o={signInState:0,presences:new i.ObservableMap({}),processingManualSignIn:!1,isRetrySignInAllowed:!0},s=(0,r.MT)("presenceStore",o)(),a=s,l=()=>s},373734:(e,t,n)=>{"use strict";n.d(t,{m9:()=>r,Is:()=>o,EB:()=>s});var i=n(371134);const r=(0,i.aD)("addPill",(e=>({pillData:e}))),o=(0,i.aD)("removePill",(e=>({pillId:e}))),s=(0,i.aD)("clearPills")},401842:(e,t,n)=>{"use strict";n.d(t,{bj:()=>l,J9:()=>c,$c:()=>d});var i=n(717420),r=n(371134),o=n(373734),s=n(461461);(0,r.ed)(o.m9,(e=>{const{allAddedPills:t,viewState:n}=(0,s.Z)(),i=e.pillData;let r=-1;t.forEach(((e,t)=>{e.id===i.id&&(r=t)})),-1!==r?t[r]=i:t.push(i),n.barVisible||(n.barVisible=!0)})),(0,r.ed)(o.Is,(e=>{const t=(0,s.Z)();t.allAddedPills=t.allAddedPills.filter((t=>t.id!=e.pillId))})),(0,r.ed)(o.EB,(e=>{const t=(0,s.Z)();for(;t.allAddedPills.length>0;)t.allAddedPills.pop()}));const a=new i.nI((()=>n.e(63081).then(n.bind(n,563081)))),l=(0,i.$y)(a,(e=>e.ComposeSmartPillBlock)),c=new i._5(a,(e=>e.addPill)),d=new i._5(a,(e=>e.removePill))},461461:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});const i={viewState:{barVisible:!1},allAddedPills:[]},r=(0,n(371134).MT)("composeSmartPill",i)(),o=()=>r},916094:(e,t,n)=>{"use strict";n.d(t,{I:()=>o,$:()=>a});var i=n(717420),r=n(321289);const o=(0,n(136947).aD)("addSessionMaskedRecipient")((function(e){r.Z.sessionMaskedRecipients[e]=!0})),s=new i.nI((()=>Promise.all([n.e(16293),n.e(52711),n.e(56646)]).then(n.bind(n,82295)))),a=new i._5(s,(e=>e.execute3SPrimeCall))},321289:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r,b:()=>o});const i=(0,n(371134).MT)("substratepeoplesuggestions",{sessionMaskedRecipients:[]})(),r=i,o=()=>i},325404:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(321289);function r(e){return!!(0,i.b)().sessionMaskedRecipients[e]}},695828:(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var i=n(55461);function r(){return(0,i.cr)("rp-cacheFirstPeopleTrieSize300")||(0,i.cr)("rp-cacheFirstPeopleTrieSize500")||(0,i.cr)("rp-cacheFirstPeopleTrieSize700")||(0,i.cr)("rp-peopleTrieOnTimeoutLow")||(0,i.cr)("rp-peopleTrieOnTimeoutMed")||(0,i.cr)("rp-peopleTrieOnTimeoutHigh")}},647451:(e,t,n)=>{"use strict";n.d(t,{Di:()=>$,AC:()=>o,aY:()=>J,zD:()=>ee.zD,Gc:()=>me,ff:()=>Y,C:()=>Q,nS:()=>ee.nS,wG:()=>pe,nY:()=>fe,nd:()=>ye,uE:()=>be,in:()=>Se,nE:()=>r,s3:()=>ge,gi:()=>he,If:()=>we});const i=(0,n(371134).MT)("SurfaceActionsStore",{addinOptionSurfaceItems:{}})();const r=(0,n(136947).aD)("setAddinOptionSurfaceItems")((function(e){i.addinOptionSurfaceItems=e}));function o(e){return i.addinOptionSurfaceItems[e]}var s=n(101060),a=n(833845),l=n(555609),c=n(332086),d=n(762664),u=n(112702),p=n(618459),m=n(419739),h=n(518295),f=n(792236),g=n(812842),v=n(68405),y=n(96392),S=n(150748),b=n(269121),I=n(796206),w=n(995339),C=n(175407),E=n(316557),P=n(478868),T=n(30509),R=n(616206),x=n(28012),k=n(126019),N=n(196151),A=n(131521),D=n(51778),Z=n(265046),M=n(857621),O=n(43456),F=n(930890),_=n(487845),L=n(791499),z=n(813869),B=n(4755),V=n(602015),U=n(610040),q=n(700252),W=n(954947);const H="C5c";var j=n(115557),G=n(359287),K=n(322099),X=n(55461);const $="-";function J(e){switch(e){case"AddAttachment":case"AddClassicAttachment":return(0,s.ZP)(u.QV);case"InsertLink":return(0,s.ZP)(u.CY);case"AddInlineImage":return(0,s.ZP)(v.a);case"AddEmoji":return(0,s.ZP)("D5c");case"QuickUse":return(0,s.ZP)("S5c");case"ToggleRibbon":return(0,s.ZP)(g.K);case"SaveDraft":return(0,s.ZP)(_.D);case"InsertSignature":return(0,s.ZP)(y.I);case"ShowFrom":return(0,s.ZP)(B.M);case"SetImportance":return(0,s.ZP)(z.a);case"ShowMessageOptions":return(0,s.ZP)(U.S);case"SwitchBodyType":return(0,s.ZP)(q.A);case"SensitivityMenu":return(0,s.ZP)(L.LH);case"ProtectMessage":return(0,s.ZP)(p.Es);case"AccChecker":return(0,s.ZP)(a.g);case"ToggleDarkCompose":return(0,s.ZP)("X5c");case"ToggleDictation":return(0,s.ZP)("Y5c");case"SetDictationLanguage":return(0,s.ZP)("W5c");case"ProofingOptions":return(0,s.ZP)("R5c");case"FluidHeroButton":return(0,s.ZP)("_5c");case"CustomizeActions":return(0,s.ZP)(H);case"MessageExtensions":return(0,s.ZP)(G.F);case"FindTime":return(0,s.ZP)(j._B);default:return""}}function Q(e){switch(e){case"LikeUnlike":return(0,s.ZP)("E5c");case"SetReaction":return(0,s.ZP)("$5c");case"Reply":return(0,s.ZP)(P.H);case"ReplyAll":return(0,s.ZP)(T.g);case"Forward":return(0,s.ZP)(I.$);case"ForwardEmailAsAttachment":return(0,s.ZP)("a6c");case"ReplyByMeeting":return(0,s.ZP)("F5c");case"ReportAbuse":return(0,s.ZP)(F.e);case"Popout":return(0,s.ZP)(O.X);case"Delete":return(0,s.ZP)("G5c");case"MarkReadUnread":return(0,s.ZP)(A.WF);case"FlagUnflag":return(0,s.ZP)(b.p);case"AssignPolicy":return(0,s.ZP)(d.T);case"AddToSafeSenders":return(0,X.cr)("tri-changeBlockReportActionsPlacement")?(0,s.ZP)(Z.p):(0,s.ZP)("H5c");case"MarkJunkNotJunk":return(0,X.cr)("tri-changeBlockReportActionsPlacement")?(0,s.ZP)(k.T):(0,s.ZP)(C.F);case"MarkAsPhishing":return(0,X.cr)("tri-changeBlockReportActionsPlacement")?(0,s.ZP)(N._):(0,s.ZP)("I5c");case"Block":case"BlockOptions":return(0,s.WU)((0,s.ZP)(S.J),"");case"CreateRule":return(0,s.ZP)(m.J);case"Print":return(0,s.ZP)(E.v);case"Download":return(0,s.ZP)("L5c");case"Translate":return(0,s.ZP)(R.v);case"ShowInImmersiveReader":return(0,s.ZP)(V.K);case"ViewMessageSource":return(0,W.Z)()?(0,s.ZP)("K5c"):(0,s.ZP)("M5c");case"ToggleDarkMode":return(0,s.ZP)(w.w);case"ReplyByIM":return(0,s.ZP)("U5c");case"ReplyAllByIM":return(0,s.ZP)("V5c");case"AddToBoard":return(0,s.ZP)(l.h);case"OtherReplyActions":return(0,s.ZP)("Q5c");case"MessageSafety":return(0,X.cr)("tri-changeBlockReportActionsPlacement")?(0,s.ZP)(x.H):(0,s.ZP)("N5c");case"View":return(0,s.ZP)("Z5c");case"CustomizeActions":return(0,s.ZP)(H);case"AdvancedActions":return(0,s.ZP)("B5c");case"Addins":return(0,s.ZP)("P5c");case"MessageExtensions":return(0,s.ZP)(G.F);case"PlayThisConversation":return(0,s.ZP)(K.U);default:return""}}function Y(e){switch(e){case"None":return(0,s.ZP)("O5c");case"Delete":return(0,s.ZP)(h.w);case"Archive":return(0,s.ZP)(c.n);case"PinUnpin":return(0,s.ZP)(M.C);case"ReadUnread":return(0,s.ZP)("T5c");case"FlagUnflag":return(0,s.ZP)(f.C);case"Move":return(0,s.ZP)(D.Q);default:return""}}var ee=n(536214),te=n(444377),ne=n(936242),ie=n(299668),re=n(553070),oe=n(387500),se=n(769367),ae=n(552542),le=n(843784),ce=n(382717),de=n(584064),ue=n(543047);function pe(e){const t=[{key:"Reply",hideInGroup:!0,hideInSxS:!0},{key:"ReplyAll",hideInGroup:!1,hideInSxS:!0},{key:"Forward",hideInGroup:!1,hideInSxS:!0}];return t.push({key:"-",hideInGroup:!1,hideInSxS:!1},{key:"ReplyByMeeting",hideInGroup:!0,hideInSxS:!0},{key:"ForwardEmailAsAttachment",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1},{key:"Delete",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1},{key:"MarkReadUnread",hideInGroup:!1,hideInSxS:!0},{key:"FlagUnflag",hideInGroup:!0,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),(0,X.cr)("fwk-skypeBusinessV2")&&t.push({key:"ReplyByIM",hideInGroup:!0,hideInSxS:!1},{key:"ReplyAllByIM",hideInGroup:!0,hideInSxS:!1},{key:"-",hideInGroup:!0,hideInSxS:!1}),(0,ie.gv)()&&t.push({key:"AddToBoard",hideInGroup:!1,hideInSxS:!1},{key:"-",hideInGroup:!1,hideInSxS:!1}),(0,ae.Z)().SessionSettings.IsShadowMailbox||(t.push({key:"AddToSafeSenders",hideInGroup:!0,hideInSxS:!0}),(0,de.dy)(e)&&t.push({key:"MarkJunkNotJunk",hideInGroup:!0,hideInSxS:!0},{key:"MarkAsPhishing",hideInGroup:!0,hideInSxS:!0}),t.push({key:"Block",hideInGroup:!0,hideInSxS:!0}),(0,W.Z)(void 0,e)&&t.push({key:"ReportAbuse",hideInGroup:!(0,W.Z)(void 0,e),hideInSxS:!0}),t.push({key:"-",hideInGroup:!1,hideInSxS:!1})),(0,W.Z)(void 0,e)||t.push({key:"AssignPolicy",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),(0,ae.Z)().SessionSettings.IsShadowMailbox||t.push({key:"CreateRule",hideInGroup:!0,hideInSxS:!0}),t.push({key:"Print",hideInGroup:!1,hideInSxS:!1}),(0,X.cr)("rp-inlineTranslation")&&!(0,ue.S)()&&t.push({key:"Translate",hideInGroup:!0,hideInSxS:!0}),(0,le.BR)()&&t.push({key:"ToggleDarkMode",hideInGroup:!1,hideInSxS:!1}),(0,ue.S)()||t.push({key:"ShowInImmersiveReader",hideInGroup:!1,hideInSxS:!0}),t.push({key:"ViewMessageSource",hideInGroup:!1,hideInSxS:!0}),t.push({key:"Popout",hideInGroup:!1,hideInSxS:!0}),(0,X.cr)("rp-reactions")||(0,W.Z)(void 0,e)||t.push({key:"LikeUnlike",hideInGroup:!1,hideInSxS:!0}),(0,X.cr)("rp-reactions")&&t.push({key:"SetReaction",hideInGroup:!1,hideInSxS:!0,hideInMailSurfaceSettings:!0}),(0,X.cr)("mos-messageExtensionsFlyout")&&t.push({key:"MessageExtensions",hideInGroup:!1,hideInSxS:!0,hideInMailSurfaceSettings:!0}),t.push({key:"OtherReplyActions",hideInMailSurfaceSettings:!0},{key:"MessageSafety",hideInMailSurfaceSettings:!0}),(0,X.cr)("tri-changeBlockReportActionsPlacement")&&t.push({key:"BlockOptions",hideInMailSurfaceSettings:!0}),t.push({key:"View",hideInMailSurfaceSettings:!0},{key:"CustomizeActions",hideInMailSurfaceSettings:!0},{key:"AdvancedActions",hideInMailSurfaceSettings:!0},{key:"Addins",hideInMailSurfaceSettings:!0}),(0,X.cr)("doc-downloadMessage")&&t.push({key:"Download",hideInGroup:!1,hideInSxS:!1}),(0,X.cr)("playMyEmails-feature")&&t.push({key:"PlayThisConversation",hideInGroup:!1,hideInSxS:!0}),t}function me(e){let t=[];return t.push({key:"AddAttachment",hideInGroup:!1}),t.push({key:"AddInlineImage",hideInGroup:!1}),(0,oe.U)("MailCompose")&&t.push({key:"FluidHeroButton",hideInGroup:!1,hideInMailSurfaceSettings:!0}),t.push({key:"AddEmoji",hideInGroup:!1}),(0,X.cr)("cal-native-findtime")&&!(0,W.Z)(void 0,e)&&t.push({key:"FindTime",hideInGroup:!1}),(0,te.r)()&&t.push({key:"ProofingOptions",hideInGroup:!1}),((0,ce.o2)()||(0,ce.yp)())&&(0,X.cr)("cmp-dictation")&&t.push({key:"ToggleDictation",hideInGroup:!1}),t=t.concat([{key:"ToggleRibbon",hideInGroup:!1},{key:"SaveDraft",hideInGroup:!1},{key:"InsertSignature",hideInGroup:!1},{key:"ShowFrom",hideInGroup:!1},{key:"SetImportance",hideInGroup:!1},{key:"SwitchBodyType",hideInGroup:!1},{key:"AccChecker",hideInGroup:!1}]),(0,X.cr)("cmp-clp")&&!(0,W.Z)(void 0,e)&&t.push({key:"SensitivityMenu",hideInGroup:!1}),(0,re.Z)()&&t.push({key:"ProtectMessage",hideInGroup:!1}),(0,ne.Z)()&&t.push({key:"ShowMessageOptions",hideInGroup:!1}),(0,X.cr)("mos-messageExtensionsFlyout")&&!(0,X.cr)("mon-ribbon")&&t.push({key:"MessageExtensions"}),t.push({key:"CustomizeActions",hideInGroup:!1,hideInMailSurfaceSettings:!0}),t}function he(e){return"Reply"==e||"ReplyAll"==e||"Forward"==e||"MessageExtensions"==e}function fe(e){return-1!==(0,se.Bb)(se.Xm.SurfaceActions).readSurfaceActions.indexOf(e)}function ge(e,t){return fe(e)||!(!(0,X.cr)("rp-csaPinnedLikes")||(0,X.cr)("rp-reactions")||"LikeUnlike"!==e||!t.LikeCount)||!("ToggleDarkMode"!==e||!(0,le.BR)())||!("SetReaction"!==e||!(0,X.cr)("rp-reactions"))||!("MessageExtensions"!==e||!(0,X.cr)("mos-messageExtensionsFlyout"))}var ve=n(874191);function ye(e,t,n,i){let r;i?r=i:(r="Pinned",(null==n?void 0:n.renderedInOverflow)&&(r=n.isPinned?"Overflow":"NotPinned")),(0,ve.y8)(e?"CSACountComposeUserAction":"CSACountReadUserAction",[t,r])}function Se(e){var t,n;null===(n=null===(t=e.subMenuProps)||void 0===t?void 0:t.items)||void 0===n||n.forEach((e=>{e.renderedInOverflow=!0}))}function be(e){var t,n;null===(n=null===(t=e.subMenuProps)||void 0===t?void 0:t.items)||void 0===n||n.forEach((e=>{e.renderedInOverflow=!1}))}var Ie=n(308631);function we(e){const t=(0,Ie.Bb)(Ie.Xm.SurfaceActions);return!["SetDictationLanguage","ProofingOptions"].includes(e)&&t.composeSurfaceActions.includes(e)||t.composeSurfaceAddins.includes(e)||["ToggleDarkCompose","AddClassicAttachment","InsertLink","FluidHeroButton","MessageExtensions"].includes(e)}},536214:(e,t,n)=>{"use strict";n.d(t,{zD:()=>q,EE:()=>H,nS:()=>W});var i=n(843784),r=n(503361),o=n(517441),s=n(95391),a=n(918305),l=n(319752),c=n(63255),d=n(662260),u=n(187900),p=n(569295),m=n(170108),h=n(957913),f=n(635344),g=n(585187),v=n(464610),y=n(117723);const S=(0,v.M)("MailErrorRegular",y.DQw),b=(0,v.M)("MailWarningRegular",y.RxI);var I=n(896500),w=n(135206),C=n(553531),E=n(201910),P=n(68034);const T=(0,v.M)("BranchRegular",P.eDh);var R=n(315902);const x=(0,v.M)("WindowNewRegular",R.T0);var k=n(338815),N=n(184529);const A=(0,v.M)("NotePinRegular",y.KbG);var D=n(683205);const Z=(0,v.M)("PersonChatRegular",D.H6J);var M=n(325552),O=n(281342);const F=(0,v.M)("ArrowDownloadRegular",O.hAs);var _=n(367397),L=n(962569),z=n(327013);const B="attach.svg",V="inlineimage.svg",U="showribbon.svg";function q(e){let t,n,r=!1,o=!1;switch(e){case"AddAttachment":t=(0,z.Z)((0,i.BR)()?"attachDark.svg":B),n=(0,z.Z)(B),r=!0;break;case"AddInlineImage":t=(0,z.Z)((0,i.BR)()?"inlineimageDark.svg":V),n=(0,z.Z)(V),r=!0;break;case"AddEmoji":t=(0,z.Z)("emoji.svg"),r=!0;break;case"ToggleDarkCompose":t="Sunny";break;case"FluidHeroButton":t=(0,L.v)(),r=!0;break;case"QuickUse":t="ClipboardList";break;case"ToggleDictation":t=(0,z.Z)("dictate.svg"),r=!0;break;case"SetDictationLanguage":t=(0,z.Z)("dictationLanguage.svg"),r=!0;break;case"ToggleRibbon":t=(0,z.Z)((0,i.BR)()?"showribbonDark.svg":U),n=(0,z.Z)(U),r=!0;break;case"SensitivityMenu":t="MarkAsProtected";break;case"ProtectMessage":t="Encryption";break;case"SaveDraft":t="Save";break;case"InsertSignature":t="InsertSignatureLine";break;case"ShowFrom":t="ArrangeByFrom";break;case"SetImportance":t="Important";break;case"ShowMessageOptions":t="MailOptions";break;case"SwitchBodyType":t="PlainText";break;case"AccChecker":t="AccessibiltyChecker";break;case"ProofingOptions":t=(0,z.Z)("spelling.svg"),r=!0;break;case"FindTime":t=M.Z,o=!0;break;case"MessageExtensions":t=_.Z,o=!0;break;default:t=""}return{iconName:t,fallbackIconName:n||t,isImage:r,isFluentIcon:o}}function W(e){let t;switch(e){case"-":t="-";break;case"Reply":t=r.Z;break;case"ReplyAll":t=o.Z;break;case"Forward":t=s.Z;break;case"ForwardEmailAsAttachment":t=I.Z;break;case"ReplyByMeeting":t=p.Z;break;case"ReportAbuse":t=m.Z;break;case"Delete":t=l.Z;break;case"MarkReadUnread":t=h.Z;break;case"FlagUnflag":t=c.Z;break;case"AssignPolicy":t=f.Z;break;case"AddToSafeSenders":t=g.Z;break;case"MarkJunkNotJunk":t=S;break;case"MarkAsPhishing":t=b;break;case"Block":t=w.Z;break;case"CreateRule":t=u.Z;break;case"Print":t=C.Z;break;case"Translate":t=d.Z;break;case"ShowInImmersiveReader":t=E.Z;break;case"ViewMessageSource":t=T;break;case"Popout":t=x;break;case"LikeUnlike":t=k.Z;break;case"SetReaction":t=a.Z;break;case"ToggleDarkMode":t=N.Z;break;case"ReplyByIM":case"ReplyAllByIM":t=Z;break;case"ToggleAmp":t="LightningBolt";break;case"AddToBoard":t=A;break;case"MessageExtensions":t=_.Z;break;case"PlayThisConversation":t="MSNVideos";break;case"Download":t=F;break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}function H(e){let t;switch(e){case"-":t="-";break;case"Delete":t="Delete";break;case"Archive":t="Archive";break;case"PinUnpin":t="Pinned";break;case"ReadUnread":t="Mail";break;case"FlagUnflag":t="Flag";break;case"Move":t="FabricFolder";break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}},327013:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(808386);function r(e){return(0,i.F)("surfaceActions/"+e)}},936242:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(964659);function r(){return!(0,i.uf)()}},774676:(e,t,n)=>{"use strict";n.d(t,{H:()=>o});const i=["\t","\n","\v","\f","\r"," ","","","","","","","","","","","","","","","\u2028","\u2029","","","","","","","","","","\u2028","\u2029","","","","","","","","","","",""];let r=null;const o=e=>{if(!e)return!0;null===r&&(r=new Set,i.forEach((e=>r.add(e))));return e.split("").every((e=>r.has(e)))}},678356:(e,t,n)=>{"use strict";n.d(t,{yo:()=>o,nA:()=>s,ze:()=>a,T$:()=>l,py:()=>c,hP:()=>d,$I:()=>u,LM:()=>p,ez:()=>m,Rk:()=>h,fV:()=>f,hn:()=>g,kK:()=>v,$7:()=>y,dm:()=>S,wo:()=>b,Ln:()=>I,N_:()=>w,oL:()=>C,DZ:()=>E,Xq:()=>P,Uv:()=>T});var i=n(717420);const r=new i.nI((()=>n.e(94932).then(n.bind(n,894932)))),o=new i._5(r,(e=>e.logEntityClicked)),s=new i._5(r,(e=>e.logResponseReceived)),a=new i._5(r,(e=>e.logSessionEnd)),l=new i._5(r,(e=>e.logResponseRendered)),c=new i._5(r,(e=>e.logSearchBoxStateChanged)),d=new i._5(r,(e=>e.logSearchResultInteraction)),u=new i._5(r,(e=>e.logResponseNeverRendered)),p=new i._5(r,(e=>e.flushNonRenderedResponseReceivedItemsFromCache)),m=new i._5(r,(e=>e.logCachedContentRendered)),h=(new i._5(r,(e=>e.logFeedback)),new i._5(r,(e=>e.logClientLayout))),f=new i._5(r,(e=>e.logClientDataSource)),g=new i._5(r,(e=>e.logEntitiesFromFilePicker)),v=new i._5(r,(e=>e.logResponseRecievedV2)),y=new i._5(r,(e=>e.logResultsRendered)),S=new i._5(r,(e=>e.logSearchEntityActions)),b=new i._5(r,(e=>e.logSearchFeedbackActions)),I=new i._5(r,(e=>e.logSearchActions)),w=new i._5(r,(e=>e.logSecondaryEntityActionClicked)),C=new i._5(r,(e=>e.clearProcessedTraceIds)),E=new i._5(r,(e=>e.logSearchSuggestionsClientLayoutEvent)),P=new i._5(r,(e=>e.logSearchSuggestionsResultsRenderedEvent)),T=new i._5(r,(e=>e.logSearchSuggestionsCachedContentRenderedEvent))},624574:(e,t,n)=>{"use strict";var i;function r(e){return Object.assign({},e)}function o(e){return Object.assign({},e)}function s(e){return Object.assign({},e)}function a(e){return Object.assign({},e)}function l(e){return Object.assign({},e)}function c(e){return Object.assign({},e)}n.d(t,{D9:()=>i,yY:()=>r,H$:()=>o,IP:()=>s,ny:()=>a,MI:()=>l,Y7:()=>c}),function(e){e.PrimaryMailbox="PrimaryMailbox",e.ArchiveMailbox="ArchiveMailbox",e.SharedFolders="SharedFolders",e.Group="Group",e.Calendar="Calendar",e.PublicFolder="PublicFolder",e.MetaOSApp="MetaOSApp"}(i||(i={}))},816958:(e,t,n)=>{"use strict";var i;n.d(t,{Z:()=>i,C:()=>r}),function(e){e.Mail="owa.react",e.MailCompose="owa.react.compose",e.Calendar="owa.react.calendar",e.FilesHub="owa.react.filesHub",e.MailSubject="owa.react.mail.subject",e.MailEmailAttachmentPicker="owa.react.mail.emailPicker",e.SuggestedAttachments="suggestedattachments",e.MeetingPrep="MeetingPrep",e.MeetingPrepPrefetch="MeetingPrep.Prefetch",e.MeetingPrepPeek="MeetingPrep.Peek",e.MeetingPrepReminder="MeetingPrep.Reminder",e.MeetingPrepAgenda="MeetingPrep.AgendaView",e.MeetingPrepMailCalendarCard="MeetingPrep.MailCalendarCard",e.MeetingPrepDesktop="OutlookDesktopOPX.MeetingPrep",e.MeetingPrepShell="ShellOPX.MeetingPrep",e.ContextualInsights="ContextualInsights",e.FileSuggestions="owa.react.filepicker",e.SonoraFilePicker="outlook.inlinefilepicker",e.SonoraHoneybee="owa.honeybee",e.ContextIQ="outlook.web.oa"}(i||(i={}));const r=i},744157:(e,t,n)=>{"use strict";n.d(t,{K:()=>l,P:()=>s});var i=n(717420),r=n(126573),o=n(55461);function s(){return!!(0,o.cr)("mc-editor-oa")}const a=new i.nI((()=>Promise.all([n.e(52637),n.e(32557),n.e(56337),n.e(64826),n.e(72760),n.e(28358),n.e(63816),n.e(7181),n.e(48139),n.e(95397),n.e(63684),n.e(63673),n.e(60156),n.e(82502),n.e(78836),n.e(37716),n.e(767),n.e(90908),n.e(36087),n.e(69325)]).then(n.bind(n,9588)))),l=(0,r.Z)(a,(e=>e.OAPlugin),"OA")},56558:(e,t,n)=>{"use strict";n.d(t,{c:()=>o,y:()=>s});var i=n(55461),r=n(528368);function o(){return(0,i.cr)("honeybee-sonora-file")&&(0,r.m)(!1)}function s(){return(0,i.cr)("honeybee-sonora-mentions-files")&&(0,r.m)(!1)}},233146:(e,t,n)=>{"use strict";n.d(t,{xu:()=>d,F3:()=>a,n:()=>l});var i=n(717420),r=n(126573),o=n(56558),s=n(55461);function a(){return!(0,s.cr)("mc-editor-oa")&&(0,s.cr)("honeybee-sonora")&&(0,s.cr)("honeybee-sonora-mentions-plugin")&&(0,o.y)()}function l(){return(0,s.cr)("honeybee-sonora")&&(0,s.cr)("honeybee-sonora-mentions-plugin-calendar")&&(0,o.y)()}const c=new i.nI((()=>Promise.all([n.e(3918),n.e(52637),n.e(56337),n.e(9598),n.e(72760),n.e(28358),n.e(63816),n.e(7181),n.e(60156),n.e(767),n.e(90908),n.e(545),n.e(79445),n.e(46688),n.e(14773),n.e(45087),n.e(665),n.e(37330),n.e(47877),n.e(51858)]).then(n.bind(n,935942)))),d=(0,r.Z)(c,(e=>e.SonoraMentionsPlugin),"SonoraMentions",(e=>11==e.eventType));(0,i.$y)(c,(e=>e.TeachingBubbleCallout))},972506:(e,t,n)=>{"use strict";n.d(t,{gX:()=>i,Pg:()=>s,um:()=>a,ZK:()=>l});var i,r=n(964659),o=n(233762);function s(){const e=d();return c()&&e?i.ToDo:function(){var e;const t=(0,r.c6)();return!(0,o._A)()&&!(null===(e=t.SessionSettings)||void 0===e?void 0:e.IsShadowMailbox)}()&&!e?i.LegacyTasks:i.None}function a(){return c()&&d()}function l(){return c()&&d(!0)}function c(){var e,t;const n=(0,r.c6)(),i=null===(e=n.SessionSettings)||void 0===e?void 0:e.IsExplicitLogon,o=null===(t=n.SessionSettings)||void 0===t?void 0:t.IsShadowMailbox;return!i&&!o}function d(e){const t=(0,r.c6)(),n=t.UserOptions,i=t.PolicySettings;return!(!(null==n?void 0:n.ReactOptinSettings)||!(n.ReactOptinSettings.TasksGraduatedFromBeta||n.ReactOptinSettings.TasksEnabled&&(e||function(e){var t;return(null===(t=null==e?void 0:e.ReactOptinSettings)||void 0===t?void 0:t.TasksShouldUseSharedToggle)?1!==e.ClientTypeOptInState:1!==e.TasksClientTypeOptInState}(n))&&function(e){if(e&&!1===e.OutlookBetaToggleEnabled)return!1;return!0}(i))||null===n.ReactOptinSettings.TasksRedirectUrl)}!function(e){e[e.None=0]="None",e[e.LegacyTasks=1]="LegacyTasks",e[e.ToDo=2]="ToDo"}(i||(i={}))},66621:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i.Z,b:()=>i.b});var i=n(785116)},785116:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s,b:()=>a});var i=n(559621),r=n(371134);const o={viewStates:new i.ObservableMap,primaryComposeId:null,newMessageCreationInProgress:!1,shouldUseFallbackPeoplePicker:!1},s=(0,r.MT)("compose",o)(),a=()=>s},126875:(e,t,n)=>{"use strict";function i(e,t){return e.mailboxInfo?e.mailboxInfo:"function"==typeof t?t():t}n.d(t,{X:()=>i})},159686:(e,t,n)=>{"use strict";function i(e){return 5===e.operation||6===e.operation}n.d(t,{Z:()=>i})},494711:(e,t,n)=>{"use strict";function i(e){return r(e)&&(2==(t=e).operation||t.toRecipientWell.recipients.some((e=>e.persona.EmailAddress.EmailAddress.toLowerCase()===t.groupId.toLowerCase())));var t}function r(e){return!!e.groupId}n.d(t,{_:()=>i,Z:()=>r})},308881:(e,t,n)=>{"use strict";function i(e){return void 0!==e.publicFolderId}n.d(t,{Z:()=>i})},942278:(e,t,n)=>{"use strict";function i(e){return void 0!==e.isInSharedFolder}n.d(t,{Z:()=>i})},547231:(e,t,n)=>{"use strict";var i;n.d(t,{H:()=>i}),function(e){e[e.None=0]="None",e[e.FileSuggestion=1]="FileSuggestion",e[e.LocalFiles=2]="LocalFiles",e[e.CloudFiles=3]="CloudFiles",e[e.UploadAndShare=4]="UploadAndShare"}(i||(i={}))},829018:(e,t,n)=>{"use strict";n.d(t,{r:()=>i});const i=(0,n(371134).aD)("clearDefaultOptions")},855079:(e,t,n)=>{"use strict";n.d(t,{K:()=>i});const i=(0,n(371134).aD)("clearDefaultPaneOptions")},711514:(e,t,n)=>{"use strict";n.d(t,{Y:()=>i});const i=(0,n(371134).aD)("setCategoryNameWithId",((e,t)=>({id:e,name:t})))},591035:(e,t,n)=>{"use strict";n.d(t,{n:()=>i});const i=(0,n(371134).aD)("setDefaultOptionWithId",((e,t,n)=>({id:e,categoryId:t,critiqueTypeInfo:n})))},144869:(e,t,n)=>{"use strict";n.d(t,{x:()=>i});const i=(0,n(371134).aD)("setDefaultPaneOptionWithId",((e,t,n)=>({id:e,categoryId:t,critiqueTypeInfo:n})))},446729:(e,t,n)=>{"use strict";n.d(t,{$:()=>i});const i=(0,n(371134).aD)("setOptionsLoadState",(e=>({loadState:e})))},743013:(e,t,n)=>{"use strict";n.d(t,{D:()=>i});const i=(0,n(371134).aD)("updateUserOptions",(e=>({options:e})))},151068:(e,t,n)=>{"use strict";n.d(t,{L:()=>o});var i=n(371134),r=n(6384);const o=(0,i.lr)("setDefaultOptionsEditor",((e,t,n)=>{(0,r.Z)().defaultOptionsEditor.set(e,{critiqueTypeInfo:n,categoryId:t})}))},117648:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(6384),r=n(373417),o=n(289408);function s(e){const t=(0,i.Z)();t.optionsLoadState===r.Z.NotLoaded||t.optionsLoadState===r.Z.Loading?(0,o.h)((()=>{e&&e((0,i.Z)().userOptions)})):t.optionsLoadState===r.Z.Loaded&&e&&e((0,i.Z)().userOptions)}},383026:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>S,x6:()=>b});var i=n(491176),r=n(75517),o=n(99391),s=n(591035),a=n(144869),l=n(711514),c=n(151068),d=n(829018),u=n(855079),p=n(874191),m=n(325876),h=n(233762),f=n(55461),g=n(8106);const v=new Set(["923cc720-1624-4973-946a-30a0c6ec4163","f21cd9e9-00c6-4827-94d5-163078fa3215","7f6d979b-d0de-4367-aa9d-589b5134b7a6","6bdf8d88-1ed5-4506-9b5f-a17e7f8c2a48"]);async function y(e,t,n){const s=new i.GX({baseUri:(0,h.sj)()?"https://nleditor.osi.officeppe.net":"https://nleditor.osi.office.net"});s.xUserSessionId=(0,m.MQ)();const a="mc-officeEditorTonalEnabled",l="mc-officeEditorDNNGrammarEnabled",c="mc-officeEditorDNNGrammarEnabledcf",d=[{name:"LicenseType",value:t?o.o.Subscription:(0,o.Z)()},{name:"Audience",value:I()}],u=[];(0,f.cr)(a)&&u.push(a),(0,f.cr)(l)?u.push(l):(0,f.cr)(c)&&u.push(c),u.length>0&&d.push({name:"FlightIds",value:u.join(";")});const g=await s.configV2({appId:"Outlook_Online",languageId:e,descriptors:d,runOnProfileId:n});return(null==g?void 0:g.responseStatus)===r.Mx.Success?g.critiqueCategoryInfoList:((0,p.y8)("EditorProofingCallFailed",{locale:e}),Promise.resolve([]))}async function S(e){const t=(0,o.Z)()===o.o.Subscription,n=await y(e,!0),i=(0,g.Mz)()&&(0,g.Ou)()&&(0,g.HE)();if((0,f.cr)("mc-editor-multilingual-proofing")||(0,d.r)(),null==n||n.forEach((e=>{const n=e.name,r=e.id,o=e.critiqueTypeInfoList;(0,l.Y)(r,n),null==o||o.forEach((e=>{(0,s.n)(e.id,r,e)})),t&&(null==o||o.forEach((e=>{const t=i&&2===e.critiquePriority&&"a9bbf01c-9bc7-4b4a-aab3-73c336cb1e22"!==r?0:e.defaultCritiqueValue;(0,c.L)(e.id,r,Object.assign(Object.assign({},e),{defaultCritiqueValue:t}))})))})),!t){const t=await y(e,!1);null==t||t.forEach((e=>{const t=e.id,n=e.critiqueTypeInfoList;null==n||n.forEach((e=>{(0,c.L)(e.id,t,e)}))}))}}async function b(e){const t=(0,o.Z)()===o.o.Subscription,n=await y(e,!0,"94BAB765-5034-1023-A1B2-08B56C6BAD43");(0,f.cr)("mc-editor-multilingual-proofing")||(0,u.K)(),null==n||n.forEach((e=>{const n=e.id,i=e.critiqueTypeInfoList;null==i||i.forEach((e=>{(t||2===e.critiquePriority)&&(0,a.x)(e.id,n,e),v.has(e.id)&&(e.defaultCritiqueValue=0)}))}))}function I(){switch((0,m.nr)()){case"Dogfood":return"Dogfood";case"Microsoft":return"Microsoft";default:return"Production"}}},481539:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(769367),r=n(743013),o=n(101060),s=n(559621),a=n(448259);async function l(){const e=await i.tR.import(),t=await e(i.Xm.Proofing),n=await e(i.Xm.ComposeAssistance),{overriddenOptions:o,overriddenCategories:l,sharedUserSettings:d}=function(e){var t;const n=new s.ObservableMap,i=new s.ObservableMap;let r;if(e)try{const o=JSON.parse(e);null===(t=null==o?void 0:o.options)||void 0===t||t.forEach((e=>{n.set(e.id,e)})),(null==o?void 0:o.categories)&&i.merge(null==o?void 0:o.categories),o.sharedUserSettings&&(r=o.sharedUserSettings)}catch(e){a.g4.warn(`[owa-proofing-option] Error parsing overriddenOptions ${e.message}`)}return{overriddenOptions:n,overriddenCategories:i,sharedUserSettings:r}}(null==t?void 0:t.overriddenOptions);(0,r.D)({overriddenOptions:o,overriddenCategories:l,spellCheckEnabled:t.spellCheckEnabled,grammarEnabled:t.grammarEnabled,writingRefinementsEnabled:!0,proofingLocale:c(t),textPredictionEnabled:n.composeAssistanceEnabled,finalDatePremiumDemo:t.finalDatePremiumDemo,premiumSuggestionsCount:t.premiumSuggestionsCount,startDatePremiumPreview:t.startDatePremiumPreview,weekCounter:t.weekCounter,sharedUserSettings:d,isTonalFreExperienceEnabled:t.isTonalFreExperienceEnabled,isEditorIndicatorEnabled:t.isEditorIndicatorEnabled,isToneEnabledInEditorIndicator:t.isToneEnabledInEditorIndicator,shouldShowIndicatorButton:t.shouldShowIndicatorButton})}function c(e){return e.proofingLocale||(0,o.gG)()}},373417:(e,t,n)=>{"use strict";var i;n.d(t,{Z:()=>r}),function(e){e[e.NotLoaded=0]="NotLoaded",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded"}(i||(i={}));const r=i},6384:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(373417),r=n(559621);const o=(0,n(371134).MT)("proofingConfig",{defaultPaneOptionsEditor:new r.ObservableMap,defaultOptionsUI:new r.ObservableMap,defaultOptionsEditor:new r.ObservableMap,optionsLoadState:i.Z.NotLoaded,critiqueTypeCategoryNames:new r.ObservableMap,userOptions:{overriddenOptions:new r.ObservableMap,overriddenCategories:new r.ObservableMap,spellCheckEnabled:void 0,grammarEnabled:void 0,proofingLocale:void 0,textPredictionEnabled:void 0,writingRefinementsEnabled:void 0,finalDatePremiumDemo:void 0,sharedUserSettings:void 0,isTonalFreExperienceEnabled:void 0,isEditorIndicatorEnabled:void 0,isToneEnabledInEditorIndicator:void 0,shouldShowIndicatorButton:void 0},settingsDialogViewState:{overriddenOptions:new r.ObservableMap,overriddenCategories:new r.ObservableMap,spellCheckEnabled:void 0,grammarEnabled:void 0,proofingLocale:void 0,textPredictionEnabled:void 0,writingRefinementsEnabled:void 0,finalDatePremiumDemo:void 0,sharedUserSettings:void 0,isTonalFreExperienceEnabled:void 0,isEditorIndicatorEnabled:void 0,isToneEnabledInEditorIndicator:void 0},premiumTemporarilyEnabled:!1})},107269:(e,t,n)=>{"use strict";n.d(t,{n:()=>o});var i=n(55461),r=n(101060);function o(){return!(!function(){const e=(0,r.gG)();return"en-US"===e||"en-CA"===e||"en-MX"===e}()||!(0,i.cr)("mc-alTextPredictionUX")&&!(0,i.cr)("mc-alTextPredictionUXCalendar"))}},99391:(e,t,n)=>{"use strict";n.d(t,{o:()=>d,Z:()=>u});var i=n(39799),r=n(954947),o=n(448259),s=n(723031),a=n(964659),l=n(226362);const c="OfficeProPlus";var d;function u(){var e,t;if((0,s.w)())return d.NoLicense;if((0,r.Z)()){const t=(0,a.c6)();return(0,a.Wn)((0,l.B6)())||(null===(e=null==t?void 0:t.SessionSettings)||void 0===e?void 0:e.IsShadowMailbox)?d.Subscription:d.NoLicense}{const e=(0,i.Ac)();try{if(null==e?void 0:e.ClientData){const n=JSON.parse(e.ClientData);return(t=null==n?void 0:n.ActiveExperiences)&&t.split(",").some((e=>e===c))?d.Subscription:d.NoLicense}}catch(e){o.g4.warn("Error parsing bposClientData ActiveExperiences: "+(null==e?void 0:e.message))}}return d.NoLicense}!function(e){e.NoLicense="NoLicense",e.Perpetual="Perpetual",e.Subscription="Subscription"}(d||(d={}))},723031:(e,t,n)=>{"use strict";n.d(t,{w:()=>r});var i=n(55461);function r(){return(0,i.cr)("mc-officeEditorFakeFreeConsumer")}},448165:(e,t,n)=>{"use strict";n.d(t,{i:()=>o});var i=n(535307);const r=["af","af-ZA","ar","ar-AE","ar-BH","ar-DZ","ar-EG","ar-IQ","ar-JO","ar-KW","ar-LB","ar-LY","ar-MA","ar-OM","ar-QA","ar-SA","ar-SY","ar-TN","ar-YE","as","az-Latn-AZ","as-IN","bg","bg-BG","bn","bn-BD","bn-IN","bs-Latn-BA","ca","ca-ES","ca-ES-valencia","cs","cs-CZ","cy","cy-GB","da","da-DK","de","de-AT","de-CH","de-DE","de-LI","de-LU","el","el-GR","en","en-029","en-AU","en-BZ","en-CA","en-GB","en-HK","en-ID","en-IE","en-IN","en-JM","en-MY","en-NZ","en-PH","en-SG","en-TT","en-US","en-ZA","en-ZW","es","es-419","es-AR","es-BO","es-CL","es-CO","es-CR","es-DO","es-EC","es-ES","es-ES_tradnl","es-GT","es-HN","es-MX","es-NI","es-PA","es-PE","es-PR","es-PY","es-SV","es-US","es-UY","es-VE","et","et-EE","eu","eu-ES","fa","fa-IR","fi","fi-FI","fr","fr-BE","fr-CA","fr-CD","fr-CH","fr-CI","fr-CM","fr-FR","fr-HT","fr-LU","fr-MA","fr-MC","fr-ML","fr-RE","fr-SN","ga","ga-IE","gd","gd-GB","gl","gl-ES","gu","gu-IN","ha","ha-Latn-NG","he","he-IL","hi","hi-IN","hr","hr-BA","hr-HR","hu","hu-HU","hy","hy-AM","id","id-ID","ig","ig-NG","is","is-IS","it","it-CH","it-IT","ka","ka-GE","kk","kk-KZ","kn","kn-IN","ko","ko-KR","kok","kok-IN","ky","ky-KG","lb","lb-LU","lt","lt-LT","lv","lv-LV","mi","mi-NZ","mk","mk-MK","ml","ml-IN","mr","mr-IN","ms","ms-BN","ms-MY","mt","mt-MT","nb-NO","ne","ne-IN","ne-NP","nl","nl-BE","nl-NL","nn-NO","nso","nso-ZA","or","or-IN","pa","pa-IN","pl","pl-PL","ps","ps-AF","pt-BR","pt-PT","rm","rm-CH","ro","ro-MD","ro-RO","ru","ru-MD","ru-RU","rw","rw-RW","si","si-LK","sk","sk-SK","sl","sl-SI","sq","sq-AL","sr-Cyrl-BA","sr-Cyrl-CS","sr-Cyrl-ME","sr-Cyrl-RS","sr-Latn-BA","sr-Latn-CS","sr-Latn-ME","sr-Latn-RS","sv","sv-FI","sv-SE","sw","sw-KE","ta","ta-IN","te","te-IN","th","th-TH","tn","tn-BW","tn-ZA","tr","tr-TR","tt","tt-RU","uk","uk-UA","ur","ur-IN","ur-PK","uz","uz-Latn-UZ","vi","vi-VN","wo","wo-SN","xh","xh-ZA","yo","yo-NG","zu","zu-ZA","en-CB","ja-JP","zh-CN","zh-TW"];function o(e){var t;return e?null===(t=(0,i.V_)(e))||void 0===t?void 0:t.some((e=>r.includes(e))):null}},289408:(e,t,n)=>{"use strict";n.d(t,{h:()=>u});var i=n(446729),r=n(383026),o=n(481539),s=n(373417),a=n(6384),l=n(448259),c=n(535307);let d=null;async function u(e){await function(){switch((0,a.Z)().optionsLoadState){case s.Z.Loading:return l.g4.info("[owa-proofing-options] Options already loading. Returning promise"),d||Promise.reject();case s.Z.Loaded:return l.g4.info("[owa-proofing-options] Options already loaded. Resolving promise"),Promise.resolve();case s.Z.NotLoaded:default:return l.g4.info("[owa-proofing-options] Options not loaded yet. Returning new promise"),(0,i.$)(s.Z.Loading),d=new Promise((e=>{(async function(){var e;try{const t=(0,a.Z)();await(0,o.Z)();const n=null!==(e=(0,c.V_)(t.userOptions.proofingLocale))&&void 0!==e?e:[];return await Promise.all(n.map((e=>(0,r.ZP)(e))).concat(n.map((e=>(0,r.x6)(e))))),l.g4.info("[owa-proofing-options] Options finished loading"),void(0,i.$)(s.Z.Loaded)}catch(e){l.g4.warn("[owa-proofing-options] Options failed to load")}(0,i.$)(s.Z.NotLoaded)})().then((()=>{d=null,e()}))}))}}(),e&&e()}},535307:(e,t,n)=>{"use strict";n.d(t,{V_:()=>i,qy:()=>r,i:()=>o});function i(e){return null==e?void 0:e.split(";")}function r(e){return null==e?void 0:e.split(";")[0]}function o(e){return e.slice(0,3).join(";")}},398751:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(552542),r=n(55461);function o(){var e;return(0,r.cr)("cmp-roaming-signature")&&!(null===(e=(0,i.Z)().SessionSettings)||void 0===e?void 0:e.IsExplicitLogon)}},459492:(e,t,n)=>{"use strict";n.d(t,{b:()=>o});var i=n(559621);const r=(0,n(371134).MT)("optionsViewState",{isFullOptionsShown:!1,areAllAllowedSubCategoriesLoaded:!1,isSaving:!1,currentCategoryKey:void 0,currentSubCategoryKey:void 0,subCategoryLoadState:new i.ObservableMap,currentOptionKey:void 0,allowedOptions:[],dirtyOptions:[]})(),o=()=>r},812537:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).aD)("mountFullOptions",((e,t,n)=>({category:e,subcategory:t,option:n})))},851532:(e,t,n)=>{"use strict";n.d(t,{f4:()=>h,So:()=>m,Y8:()=>a,RQ:()=>u,Et:()=>p,pN:()=>d,Ez:()=>c});var i=n(447424),r=n(717420),o=n(812537),s=n(459492);function a(){const e=(0,s.b)();return{isFullOptionsShown:e.isFullOptionsShown,areAllAllowedSubCategoriesLoaded:e.areAllAllowedSubCategoriesLoaded,currentCategoryKey:e.currentCategoryKey,currentSubCategoryKey:e.currentSubCategoryKey,currentOptionKey:e.currentOptionKey}}const l=new r.nI((()=>Promise.all([n.e(25671),n.e(3918),n.e(52637),n.e(32557),n.e(39006),n.e(18838),n.e(16025),n.e(19280),n.e(33615),n.e(17483),n.e(56337),n.e(69390),n.e(11102),n.e(56841),n.e(62600),n.e(90885),n.e(3128),n.e(36856),n.e(62199),n.e(88131)]).then(n.bind(n,885777)))),c=new r._5(l,(e=>e.mountAndShowFullOptions)),d=new r.EF(l,(e=>e.hideFullOptions)),u=new r.EF(l,(e=>e.confirmDirtyOptionsAndPerformAction)),p=new r.EF(l,(e=>e.exitOptionsFullPage));var m=(0,i.h)(l,(e=>e.QuickOptions));const h=(0,r.$y)(l,(e=>e.ProjectionOptionsFull));(0,r.Kv)(o.Z,l,(e=>e.mountFullOptionsOrchestrator))},364332:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(52637),n.e(18358)]).then(n.bind(n,18358)))),o=(0,i.$y)(r,(e=>e.LazyAnnounced))},973218:(e,t,n)=>{"use strict";n.d(t,{Ds:()=>r,KV:()=>d,h3:()=>u});const i=function(e,t){var n,i;if(e.ExtendedProperty)for(let r=0;r<e.ExtendedProperty.length;r++){const o=e.ExtendedProperty[r];if((null===(n=null==o?void 0:o.ExtendedFieldURI)||void 0===n?void 0:n.PropertyTag)===t||(null===(i=null==o?void 0:o.ExtendedFieldURI)||void 0===i?void 0:i.PropertyName)===t)return o.Value}},r=e=>{const t=i(e,"SourceWellKnownFolderType");switch(t&&parseInt(t,10)||-1){case 86:return"REMOTE_DISTINGUISHED_FOLDER_TYPE_ARCHIVE";case 87:return"REMOTE_DISTINGUISHED_FOLDER_TYPE_IMPORTANT";case 88:return"REMOTE_DISTINGUISHED_FOLDER_TYPE_STARRED";default:return"REMOTE_DISTINGUISHED_FOLDER_TYPE_UNSPECIFIED"}},o=e=>i(e,"0x7018")||null,s=e=>"false"!==i(e,"0x10f4");var a=n(210399);var l=n(414691),c=n(448259);function d(e,t,n,r){var o;const a=e.RootFolder;if(!a||!a.Folders||!a.ParentFolder)throw new Error("mapFindFolderResponseToGql: failed to get folders");const c=(null===(o=null==a?void 0:a.ParentFolder)||void 0===o?void 0:o.DistinguishedFolderId)||"none",d=[];null==a||a.Folders.forEach((e=>{if(e&&function(e,t,n,r){if(r){if("SearchFolder:#Exchange"!=(null==e?void 0:e.__type)||"true"===i(e,"0x361f"))return!1}else if(!function(e){return"Folder:#Exchange"==e}(null==e?void 0:e.__type))return!1;if((null==e?void 0:e.DistinguishedFolderId)&&l.V6.indexOf(e.DistinguishedFolderId)>=0)return!1;if(s(e))return!1;if("clutter"===e.DistinguishedFolderId&&0===e.TotalCount)return!1;if("junkemail"===e.DistinguishedFolderId)return!!t;if("notes"===e.DistinguishedFolderId)return!!n;return!0}(e,n,r,c==l.Ry)){const n=u(e,t);n&&d.push(n)}}));const p=function(e,t){return"SharedMailbox"===t?void 0:e}(c,t.type);a.ParentFolder.DistinguishedFolderId=p;const m=u(a.ParentFolder,t);return{__typename:"FolderHierarchyResult",Folders:d,RootFolder:m,offset:a.IndexedPagingOffset,TotalItemsInView:a.TotalItemsInView,IncludesLastItemInRange:a.IncludesLastItemInRange}}function u(e,t){const n=e,{FolderId:s,ParentFolderId:l,DisplayName:d,ArchiveTag:u,PolicyTag:f,ChildFolderCount:g,UnreadCount:v,TotalCount:y,FolderClass:S,DistinguishedFolderId:b}=n;if(!s||!l)return c.g4.warn("mapOWSFolderToGql: ignoring folder with missing folderId or missing parentFolderId"),null;const I=g||0,w=m(s),C=function(e){const t=i(e,a.s);if(t){const e=atob(t);return[e.substr(0,e.length-1)]}return null}(n);return{id:w.Id,changeKey:w.ChangeKey,__typename:"MailFolder",type:n.__type,parentFolderId:m(l).Id,displayName:d||"",distinguishedFolderType:b||null,FolderClass:S||"IPF.Note",UnreadCount:v||0,totalMessageCount:y||0,ArchiveTag:u?h(u):null,PolicyTag:f?h(f):null,childFolderCount:I,remoteFolderInfo:{remoteFolderDisplayName:o(n),remoteDistinguishedFolderType:r(n)},replicaList:C,PermissionSet:n.PermissionSet,messageSizeInBytes:p(n),pausedTotalCount:null,principalSMTPAddress:null,mailboxInfo:{type:t.type,userIdentity:t.userIdentity,mailboxSmtpAddress:t.mailboxSmtpAddress,auxiliaryMailboxGuid:null==C?void 0:C[0]}}}function p(e){var t,n;return null===(n=null===(t=e.ExtendedProperty)||void 0===t?void 0:t[0])||void 0===n?void 0:n.Value}function m(e){return{__typename:"FolderId",Id:e.Id,ChangeKey:e.ChangeKey}}function h(e){return{__typename:"RetentionTagType",IsExplicit:!!e.IsExplicit,Value:e.Value}}},210399:(e,t,n)=>{"use strict";n.d(t,{s:()=>i});const i="0x6698"},601467:(e,t,n)=>{"use strict";n.d(t,{p2:()=>o,vy:()=>s,_l:()=>a,$P:()=>l,Sf:()=>c,zi:()=>d,E5:()=>u,$_:()=>p,iz:()=>m,ck:()=>h,Io:()=>f});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(25671),n.e(56841),n.e(9152),n.e(90885),n.e(53515),n.e(78501),n.e(93310),n.e(54670)]).then(n.bind(n,181246)))),o=new i._5(r,(e=>e.getTopicDefinition)),s=new i._5(r,(e=>e.getTopicAnnotations)),a=new i._5(r,(e=>e.getMyTopics)),l=new i._5(r,(e=>e.getTopicsByName)),c=new i._5(r,(e=>e.getTopicsByPrefix)),d=new i._5(r,(e=>e.logEvent)),u=new i._5(r,(e=>e.unsafeGetTopicsSdk)),p=new i._5(r,(e=>e.getTopicBootstrapperConfig)),m=new i._5(r,(e=>e.addTopicHighlight)),h=new i._5(r,(e=>e.updateIsTopicHighlightsEnabled)),f=new i._5(r,(e=>e.removeTopicHighlightsByItemId));new i._5(r,(e=>e.removeTopicHighlightByTopicId))},55975:(e,t,n)=>{"use strict";n.d(t,{wM:()=>l,uD:()=>c,yu:()=>d,GJ:()=>u,TC:()=>p,Pd:()=>m,Uw:()=>h});var i=n(934954),r=n(55461),o=n(964659),s=n(943674),a=n(612239);function l(){return(0,r.cr)("csi-owa-auto-topic-highlights")&&c()}function c(){var e;return!(!(null===(e=(0,o.c6)().UserOptions)||void 0===e?void 0:e.IsTopicHighlightsEnabled)||!m())}function d(){return(0,r.cr)("csi-editor-topicsuggestions")&&m()&&!u()&&f()}function u(){return(0,r.cr)("mc-editor-oa-flags")&&(0,r.cr)("mc-editor-oa-topic-detection")&&m()&&f()}function p(){return(0,r.cr)("mc-editor-oa-vivatopics")&&m()}function m(){const e=(0,a.I)();return e?function(e){return(0,r.cr)("csi-owa-topics-mvp")&&e.canUserViewTopics()}(e):function(){var e,t;const n=(0,o.c6)(),s=null===(e=n.SessionSettings)||void 0===e?void 0:e.ExternalDirectoryTenantGuid,a=null===(t=n.SessionSettings)||void 0===t?void 0:t.ExternalDirectoryUserGuid;return(0,r.cr)("csi-owa-topics-mvp")&&(0,i.k)({tenantAadObjectId:s,userAadObjectId:a},"Read")}()}function h(){return((0,r.cr)("csi-editor-topicsuggestions")||(0,r.cr)("mc-editor-oa-flags")&&(0,r.cr)("mc-editor-oa-topic-detection"))&&m()}function f(){return(0,s.I3)()}},481433:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(222700),r=n(363293),o=n(601467);let s;function a(){return s||((0,r.e)(),s=o.$_.importAndExecute().then((e=>(0,i.O)(e))).catch((e=>Promise.reject(e)))),s}},943674:(e,t,n)=>{"use strict";n.d(t,{R:()=>r,I3:()=>o,zs:()=>s});var i=n(964659);function r(){var e;const t=null===(e=(0,i.c6)().UserOptions)||void 0===e?void 0:e.TopicsBitFlags;return null==t?511:t}function o(){return e=r(),!!(2&e);var e}function s(e){return t=r(),n=2,e?t|=n:t&=~n,t;var t,n}},612239:(e,t,n)=>{"use strict";n.d(t,{I:()=>o});var i=n(222700),r=n(481433);function o(){const e=(0,i.I)();return e||(0,r.Z)().catch((e=>{e.message="tryGetTopicsSdk: "+e.message,e.reported=!0})),e}},257911:(e,t,n)=>{"use strict";n.d(t,{mh:()=>o,qK:()=>s,qw:()=>a,$c:()=>l,Kv:()=>c});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(52637),n.e(32557),n.e(39006),n.e(18838),n.e(16025),n.e(19280),n.e(33615),n.e(17483),n.e(56337),n.e(75482),n.e(69390),n.e(11102),n.e(9598),n.e(42106),n.e(62600),n.e(3128),n.e(5989),n.e(62199),n.e(91992),n.e(37818)]).then(n.bind(n,375442)))),o=new i._5(r,(e=>e.openMeetingPollPane)),s=new i._5(r,(e=>e.insertContent)),a=new i._5(r,(e=>e.insertCalendarContent)),l=(0,i.$y)(r,(e=>e.MeetingPollPaneOPX)),c=new i._5(r,(e=>e.initializeOpxData))},688002:(e,t,n)=>{"use strict";n.d(t,{ce:()=>i,WO:()=>a,JU:()=>o});const i={alert:"alert",alertdialog:"alertdialog",application:"application",article:"article",banner:"banner",button:"button",cell:"cell",checkbox:"checkbox",columnheader:"columnheader",combobox:"combobox",complementary:"complementary",contentinfo:"contentinfo",definition:"definition",dialog:"dialog",directory:"directory",document:"document",feed:"feed",figure:"figure",form:"form",grid:"grid",gridcell:"gridcell",group:"group",heading:"heading",img:"img",link:"link",list:"list",listbox:"listbox",listitem:"listitem",log:"log",main:"main",marquee:"marquee",math:"math",menu:"menu",menubar:"menubar",menuitem:"menuitem",menuitemcheckbox:"menuitemcheckbox",menuitemradio:"menuitemradio",navigation:"navigation",note:"note",option:"option",presentation:"presentation",progressbar:"progressbar",radio:"radio",radiogroup:"radiogroup",region:"region",row:"row",rowgroup:"rowgroup",rowheader:"rowheader",scrollbar:"scrollbar",search:"search",searchbox:"searchbox",separator:"separator",slider:"slider",spinbutton:"spinbutton",status:"status",switch:"switch",tab:"tab",table:"table",tablist:"tablist",tabpanel:"tabpanel",term:"term",textbox:"textbox",timer:"timer",toolbar:"toolbar",tooltip:"tooltip",tree:"tree",treegrid:"treegrid",treeitem:"treeitem"};let r=0;function o(e="id"){return`${e}${r++}`}function s(e){return Array.isArray(e)?e.join(" "):e}function a(e){if(!e)return null;const t={},n=Object.keys(e);for(let i=0;i<n.length;i++){switch(n[i]){case"role":t.role=e.role;break;case"id":t.id=e.id;break;case"activeDescendant":t["aria-activedescendant"]=e.activeDescendant;break;case"atomic":t["aria-atomic"]=e.atomic;break;case"autocomplete":t["aria-autocomplete"]=e.autocomplete;break;case"busy":t["aria-busy"]=e.busy;break;case"checked":t["aria-checked"]=e.checked;break;case"controls":t["aria-controls"]=s(e.controls);break;case"describedBy":t["aria-describedby"]=s(e.describedBy);break;case"disabled":t["aria-disabled"]=e.disabled;break;case"dropEffect":t["aria-dropeffect"]=s(e.dropEffect);break;case"expanded":t["aria-expanded"]=e.expanded;break;case"flowTo":t["aria-flowto"]=s(e.flowTo);break;case"grabbed":t["aria-grabbed"]=e.grabbed;break;case"hasPopup":t["aria-haspopup"]=e.hasPopup;break;case"hidden":t["aria-hidden"]=e.hidden;break;case"invalid":t["aria-invalid"]=e.invalid;break;case"label":t["aria-label"]=e.label;break;case"labelledBy":t["aria-labelledby"]=s(e.labelledBy);break;case"level":t["aria-level"]=e.level;break;case"live":t["aria-live"]=e.live;break;case"multiline":t["aria-multiline"]=e.multiline;break;case"multiselectable":t["aria-multiselectable"]=e.multiselectable;break;case"orientation":t["aria-orientation"]=e.orientation;break;case"owns":t["aria-owns"]=s(e.owns);break;case"positionInSet":t["aria-posinset"]=e.positionInSet;break;case"pressed":t["aria-pressed"]=e.pressed;break;case"readonly":t["aria-readonly"]=e.readonly;break;case"relevant":t["aria-relevant"]=s(e.relevant);break;case"required":t["aria-required"]=e.required;break;case"selected":t["aria-selected"]=e.selected;break;case"setSize":t["aria-setsize"]=e.setSize;break;case"sort":t["aria-sort"]=e.sort;break;case"valueMax":t["aria-valuemax"]=e.valueMax;break;case"valueMin":t["aria-valuemin"]=e.valueMin;break;case"valueNow":t["aria-valuenow"]=e.valueNow;break;case"valueText":t["aria-valuetext"]=e.valueText}}return t}},974037:(e,t,n)=>{"use strict";n.d(t,{s:()=>r});var i=n(964659);function r(e){const t=!e||(0,i.sB)(e)?(0,i.c6)():(0,i.Tz)(e);return(null==t?void 0:t.GroupsEnabled)&&!t.SessionSettings.IsExplicitLogon}},447424:(e,t,n)=>{"use strict";n.d(t,{h:()=>a});var i=n(989526),r=n(191008),o=n(717420),s=n(564070);function a(e,t,n,a){return(0,o.$y)(e,(e=>{const n=t(e);return e=>i.createElement(r.e,{client:(0,s.WQ)()},i.createElement(n,Object.assign({},e)))}),n,a)}},249531:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(281342);const o=(0,i.M)("AddCircleRegular",r.n2l)},367397:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(281342);const o=(0,i.M)("AppsRegular",r.vIt)},95391:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(281342);const o=(0,i.M)("ArrowForwardRegular",r.Is_)},517441:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(281342);const o=(0,i.M)("ArrowReplyAllRegular",r.XFz)},503361:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(281342);const o=(0,i.M)("ArrowReplyRegular",r.HYp)},325552:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(68034);const o=(0,i.M)("CalendarDataBarRegular",r.heR)},569295:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(68034);const o=(0,i.M)("CalendarLtrRegular",r.Cvr)},635344:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(68034);const o=(0,i.M)("ClipboardArrowRightRegular",r.$36)},319752:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(421941);const o=(0,i.M)("DeleteRegular",r.X10)},817044:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(421941);const o=(0,i.M)("DismissRegular",r.Vhq)},918305:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(584612);const o=(0,i.M)("EmojiRegular",r.loU)},440752:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(584612);const o=(0,i.M)("ErrorCircleRegular",r.tzZ)},63255:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(584612);const o=(0,i.M)("FlagRegular",r.Wsl)},187900:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(584612);const o=(0,i.M)("FolderMailRegular",r.Ze)},201910:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(117723);const o=(0,i.M)("ImmersiveReaderRegular",r.zpY)},896500:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(117723);const o=(0,i.M)("MailAttachRegular",r.e_C)},957913:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(117723);const o=(0,i.M)("MailRegular",r.W0d)},955482:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(117723);const o=(0,i.M)("OpenRegular",r.diQ)},585187:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(683205);const o=(0,i.M)("PersonAddRegular",r.K7p)},135206:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(683205);const o=(0,i.M)("PersonProhibitedRegular",r.Q4b)},705563:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(683205);const o=(0,i.M)("PresenceUnknownRegular",r.OO9)},553531:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(683205);const o=(0,i.M)("PrintRegular",r.GTP)},170108:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(38947);const o=(0,i.M)("ShieldErrorRegular",r.Qgw)},338815:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(332358);const o=(0,i.M)("ThumbLikeRegular",r.x59)},662260:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(332358);const o=(0,i.M)("TranslateRegular",r.f4L)},184529:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(464610),r=n(332358);const o=(0,i.M)("WeatherSunnyRegular",r.Y3s)},134432:(e,t,n)=>{"use strict";n.d(t,{c:()=>o,m:()=>a});var i=n(559621),r=n(75277);class o{constructor(e,t){this.parentCacheKey=e,this.childMruCacheKey=t,this.cacheTime=Date.now()}static isExpired(e){return Date.now()-e.cacheTime>=72e5}static compareEntryCacheTime(e,t){return e.cacheTime-t.cacheTime}}var s=n(136947);class a{constructor(e,t=300,n=Date.now()){this.comparer=e,this.cacheLimit=t,this.lastExpiredEntryClearedTime=n,this.cache=new i.ObservableMap}initialize(e){this.cache=e.cache}add(e,t){(0,s.aD)("NestedMruCache_add")((()=>{this.clearOldEntriesIfNeeded();let n=null;this.cache.has(e)?n=this.cache.get(e):(n=new r.z(this.cacheLimit),n.initialize(new i.ObservableMap),this.cache.set(e,n)),n.add(t.childMruCacheKey,t)}))()}containsValueForKey(e,t){if(!this.cache.has(e))return!1;const n=this.cache.get(e).get(t);return!(!n||o.isExpired(n))}get(e,t){let n=null;return this.containsValueForKey(e,t)&&(n=this.cache.get(e).get(t)),n}clearUpExpiredEntries(){if(!(Date.now()-this.lastExpiredEntryClearedTime<12e5)){for(const e of this.cache.values())e.getItemIds().forEach((t=>{o.isExpired(e.get(t))&&e.remove(t)}));this.lastExpiredEntryClearedTime=Date.now()}}remove(e){(0,s.aD)("NestedMruCache_remove")((()=>{if(this.cache.has(e)){const t=this.cache.get(e);t.getItemIds().map((e=>{t.remove(e)}))}}))()}clear(){(0,s.aD)("NestedMruCache_clear")((()=>{const e=this.cache.keys();for(const t of e)this.remove(t)}))()}countTotalNumberOfEntries(){let e=0;if(this.cache)for(const t of this.cache.values())e+=t.getItemIds().length;return e}returnAllMailTipsCacheEntries(){const e=[];if(this.cache)for(const t of this.cache.values())t&&t.getItemIds().map((n=>{const i=t.get(n);e.push(i)}));return e}clearOldEntriesIfNeeded(){if(this.countTotalNumberOfEntries()>=300&&this.clearUpExpiredEntries(),this.countTotalNumberOfEntries()>=300){const e=[];for(const t of this.cache.values())t.getItemIds().forEach((n=>{e.push(t.get(n))}));e.sort(this.comparer);for(let t=0;t<50;t++){const n=e[t].parentCacheKey,i=e[t].childMruCacheKey;this.cache.get(n).remove(i)}}}}},434951:(e,t,n)=>{"use strict";n.d(t,{le:()=>r,Qw:()=>s,qQ:()=>o,Xy:()=>d,wc:()=>c,lI:()=>a,fo:()=>l,up:()=>u});var i=n(371134);const r=(0,i.aD)("onAddinTrigger",(e=>({kind:"AddIn",event:e}))),o=(0,i.aD)("onMessageExtensionTrigger",(e=>({kind:"MessageExtension",event:e}))),s=(0,i.aD)("onAppBarAppTrigger",(e=>({kind:"AppBar",event:e}))),a=(0,i.aD)("onOpenAppStoreLaunchPage",(e=>({kind:"AppStore",event:e}))),l=(0,i.aD)("onOpenAppStoreMessageExtension",(e=>({kind:"AppStore",event:e}))),c=(0,i.aD)("onOpenAppStoreAddIns",(e=>({kind:"AppStore",event:e}))),d=(0,i.aD)("onOpenAboutDialog",(e=>({kind:"AboutDialog",event:e}))),u=(0,i.aD)("onPreviewTrigger",(e=>({kind:"PublicPreviewDialog",event:e})))},158408:(e,t,n)=>{"use strict";n.d(t,{h:()=>s});const i={hotkey_keyword_shift:"hsc",hotkey_keyword_ctrl:"isc",hotkey_keyword_alt:"jsc",hotkey_keyword_meta:"ksc",hotkey_keyword_backspace:"lsc",hotkey_keyword_tab:"msc",hotkey_keyword_enter:"nsc",hotkey_keyword_return:"osc",hotkey_keyword_capslock:"psc",hotkey_keyword_esc:"qsc",hotkey_keyword_escape:"rsc",hotkey_keyword_space:"ssc",hotkey_keyword_pageup:"tsc",hotkey_keyword_pagedown:"usc",hotkey_keyword_end:"vsc",hotkey_keyword_home:"wsc",hotkey_keyword_left:"xsc",hotkey_keyword_up:"ysc",hotkey_keyword_right:"zsc",hotkey_keyword_down:"Asc",hotkey_keyword_ins:"Bsc",hotkey_keyword_del:"Csc",hotkey_keyword_command:"Dsc",hotkey_keyword_plus:"Esc",keyboardShortcutThen:"Fsc"};var r=n(101060),o=n(382717);function s(e,t){return"string"==typeof e?a(e,t):e instanceof Array?e.map((e=>a(e,t))).join(" / "):""}function a(e,t){const n=e.split("+");if(1===n.length){const n=e.split(" ");return 1===n.length?l(n[0],t):(0,r.WU)((0,r.ZP)("Fsc"),l(n[0],t),l(n[1],t))}{const e=[];return n.forEach((n=>{e.push(l(n,t))})),e.join("+")}}function l(e,{useMacSymbols:t=(0,o.V5)()}={}){if(t)switch(e.toLowerCase()){case"ctrl":return"";case"alt":return"";case"shift":return""}return(0,r.ZP)(i[`hotkey_keyword_${e}`])||(n=e).charAt(0).toUpperCase()+n.slice(1);var n}},778509:(e,t,n)=>{"use strict";n.d(t,{g:()=>a});var i=n(169397),r=n(788573),o=n(158408),s=n(923912);function a(e){const t=(0,s.Z)(),n=(0,i.o)(t);return n?(0,o.h)((0,r.Z)(e)[n]):void 0}},169397:(e,t,n)=>{"use strict";n.d(t,{o:()=>o});var i=n(984869),r=n(308631);function o(e){return(0,i.Z)()?function(e){switch(e){case r.$k.OutlookForWindows:return"outlook";case r.$k.OutlookForWeb:return"owa";case r.$k.Off:return null}}(e):function(e){switch(e){case 0:return"hotmail";case 3:return"gmail";case 2:return"yahoo";case 4:return"owa";case 1:return null}}(e)}},610190:(e,t,n)=>{"use strict";n.d(t,{a:()=>s});var i=n(169397),r=n(788573),o=n(923912);function s(e){const t=(0,o.Z)(),n=(0,i.o)(t);return n&&void 0!==(0,r.Z)(e)[n]}},480109:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});function i(e){return!!e&&"Success"==e.ResponseClass}},290841:(e,t,n)=>{"use strict";function i(e,t,n){let i="ResponseCode="+e;t&&(i+=", Stacktrace="+t);const r=new Error(i);return r.responseCode=e,r.fetchErrorType="ServerFailure",n&&(r.diagnosticInfo="MessageText= "+n),r}n.d(t,{Z:()=>i})},527332:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(290841),r=n(480109),o=n(31102);function s(e,t){if(!e)return t&&(0,o.hz)(t,"HSR_NO_R",(0,o.BE)(t)),Promise.reject((0,i.Z)("500","Server returned a null response!",void 0));const n=Array.isArray(e)?e:[e];for(const e of n)if(e&&!(0,r.Z)(e))return t&&(0,o.hz)(t,"HSR_R_E",(0,o.BE)(t)),Promise.reject((0,i.Z)(e.ResponseCode,e.StackTrace,e.MessageText));return t&&(0,o.hz)(t,"HSR_S",(0,o.BE)(t)),Promise.resolve()}},980954:(e,t,n)=>{"use strict";n.d(t,{d:()=>s});var i=n(371134),r=n(559621);const o=(0,i.MT)("groupsStore",{groupsStateByMailboxInfo:new r.ObservableMap})(),s=()=>o},428382:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(231673);function r(e,t){const n=(0,i.U)(e,t.toLowerCase());return null==n?void 0:n.groupDetails}},231673:(e,t,n)=>{"use strict";n.d(t,{U:()=>r});var i=n(103514);function r(e,t){return(0,i.L)(e).groups.get(t.toLowerCase())}},103514:(e,t,n)=>{"use strict";n.d(t,{L:()=>s});var i=n(72251),r=n(980954),o=n(559621);function s(e){const t=(0,i.M4)(e),n=(0,r.d)().groupsStateByMailboxInfo.get(t);if(!n){const e={groups:new o.ObservableMap};return(0,r.d)().groupsStateByMailboxInfo.set(t,e),e}return n}},560725:(e,t,n)=>{"use strict";n.d(t,{ky:()=>r,pf:()=>o,uP:()=>s,wz:()=>a});const i={};function r(e,t){a(e)&&o(e),i[e]=t}function o(e){delete i[e]}function s(e){return i[e]}function a(e){return!!i[e]}},812158:(e,t,n)=>{"use strict";n.d(t,{P8:()=>i,AE:()=>a});var i,r=n(101060),o=n(789065),s=n(238172);!function(e){e[e.File=0]="File",e[e.Item=1]="Item",e[e.Cloud=2]="Cloud"}(i||(i={}));const a=e=>e.map((e=>({id:l(e),name:e.Name,contentType:e.ContentType,size:e.Size,attachmentType:c(e),isInline:e.IsInline||!1})));function l(e){var t;return(0,s.j)(e)?e.AttachLongPathName:null===(t=e.AttachmentId)||void 0===t?void 0:t.Id}function c(e){switch(e.__type||e.OwsTypeName){case o.$H:return i.File;case o.sx:return i.Item;case o.zH:return i.Cloud;case o.b$:const t=e;return(0,r.LP)(t.AttachmentIdToAttach)?i.Item:i.File;default:throw new Error(`Invalid type of attachment ${e.__type}`)}}},225647:(e,t,n)=>{"use strict";var i;n.d(t,{Z:()=>r}),function(e){e[e.Added=0]="Added",e[e.Deleted=1]="Deleted"}(i||(i={}));const r=i},308913:(e,t,n)=>{"use strict";var i;n.d(t,{_:()=>i}),function(e){e.Room="room",e.Custom="custom"}(i||(i={}))},286973:(e,t,n)=>{"use strict";var i;n.d(t,{Z:()=>r}),function(e){e[e.To=0]="To",e[e.Cc=1]="Cc",e[e.Bcc=2]="Bcc",e[e.RequiredAttendees=0]="RequiredAttendees",e[e.OptionalAttendees=1]="OptionalAttendees",e[e.Resources=2]="Resources"}(i||(i={}));const r=i},265176:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=class{constructor(e){this.errorCode=e}}},951023:(e,t,n)=>{"use strict";var i;n.d(t,{X:()=>i,Z:()=>r}),function(e){e[e.OoeInvalidDataFormat=2006]="OoeInvalidDataFormat",e[e.OperationNotSupported=5e3]="OperationNotSupported",e[e.AttachmentSizeExceeded=9e3]="AttachmentSizeExceeded",e[e.NumberOfAttachmentsExceeded=9001]="NumberOfAttachmentsExceeded",e[e.InvalidAttachmentId=9003]="InvalidAttachmentId",e[e.InvalidAttachmentPath=9004]="InvalidAttachmentPath",e[e.CannotAddAttachmentBeforeUpgrade=9005]="CannotAddAttachmentBeforeUpgrade",e[e.AttachmentDeletedBeforeUploadCompletes=9006]="AttachmentDeletedBeforeUploadCompletes",e[e.AttachmentUploadGeneralFailure=9007]="AttachmentUploadGeneralFailure",e[e.AttachmentToDeleteDoesNotExist=9008]="AttachmentToDeleteDoesNotExist",e[e.AttachmentDeleteGeneralFailure=9009]="AttachmentDeleteGeneralFailure",e[e.InvalidEndTime=9010]="InvalidEndTime",e[e.HtmlSanitizationFailure=9011]="HtmlSanitizationFailure",e[e.NumberOfRecipientsExceeded=9012]="NumberOfRecipientsExceeded",e[e.CursorPositionChanged=9014]="CursorPositionChanged",e[e.ComposeFormNotReadyForAttachments=9015]="ComposeFormNotReadyForAttachments",e[e.InvalidSelection=9016]="InvalidSelection",e[e.GenericTokenError=9018]="GenericTokenError",e[e.GenericSettingsError=9019]="GenericSettingsError",e[e.GenericResponseError=9020]="GenericResponseError",e[e.SaveError=9021]="SaveError",e[e.DuplicateNotificationKey=9023]="DuplicateNotificationKey",e[e.NotificationKeyNotFound=9024]="NotificationKeyNotFound",e[e.NumberOfNotificationsExceeded=9025]="NumberOfNotificationsExceeded",e[e.PersistedNotificationArrayReadError=9026]="PersistedNotificationArrayReadError",e[e.PersistedNotificationArraySaveError=9027]="PersistedNotificationArraySaveError",e[e.CannotPersistPropertyInUnsavedDraftError=9028]="CannotPersistPropertyInUnsavedDraftError",e[e.CallSaveAsyncBeforeToken=9029]="CallSaveAsyncBeforeToken",e[e.InvalidParameterValueError=9031]="InvalidParameterValueError",e[e.ApiCallNotSupportedByExtensionPoint=9032]="ApiCallNotSupportedByExtensionPoint",e[e.SetRecurrenceOnInstance=9033]="SetRecurrenceOnInstance",e[e.InvalidRecurrence=9034]="InvalidRecurrence",e[e.InsufficientItemPermissions=9038]="InsufficientItemPermissions",e[e.InternalServerError=9042]="InternalServerError",e[e.AttachmentTypeNotSupported=9043]="AttachmentTypeNotSupported",e[e.InvalidCategoryError=9044]="InvalidCategoryError",e[e.DuplicateCategoryError=9045]="DuplicateCategoryError",e[e.ItemNotSavedError=9046]="ItemNotSavedError",e[e.MissingExtendedPermissionsForAPIError=9047]="MissingExtendedPermissionsForAPIError",e[e.ItemNotFound=9049]="ItemNotFound",e[e.KeyNotFound=9050]="KeyNotFound",e[e.SessionDataObjectMaxLengthExceeded=9051]="SessionDataObjectMaxLengthExceeded"}(i||(i={}));const r=i},656745:(e,t,n)=>{"use strict";n.d(t,{LX:()=>o,V3:()=>s,eg:()=>a,UE:()=>l,jP:()=>c,vf:()=>d,lu:()=>u,Kr:()=>p});let i={},r={};function o(e,t,n,o){f([e,"data",t])||function(e,t){i[e]=i[e]||{data:{},messageIds:[]},i[e].data[t]={}}(e,t),l(n)&&m(n),function(e,t,n,o){i[e].data[t][n]=o,i[e].messageIds.push(n),r[n]={hostItemIndex:e,extensionId:t}}(e,t,n,o)}function s(e){a(e)&&m(e)}function a(e){if(!l(e))return null;const{hostItemIndex:t,extensionId:n}=r[e];return f([t,"data",n,e])}function l(e){return!!r[e]}function c(e,t,n){const i=h(e,t)||[],r=Object.keys(i).length||0,o=function(e){for(const t of Object.values(e))if(t.Actions)return!0;return!1}(i);return!!(r>=5||n&&o)}function d(e,t){const n=h(e,t);return n?Object.keys(n).reduce(((e,t)=>{const i=n[t];return i.Persistent&&(e[t]=i),e}),{}):{}}function u(e){return i[e]?i[e].messageIds:[]}function p(e){if(!i[e])return;i[e].messageIds.forEach((e=>delete r[e])),delete i[e]}function m(e){const{hostItemIndex:t,extensionId:n}=r[e];delete h(t,n)[e],delete r[e];const o=i[t].messageIds,s=o.indexOf(e);~s&&o.splice(s,1)}function h(e,t){return f([e,"data",t])}function f(e){let t=i;for(let n=0;n<e.length;n++){const i=e[n];if(!t[i])return null;t=t[i]}return t}},300659:(e,t,n)=>{"use strict";var i;n.d(t,{Z:()=>r}),function(e){e[e.Selected=0]="Selected",e[e.Deselected=1]="Deselected"}(i||(i={}));const r=i},520085:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={sendFeedback:()=>{}}},86725:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).aD)("openInClientStore")},577603:(e,t,n)=>{"use strict";function i(e,t,n){const r={hostItemIndex:e,targetWindow:n};if(t.isAddin=!0,t.getClickHandler)t.onClick=t.getClickHandler(r);else if(t.sectionProps){t.sectionProps.items.forEach((t=>{i(e,t,n)}))}else if(t.subMenuProps){t.subMenuProps.items.forEach((t=>{i(e,t,n)}))}}n.d(t,{Z:()=>i})},154517:(e,t,n)=>{"use strict";var i;n.d(t,{R:()=>i}),function(e){e[e.Unknown=0]="Unknown",e[e.Single=1]="Single",e[e.Empty=2]="Empty",e[e.Multi=3]="Multi",e[e.NotSupported=4]="NotSupported"}(i||(i={}))},22300:(e,t,n)=>{"use strict";n.d(t,{v:()=>o,T:()=>s});var i=n(559621),r=n(989526);function o(e){return{get:e}}function s(e,t){return(0,r.useMemo)((()=>(0,i.computed)(e)),t).get()}},394834:(e,t,n)=>{"use strict";n.d(t,{O:()=>r});var i=n(989526);function r(){const e=(0,i.useRef)(),t=(0,i.useCallback)((()=>{window.clearTimeout(e.current),e.current=0}),[]),n=(0,i.useCallback)(((n,i,...r)=>{t(),e.current=window.setTimeout(((...t)=>{e.current=0,n(...t)}),i,...r)}),[t]),r=(0,i.useCallback)((()=>!!e.current),[]);return(0,i.useEffect)((()=>t),[]),[n,t,r]}},306130:(e,t,n)=>{"use strict";n.d(t,{y:()=>o});var i=n(989526),r=n(807402);function o(e,t){i.useEffect((()=>{if(e.current){const n=new r.Z((([e])=>{t(e.contentRect)}));n.observe(e.current);const{width:i,height:o}=e.current.getBoundingClientRect();return t({top:0,left:0,x:0,y:0,bottom:o,height:o,right:i,width:i}),()=>n.disconnect()}}),[e,t])}},40330:(e,t,n)=>{"use strict";n.d(t,{bb:()=>C,c:()=>w,CU:()=>x,RZ:()=>R,fU:()=>k,up:()=>N,iF:()=>T,xq:()=>E});var i=n(304113),r=n(101060),o=n(874191),s=n(922002),a=n(789568),l=n(64047),c=n(552542),d=n(676186),u=n(528368);var p=n(517185),m=n(491962),h=n(954947);var f=n(55461);const g={iconRoot:"wVSaJ",iconRootControlIcon:"eSqMe",iconRootComputer:"AfTXM",iconRootCloud:"e9IWm",iconRootOneDrive:"LrUHL",oneDriveIcon:"S1nka",iconRootUploadAndShare:"WncIa"};var v=n(254712),y=n.n(v),S=n(327013);const b=y().bind(g);function I(e,t){return{isEnabled:(e,t)=>!0,text:e,iconProps:t,getCreateAttachmentHandler:(e,t)=>e=>{const n={isInline:e.isInline,isHiddenInline:!1},i=e.shouldShare?Object.assign(Object.assign({},n),{shouldShare:!0}):Object.assign(Object.assign({},n),{shouldShare:!1});t(e.files,i,e.dataProviderType)},logUsage:(e,t)=>{(0,o.y8)("FPDualEntryFilePicker",{entrySource:e.toString(),suggestedAttachmentTraceId:t},{isCore:!0,excludeFromKusto:!0})}}}const w={computer:{isEnabled:(e,t)=>!0,text:()=>(0,r.ZP)(i.vs),iconProps:{iconName:"System",styles:{root:b(g.iconRoot,g.iconRootControlIcon,g.iconRootComputer)}},getCreateAttachmentHandler:function(e,t,n,i,r,p,m){return async(i,h)=>{var f,g,v;const y=[];for(let e=0;e<i.files.length;e++){if(i.files[e].fileType!==s.Y0.Local)throw new Error(`Unexpected file type ${i.files[e].fileType}`);y.push(i.files[e].fileObject)}const S=y.reduce(((e,t)=>e+t.size),0),b=(await a.s.import())(e),I=S>b,C=S>1024*l.Hd,E=(I||C)&&(0,u.m)(!!e.groupId)&&(null===(f=(0,d.Z)())||void 0===f?void 0:f.ReferenceAttachmentsEnabled)&&!(null===(v=null===(g=(0,c.Z)())||void 0===g?void 0:g.SessionSettings)||void 0===v?void 0:v.IsShadowMailbox),P=e=>{const n={isInline:e.isInline,isHiddenInline:!1,shouldShare:!!e.shouldShare,mailboxInfo:r};t(e.files,n,e.dataProviderType)},T=!!e.groupId;E?((0,o.y8)("AFPSecondPanelShownForLargeFiles",{suggestSharing:C,exceedsAvailbleSize:I,fileCount:Math.min(y.length,23)}),(await l.Ue.import())(P,null!=p?p:null,y,null,l.Zv.LocalComputerFiles,b,n,h,!!m,T,function(e,t,n,i,r,o,s,a){return()=>{w.uploadAndShareFromCloud.getCreateAttachmentHandler(t,a&&n?(e,t,i)=>n({files:e,dataProviderType:null,targetWindow:o,properties:t}):i,r,o,s)(e,o)}}(i,e,p,t,n,h,r,!!m))):P(i)}},logUsage:(e,t)=>{(0,o.y8)("FPDualEntryComputer",{entrySource:e.toString(),suggestedAttachmentTraceId:t},{isCore:!0,excludeFromKusto:!0})}},onlineLocation:I((()=>(0,r.ZP)(i.t0)),{iconName:"Cloud",styles:{root:b(g.iconRoot,g.iconRootControlIcon,g.iconRootCloud)}}),onlineLocationOneDrive:I((()=>(0,r.ZP)(i.t0)),{imageProps:{src:(0,S.Z)("oneDriveColor.svg"),className:g.oneDriveIcon},styles:{root:b(g.iconRoot,g.iconRootOneDrive)}}),otherOnlineLocations:I((()=>(0,r.ZP)(i.IJ)),{iconName:"Cloud",styles:{root:b(g.iconRoot,g.iconRootControlIcon,g.iconRootCloud)}}),uploadAndShareFromCloud:{isEnabled:(e,t)=>{var n,i;return!t&&(0,u.m)(!!e)&&(!!(null===(n=(0,d.Z)())||void 0===n?void 0:n.ReferenceAttachmentsEnabled)||(0,f.cr)("doc-fullyDeprecateCloudyMaster")||(0,f.cr)("doc-deprecateCloudy-preview-thumbnailView"))&&!(null===(i=(0,c.Z)().SessionSettings)||void 0===i?void 0:i.IsShadowMailbox)},text:()=>(0,r.ZP)(i.EE),ariaLabel:()=>(0,r.ZP)(i.vL),iconProps:{iconName:"CloudUpload",styles:{root:b(g.iconRoot,g.iconRootControlIcon,g.iconRootUploadAndShare)}},getCreateAttachmentHandler:function(e,t,n,i,r){return async(n,i)=>{const o=await p.c.import();if((0,h.Z)()){const e={providerInfo:{type:1}},s=await o(e,i,r);if(s.isFolderSelected){const{folderInfo:e}=s,i={isInline:n.isInline,isHiddenInline:!1,shouldShare:!0,shareProperties:{folderInfo:e}};t(n.files,i,n.dataProviderType)}}else{let s={providerInfo:{type:0}};if(e.groupId){const t=(await m.kd.import())(e.groupId);s={providerInfo:{type:2e4,groupMailboxId:e.groupId,groupDisplayName:t}}}const a=await o(s,i,r);if(a.isFolderSelected){const{folderInfo:e}=a,i={isInline:n.isInline,isHiddenInline:!1,shouldShare:!0,shareProperties:{folderInfo:e,groupMailboxId:2e4===a.providerType?a.groupMailboxId:null}};t(n.files,i,n.dataProviderType)}}}},logUsage:(e,t)=>{(0,o.y8)("FPMultiEntryUploadAndShareFromCloud",{entrySource:e.toString(),suggestedAttachmentTraceId:t},{isCore:!0,excludeFromKusto:!0})}}};var C;function E(e){switch(e){case C.OnlineLocation:return!P();case C.OnlineLocationOneDrive:return P();case C.OtherOnlineLocations:return T();default:return!0}}function P(){return(0,f.cr)("doc-wxpRef-browseCloudLocations-OD")||(0,f.cr)("doc-wxpRef-browseCloudLocations-BrowseODAndBrowseOCL")||(0,f.cr)("doc-wxpRef-browseCloudLocations-ODAndBrowseOCL")||(0,f.cr)("doc-wxpRef-browseCloudLocations-ODAndOCL")}function T(){return(0,f.cr)("doc-wxpRef-browseCloudLocations-BrowseODAndBrowseOCL")||(0,f.cr)("doc-wxpRef-browseCloudLocations-ODAndBrowseOCL")||(0,f.cr)("doc-wxpRef-browseCloudLocations-ODAndOCL")}function R(e,t){return e.text=()=>t?k():N(),e}function x(e){return"onlineLocationOneDrive"===e?k():N()}function k(){return(0,f.cr)("doc-wxpRef-browseCloudLocations-BrowseODAndBrowseOCL")?(0,r.ZP)(i.xE):(0,r.ZP)(i.yH)}function N(){return(0,f.cr)("doc-wxpRef-browseCloudLocations-ODAndOCL")?(0,r.ZP)(i.Vn):(0,r.ZP)(i.IJ)}!function(e){e[e.Computer=0]="Computer",e[e.OnlineLocation=1]="OnlineLocation",e[e.OnlineLocationOneDrive=2]="OnlineLocationOneDrive",e[e.OtherOnlineLocations=3]="OtherOnlineLocations",e[e.UploadAndShareFromCloud=4]="UploadAndShareFromCloud"}(C||(C={}))},567144:(e,t,n)=>{"use strict";n.d(t,{F:()=>o,_:()=>s});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(46688),n.e(14773),n.e(82120),n.e(45087),n.e(665),n.e(37330),n.e(47877),n.e(78159),n.e(49792),n.e(95994),n.e(22107),n.e(26132),n.e(45897),n.e(69939),n.e(13201),n.e(98439),n.e(18326)]).then(n.bind(n,828253)))),o=(0,i.$y)(r,(e=>e.AttachmentWellView)),s=(0,i.$y)(r,(e=>e.AttachmentWellPrintView))},488960:(e,t,n)=>{"use strict";n.d(t,{B:()=>u,Q:()=>d});var i=n(445181),r=n(763754),o=n(364913),s=n(933658),a=n(647451),l=n(769295),c=n(55461);function d(e,t){const n=e.length;n>0&&e[n-1].displayName!=a.Di&&e.push({key:`addinDivider_${t}`,displayName:a.Di,itemType:r.n.Divider,onClick:null})}function u(e,t,n,a,u,p,m,h,f,g,v,y,S){y=y||function(e){if(!e||!e.ParentFolderId)return!1;const t=e.ParentFolderId.Id;return(0,s.p$)(t,"SharedMailbox")}(t);const b=e==o.a.MessageRead?(0,l._G)(n):(0,l.$4)(n),I=(0,i.Z)(e,y,b,f);let w=!0;I.forEach((t=>{if("FindTime"==t.name&&(0,c.cr)("cal-native-findtime"))return;(0,l.aT)(b,t,f);const n=t;if(n.iconOnly=!0,g&&(n.className=g),n.disabled=!!S,a.indexOf(t.key)>=0){const e=Object.assign({},n);null!=e.name&&null!=e.title&&e.name.trim()!=e.title.trim()&&(e.name=e.ariaLabel),e.title="",function(e,t,n){t.isPinned=!0,t.subMenuProps&&t.subMenuProps.items.forEach((e=>{e.isPinned=!0})),n?e.unshift(t):e.push(t)}(u,e,m)}-1!=a.indexOf(t.key)&&!v||(0,c.cr)("mos-messageExtensionsFlyout")||(w&&(d(p,h++),w=!1),n.renderedInOverflow=!0,n.subMenuProps&&n.subMenuProps.items.forEach((e=>{e.renderedInOverflow=!0})),(n.itemType!==r.n.Divider||0!==p.length&&p[p.length-1].itemType!==r.n.Divider)&&(((0,c.cr)("addin-exp-awarenessNudgeCusBtn")||(0,c.cr)("addin-exp-awarenessNudge")||(0,c.cr)("addin-exp-awarenessNudgeWaterDropNudge"))&&l.LO.importAndExecute(n,e),p.push(n)))}))}var p=n(101862),m=n(717420),h=n(434951);const f=new p.nI((()=>n.e(35036).then(n.bind(n,435036))));(0,m.Kv)(h.le,f,(e=>e.onAddinTriggerOrchestrator)),(0,m.Kv)(h.wc,f,(e=>e.onOpenAppStoreAddInsOrchestrator))},445181:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var i=n(371134);const r=(0,i.MT)("AddinsSurfaceActionsStore",{isAddinObserverLoaded:!1})(),o=(0,i.lr)("setAddinObserverLoaded",(function(){r.isAddinObserverLoaded=!0}));var s=n(301198),a=n(55461);let l;function c(e,t,n,i){const o=[];if(r.isAddinObserverLoaded&&l){const r=l(e,t,n,i).get();(null==r?void 0:r.sectionProps)&&o.push(...r.sectionProps.items.filter((e=>!("FindTime"==e.name&&(0,a.cr)("cal-native-findtime")))))}return o}s.jI.import().then((e=>{l=e,o()}))},347122:(e,t,n)=>{"use strict";function i(){return{actions:[],isExecuted:!1}}function r(e,t){!e||e.isExecuted?t():e.actions.push(t)}function o(e){e&&!e.isExecuted&&window.setTimeout((()=>{for(let t=0;t<e.actions.length;t++)e.actions[t]();e.actions=[],e.isExecuted=!0}),0)}n.d(t,{Gr:()=>i,Oy:()=>r,TQ:()=>o})},177760:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const i=new Map,r=()=>i},645900:(e,t,n)=>{"use strict";n.d(t,{N:()=>a,S:()=>s});var i=n(177760),r=n(874191),o=n(458276);const s=(e,t,n,s,a,l)=>{const c=(0,o.Z)(e,t),d=(0,i.Z)();if(!d.has(c)){const e=new r.Gn(t);s&&e.addCustomData(s),a&&e.addCosmosOnlyData(a),l&&e.addActionSource(l),d.set(c,{datapoint:e,operationSet:new Set(n)})}},a=(e,t,n)=>{const r=(0,i.Z)(),s=(0,o.Z)(e,t),a=r.get(s);(null==a?void 0:a.operationSet.has(n))&&(a.datapoint.addCheckmark(n.toString()),a.operationSet.delete(n),0==a.operationSet.size&&(a.datapoint.end(),r.delete(s)))}},243576:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(458276),r=n(177760);function o(e,t){const n=e.logTraceId;if(n){const e=(0,i.Z)(n,"MailComposeNew");if(e){const n=(0,r.Z)().get(e);if(n){const e=n.datapoint.getStartTime();if(e){const i=Date.now()-e;n.datapoint.addCustomData(Object.assign(Object.assign({},t),{duration:i}))}else n.datapoint.addCustomData(t)}}}}},458276:(e,t,n)=>{"use strict";function i(e,t){return e+t}n.d(t,{Z:()=>i})},879032:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).aD)("deleteMeetingMessage",((e,t)=>({item:e,issueDeleteItemCall:t})))},85461:(e,t,n)=>{"use strict";n.d(t,{_:()=>i});const i=(0,n(371134).aD)("onMeetingActionCompleted",(e=>({targetWindow:e})))},390222:(e,t,n)=>{"use strict";n.d(t,{wG:()=>r.Z,_y:()=>o._,CQ:()=>a,zA:()=>l,pF:()=>c,uw:()=>d,lp:()=>u,tS:()=>p,zc:()=>m,DS:()=>h,Pz:()=>f,AS:()=>g,JL:()=>v,Fq:()=>y,qe:()=>S,Z0:()=>b,JT:()=>I,EQ:()=>w});var i=n(717420),r=n(879032),o=n(85461);const s=new i.nI((()=>Promise.all([n.e(3918),n.e(52637),n.e(32557),n.e(19280),n.e(33615),n.e(17483),n.e(69390),n.e(11102),n.e(9598),n.e(56841),n.e(9152),n.e(90885),n.e(3128),n.e(36856),n.e(54964),n.e(46465),n.e(76029),n.e(422),n.e(77456),n.e(21146)]).then(n.bind(n,851220)))),a=new i._5(s,(e=>e.addItemToCalendar)),l=new i._5(s,(e=>e.initializeMeetingRequestViewStateAction)),c=new i._5(s,(e=>e.removeCancelledMeetingFromCalendar)),d=(0,i.$y)(s,(e=>e.MeetingMessageInfo)),u=((0,i.$y)(s,(e=>e.MeetingRequestActions)),(0,i.$y)(s,(e=>e.MeetingCancellationAction)),(0,i.$y)(s,(e=>e.MeetingActionButton)),(0,i.$y)(s,(e=>e.MeetingDetailsTime)),(0,i.$y)(s,(e=>e.MeetingDetailsLocation)),(0,i.$y)(s,(e=>e.MeetingRequestInfo))),p=(0,i.$y)(s,(e=>e.MeetingRequestResponseEditor)),m=(0,i.$y)(s,(e=>e.MeetingDetails)),h=(0,i.$y)(s,(e=>e.MeetingRequestConflicts)),f=((0,i.$y)(s,(e=>e.EditEventLink)),(0,i.$y)(s,(e=>e.MeetingMessageSummary))),g=(0,i.$y)(s,(e=>e.PreviewSummary)),v=(0,i.$y)(s,(e=>e.SenderSummary)),y=(0,i.$y)(s,(e=>e.CollapsedMeetingMessage)),S=(0,i.$y)(s,(e=>e.MeetingIcon)),b=new i._5(s,(e=>e.logMeetingMessageActionForInvite)),I=new i._5(s,(e=>e.logMeetingMessageActionForEvent)),w=new i._5(s,(e=>e.showNotificationWhenRespondToMeeting))},467490:(e,t,n)=>{"use strict";n.d(t,{L:()=>i});const i=(0,n(371134).aD)("executeComposeMessageExtension",((e,t,n,i,r)=>({appId:e,contextMenuHostId:t,tabId:n,editorViewState:i,isReplyForwardScenario:r})))},666015:(e,t,n)=>{"use strict";n.d(t,{o:()=>i});const i=(0,n(371134).aD)("SettingsPageTrigger",((e,t,n)=>({appId:e,configUrl:t,correlationId:n})))},862313:(e,t,n)=>{"use strict";n.d(t,{ZS:()=>I,bz:()=>b,QL:()=>v,k_:()=>y});var i=n(101862),r=n(717420),o=n(467490),s=n(666015),a=n(989526);const l=new r.nI((()=>Promise.all([n.e(99458),n.e(64826),n.e(72760),n.e(53515),n.e(33995),n.e(99369),n.e(95397),n.e(63684),n.e(63673),n.e(39053),n.e(57265),n.e(18669),n.e(53059),n.e(31086),n.e(77456),n.e(99110),n.e(42297),n.e(55782),n.e(58247),n.e(91412)]).then(n.bind(n,237155)))),c=new r.EF(l,(e=>e.getMsgExtApps));var d=n(763754),u=n(518635),p=n(647451),m=n(101060),h=n(544879),f=n(836498),g=n(55461);function v(e,t){const n=e.length;n>0&&e[n-1].displayName!=p.Di&&e.push({key:`addinDivider_${t}`,displayName:p.Di,itemType:d.n.Divider,onClick:null})}function y(e,t,n,i,r,o,s){const l=a.useCallback((()=>{const t=new f.VL("MessageExtensionApps","AppLoading","","");t.addMetricProps({IsLoadedFirstTime:!c.isLoaded(),EditiorId:e.editorId}),c.import().then((n=>{n(e,i,r,o,s,!0),t.logMetricEnd()}))}),[e,t,n,i,r,o,s]);if(!(0,g.cr)("me-search-global")||!(0,g.cr)("me-search-entrypoint")||(0,g.cr)("mos-messageExtensionsFlyout"))return null;let p=[];if(c.isLoaded()){const t=c.tryImportForRender();t&&(p=t(e,i,r,o,s,!1))}const v=(0,m.ZP)(h.XQ);return{key:"MessageExtensions",name:v,title:v,ariaLabel:v,itemType:d.n.Normal,subMenuProps:{items:p,onMenuOpened:l},iconProps:{iconType:u.T.default,iconName:"OEM"},renderedInOverflow:!0}}const S=new i.Hd((()=>Promise.all([n.e(99458),n.e(64826),n.e(72760),n.e(53515),n.e(33995),n.e(99369),n.e(95397),n.e(63684),n.e(63673),n.e(39053),n.e(57265),n.e(18669),n.e(53059),n.e(31086),n.e(77456),n.e(99110),n.e(42297),n.e(55782),n.e(58247),n.e(44669)]).then(n.bind(n,163915))));(0,r.Kv)(o.L,S,(e=>e.composeMessageExtensionTriggerOrchestrator));const b=new i._5(S,(e=>e.launchMsgExtApp)),I=new i._5(S,(e=>e.executeComposeMessageExtension));(0,r.Kv)(s.o,S,(e=>e.settingsPageTriggerOrchestrator))},357704:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=e=>{if(e){const{shouldEncryptMessageAsSmime:t,shouldSignMessageAsSmime:n}=e;return t||n}return!1}},491962:(e,t,n)=>{"use strict";n.d(t,{av:()=>r.a,Is:()=>u,Fg:()=>m,CW:()=>r.C,RY:()=>a,Ws:()=>c,Zs:()=>h,lp:()=>f,kd:()=>v,Jz:()=>y,jx:()=>E,Y3:()=>w,xs:()=>I,xp:()=>C,lg:()=>b,Qv:()=>S});var i=n(717420),r=n(687893),o=n(913717),s=n(55461);function a(){const e=(0,o.ii)();return e&&(2==e.tableQuery.type||(0,s.cr)("grp-loadFolders")&&3==e.tableQuery.type)}var l=n(624574);function c(e){return!!e&&(2==e.type||d(e)||(0,s.cr)("grp-loadFolders")&&3==e.type)}function d(e){if(!e||1!=e.type)return!1;return e.searchScope.kind==l.D9.Group}function u(e){if(2==e.type)return e.folderId;if((0,s.cr)("grp-loadFolders")&&3==e.type)return e.groupId;if(d(e)){return e.searchScope.groupId}return null}var p=n(672909);function m(e,t){return{type:"GroupMailbox",userIdentity:d(t)?(0,p.Q)().userIdentity:t.mailboxInfo.userIdentity,mailboxSmtpAddress:e}}function h(){const e=(0,o.ii)();return e&&c(e.tableQuery)}function f(){return(0,s.cr)("grp-loadFolders")&&a()}const g=new i.nI((()=>Promise.all([n.e(1627),n.e(33658),n.e(9849),n.e(13717),n.e(51433)]).then(n.bind(n,615750)))),v=new i.EF(g,(e=>e.getGroupDisplayName)),y=new i.EF(g,(e=>e.getGroupDisplayNameFromTableView)),S=new i.EF(g,(e=>e.isPrivateUnjoinedGroup)),b=new i.EF(g,(e=>e.isJoinedGroup)),I=new i.EF(g,(e=>e.getRetentionPolicyTagsForGroup)),w=new i.EF(g,(e=>e.getRetentionPolicyTagListForGroupTableQuery)),C=new i.EF(g,(e=>e.isGroupOwner)),E=new i.EF(g,(e=>e.getGroupUrl))},687893:(e,t,n)=>{"use strict";n.d(t,{C:()=>o,a:()=>s});var i=n(913717),r=n(55461);function o(){return s((0,i.ii)())}function s(e){let t=null;return e&&(2===e.tableQuery.type?t=e.tableQuery.folderId:(0,r.cr)("grp-loadFolders")&&3===e.tableQuery.type&&(t=e.tableQuery.groupId)),t}},29281:(e,t,n)=>{"use strict";n.r(t),n.d(t,{removeMailItemWithData:()=>r,undoLatestDelayedMailItem:()=>o});var i=n(490303);const r=(0,n(371134).lr)("removeMailItemWithData",(function(e){const t=(0,i.b)();for(let n=0;n<t.delayedMailItems.length;n++)if(t.delayedMailItems[n].data==e){t.delayedMailItems.splice(n,1);break}}));const o=(0,n(136947).aD)("undoLatestDelayedMailItem")((function(){const e=(0,i.b)().delayedMailItems.pop();e&&(window.clearTimeout(e.timeoutId),e.afterCancel(e.data))}))},490303:(e,t,n)=>{"use strict";n.d(t,{b:()=>r});const i=(0,n(371134).MT)("delayedSend",{delayedMailItems:[]})();const r=()=>i},205558:(e,t,n)=>{"use strict";n.d(t,{$h:()=>r,mU:()=>a,PZ:()=>s,bh:()=>o});const i=(0,n(371134).MT)("folderForestStore",{selectedNode:{id:null,treeType:"primaryFolderTree",type:0}})(),r=i,o=()=>i;function s(){return r.selectedNode}function a(){const e=s();switch(e.type){case 1:return e.searchFolderId;case 3:return null;default:return e.id}}},606328:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var i=n(828747),r=n(101194);var o=n(112178),s=n(114594),a=n(448259),l=n(527332);function c(e,t,n,c,d,u,p){const m=(0,s.F)();var h;return c&&(m.RequestServerVersion=c),u&&(m.ManagementRole=(h={UserRoles:["MailboxSearch"]},Object.assign({__type:"ManagementRoleType:#Exchange"},h))),(0,o.Z)({Header:m,Body:(0,i.Z)({ItemShape:t,ItemIds:Array.isArray(e)?e.map((e=>(0,r.Z)({Id:e}))):e?[(0,r.Z)({Id:e})]:[],ShapeName:null!=n?n:void 0,InternetMessageId:p})},d).then((e=>{var t,n;return null===(n=null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseMessages)||void 0===n?void 0:n.Items})).then((e=>(0,l.Z)(e).then((()=>e)))).then((t=>{if(!(null==t?void 0:t.length))return null;let n=[];return t.forEach((e=>{n=n.concat(e.Items)})),n.length?Array.isArray(e)||void 0!==p?n:n[0]:null})).catch((e=>(a.g4.warn("GetItem:"+e.message),e)))}},913717:(e,t,n)=>{"use strict";n.d(t,{zi:()=>pe.Z,H4:()=>i,WR:()=>r,a$:()=>p,EH:()=>ge,JF:()=>te.Z,OG:()=>fe,oc:()=>ee.Z,br:()=>L.Z,ZW:()=>k,yw:()=>f,rh:()=>S.Z,sp:()=>S.s,Kr:()=>R.Z,JY:()=>g.Z,au:()=>c,kU:()=>b,xN:()=>u.Z,tN:()=>X,PV:()=>$,op:()=>G,FB:()=>J,gV:()=>K,ll:()=>v,OC:()=>H.OC,OV:()=>w,he:()=>H.he,J2:()=>Q,e6:()=>ae,VH:()=>z,OD:()=>O.Z,lK:()=>A,vu:()=>F,ZA:()=>C.Z,Q6:()=>le,ii:()=>I.Z,XU:()=>ne.Z,q6:()=>E,bh:()=>o.Z,rs:()=>Z.Z,J_:()=>y,JK:()=>M.Z,Ep:()=>D.Z,N_:()=>de,$q:()=>P,Mh:()=>V.Z,jJ:()=>W,E0:()=>me.E,ol:()=>ce,eb:()=>ue,Se:()=>B,dg:()=>_.Z,Fh:()=>se,oP:()=>he,r1:()=>Y,z5:()=>T});var i=n(90591),r=n(780901),o=n(416399),s=n(371134),a=n(178336);const l=(0,s.lr)("createFocusedOtherDropViewState",(function(){(0,o.Z)().focusedOtherDropViewState=(0,a.Z)()}));function c(){const e=(0,o.Z)();return e.focusedOtherDropViewState||l(),e.focusedOtherDropViewState}var d,u=n(770730);!function(e){e[e.None=0]="None",e[e.Previous=1]="Previous",e[e.Next=2]="Next"}(d||(d={}));const p=d;var m=n(409849),h=n(352899);function f(e,t){var n,r,s;const a=(0,o.Z)().expandedConversationViewState;if((null==a?void 0:a.expandedRowKey)!==e||0!==t.tableQuery.listViewType)return!1;const l=i.getConversationId(e,t),c=m.cW.conversations.get(l);let d=0;return(0,h.FD)(e)?d=(null===(n=null==a?void 0:a.forks)||void 0===n?void 0:n.length)||0:(0,h.Lg)(e)&&(d=(null===(r=null==c?void 0:c.conversationNodeIds)||void 0===r?void 0:r.length)||0),d>0&&d===(null===(s=null==a?void 0:a.selectedNodeIds)||void 0===s?void 0:s.length)}var g=n(752375);function v(e){const{isInVirtualSelectAllMode:t,virtualSelectAllExclusionList:n,selectedRowKeys:i,rowKeys:r,totalRowsInView:o,tableQuery:s,isInCheckedMode:a}=e;return t?0===n.length:(r.length==o||1==s.type)&&(a&&i.size==r.length)}function y(e){const{isInCheckedMode:t,isInVirtualSelectAllMode:n,selectedRowKeys:i}=e;return n||t&&i.size>=1}var S=n(94316);function b(e){const t=(0,o.Z)().tableViews.get(e);switch(null==t?void 0:t.tableQuery.type){case 2:return t.serverFolderId;case 0:return t.tableQuery.folderId;default:return null}}var I=n(367953);function w(){const e=(0,I.Z)();return!!e&&1===e.tableQuery.type}var C=n(363126);function E(e){switch(e.tableQuery.type){case 0:case 2:case 3:return e.tableQuery.sortBy;default:throw new Error("getSortByForTable: Table Query type should be either of type group, or mail folder")}}function P(e){if(!e)return null;switch(e.tableQuery.type){case 0:case 2:case 3:case 1:return e.tableQuery.viewFilter;default:throw new Error("Table Query should be either of type search, mail folder or group")}}function T(e){return e&&"Unread"==P(e)}var R=n(563897),x=n(509636);function k(e,t){const n=(0,o.Z)(),i=(0,Z.Z)(e,t);let r=null;return ue(n.tableViews.get(t).tableQuery.folderId)?r=(0,x.CM)(n.inboxPausedDateTime):i&&(r=new Date(i.lastModifiedTimeStamp).toISOString()),{conversationId:i.id,conversationLastSyncTimeStamp:r}}var N=n(448259);function A(e,t){switch(t){case 0:case 1:return e.InstanceKey;default:return N.g4.warn("listViewType:"+t+" not supported"),null}}var D=n(977561),Z=n(732738),M=n(767921),O=n(686346);function F(e,t){const n=[];for(let i=0;i<e.length;i++){const r=t.rowIdToRowKeyMap.get(e[i]);r&&Array.prototype.push.apply(n,r)}return n}var _=n(924583),L=n(801864);function z(e){let t;switch(e){case 0:t="Conversation";break;case 1:t="Message";break;default:t="Unknown"}return t}function B(e){const{isInVirtualSelectAllMode:t,virtualSelectAllExclusionList:n}=e;return t&&n.length>0}var V=n(704326),U=n(866371),q=n(414691);function W(e){return!!e&&((0,U.Z)(e.folderId)===q.Rg||(0,U.Z)(e.folderId)===q._r)}var H=n(238918),j=n(135726);function G(e){switch(e){case 1:return"Date";case 3:return"From";case 5:return"Importance";case 7:return"Size";case 8:return"Subject";default:return(0,j.v)(e)}}function K(e){switch(e){case"All":case"Flagged":case"HasAttachment":case"ToOrCcMe":case"Unread":case"UserCategory":case"Focused":case"Mentioned":case"HasFile":return e;default:(0,j.v)(e)}}function X(e){switch(e){case-1:return"None";case 0:return"Focused";case 1:return"Other";default:(0,j.v)(e)}}function $(e){switch(e){case 0:return"Conversation";case 1:return"Message";case 2:return"CalendarItems";default:(0,j.v)(e)}}function J(e){switch(e){case 0:return"Folder";case 1:return"Search";case 2:return"Group";case 3:return"GroupFolder";default:(0,j.v)(e)}}function Q(e,t,n){const r=[];return t.forEach((t=>{const o=i.getItemIds(t,n);"Flagged"==e.FlagStatus?r.push(o[0]):r.push(...o)})),r}function Y(e,t,n){return!(0,ee.Z)(e)&&(t&&n)}var ee=n(404120),te=n(841874),ne=n(483311),ie=(n(632715),n(194285)),re=n(735403),oe=n(101060);function se(){var e,t;const n=(0,I.Z)(),i=n.selectedRowKeys;if(1!==i.size)return!1;const r=[...i.keys()][0];return(null===(t=null===(e=(0,o.Z)().expandedConversationViewState)||void 0===e?void 0:e.selectedNodeIds)||void 0===t?void 0:t.length)>0&&!f(r,n)}function ae(e){const t=(0,o.Z)(),n=t.tableViews.get(e),i=(0,g.Z)(n),{tableQuery:r,selectedRowKeys:s}=n,a=v(n);if(a||B(n))return(0,C.Z)(a,n,i);const l=se()?t.expandedConversationViewState.selectedNodeIds.length:s.size;return 1==r.listViewType||se()?0===l?(0,oe.ZP)(re.P7):1===l?(0,oe.ZP)(re.Kz):(0,oe.WU)((0,oe.ZP)(re.bF),l):0===l?(0,oe.ZP)(ie.jg):1===l?(0,oe.ZP)(ie.Sw):(0,oe.WU)((0,oe.ZP)(ie.eP),l)}function le(){return(0,o.Z)().expandedConversationViewState.selectedNodeIds}function ce(e,t){return e?-1!==(0,g.Z)(e)||"All"!==t&&"UserCategory"!==t:null}function de(e){return 0===e.tableQuery.type&&"UserCategory"===e.tableQuery.viewFilter?e.tableQuery.categoryName:null}function ue(e){return(0,o.Z)().inboxPausedDateTime&&e&&"inbox"===(0,U.Z)(e)}var pe=n(629604),me=n(460822);function he(e,t){e.currentRowOperation=t,Promise.resolve().then((()=>{e.currentRowOperation=0}))}const fe=(0,s.lr)("clearListViewVirtualization",(e=>{const t=(0,o.Z)();e?(t.scrollTop=0,t.doNotVirtualize=!1):t.doNotVirtualize=!0,t.rowInfoForVLV.clear()})),ge=(0,s.lr)("addNodeAsFork",((e,t)=>{const n=t.shift();if((0,h.FD)(e)&&n){const e=(0,o.Z)(),i=e.expandedConversationViewState.forks,r=i.map((e=>e.id));if((null==r?void 0:r.length)<=1){const n=t[0];i.unshift({id:n,displayNames:[],ancestorIds:t}),e.expandedConversationViewState.selectedNodeIds.push(n)}-1==r.indexOf(n)&&i.unshift({id:n,displayNames:[],ancestorIds:[n]})}}))},770730:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(138272),r=n(580712),o=n(161161),s=n(101060),a=n(913717);function l(e,t,n){if(1===e)return(0,s.ZP)(o.F);if(t){if((0,a.N_)(t))return(0,a.N_)(t);switch((0,a.JY)(t)){case 0:return(0,s.ZP)(r.m);case 1:return(0,s.ZP)(i.f)}}return n}},352899:(e,t,n)=>{"use strict";n.d(t,{FD:()=>o,Lg:()=>s,Fw:()=>a});var i=n(416399),r=n(335779);function o(e){return(0,r.Z)()&&l(e)&&!!(0,i.Z)().expandedConversationViewState.forks}function s(e){return(0,r.Z)()?l(e)&&!(0,i.Z)().expandedConversationViewState.forks:l(e)}function a(e){const t=(0,i.Z)().expandedConversationViewState,n=t.expandedRowKey==e&&t.shouldBeExpanded;return(0,r.Z)()&&n&&!t.forks}function l(e){const t=(0,i.Z)();return t.expandedConversationViewState.expandedRowKey==e&&!t.expandedConversationViewState.shouldBeExpanded}},460822:(e,t,n)=>{"use strict";function i(e){return"persona"===e||"privatedistributionlist"===e||"category"===e}n.d(t,{E:()=>i})},90591:(e,t,n)=>{"use strict";n.r(t),n.d(t,{getArchiveTag:()=>Q,getCanDelete:()=>b,getCategories:()=>I,getConversationId:()=>w,getConversationProperty:()=>te,getDraftItemIds:()=>x,getEffectiveMentioned:()=>Z,getExecuteSearchSortOrder:()=>k,getFlagStatus:()=>D,getFlagType:()=>A,getGlobalItemIds:()=>R,getImportance:()=>J,getInstrumentationContext:()=>j,getIsDraft:()=>G,getIsPinned:()=>C,getIsSnoozed:()=>X,getIsSubmitted:()=>K,getItem:()=>E,getItemIds:()=>P,getLastDeliveryOrRenewTimeStamp:()=>M,getLastDeliveryTimeStamp:()=>F,getLastModifiedTimeStamp:()=>O,getLastSenderMailbox:()=>L,getLastSenderSMTP:()=>z,getLatestGlobalItemId:()=>T,getMailboxGuids:()=>$,getParentFolderId:()=>H,getPolicyTag:()=>Y,getRowClientItemId:()=>q,getRowIdString:()=>U,getRowIdToShowInReadingPane:()=>W,getSize:()=>V,getSubject:()=>_,getUniqueSenders:()=>N,getUnreadCount:()=>B});var i=n(416399),r=n(732738),o=n(767921),s=n(924583),a=n(238918),l=n(874191),c=n(632715),d=n(409849),u=n(352899),p=n(562325),m=n(947239),h=n(335779),f=n(448259),g=n(719360);function v(e){const t=function(e,t){return S({isPinned:t,returnTime:e.returnTime,receivedOrRenewedTime:e.lastDeliveryOrRenewTimeStamp,receivedTime:e.lastDeliveryTimeStamp})}(e,(0,a.he)(e));return t}function y(e){const t=function(e,t){return S({isPinned:t,returnTime:e.ReturnTime,receivedOrRenewedTime:e.ReceivedOrRenewTime,receivedTime:e.DateTimeReceived})}(e,(0,a.Zd)(e));return t}function S(e){const{returnTime:t,receivedOrRenewedTime:n,receivedTime:i,isPinned:r}=e;return!!t||!r&&n&&(o=i,!(new Date(n).setMilliseconds(0)==new Date(o).setMilliseconds(0)));var o}function b(e,t){return ee(e,t,1)}function I(e,t){return ee(e,t,2)}function w(e,t){return ee(e,t,3)}function C(e,t){return ee(e,t,14)}function E(e,t){return ee(e,t,17)}function P(e,t){return ee(e,t,18)}function T(e,t){return ee(e,t,10)}function R(e,t){return ee(e,t,9)}function x(e,t){return ee(e,t,4)}function k(e,t){return ee(e,t,6)}function N(e,t){return ee(e,t,31)}function A(e,t){return ee(e,t,7)}function D(e,t){return ee(e,t,8)}function Z(e,t){return ee(e,t,5)}function M(e,t){return ee(e,t,19)}function O(e,t){return ee(e,t,21)}function F(e,t){return ee(e,t,20)}function _(e,t){return ee(e,t,30)}function L(e,t){return ee(e,t,22)}function z(e,t){return ee(e,t,23)}function B(e,t){return ee(e,t,32)}function V(e,t){return ee(e,t,29)}function U(e,t){return ee(e,t,28)}function q(e,t){return ee(e,t,26)}function W(e,t){return ee(e,t,27)}function H(e,t){return ee(e,t,24)}function j(e,t){return ee(e,t,12)}const G=function(e,t){return ee(e,t,13)},K=function(e,t){return ee(e,t,16)};function X(e,t){return ee(e,t,15)}function $(e,t){return ee(e,t,33)}function J(e,t){return ee(e,t,11)}function Q(e,t){return ee(e,t,0)}function Y(e,t){return ee(e,t,25)}const ee=(0,g.O)(((e,t,n)=>{switch(t.tableQuery.listViewType){case 0:return te(e,t,n);case 1:return function(e,t,n){var i,r;const l=(0,o.Z)(e,t.id);if(!l)return ne("ItemNotInRelations",n),null;const c=l.clientId,u=d.cW.items.get(c.Id);if(!u)return ne("ItemNotInCache",n),null;const p=(0,s.Z)(u)?u:null,m=null===(i=null==p?void 0:p.From)||void 0===i?void 0:i.Mailbox;switch(n){case 28:case 10:return c.Id;case 27:case 26:return c;case 3:return null===(r=null==p?void 0:p.ConversationId)||void 0===r?void 0:r.Id;case 7:return u.Flag;case 8:return u.Flag?u.Flag.FlagStatus:null;case 14:return a.Zd(u);case 17:return u;case 18:case 9:return[c.Id];case 19:return u.ReceivedOrRenewTime;case 20:return u.DateTimeReceived;case 21:return u.LastModifiedTime;case 32:return p&&!p.IsRead?1:0;case 22:return m;case 23:return null==m?void 0:m.EmailAddress;case 31:return m?[m.Name]:null;case 6:return l.executeSearchSortOrder;case 24:return u.ParentFolderId.Id;case 30:return u.Subject;case 29:return u.Size;case 5:return u.MentionedMe;case 13:return u.IsDraft;case 4:return u.IsDraft?[c.Id]:[];case 16:return u.IsSubmitted;case 12:return l.instrumentationContext;case 2:return u.Categories;case 1:return u.CanDelete;case 11:return u.Importance;case 0:return u.ArchiveTag;case 25:return u.PolicyTag;case 15:return y(u);case 33:return null==p?void 0:p.MailboxGuids;default:return null}}(e,t,n);default:return null}}));function te(e,t,n){var o;const s=(0,r.Z)(e,t.id);if(!s)return ne("ConversationNotInCache",n),null;const l=s.id,f=(0,c.Z)(l),g=d.cW.conversations.get(l);let y;switch((null==g?void 0:g.conversationNodeIds)&&g.conversationNodeIds.length>0&&(y=(0,m.df)(g.conversationNodeIds[0])),n){case 28:case 3:return l;case 26:return null==f?void 0:f.clientId;case 27:if((0,h.Z)()){const t=(0,i.Z)().expandedConversationViewState;let n=null;if(t.expandedRowKey==e&&(n=t.selectedNodeIds),!n||n.length<=0||!t.shouldBeExpanded)return{Id:s.itemIds[0],mailboxInfo:null==f?void 0:f.clientId.mailboxInfo};if(1==n.length)return{Id:(0,p.Z)(n[0],(0,u.FD)(e)),mailboxInfo:null==f?void 0:f.clientId.mailboxInfo}}return null==f?void 0:f.clientId;case 7:return null==y?void 0:y.Flag;case 8:return s.flagStatus;case 14:return a.he(s);case 17:return y;case 18:return s.itemIds;case 10:return null==f?void 0:f.globalItemIds[0];case 9:return(null==f?void 0:f.globalItemIds)||[];case 4:return s.draftItemIds||[];case 19:return s.lastDeliveryOrRenewTimeStamp;case 20:return s.lastDeliveryTimeStamp;case 21:return s.lastModifiedTimeStamp;case 32:return s.unreadCount;case 22:return null===(o=s.lastSender)||void 0===o?void 0:o.Mailbox;case 23:return s.lastSender&&s.lastSender.Mailbox.EmailAddress;case 6:return s.executeSearchSortOrder;case 24:return 1===t.tableQuery.type?s.parentFolderId:t.tableQuery.folderId;case 30:return null==f?void 0:f.subject;case 31:return s.uniqueSenders;case 29:return null==f?void 0:f.size;case 5:return s.effectiveMentioned;case 12:return s.instrumentationContext;case 2:return s.categories;case 1:return null==g?void 0:g.canDelete;case 11:return s.importance;case 0:return null==y?void 0:y.ArchiveTag;case 25:return null==y?void 0:y.PolicyTag;case 15:return v(s);case 33:return s.mailboxGuids;default:return null}}function ne(e,t){const n=(0,l.qO)((()=>!0));let i=e+" PropertyType:"+t;n&&(i+=" Scenario:"+n.eventName),f.g4.warn(i,"conversation"),(0,l.y8)(e,{Scenario:null==n?void 0:n.eventName,propertyType:t})}},632715:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(416399);function r(e){return(0,i.Z)().conversationItems.get(e)}},416399:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(559621);const r=(0,n(371134).MT)("listview",{conversationItems:new i.ObservableMap({}),itemContextMenuState:null,selectedTableViewId:null,tableViewConversationRelations:new i.ObservableMap({}),tableViewItemRelations:new i.ObservableMap({}),tableViews:new i.ObservableMap({}),attachmentViewStates:new i.ObservableMap({}),expandedConversationViewState:{expandedRowKey:null,focusedNodeId:null,selectedNodeIds:[],allNodeIds:[],shouldBeExpanded:!1,busStopStateMap:new i.ObservableMap({}),forks:null},rowAttachmentPreviewWellViews:new i.ObservableMap({}),focusedOtherDropViewState:null,rowInfoForVLV:new i.ObservableMap({}),meetingMessageItems:new i.ObservableMap({}),offsetHeight:0,scrollTop:0,inboxPausedDateTime:null,inboxPausedLength:null,txpActionButtonData:new i.ObservableMap({}),lastIndexToRender:0,doNotVirtualize:!1})(),o=()=>r},629604:(e,t,n)=>{"use strict";var i;n.d(t,{Z:()=>r}),function(e){e[e.None=0]="None",e[e.BusStart=1]="BusStart",e[e.BusEnd=2]="BusEnd",e[e.BusStop=3]="BusStop",e[e.NoStop=4]="NoStop",e[e.CheckMark=5]="CheckMark"}(i||(i={}));const r=i},841874:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(404120),r=n(913717);function o(e){return"Unread"==(0,r.$q)(e)&&(0,i.Z)(e)}},404120:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(913717),r=n(274443),o=n(874191);function s(e){if("Unread"!==(0,i.$q)(e))return!0;const t=(0,r.O3)(64);return(0,o.y8)("Unread_Filter_Override",{isAutoReadInUnreadFilterSet:t}),t}},801864:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(732738);function r(e,t,n,r){const o=[],s=new Map;for(let a=0;a<e.length;a++){const l=e[a],c=(0,i.Z)(l,t),d=null==c?void 0:c.id;d&&!s.get(d)&&n(c,r)&&(o.push(l),s.set(d,!0))}return o}},94316:(e,t,n)=>{"use strict";n.d(t,{s:()=>s,Z:()=>a});var i=n(358713),r=n(899147),o=n(55461);function s(e,t){return e.serverFolderId?e.serverFolderId==e.tableQuery.folderId?t?null:a(e.tableQuery):l(e.serverFolderId):null}function a(e){return 2==e.type?(t=e.folderId,(0,i.Z)({Id:(0,o.cr)("grp-junkemailitems")?"junkemail":"inbox",Mailbox:{MailboxType:"GroupMailbox",EmailAddress:t}})):l(e.folderId);var t}function l(e){return(0,r.Z)({Id:e})}},563897:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(460822);function r(e,t){if(0===e.tableQuery.type){const n=e.tableQuery.scenarioType;return t&&!(0,i.E)(n)?e.tableQuery.folderId:e.serverFolderId}return null}},752375:(e,t,n)=>{"use strict";function i(e){if(!e)return-1;switch(e.tableQuery.type){case 0:case 2:case 3:const t=e.tableQuery.focusedViewFilter;return null==t?-1:t;case 1:return-1;default:throw new Error("Table Query should be either of type search, mail folder or group")}}n.d(t,{Z:()=>i})},686346:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(416399),r=n(90591);function o(e,t){const n=(0,i.Z)().tableViews.get(t),o=e.map((e=>(0,r.getRowIdString)(e,n))).filter((e=>e));return o.filter(((e,t)=>o.indexOf(e)==t))}},363126:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var i=n(913717);const r="mTa";var o=n(101060),s=n(933658);const a="nTa";var l=n(735403),c=n(194285);function d(e,t,n){const{tableQuery:d,virtualSelectAllExclusionList:u,totalRowsInView:p}=t;if(e){if(-1!==n)return 0===n?(0,o.ZP)("lTa"):(0,o.ZP)("oTa");if(1==d.type)return(0,o.ZP)(r);if((0,i.N_)(t))return(0,o.WU)((0,o.ZP)(a),(0,i.N_)(t));const e=s.ZP.folderTable.get(d.folderId);return(0,o.WU)((0,o.ZP)(a),(0,s.mH)(e))}if((0,i.Se)(t)){const e=p-u.length;return(0,i.Mh)(t)?(0,o.WU)((0,o.ZP)(c.eP),e):(0,o.WU)((0,o.ZP)(l.bF),e)}return(0,o.ZP)(r)}},367953:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(483311),r=n(416399);function o(){return(0,r.Z)().tableViews.get((0,i.Z)())}},483311:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(416399);function r(){return(0,i.Z)().selectedTableViewId}},732738:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(977561),r=n(416399);function o(e,t){const n=(0,i.Z)(e,t);return(0,r.Z)().tableViewConversationRelations.get(n)}},767921:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(977561),r=n(416399);function o(e,t){const n=(0,i.Z)(e,t);return(0,r.Z)().tableViewItemRelations.get(n)}},977561:(e,t,n)=>{"use strict";function i(e,t){return t+e}n.d(t,{Z:()=>i})},704326:(e,t,n)=>{"use strict";function i(e){return 0===e.tableQuery.listViewType}n.d(t,{Z:()=>i})},924583:(e,t,n)=>{"use strict";function i(e){return!(null==e?void 0:e.ItemClass)||-1!==e.ItemClass.indexOf("IPM.Note")||-1!==e.ItemClass.indexOf("IPM.Schedule.Meeting")||-1!==e.ItemClass.indexOf("IPM.GroupMailbox.JoinRequest")||-1!==e.ItemClass.indexOf("IPM.GroupMailbox.AddMemberRequest")||-1!==e.ItemClass.indexOf("IPM.Post")||-1!==e.ItemClass.indexOf("IPM.Sharing")||-1!==e.ItemClass.indexOf("IPM.Outlook.Recall")}n.d(t,{Z:()=>i})},238918:(e,t,n)=>{"use strict";n.d(t,{he:()=>o,Zd:()=>s,OC:()=>a,GI:()=>l});var i=n(509636);const r=(0,i.ri)("UTC",4500,8,1);(0,i.CM)(r).slice(0,-1);function o(e){return a(e.lastDeliveryOrRenewTimeStamp)}function s(e){return a(e.ReceivedOrRenewTime)}function a(e){if(e===l())return!0;return new Date(e).getTime()==(0,i.u3)(r)}function l(){try{return new Date((0,i.u3)(r)).toLocaleString(),(0,i.vk)(r).toString()}catch(e){return null}}},780901:(e,t,n)=>{"use strict";n.r(t),n.d(t,{DESCENDING_SORT_DIR:()=>r,ASCENDING_SORT_DIR:()=>o,DEFAULT_SORT_COLUMN:()=>s,getSortBySupportingPin:()=>a,getSupportedSortColumns:()=>l,getDefaultSortDirectionForSortColumn:()=>c,getDefaultSortBy:()=>d,isTableMultiValueSort:()=>u});var i=n(866371);const r="Descending",o="Ascending",s=1;function a(){return{sortColumn:1,sortDirection:r}}function l(e){const t=(0,i.Z)(e);return"sentitems"==t||"drafts"==t?[1,7]:[1,3,7,5,8]}function c(e){switch(e){case 1:case 7:case 5:return r;case 3:case 8:return o;default:throw new Error("getDefaultSortDirectionForSortColumn: sortColumn not supported")}}function d(){return{sortColumn:s,sortDirection:c(s)}}function u(e){const t=0==e.type&&e.sortBy.sortColumn;return t&&0==e.listViewType&&3==t}},191266:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(298183);const r=(0,n(371134).lr)("setTypeOfItemBeingDragged",(function(e){(0,i.b)().typeOfItemBeingDragged=e}))},409849:(e,t,n)=>{"use strict";n.d(t,{n1:()=>o.n,er:()=>s.Z,bF:()=>f.Z,VL:()=>l,rV:()=>a.Z,p7:()=>T.Z,bh:()=>r.b,HH:()=>R,QG:()=>x,b$:()=>w.Z,o7:()=>E,B2:()=>b,EG:()=>S,BA:()=>I,pv:()=>P,oM:()=>h,en:()=>v,pA:()=>D,KR:()=>u,cW:()=>r.Z,a6:()=>p.Z,b5:()=>k,FF:()=>N.Z});var i=n(717420),r=n(298183),o=n(288393),s=n(431042),a=n(781406);function l(e,t){return e["ChronologicalNewestOnBottom"==t?0:e.length-1]}var c=n(402906),d=n(742130);function u(e){return(0,a.Z)(e,(0,c.Z)({BaseShape:"IdOnly",AdditionalProperties:[(0,d.Z)({FieldURI:"TailoredXpEntities"}),(0,d.Z)({FieldURI:"TailoredXpCalendarEventIds"}),(0,d.Z)({FieldURI:"TailoredXpEntitiesStatus"}),(0,d.Z)({FieldURI:"EntityNamesMap"})]}),"ItemTailoredXpData","Exchange2013").then((e=>{if(e&&!(e instanceof Error)){const{TailoredXpEntities:t,TailoredXpCalendarEventIds:n,TailoredXpEntitiesStatus:i,EntityNamesMap:r}=e;return{TailoredXpEntities:t,TailoredXpCalendarEventIds:n,TailoredXpEntitiesStatus:i,EntityNamesMap:r}}return{}}))}var p=n(607766),m=n(552542);function h(e){const t=r.Z.conversations.get(e);if(t){const e=(0,m.Z)().UserOptions.ConversationSortOrderReact;return t.conversationNodeIds.length>0&&!t.loadingState.hasLoadFailed&&t.conversationSortOrder==e}return!1}var f=n(881027),g=n(933658);function v(e,t={folderTable:g.ZP.folderTable}){return!!t.folderTable.get(e)}var y=n(414691);function S(e,t){const n=g.ZP.folderTable.get(e);return!!n&&((0,g.Di)(n,y.Yo,t)||n.distinguishedFolderType===y.Rg)}function b(e){return S(e)||function(e){const t=g.ZP.folderTable.get(e);return t&&t.distinguishedFolderType===y.Yo}(e)}function I(e,t,n={folderTable:g.ZP.folderTable}){return(0,g.Di)(e,t,n)}var w=n(449372),C=n(493570);function E(e){return e&&((0,C.Z)(e,y._r)||(0,C.Z)(e,y.Rg))}function P(e){return e&&(I(e,y.CJ)||I(e,y.SO))}var T=n(378148);function R(e,t){try{return x(e,t)}catch(e){return null}}function x(e,t){if(!e||!t)return null;const n=(0,g.Xe)().get(e).PermissionSet.Permissions.filter((e=>e.UserId.PrimarySmtpAddress===t));return null==n?void 0:n[0]}const k=(0,n(371134).lr)("setIsDraftQueuedForSubmission",((e,t)=>{const n=(0,r.b)().items.get(null==e?void 0:e.Id);n&&(n.isDraftQueuedForSubmission=t)}));var N=n(335779);const A=new i.nI((()=>n.e(39154).then(n.bind(n,239154)))),D=new i._5(A,(e=>e.setTriageActionAnnouncement))},562325:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(947239);function r(e,t){var n;return t?e:null===(n=(0,i.df)(e))||void 0===n?void 0:n.ItemId.Id}},607766:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(298183);function r(e){return i.Z.items.get(e)}},781406:(e,t,n)=>{"use strict";function i(e,t,n){e.headers?e.headers.set(t,n):e.headers=new Headers({headerName:n})}n.d(t,{Z:()=>c});var r=n(101862),o=n(55461),s=n(606328);const a=new r.nI((()=>Promise.all([n.e(3918),n.e(71939),n.e(20287)]).then(n.bind(n,220287)))),l=new r._5(a,(e=>e.getItemViaGraphQL));function c(e,t,n,r,a,c,d,u,p,m,h){if("ItemNormalizedBody"==n&&(0,o.cr)("rp-bypassGetMessageHeader")&&(null==m&&(m=function(e){if(e)switch(e.type){case"GroupMailbox":case"PublicMailbox":case"TeamsMailbox":return!0}return!1}(a)),c=c||{},m&&i(c,"X-MessageServiceBypassTrafficSplitter","OWAExplicitDisable"),function(e,t){if(!t)return;const n=[];"UserMailbox"!=t.type&&n.push(t.type),t.userIdentity!=t.mailboxSmtpAddress&&n.push("ExplicitLogon"),0!=n.length&&i(e,"X-CustomOWAScenarioData","MailboxAccess:"+n.join())}(c,a)),(0,o.cr)("mon-rp-loadItemViaGql")){if(!e&&!u)throw new Error("getItem passed a null or undefined id");return l.importAndExecute(e,t,n,r,a,c,d,u,p,h)}return(0,s.Z)(e,t,n,r,c,d,u)}},298183:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a,b:()=>l});var i=n(559621),r=n(371134);const o={conversationNodes:new i.ObservableMap({}),conversations:new i.ObservableMap({}),items:new i.ObservableMap({}),searchFolderDisplayName:null,typeOfItemBeingDragged:null,triageAnnouncement:{message:null,politenessSetting:"off"}},s=(0,r.MT)("mail",o)(),a=s,l=()=>s},881027:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=new(n(75277).z)(50)},288393:(e,t,n)=>{"use strict";var i;n.d(t,{n:()=>i}),function(e){e[e.None=0]="None",e[e.Pending=1]="Pending",e[e.Complete=2]="Complete"}(i||(i={}))},431042:(e,t,n)=>{"use strict";var i;n.d(t,{Z:()=>r}),function(e){e[e.Auto=0]="Auto",e[e.CommandBarArrows=1]="CommandBarArrows",e[e.KeyboardUpDown=2]="KeyboardUpDown",e[e.KeyboardEnter=3]="KeyboardEnter",e[e.KeyboardShiftEnter=4]="KeyboardShiftEnter",e[e.KeyboardCtrlSpace=5]="KeyboardCtrlSpace",e[e.MailListItemBody=6]="MailListItemBody",e[e.MailListItemBodyDoubleClick=7]="MailListItemBodyDoubleClick",e[e.MailListItemCheckbox=8]="MailListItemCheckbox",e[e.MailListItemContextMenu=9]="MailListItemContextMenu",e[e.MailListItemExpansion=10]="MailListItemExpansion",e[e.MailListItemRichPreview=11]="MailListItemRichPreview",e[e.MailListItemTwisty=12]="MailListItemTwisty",e[e.NewConversation=13]="NewConversation",e[e.Reset=14]="Reset",e[e.RowRemoval=15]="RowRemoval",e[e.ImmersiveReadingPaneDelete=16]="ImmersiveReadingPaneDelete",e[e.RouteHandler=17]="RouteHandler",e[e.ToggleCheckAll=18]="ToggleCheckAll",e[e.MessageAd=19]="MessageAd",e[e.SearchSuggestionClick=20]="SearchSuggestionClick",e[e.SingleLineClearSelection=21]="SingleLineClearSelection",e[e.KeyboardHome=22]="KeyboardHome",e[e.KeyboardEnd=23]="KeyboardEnd",e[e.KeyboardShiftHome=24]="KeyboardShiftHome"}(i||(i={}));const r=i},947239:(e,t,n)=>{"use strict";n.d(t,{_5:()=>l,LA:()=>c,df:()=>d});var i=n(205558),r=n(552542),o=n(493570),s=n(298183),a=n(449372);function l(e){const t=(null==e?void 0:e.itemIds)?e.itemIds.length:0;if(0==t)return[null,!1,!1];let n=null,r=2==(0,i.PZ)().type||!(0,i.mU)(),l=!1;if(1==t){if(n=s.Z.items.get(e.itemIds[0]),!n)return[null,!1,!1];r=r||n.ParentFolderId&&n.ParentFolderId.Id==(0,i.mU)()}else{let t=null;for(const a of e.itemIds){const e=s.Z.items.get(a);if(!e)return[null,!1,!1];if(e.ParentFolderId&&e.ParentFolderId.Id==(0,i.mU)()){n=e,r=!0;break}(0,o.Z)(e.ParentFolderId.Id,"sentitems")&&(t=e)}n||(n=t||s.Z.items.get(e.itemIds[0]))}return l=(0,a.Z)(n.ParentFolderId.Id),[n,r,l]}function c(e,t,n){var i;const o=(0,r.Z)(),s=null===(i=null==o?void 0:o.UserOptions)||void 0===i?void 0:i.HideDeletedItems;return e&&!((e.IsDraft||s)&&t&&!n)}function d(e){const t=s.Z.conversationNodes.get(e),[n,i,r]=l(t);return c(n,r,i)?n:null}},378148:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(933658),r=n(205558),o=n(29953);function s(){const e=(0,r.PZ)(),t=5===e.type;let n=null;return n=1===e.type?e.searchFolderId:e.id,n?t&&o.Z.folderTable.has(n)?o.Z.folderTable.get(n):i.ZP.folderTable.has(n)?i.ZP.folderTable.get(n):null:null}},956182:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(378148),r=n(20408);function o(){var e;return(null===(e=(0,i.Z)())||void 0===e?void 0:e.mailboxInfo)||(0,r.fF)()}},449372:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(493570),r=n(414691);function o(e){return e&&((0,i.Z)(e,r.CJ)||(0,i.Z)(e,r.SO))}},23471:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(552542);function r(){const e=(0,i.Z)();return"ChronologicalNewestOnBottom"==(e.UserOptions?e.UserOptions.ConversationSortOrderReact:"ChronologicalNewestOnBottom")}},335779:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var i=n(719360),r=n(226362),o=n(55461),s=n(329746),a=n(888534),l=n(964659);const c=(0,i.O)((()=>{var e,t;let n;if((0,o.cr)("mon-rp-unstackedConversation")){n=0==(null===(t=null===(e=(0,l.c6)())||void 0===e?void 0:e.UserOptions)||void 0===t?void 0:t.GlobalListViewTypeReact)&&!function(){var e,t;let n=null;const i=a.m.tryImportForRender();if(i)n=i();else{const i=(0,s.X)("useNativeConversationOptions"),o=(0,r.zl)(),a=null===(e=(0,l.pX)(o))||void 0===e?void 0:e.PrimeSettings;if(null==a?void 0:a.Items)for(const e of a.Items)if("ReadingPaneConversationOptions"===e.Id&&e.Value){const r=null===(t=e.Value.options)||void 0===t?void 0:t[0];n=i?null==r?void 0:r.conversationEnabledNativeHost:null==r?void 0:r.conversationEnabled;break}null==n&&(n=!i)}return n}()}else n=!1;return n}))},391071:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).aD)("loadSignatureEditorWizard",((e,t)=>({target:e,viewState:t})))},270210:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).aD)("onComposeNativeAddinClose",((e,t)=>({editorId:e,targetWindow:t})))},462844:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).lr)("setDeferredSendTime",((e,t)=>{e.deferredSendTime=t}))},783610:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(531016),r=n(371134);const o=(0,r.aD)("setImportance",((e,t)=>(0,i.uY)({name:"ComposeCommmandSetImportance",customData:[t]},{viewState:e,importance:t})));(0,r.ed)(o,(({viewState:e,importance:t})=>{e.importance=t}));const s=o},42118:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(575398),r=n(371134),o=n(816958);const s=(0,r.lr)("showBccWell",(e=>{e.bccRecipientWell||(e.bccRecipientWell=(0,i.Z)(e.toRecipientWell.userIdentity,e.toRecipientWell.findPeopleFeedbackManager,[],void 0,o.C.MailCompose)),e.isBccShown=!0}))},650122:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(575398),r=n(371134),o=n(816958);const s=(0,r.lr)("showCcWell",(e=>{e.ccRecipientWell||(e.ccRecipientWell=(0,i.Z)(e.toRecipientWell.userIdentity,e.toRecipientWell.findPeopleFeedbackManager,[],void 0,o.C.MailCompose)),e.isCcShown=!0}))},948084:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).lr)("switchToReadWriteRecipient",(function(e){e.showCompactRecipientWell=!1}))},40642:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var i=n(948084),r=n(264694),o=n(977643),s=n(925829),a=n(531016),l=n(371134);const c=(0,l.aD)("toggleFrom",(e=>(0,a.uY)({name:"ComposeCommandShowFrom"},{viewState:e})));(0,l.ed)(c,(({viewState:e})=>{e.fromViewState.isFromShown=!e.fromViewState.isFromShown,e.fromViewState.isFromShown&&!e.fromViewState.from&&(e.fromViewState.from=(0,r.Z)(e.mailboxInfo,void 0,e.referenceItemId))})),(0,l._F)(c,(({viewState:e})=>{e.fromViewState.isFromShown||(0,o.Z)(e,s.o),e.fromViewState.isFromShown&&e.showCompactRecipientWell&&(0,i.Z)(e)}));const d=c},354028:(e,t,n)=>{"use strict";n.d(t,{Z:()=>b,K:()=>E});var i=n(101060),r=n(677493),o=n(733789),s=n(563474),a=n(398327);function l(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"GetDlpPolicyTipsRequest:#Exchange"},n)),(0,a.S)("GetDlpPolicyTips",e,t)}var c=n(954947),d=n(977643),u=n(136947),p=n(32781),m=n(210667),h=n(802925),f=n(629270),g=n(559181),v=n(55461),y=n(448259);const S=(0,u.aD)("triggerPolicyTips")((function(e,t,n,i,o,s){var a,c,u;const g=e.policyTipsViewState,y=(0,m.Z)(e);if(g.handlerDisabled||!(0,v.cr)("cmp-dlp-check-encrypted")&&y==p.j.Encrypted)return;const{inProgressPolicyMatch:S,succeededPolicyMatch:b,pendingPolicyMatch:E}=g;if(n||(n=P(e.subject)),i||(i=P(e.content)),o||(o=(0,r.Z)(e)),s||(s=null===(u=null===(c=null===(a=e.protectionViewState)||void 0===a?void 0:a.clpViewState)||void 0===c?void 0:c.selectedCLPLabel)||void 0===u?void 0:u.id),g.isRequestInProgress)g.pendingRequests=!0,E.itemId=e.itemId,E.subjectChecksum=n,E.contentChecksum=i,E.eventTrigger=t,E.attachmentIds=o,E.CLPLabelId=s;else{if(g.pendingRequests=!1,S.itemId=e.itemId,S.subjectChecksum=n,S.contentChecksum=i,S.eventTrigger=t,S.attachmentIds=o,S.CLPLabelId=s,0==(x=S).subjectChecksum&&0==x.contentChecksum&&0==x.attachmentIds.length)return b.policyMatchDetails=[],b.subjectChecksum=0,b.contentChecksum=0,b.attachmentIds=[],b.CLPLabelId="",void(0,d.Z)(e,"dlpPolicyTips");(T(S,b)||function(e,t){if(e.attachmentIds.length!=t.attachmentIds.length)return!0;for(let n=0;n<e.attachmentIds.length;n++)if(null!=e.attachmentIds[n]&&null!=t.attachmentIds[n]&&e.attachmentIds[n].Id!=t.attachmentIds[n].Id)return!0;return!1}(S,b)||(R=b,S.CLPLabelId!=R.CLPLabelId)||1==t)&&function(e){const{succeededPolicyMatch:t,inProgressPolicyMatch:n}=e.policyTipsViewState,i=e.itemId;if(null==i?void 0:i.Id){const r={ItemId:i,ClientSupportsScanResultData:!0,ScanResultData:t.scanResultData,ScanResultMetadata:t.scanResultMetaData,BodyOrSubjectChanged:T(n,t),NeedToReclassify:!t.itemId,CustomizedStringsNeeded:!0,Recipients:(0,f.wI)(e),EventTrigger:n.eventTrigger};e.policyTipsViewState.isRequestInProgress=!0,l(r,(0,h.Z)(e.mailboxInfo)).then((t=>{I(t,e,w,C)}))}}(e)}var R,x})),b=S;function I(e,t,n,i){const r=t.policyTipsViewState,o=r.pendingPolicyMatch;r.isRequestInProgress=!1,r.pendingRequests&&o&&S(t,o.eventTrigger,o.subjectChecksum,o.contentChecksum,o.attachmentIds,o.CLPLabelId),0==e.EvaluationResult||1==e.OptimizationResult||2==e.EvaluationResult?n(t,e):i(t,e)}function w(e,t){const n=e.policyTipsViewState,{succeededPolicyMatch:i,inProgressPolicyMatch:r}=n;i.itemId=r.itemId,i.attachmentIds=r.attachmentIds,i.subjectChecksum=r.subjectChecksum,i.contentChecksum=r.contentChecksum,i.CLPLabelId=r.CLPLabelId,i.policyMatchDetails=t.Matches,t.ScanResultData&&(i.scanResultData=t.ScanResultData),t.ScanResultMetadata&&(i.scanResultMetaData=t.ScanResultMetadata),1==t.OptimizationResult&&(n.handlerDisabled=!0),function(e,t){if(t){const n=e.policyTipsViewState,i={complianceUrl:t.ComplianceURL,blockString:t.PolicyTipMessageBlockString,notifyString:t.PolicyTipMessageNotifyString,overrideString:t.PolicyTipMessageOverrideString},r=(e,t)=>t||e;(0,s.Z)(n,i,r)}}(e,t.CustomizedStrings),E(e)}function C(e,t){const n=e.policyTipsViewState;t?(y.g4.warn((0,i.WU)("PolicyTips failed with EvaluationResult code of: {0}",t.EvaluationResult)+" Diagnostic: "+t.DiagnosticData),4!=t.EvaluationResult&&7!=t.EvaluationResult&&1!=t.EvaluationResult&&6!=t.EvaluationResult&&8!=t.EvaluationResult||(y.g4.warn("Disabling further PolicyTips requests because of the failure"),n.handlerDisabled=!0)):(y.g4.warn("PolicyTipsResponse is null (PolicyTipsRequest is timed out)"),n.handlerDisabled=!0),(0,d.Z)(e,"dlpPolicyTips")}function E(e){(0,d.Z)(e,["consumerDlpPolicyTips","enterpriseDlpPolicyTips"]);(0,g.z)(e.policyTipsViewState.succeededPolicyMatch)&&((0,c.Z)(void 0,e.mailboxInfo)?(0,o.Z)(e,"consumerDlpPolicyTips"):(0,o.Z)(e,"enterpriseDlpPolicyTips"))}function P(e){let t=0;if(e)for(let n=0;n<e.length;n++)t+=e.charCodeAt(n);return t}function T(e,t){return e.subjectChecksum!=t.subjectChecksum||e.contentChecksum!=t.contentChecksum}},469008:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=(0,n(371134).lr)("updateSubject",(function(e,t){e.subject=t,e.isDirty=!0}))},416894:(e,t,n)=>{"use strict";n.d(t,{gx:()=>r,PU:()=>s,Nc:()=>a,yz:()=>l,lM:()=>c,fv:()=>d,X3:()=>u,GB:()=>p,hb:()=>m,y1:()=>h,aJ:()=>f,AD:()=>g,Wj:()=>v,Jt:()=>y,Gq:()=>S,GW:()=>b,aR:()=>I,Dq:()=>w,or:()=>C,Dy:()=>E,QD:()=>P});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(25671),n.e(3918),n.e(52637),n.e(32557),n.e(39006),n.e(18838),n.e(16025),n.e(19280),n.e(33615),n.e(17483),n.e(56337),n.e(75482),n.e(69390),n.e(11102),n.e(56841),n.e(9152),n.e(90885),n.e(3128),n.e(5989),n.e(44604)]).then(n.bind(n,821393)))),o={captureBundleTime:!0},s=new i._5(r,(e=>e.replyToMessage),o),a=new i._5(r,(e=>e.forwardMessage),o),l=new i._5(r,(e=>e.onRespondExtendedCardAction)),c=new i._5(r,(e=>e.closeCompose)),d=new i._5(r,(e=>e.discardCompose)),u=new i._5(r,(e=>e.loadDraftToCompose)),p=new i._5(r,(e=>e.openCompose)),m=new i._5(r,(e=>e.openComposeAndChangeFrom)),h=new i._5(r,(e=>e.trySaveAndCloseCompose)),f=(new i._5(r,(e=>e.trySaveAndCloseAllMessages)),new i._5(r,(e=>e.moveComposeToTab))),g=new i._5(r,(e=>e.tryCreateResendDraft)),v=new i._5(r,(e=>e.replyToApprovalMessage)),y=new i._5(r,(e=>e.onEditDraftButtonClicked)),S=new i.EF(r,(e=>e.createReply)),b=new i.EF(r,(e=>e.getToCcRecipientsForReply)),I=new i.EF(r,(e=>e.replyToMessageAndCreateViewState)),w=new i.EF(r,(e=>e.createAttachments)),C=new i.EF(r,(e=>e.extractComposePopoutData)),E=new i.EF(r,(e=>e.checkShouldUseFallbackPicker)),P=new i.EF(r,(e=>e.tryGetSmimeViewState))},891235:(e,t,n)=>{"use strict";function i(e){const{IRMData:t}=e.protectionViewState,n=2===e.uiEnabledState;return!(t&&!t.IsOwner&&!t.ForwardAllowed||n)}n.d(t,{Z:()=>i})},264694:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(63132);function r(e,t,n){return{email:t||(0,i.Z)(e,n)}}},868102:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(66621),r=n(447938);function o(e){let t=null,n=null;if(null==e?void 0:e.recipients)for(const o of[...i.Z.viewStates.values()])if(n=(0,r.Z)(o),n.toRecipients===e.recipients||n.ccRecipients===e.recipients||n.bccRecipients===e.recipients){t=o;break}return t}},532371:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>l,VN:()=>c});var i=n(903590),r=n(368777),o=n(954947),s=n(964659),a=n(55461);function l(e,t){let n=[];const o=(0,i.Z)(e);(0,r.Z)(o,e)||n.push(o);const s=c(e,o,t);return n=n.concat(s),n}function c(e,t,n){let i=[];const r=(0,o.Z)(void 0,e);if(r||n){const n=function(e,t){var n;return d(e,t,null===(n=(0,s.pX)(e).SessionSettings)||void 0===n?void 0:n.UserProxyAddresses)}(e,t);i=i.concat(n)}if(r)if((0,a.cr)("cmp-useAccountStoreForFromAddresses"));else{const n=function(e,t){var n;return d(e,t,null===(n=(0,s.pX)(e).SessionSettings)||void 0===n?void 0:n.NotManagedEmailAddresses)}(e,t);i=i.concat(n)}return i}function d(e,t,n){const i=[];return n&&n.length>0&&n.forEach((n=>{t==n||(0,r.Z)(n,e)||i.push(n)})),i}},63132:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var i=n(409849),r=n(552542),o=n(964659),s=n(532371),a=n(903590),l=n(983351),c=n(954947),d=n(55461);var u=n(368777);function p(e){const t=function(e){var t,n,i,s;const u=(0,d.cr)("cmp-from-address-multi-account")?(0,o.pX)(e):(0,r.Z)(),p=(0,c.Z)(void 0,e)?null!==(n=null===(t=u.SessionSettings)||void 0===t?void 0:t.DefaultFromAddress)&&void 0!==n?n:"":null!==(s=null===(i=u.UserOptions)||void 0===i?void 0:i.SendAddressDefault)&&void 0!==s?s:"";return(0,l.DA)(p)?p:(0,a.Z)(e)}(e),n=(0,a.Z)(e);if(n===t&&(0,u.Z)(t,e)){const t=(0,s.VN)(e,n,!0);if(t&&t.length>0)return t[0]}return t}var m=n(629765);function h(e,t){var n,s;let a;if(t){const n=(0,i.bh)(),r=null==n?void 0:n.items,o=r&&r.has(t.Id)&&r.get(t.Id);a=o&&(0,m.Z)(o.ToRecipients,o.CcRecipients,e)}const l=(0,d.cr)("cmp-from-address-multi-account")?(0,o.pX)(e):(0,r.Z)();return{MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:a||p(e),Name:null!==(s=null===(n=l.SessionSettings)||void 0===n?void 0:n.UserDisplayName)&&void 0!==s?s:""}}},903590:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(964659);function r(e){var t,n;return null!==(n=null===(t=(0,i.pX)(e).SessionSettings)||void 0===t?void 0:t.UserEmailAddress)&&void 0!==n?n:""}},629765:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(532371),r=n(265268);function o(e,t,n){return function(e,t){for(let n=0;n<t.length;n++)if(s(t[n],e))return t[n];return null}((e||[]).concat(t||[]),(0,i.ZP)(n,!0))}function s(e,t){if(t&&t.length>0)for(const n of t)if(n&&(0,r.U)(e,n.EmailAddress))return!0;return!1}},368777:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(964659),r=n(954947);function o(e,t){let n=!1;if((0,r.Z)(void 0,t)){const r=(0,i.pX)(t);n=0==(e=e.toLowerCase()).indexOf("outlook_"+r.HexCID)||-1!=e.indexOf("@shadow.outlook.com")}return n}},677493:(e,t,n)=>{"use strict";function i(e){const t=[],n=e.attachmentWell;return n&&(n.docViewAttachments.forEach((e=>{t.push(e.attachmentId)})),n.inlineAttachments.forEach((e=>{t.push(e.attachmentId)})),n.imageViewAttachments.forEach((e=>{t.push(e.attachmentId)}))),t}n.d(t,{Z:()=>i})},629270:(e,t,n)=>{"use strict";n.d(t,{cF:()=>r,$0:()=>o,wI:()=>s});var i=n(716141);const r=e=>[e.toRecipientWell,e.ccRecipientWell,e.bccRecipientWell],o=e=>{const t=r(e);return(0,i.Z)(t).map((e=>e.persona.EmailAddress.EmailAddress))},s=e=>{const t=r(e);return(0,i.Z)(t).map((e=>e.persona.EmailAddress))}},210667:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(32781);function r(e){var t,n,r,o,s;return(null===(n=null===(t=e.protectionViewState)||void 0===t?void 0:t.IRMData)||void 0===n?void 0:n.RmsTemplateId)||(null===(s=null===(o=null===(r=e.protectionViewState)||void 0===r?void 0:r.clpViewState)||void 0===o?void 0:o.selectedCLPLabel)||void 0===s?void 0:s.isEncryptingLabel)?i.j.Encrypted:"HTML"!==e.bodyType?i.j.PlainText:i.j.None}},967575:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(621483),r=n(101060);function o(e){return""==(e=e||"").trim()&&(e=(0,r.ZP)(i.r)),e}},551977:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(868102),r=n(264694),o=n(226362);function s(e){var t,n;const s=(0,i.Z)(e);return(null===(n=null===(t=null==s?void 0:s.fromViewState)||void 0===t?void 0:t.from)||void 0===n?void 0:n.email)?s.fromViewState.from.email.EmailAddress:(0,r.Z)((null==s?void 0:s.mailboxInfo)||(0,o.zl)()).email.EmailAddress}},540407:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(361346),r=n(551977);function o(e,t){let n;const o=(0,r.Z)(e);return o&&(n=(0,i.Z)(t,o)),n}},447938:(e,t,n)=>{"use strict";function i(e){return{toRecipients:e.toRecipientWell?e.toRecipientWell.recipients:[],ccRecipients:e.ccRecipientWell?e.ccRecipientWell.recipients:[],bccRecipients:e.bccRecipientWell?e.bccRecipientWell.recipients:[]}}n.d(t,{Z:()=>i})},498469:(e,t,n)=>{"use strict";function i(e){return(null==e?void 0:e.recipients)?e.recipients.length:0}n.d(t,{Z:()=>i})},405972:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(101060);function r(e){return{"@odata.type":"Microsoft.OutlookServices.Message",Subject:e.subject,Body:{"@odata.type":"Microsoft.OutlookServices.ItemBody",Content:e.content,ContentType:e.bodyType},ToRecipients:o(e.toRecipientWell),CcRecipients:o(e.ccRecipientWell),BccRecipients:o(e.bccRecipientWell),SingleValueExtendedProperties:[{PropertyId:"String {00062008-0000-0000-c000-000000000046} Name EntityExtraction/ExtractLanguage1.0",Value:JSON.stringify([{Language:{Locale:(0,i.gG)()}}])}]}}function o(e){var t;return null===(t=null==e?void 0:e.recipients)||void 0===t?void 0:t.map((e=>{var t,n,i;return{"@odata.type":"Microsoft.OutlookServices.Recipient",EmailAddress:{"@odata.type":"Microsoft.OutlookServices.EmailAddress",Name:(null==e?void 0:e.displayText)||(null===(t=null==e?void 0:e.persona)||void 0===t?void 0:t.DisplayName),Address:null===(i=null===(n=null==e?void 0:e.persona)||void 0===n?void 0:n.EmailAddress)||void 0===i?void 0:i.EmailAddress}}}))}},925829:(e,t,n)=>{"use strict";n.d(t,{o:()=>s,Z:()=>a});var i=n(733789),r=n(977643);const o=(0,n(371134).lr)("setIsFromValid",(function(e,t){e.isFromValid=t})),s="errorMessageInvalidSenderMailCanNotBeSend";function a(e,t,n){o(t,n),n?(0,r.Z)(e,s):(0,i.Z)(e,s)}},119316:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(795307),r=n(522343);async function o(e,t,n,o,s,a){const l=1===o||2===o;(await i.KI.import())(e,((e,n,i)=>{const a={insertOnNewLine:l,position:o,replaceSelection:!1,updateCursor:!1};return e.addUndoSnapshot((()=>{(0,r.default)(t,"Node")?e.insertNode(t,a):"string"==typeof t&&e.insertContent(t,a)}),s),(0,r.default)(t,"Node")&&i.createRange(t,-3)}),((e,t,i)=>(l?e+=n:(e=e.substr(0,t)+n+e.substr(i),t+=n.length,i+=n.length),{value:e,selectionStart:t,selectionEnd:i,focus:!a})))}},644674:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(776463),r=n(918822);function o(e){const t=(0,i.yM)(e);if(t){return!!(0,r.Z)(t.id)}return!1}},265268:(e,t,n)=>{"use strict";n.d(t,{U:()=>o,v:()=>s});var i=n(964659),r=n(672909);function o(e,t){return e===t||!!e&&!!t&&e.toLowerCase()==t.toLowerCase()}function s(e,t){var n;return e&&o(e.EmailAddress,null===(n=(0,i.pX)(null!=t?t:(0,r.Q)()).SessionSettings)||void 0===n?void 0:n.UserEmailAddress)}},950290:(e,t,n)=>{"use strict";n.d(t,{D:()=>s,A:()=>l});var i=n(964659),r=n(874191),o=n(48175);const s=e=>{var t,n;try{const s=(0,o.mp)(e);if(s){const l=(0,o.ZP)(s,e.mailboxInfo),c=null===(t=(0,i.pX)(e.mailboxInfo).SessionSettings)||void 0===t?void 0:t.UserEmailAddress,d=null===(n=e.fromViewState.from)||void 0===n?void 0:n.email,u=null==d?void 0:d.EmailAddress,p=a(s,u,c);(0,r.y8)("MessageSentFromGroupSpace",{SenderType:p,isSendAsGroupEnabled:l,operation:e.operation},{isCore:!0})}}catch(e){}},a=(e,t,n)=>t===e?1:t===n?0:2,l=(e,t)=>{var n;try{const s=(0,o.mp)(e);if(s){const l=(0,o.ZP)(s,e.mailboxInfo),c=null===(n=(0,i.pX)(e.mailboxInfo).SessionSettings)||void 0===n?void 0:n.UserEmailAddress,d=a(s,t,c);(0,r.y8)("ChangeFromInGroupSpace",{newSenderType:d,isSendAsGroupEnabled:l,operation:e.operation},{isCore:!0})}}catch(e){}}},616737:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(769295),r=n(518028),o=n(951789);var s=n(101060);function a(e,t,n){var a,l;if((null===(a=e.attachmentWell.docViewAttachments)||void 0===a?void 0:a.some((e=>e.isCloudy)))||(null===(l=e.attachmentWell.imageViewAttachments)||void 0===l?void 0:l.some((e=>e.isCloudy))))return void(0,o.i)("",(0,s.ZP)("_sb"),!1,{targetWindow:n,hideCancelButton:!0});const{protectionViewState:c,composeId:d,bodyType:u}=e;(0,r.Z)(c,e,t,u)&&i.Cp.import().then((e=>{e((0,i.$4)(d),n)}))}},48175:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>o,mp:()=>s,jc:()=>a});var i=n(55461),r=n(428382);function o(e,t){var n;if(!(0,i.cr)("grp-SendAsOnBehalfOfGrp"))return!1;const o=e?(0,r.Z)(t,e):null;return!!(null===(n=null==o?void 0:o.AdditionalProperties)||void 0===n?void 0:n.SendAsPermission)}function s(e){return e.sendAsGroupId}function a(e){var t,n;const i=s(e);return!!(o(i,e.mailboxInfo)&&i===(null===(n=null===(t=e.fromViewState.from)||void 0===t?void 0:t.email)||void 0===n?void 0:n.EmailAddress))}},230181:(e,t,n)=>{"use strict";n.d(t,{h:()=>a});var i=n(215191),r=n(716141),o=n(762978),s=n(891235);function a(e,t,n,a=!1){const l=(0,r.Z)([e.toRecipientWell,e.ccRecipientWell,e.bccRecipientWell]).some((e=>e.persona.EmailAddress.EmailAddress===t));if((0,s.Z)(e)&&!l){const r=a&&e.ccRecipientWell?e.ccRecipientWell:e.toRecipientWell;(0,i.Z)([(0,o.K)(t)],r,n)}}},867310:(e,t,n)=>{"use strict";n.d(t,{O:()=>r,M:()=>o});var i=n(498469);function r(e){var t,n,i;return e.isDirty||(null===(t=e.toRecipientWell)||void 0===t?void 0:t.isDirty)||(null===(n=e.ccRecipientWell)||void 0===n?void 0:n.isDirty)||(null===(i=e.bccRecipientWell)||void 0===i?void 0:i.isDirty)}function o(e){return(0,i.Z)(e.toRecipientWell)+(0,i.Z)(e.ccRecipientWell)+(0,i.Z)(e.bccRecipientWell)}},458459:(e,t,n)=>{"use strict";n.d(t,{Dc:()=>f,lO:()=>h,eJ:()=>d,Ik:()=>p,gx:()=>o,W7:()=>y,TV:()=>m,xL:()=>l,a1:()=>a,lW:()=>s,r5:()=>v,Td:()=>g,zv:()=>c,Wc:()=>u});var i=n(717420);function r(e,t){const n=new i.EF(e,(e=>e[t]));return(...e)=>n.import().then((t=>t(...e)))}const o=new i.nI((()=>Promise.all([n.e(3918),n.e(52637),n.e(32557),n.e(56337),n.e(42106),n.e(62199),n.e(91992),n.e(72760),n.e(28358),n.e(53515),n.e(7181),n.e(60156),n.e(767),n.e(87412),n.e(77456),n.e(99110),n.e(1627),n.e(33658),n.e(46688),n.e(2678)]).then(n.bind(n,284117)))),s=r(o,"send"),a=r(o,"save"),l=r(o,"runPostOpenTasks"),c=r(o,"switchBodyType"),d=r(o,"discard"),u=r(o,"upConvert"),p=r(o,"insertSignature"),m=r(o,"popoutCompose"),h=r(o,"createAttachments"),f=r(o,"clickAttachButton"),g=r(o,"showMessageOptionsDialog"),v=r(o,"setFromAddress"),y=r(o,"onClickFromMenu")},454926:(e,t,n)=>{"use strict";n.d(t,{I:()=>s});var i=n(525053),r=n(416894),o=n(956182);function s(e,t,n,s,a,l){const c={mailboxInfo:(0,o.Z)(),operation:0,bodyType:"HTML",subject:s,newContent:a,to:e,cc:t,bcc:n,preferAsyncSend:!0,attachmentFilesToUpload:(0,i.Z)(l)};r.GB.importAndExecute(c,2)}},41501:(e,t,n)=>{"use strict";n.d(t,{qL:()=>g,Ii:()=>f,_y:()=>l,TB:()=>d,Ug:()=>m});var i=n(769295),r=n(717420);var o=n(101060),s=n(454926);var a=n(974037);function l(e){if(!e)return!1;if(function(e){return null!=e.RightsManagementLicenseData}(e))return!1;if(e.IsDraft)return!1;if((0,a.s)()&&e.MailboxInfo&&"GroupMailbox"===e.MailboxInfo.type)return!1;{const t=e.ItemClass.toLowerCase();if(function(e){return 0==e.indexOf("ipm.note.smime")&&-1==e.indexOf("ipm.note.smime.multipartsigned")}(t)||function(e){return 0==e.indexOf("report")}(t))return!1}return!0}var c=n(954947);async function d(e,t=null){!(0,c.Z)()&&await i.M.importAndExecute(e,t)}var u=n(491962),p=n(930801);function m(){p.Gv.importAndExecute((()=>d((0,u.Zs)()?i.RT.NotSupported:i.RT.Empty)))}const h=new r.nI((()=>Promise.all([n.e(25671),n.e(3918),n.e(52637),n.e(32557),n.e(18838),n.e(19280),n.e(33615),n.e(17483),n.e(56337),n.e(75482),n.e(69390),n.e(11102),n.e(9598),n.e(42106),n.e(56841),n.e(9152),n.e(90885),n.e(3128),n.e(91992),n.e(71723)]).then(n.bind(n,326004)))),f=new r.EF(h,(e=>e.createMailReadAdapter)),g=new r.EF(h,(e=>e.createMailComposeAdapter));i.lF.sendFeedback=function(){const e=[{Name:(0,o.ZP)("FAc"),EmailAddress:"outlookinclientstorefeedback@service.microsoft.com"}];s.I(e,[],[],(0,o.ZP)("GAc"),(0,o.ZP)("HAc"),[])}},525053:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(769295),r=n(922002),o=n(212971);function s(e){const t=[];if(e)for(const n of e){let e;n.attachmentType==i.P8.Item?e={fileType:r.Y0.MailItem,name:n.name,size:n.size||0,itemId:n.id}:n.attachmentType==i.P8.File&&(e={fileType:r.Y0.Uri,name:n.name,size:n.size||0,uri:n.id,type:(0,o.LG)(n.id)}),e&&t.push({file:e,isInline:n.isInline})}return t}},468068:(e,t,n)=>{"use strict";var i;n.d(t,{U:()=>i}),function(e){e[e.Reply=0]="Reply",e[e.ReplyAll=1]="ReplyAll",e[e.Forward=2]="Forward",e[e.ForwardAsAttachment=3]="ForwardAsAttachment",e[e.ReplyWithMeeting=4]="ReplyWithMeeting"}(i||(i={}))},269622:(e,t,n)=>{"use strict";n.d(t,{_R:()=>s,A3:()=>a,Uj:()=>l,kS:()=>c,GC:()=>d,wK:()=>u,D1:()=>p,hD:()=>m,UN:()=>r.U});var i=n(717420),r=n(468068);const o=new i.nI((()=>Promise.all([n.e(52637),n.e(56337),n.e(42106),n.e(56841),n.e(62600),n.e(90885),n.e(50546),n.e(53515),n.e(97335),n.e(77044),n.e(52542),n.e(81097),n.e(61483),n.e(53198),n.e(32931),n.e(26132),n.e(69295),n.e(26069),n.e(11381),n.e(69385)]).then(n.bind(n,437363)))),s=new i._5(o,(e=>e.onClearMsgPermissions)),a=new i._5(o,(e=>e.onDelete)),l=new i._5(o,(e=>e.onFlagUnflag)),c=new i._5(o,(e=>e.onMarkAsReadUnread)),d=new i._5(o,(e=>e.onResponse)),u=new i._5(o,(e=>e.onSensitivity)),p=new i._5(o,(e=>e.onToggleMessageClassification)),m=new i._5(o,(e=>e.onToggleRmsTemplate))},873896:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(269622);function r(e,t,n){i.wK.importAndExecute(e,t,n)}},343025:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(269622);function r(e,t){i.D1.importAndExecute(e,t)}},359894:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(269622);function r(e,t,n){i.hD.importAndExecute(e,t,n)}},920234:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>c,qW:()=>p,vv:()=>u,KT:()=>d,H2:()=>m});var i=n(20408),r=n(933658);const o=new Map;var s=n(491962),a=n(324112),l=n(913717);function c(e){return e?u(e.tableQuery):(0,i.fF)()}function d(e){return c((0,l.bh)().tableViews.get(e))}function u(e){const t=(0,s.Is)(e),n=null==e?void 0:e.folderId;return null!=t?(0,s.Fg)(t,e):p(n)}function p(e){return(0,r.tA)(e)?(0,a.u9)(e):function(e){if(!e)return(0,i.fF)();if(!o.has(e)){const t=(0,r.dh)(e,!0);o.set(e,t)}return o.get(e)}(e)}function m(e){return{mailboxInfo:u(e)}}},69192:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(136947),r=n(552542);const o=(0,i.aD)("setIRMData")((function(e,t){(function(e){const t=(0,r.Z)();if(t.SegmentationSettings&&!t.SegmentationSettings.Irm)return!1;const{IRMData:n}=e;return null==n||n.RightsManagedMessageDecryptionStatus&&0!=n.RightsManagedMessageDecryptionStatus||n.IsOwner||n.ExportAllowed})(e)&&(t?e.IRMData=t:e.IRMData&&(e.IRMData.RmsTemplateId=null))}))},373924:(e,t,n)=>{"use strict";n.d(t,{b:()=>s,d:()=>o});var i=n(371134),r=n(559621);const o=(0,i.MT)("protection",{clpLabels:[],learnMoreUrl:"",hasMandatoryLabel:!1,hasMandatoryTeamworkLabel:!1,showLouderLabels:!1,labelInheritanceType:"",rmsTemplates:new r.ObservableMap,messageClassifications:new r.ObservableMap})(),s=()=>o},143149:(e,t,n)=>{"use strict";n.d(t,{rg:()=>i,J2:()=>r,Rr:()=>o,_S:()=>s});const i="c026002d-cda6-401e-bfad-28de214d0fba",r="cf5cf348-a8d7-40d5-91ef-a600b88a395d",o="ce1584ed-3033-4a43-a76b-5aed8599329d",s=i},649101:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(55461),r=n(373924),o=n(954947);function s(e){const{clpLabels:t}=r.d;return(0,i.cr)("cmp-clp")&&t.length>0&&t.some((e=>e.isLabelEnabled))&&!(0,o.Z)(void 0,e)}},890959:(e,t,n)=>{"use strict";function i(e,t){var n;return!((null===(n=null==e?void 0:e.contentType)||void 0===n?void 0:n.length)>0)||-1!=e.contentType.indexOf(t)}n.d(t,{Z:()=>i})},940531:(e,t,n)=>{"use strict";function i(e,t){return!!e&&(t&&function(e,t){var n;return e.id==t.id||(null===(n=e.children)||void 0===n?void 0:n.some((e=>e.id==t.id)))}(e,t))}n.d(t,{Z:()=>i})},81605:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(373924);function r(e){const{rmsTemplates:t,messageClassifications:n}=i.d;return e&&e.length>0?e.some((e=>t.has(e)||n.has(e))):t.size>0||n.size>0}},570150:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(143149),r=n(964659);function o(e){if(!(0,r.uf)())return"irmInfoBar";switch(e){case i.rg:return"encryption";case i.J2:return"encryptionDoNotForward";default:return null}}},518028:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var i=n(733789),r=n(977643),o=n(69192),s=n(373924),a=n(570150),l=n(964659),c=n(226362);function d(e,t,n,d){const{IRMData:u}=e,{rmsTemplates:p}=s.d;if(!u||u.RmsTemplateId!=n){u&&(0,r.Z)(t,(0,a.Z)(u.RmsTemplateId));const s=function(e,t){var n;let i;t&&(i={RmsTemplateId:t.RmsTemplateId,IsOwner:!0,RightsManagedMessageDecryptionStatus:0,TemplateName:t.TemplateName,TemplateDescription:t.TemplateDescription,BodyType:e,ContentOwner:null===(n=(0,l.pX)((0,c.B6)()).SessionSettings)||void 0===n?void 0:n.UserEmailAddress,EditAllowed:!1,ReplyAllowed:!1,ReplyAllAllowed:!1,ForwardAllowed:!1,PrintAllowed:!1,ExtractAllowed:!1,ProgrammaticAccessAllowed:!1});return i}(d,p.get(n));if(s)return(0,o.Z)(e,s),(0,i.Z)(t,(0,a.Z)(s.RmsTemplateId)),!0}return!1}},314330:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(373924);function r(e,t){const{IRMData:n}=e;return n&&t&&n.RmsTemplateId==t||n&&!n.IsOwner||0==i.d.rmsTemplates.size||t&&!i.d.rmsTemplates.has(t)}},142547:(e,t,n)=>{"use strict";n.d(t,{o:()=>r});var i=n(717420);const r=(0,n(447424).h)(new i.nI((()=>Promise.all([n.e(25671),n.e(3918),n.e(52637),n.e(32557),n.e(39006),n.e(18838),n.e(16025),n.e(19280),n.e(33615),n.e(17483),n.e(56337),n.e(75482),n.e(69390),n.e(11102),n.e(42106),n.e(56841),n.e(62600),n.e(9152),n.e(90885),n.e(1650)]).then(n.bind(n,788599)))),(e=>e.MailComposeProjectionRibbon))},888534:(e,t,n)=>{"use strict";n.d(t,{m:()=>o});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(8631),n.e(99503)]).then(n.bind(n,538193)))),o=new i.EF(r,(e=>e.isReadingPaneConversationEnabled))},591603:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ProjectionCompose:()=>S});const i="vOrr3",r="Unjga",o="b7vBW";var s=n(92894),a=n(376807),l=n(55461),c=n(66621),d=n(16255),u=n(142547),p=n(989526),m=n(92766),h=n(287382),f=n(717420);const g=new f.nI((()=>n.e(21939).then(n.bind(n,421939)))),v=new f._5(g,(e=>e.getHotkeys));var y=n(101060);const S=(0,s.Pi)((function({composeId:e}){var t;const n=(0,c.b)().viewStates.get(e),s=null!==(t=(0,h.zY)())&&void 0!==t?t:window,f=p.useRef(s.document.body);if((0,m.BO)(f,(()=>v.importAndExecute(s.document)),void 0),p.useEffect((()=>{!function(e,t){e.document.title=t||(0,y.ZP)("QOd")}(s,null==n?void 0:n.subject)}),[]),n){const e=(0,l.cr)("mon-ribbon")&&(0,a.j1)();return p.createElement("div",{className:i},e&&p.createElement(u.o,{composeViewState:n}),!e&&p.createElement("div",{className:r},p.createElement(d.Xd,{composeViewState:n})),p.createElement("div",{id:"FullComposeContainer",className:o},p.createElement(d.G2,{viewState:n})))}return p.createElement("div",null)}));n(458459).gx.importModule("composeProjection")},671463:(e,t,n)=>{"use strict";n.d(t,{gx:()=>o,Dv:()=>s,Zu:()=>r.Z});var i=n(717420),r=n(980084);const o=new i.nI((()=>Promise.all([n.e(25671),n.e(52637),n.e(56337),n.e(42106),n.e(62600),n.e(99458),n.e(64826),n.e(72760),n.e(28358),n.e(52772),n.e(63816),n.e(7181),n.e(96921),n.e(88928),n.e(62122),n.e(16255),n.e(45156),n.e(9458),n.e(47007),n.e(31950)]).then(n.bind(n,143614)))),s=(0,i.$y)(o,(e=>e.ComposeWacRibbon))},980084:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(647451);const r=e=>()=>{var t;const n="AddInlineImage";null===(t=e.current)||void 0===t||t.click(),((e,t,n="")=>{(0,i.nd)(!0,`${e}${n}`,t)})(n,{key:n})}},360947:(e,t,n)=>{"use strict";var i;n.d(t,{Z:()=>r}),function(e){e.CommandingBar="CommandingBar",e.ToolBar="ToolBar"}(i||(i={}));const r=i},332328:(e,t,n)=>{"use strict";n.d(t,{M:()=>p});var i=n(874191),r=n(922002),o=n(732286),s=n(789065),a=n(55461),l=n(729379),c=n(458459),d=n(551977),u=n(594211);async function p(e,t,n,i){if(e.Endpoint===o.Nc.MRUClassic||e.Endpoint===o.Nc.MRUClassicContextual){const o=e.Id,a={fileType:r.Y0.AttachmentItemSuggestion,name:e.FileName,size:parseInt(e.FileSize),attachmentItemId:o,type:s.b$};(0,c.lO)([a],n,{isInline:!1,isHiddenInline:!1,shouldShare:!1},i,void 0,(n=>m(n.Id,e,t)))}else{const r=await o.e_.import(),s=await l.gN.import();await r(e,(r=>{(0,a.cr)("doc-deprecateCloudy-preview-thumbnailView")||(0,a.cr)("doc-fullyDeprecateCloudyMaster")?s([r],(0,u.E)(n),n,(0,d.Z)(n.toRecipientWell),i,n.mailboxInfo):(0,c.lO)([r],n,{isInline:!1,isHiddenInline:!1,shouldShare:!0,isAddedFromSmartDoc:!1},i,void 0,(n=>m(n.Id,e,t)),void 0,void 0)}))}}function m(e,t,n){(0,i.y8)("AttachmentSuggestionClicked",[t.Endpoint,t.Id,n,t.FileSourceType,t.FileExtension,e,t.TraceId],{isCore:!0,excludeFromKusto:!0}),(0,i.y8)("AttachmentSuggestionClickedSampled",{position:n,traceId:t.TraceId})}},995082:(e,t,n)=>{"use strict";n.d(t,{K:()=>d});var i=n(64047),r=n(458459),o=n(409849),s=n(547231),a=n(874191),l=n(990960),c=n(732286);async function d(e,t,n,d,u){const p=t.smartPillViewState.smartDocOption!=s.H.None;if(n.isAddedFromSmartDoc=p,n.isInline&&e.length>0){const n=await l.Rx.import();await n(e,t.inlineImageV2)}const m=[],h=new Promise((async(i,l)=>{e=await(0,r.lO)(e,t,n,u,(e=>{p&&function(e){var t,n;const i=o.cW.items.get(null===(t=e.referenceItemId)||void 0===t?void 0:t.Id);let r="";(null===(n=null==i?void 0:i.SmartDocData)||void 0===n?void 0:n.EntityId)&&(r=i.SmartDocData.EntityId);(0,a.y8)("SmartDocAttachmentsAdded",{smartDocExtractionId:r,readingPaneView:e.smartPillViewState.isConversationItemPart},{isCore:!0,excludeFromKusto:!0}),e.smartPillViewState.smartDocOption=s.H.None}(t),i()}),((e,t,n)=>{m.push(t.Id)}),void 0,void 0)}));if(await h,n.isInline&&e.length>0){(await l.ND.import())(e,t,t.inlineImageV2)}const f=await i.uK.import(),g=(await c.mX.import())(t.referenceItemId,t.mailboxInfo);f({files:e,isInline:n.isInline,shouldShare:n.shouldShare,dataProviderType:d},g||void 0),c.hn.importAndExecute(e,t.referenceItemId,t.suggestedAttachmentSessionId,m,t.mailboxInfo)}},833908:(e,t,n)=>{"use strict";n.d(t,{f:()=>u});var i=n(40330),r=n(874191),o=n(732286),s=n(55461),a=n(64047),l=n(801716),c=n(22046);async function d(e,t,n,i){var r;const s=(null===(r=(0,c.G)(e,"getDocument"))||void 0===r?void 0:r.defaultView)||window;(0,l.l)(e,s,i);const a=(await o.mX.import())(e.referenceItemId,e.mailboxInfo);t.onlineLocation.logUsage(n,a)}function u(e,t,n,l){return{computer:async()=>{const i=new r.Gn("AttachLocalComputerClicked");i.addCustomData([l]),e.computer.current.current?(e.computer.current.current.click(),i.end()):i.endWithError(r.SO.ClientError,new Error("Lazy component not loaded"));const s=(await o.mX.import())(t.referenceItemId,t.mailboxInfo);n.computer.logUsage(l,s)},onlineLocation:async()=>{await d(t,n,l,a.xB.None)},onlineLocationOneDrive:async()=>{await d(t,n,l,(0,i.iF)()?a.xB.OneDrive:a.xB.None)},otherOnlineLocations:async()=>{await d(t,n,l,a.xB.OtherOnlineLocations)},uploadAndShareFromCloud:async()=>{const i=new r.Gn("AttachUploadAndSharedClicked");i.addCustomData([l]),((0,s.cr)("doc-fullyDeprecateCloudyMaster")||(0,s.cr)("doc-deprecateCloudy-preview-thumbnailView"))&&e.onlineLocation.current.current?(e.onlineLocation.current.current.click(),i.end()):(0,s.cr)("doc-fullyDeprecateCloudyMaster")||(0,s.cr)("doc-deprecateCloudy-preview-thumbnailView")||!e.uploadAndShareFromCloud.current.current?i.endWithError(r.SO.ClientError,new Error("Lazy component not loaded")):(e.uploadAndShareFromCloud.current.current.click(),i.end());const a=(await o.mX.import())(t.referenceItemId,t.mailboxInfo);n.uploadAndShareFromCloud.logUsage(l,a)}}}},62054:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>f,pX:()=>v,SR:()=>y});var i,r=n(135726),o=n(64047),s=n(40330),a=n(55461),l=n(210667),c=n(676186),d=n(357704),u=n(647451),p=n(360947),m=n(801716),h=n(732286);function f(e,t,n,c,u){var p;const h={actionName:"computerAttach",onClick:()=>(0,m.g)(c,e,"AttachLocalComputerClicked")},f={actionName:"onlineAttach",onClick:()=>{(0,m.l)(c,u)}},S={actionName:"onlineAttachOneDrive",onClick:()=>{(0,m.l)(c,u,(0,s.iF)()?o.xB.OneDrive:o.xB.None)}},b={actionName:"onlineAttachOtherLocations",onClick:()=>{(0,m.l)(c,u,o.xB.OtherOnlineLocations)}},I={actionName:"computerToCloudAttach",onClick:()=>(0,m.g)(c,(0,a.cr)("doc-fullyDeprecateCloudyMaster")||(0,a.cr)("doc-deprecateCloudy-preview-thumbnailView")?n:t,"AttachUploadAndSharedClicked")},w=(0,l.Z)(c),C=w===o.jf.None;return((0,d.Z)(c.smimeViewState)?y():v(C,w===o.jf.PlainText,!!(null===(p=c.attachmentWell)||void 0===p?void 0:p.groupId))).map((e=>{switch(e){case i.COMPUTER_ATTACHMENT_KEY:return g(s.c.computer,i.COMPUTER_ATTACHMENT_KEY,h.actionName,h.onClick,c);case i.UPLOAD_AND_SHARE_FROM_CLOUD_KEY:return g(s.c.uploadAndShareFromCloud,i.UPLOAD_AND_SHARE_FROM_CLOUD_KEY,I.actionName,I.onClick,c);case i.ONLINE_LOCATION_KEY:return g(s.c.onlineLocation,i.ONLINE_LOCATION_KEY,f.actionName,f.onClick,c);case i.ONLINE_ONEDRIVE_LOCATION_KEY:return g((0,s.RZ)(s.c.onlineLocationOneDrive,!0),i.ONLINE_ONEDRIVE_LOCATION_KEY,S.actionName,S.onClick,c);case i.OTHER_ONLINE_LOCATIONS_KEY:return g((0,s.RZ)(s.c.otherOnlineLocations,!1),i.OTHER_ONLINE_LOCATIONS_KEY,b.actionName,b.onClick,c);default:return(0,r.v)(e)}}))}function g(e,t,n,i,r){var o;const s=null===(o=e.ariaLabel)||void 0===o?void 0:o.call(e),a=r.referenceItemId,l=r.mailboxInfo;return{key:t,name:e.text(),ariaLabel:s,title:s,iconProps:e.iconProps,onClick:(t,r)=>{(0,u.nd)(!0,n,r),i(),h.mX.import().then((t=>{const n=t(a,l);e.logUsage(p.Z.ToolBar,n)}))}}}function v(e,t,n){const r=[],o=(0,c.Z)().ReferenceAttachmentsEnabled&&e;return S()&&r.push(i.COMPUTER_ATTACHMENT_KEY),(S()||o)&&((0,s.xq)(s.bb.OnlineLocation)&&r.push(i.ONLINE_LOCATION_KEY),(0,s.xq)(s.bb.OnlineLocationOneDrive)&&r.push(i.ONLINE_ONEDRIVE_LOCATION_KEY),(0,s.xq)(s.bb.OtherOnlineLocations)&&r.push(i.OTHER_ONLINE_LOCATIONS_KEY)),s.c.uploadAndShareFromCloud.isEnabled(!!n,t)&&r.push(i.UPLOAD_AND_SHARE_FROM_CLOUD_KEY),r}function y(){return[i.COMPUTER_ATTACHMENT_KEY]}function S(){return(0,c.Z)().ClassicAttachmentsEnabled}!function(e){e.COMPUTER_ATTACHMENT_KEY="addMyComputerAttachment",e.ONLINE_LOCATION_KEY="addOnlineLocationAttachment",e.UPLOAD_AND_SHARE_FROM_CLOUD_KEY="addUploadAndShareFromCloud",e.ONLINE_ONEDRIVE_LOCATION_KEY="addOneDriveAttachment",e.OTHER_ONLINE_LOCATIONS_KEY="addOtherOnlineLocations"}(i||(i={}))},594211:(e,t,n)=>{"use strict";function i(e){return{attachmentWell:Object.assign(Object.assign({},e.attachmentWell),{logTraceId:e.logTraceId}),getRecipientWells:()=>[e.toRecipientWell,e.ccRecipientWell,e.bccRecipientWell]}}n.d(t,{E:()=>i})},768219:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(874191),r=n(409849);function o(e){var t;const n=r.cW.items.get(e);(0,i.y8)("AttachButtonClicked",[!0,null===(t=null==n?void 0:n.SmartDocData)||void 0===t?void 0:t.EntityId])}},801716:(e,t,n)=>{"use strict";n.d(t,{g:()=>p,l:()=>m});var i=n(874191),r=n(64047),o=n(509636),s=n(729379),a=n(458459),l=n(551977),c=n(360947),d=n(995082),u=n(594211);function p(e,t,n,r){e.itemId||(0,a.a1)(e);const o=t(),s=new i.Gn(n);s.addCustomData([c.Z.ToolBar]),o?(o.click(),s.end()):s.endWithError(i.SO.ClientError,new Error("Lazy component not loaded"))}function m(e,t,n){const c=(0,o.ri)();(0,a.Dc)(!1,(n=>{(0,i.y8)("FilePickerSelectedFiles",{asLink:!1},{cosmosOnlyData:JSON.stringify({timeSpan:(0,o._Q)((0,o.ri)(),c)})});const r={isInline:n.isInline,isHiddenInline:!1},s=n.shouldShare?Object.assign(Object.assign({},r),{shouldShare:!0}):Object.assign(Object.assign({},r),{shouldShare:!1});(0,d.K)(n.files,e,s,n.dataProviderType,t)}),(async n=>{(await r.uK.import())({files:n.files,isInline:!1,shouldShare:!0,dataProviderType:n.dataProviderType});(await s.gN.import())(n.files,(0,u.E)(e),e,(0,l.Z)(e.toRecipientWell),t,e.mailboxInfo,e.linksContainerId)}),e,t,n)}},881781:(e,t,n)=>{"use strict";n.d(t,{x1:()=>d,Am:()=>u,l3:()=>p});var i=n(66621),r=n(776463),o=n(918822),s=n(629270),a=n(551977),l=n(230181);function c(e,t){const n=i.Z.viewStates.get(e),s=(0,r.bh)().tabs.filter((t=>t.type==r.AO.MailCompose&&t.data==e))[0],a=s&&(0,o.Z)(s.id);if(n){return t(n,(null==a?void 0:a.window)||window)}return null}function d(e){if(e){const t=(0,o.Z)(e);return(null==t?void 0:t.window)||window}return window}function u(e){return c(e,((e,t)=>({targetWindow:t,composeViewState:e,editorViewState:e,accChecker:e.accChecker,expressionId:e.expressionId,ribbonViewState:e.ribbon})))}function p(e){return c(e,((e,t)=>({targetWindow:t,editorViewState:e,fileName:e.subject,composeLinkParameters:{getRecipientWells:()=>(0,s.cF)(e),fromAddress:(0,a.Z)(e.toRecipientWell),linkIdContainer:e.attachmentWell},atMentionHandler:n=>{(0,l.h)(e,n,t)}})))}},648877:(e,t,n)=>{"use strict";n.d(t,{m:()=>m});var i=n(509636),r=n(55461),o=n(649041),s=n(717420);const a=new s.nI((()=>Promise.all([n.e(3918),n.e(56337),n.e(42106),n.e(54964),n.e(50546),n.e(26889),n.e(67627),n.e(74363)]).then(n.bind(n,348834)))),l=new s.EF(a,(e=>e.SuggestionDatePicker)),c=new s._5(a,(e=>e.showScheduleDatePickerDialog));var d=n(537678),u=n(485306),p=n(101060);function m(e,t){c.import().then((n=>{l.import().then((s=>{n({minTime:(0,i.zO)(),onScheduleItemClicked:t,onClose:()=>{d.MD.importAndExecute()},acceptButtonText:(0,p.ZP)(o.h),snapToInterval:!0,targetWindow:e,title:(0,r.cr)("cmp-send-later-suggestions")?u.Gi:void 0,SuggestionDatePicker:(0,r.cr)("cmp-send-later-suggestions")?s:void 0})}))}))}},16255:(e,t,n)=>{"use strict";n.d(t,{gx:()=>r,G2:()=>o,AG:()=>Compose,Xd:()=>s,C1:()=>a});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(52637),n.e(32557),n.e(9598),n.e(56841),n.e(62600),n.e(90885),n.e(36856),n.e(72760),n.e(91566),n.e(28358),n.e(52772),n.e(78098),n.e(63816),n.e(72399),n.e(38282),n.e(7402),n.e(15386),n.e(45961),n.e(20053),n.e(25433)]).then(n.bind(n,159190)))),o=(0,i.$y)(r,(e=>e.FullCompose)),Compose=(0,i.$y)(r,(e=>e.Compose)),s=(0,i.$y)(r,(e=>e.ComposeCommandingBar)),a=(0,i.$y)(r,(e=>e.ComposeTab))},159190:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Compose:()=>Compose,ComposeCommandingBar:()=>Ae,ComposeTab:()=>ba,FullCompose:()=>Pa});var i=n(833908),r=n(740615),o=n(106147),s=n(92894),a=n(874191),l=n(64047),c=n(40330),d=n(732286),u=n(604004),p=n(795307),m=n(215375),h=n(553070),f=n(55461),g=n(579549),v=n(101060),y=n(833845),S=n(112702),b=n(985903),I=n(656761),w=n(618459),C=n(649041),E=n(648767),P=n(96392),T=n(886104),R=n(717781),x=n(43456),k=n(487845),N=n(979716),A=n(791499),D=n(813869),Z=n(4755),M=n(610040),O=n(700252),F=n(440998),_=n(783610),L=n(40642),z=n(210667),B=n(405972),V=n(616737),U=n(458459),q=n(308881),W=n(373924),H=n(143149),j=n(649101),G=n(314330),K=n(658980),X=n(22300),$=n(398751),J=n(964659),Q=n(552542),Y=n(676186),ee=n(357704),te=n(936242),ne=n(297462),ie=n(989526),re=n(432050),oe=n(360947),se=n(332328),ae=n(62054),le=n(343025),ce=n(359894);function de(e,t){const{protectionViewState:n}=e,{clpViewState:i,IRMData:r}=n,{rmsTemplates:o}=W.d;return{items:t.map((t=>{var s;const a=o.get(t);if(a){const t=pe(a,r,e);return t.disabled=(0,G.Z)(n)||(null===(s=i.selectedCLPLabel)||void 0===s?void 0:s.isEncryptingLabel),t}return null})).filter((e=>null!=e))}}function ue(e){const{protectionViewState:t}=e,{IRMData:n}=t,{rmsTemplates:i,messageClassifications:r}=W.d,o=[];return r.forEach((t=>{const n=function(e,t){const{protectionViewState:n}=e,{classificationViewState:i}=n,{Id:r,Name:o}=t,{messageClassification:s}=i,a=s&&s.Id===r;return{name:o,key:r,onClick:()=>{(0,le.Z)(e,t)},canCheck:!0,checked:a}}(e,t);o.push(n)})),i.forEach((i=>{const r=pe(i,n,e);r.disabled=!!(0,G.Z)(t),o.push(r)})),{items:o}}function pe(e,t,n){const{RmsTemplateId:i,TemplateName:r}=e;return{name:r,key:i,onClick:e=>{const t=(null==e?void 0:e.nativeEvent.view)||window;(0,ce.Z)(n,i,t)},canCheck:!0,checked:t&&t.RmsTemplateId==i}}var me=n(653348);const he="aUO1a",fe="aBnwL",ge="NvhAZ",ve="Pzosc";function ye(e){const{roamingSignatureMap:t}=(0,me.s)(e.mailboxInfo);if(0==t.size)return;const n=[];return t.forEach((t=>{let i;if(t.html)i=t.html.name;else{if(!t.txt)return;i=t.txt.name}n.push({name:i,title:i,className:ge,onClick:()=>{(0,U.Ik)(e,t)},key:i})})),n}var Se=n(940531),be=n(763754),Ie=n(873896),we=n(890959);function Ce(e,t,n,i){let r=Ee(e,t,n,i);const{learnMoreUrl:o}=W.d;return r?(o&&(r=r.concat(function(e){return[{key:"divider",itemType:be.n.Divider},{name:(0,v.ZP)(A.Ou),title:(0,v.ZP)(A.VP),onClick:()=>{window.open(e,"_blank")},key:"LearnMore",canCheck:!1,checked:null}]}(o))),r):null}function Ee(e,t,n,i){if(!e||e.length<=0)return[];const r=[],{protectionViewState:o}=t,{clpViewState:s}=o;return e.filter((e=>e.isLabelEnabled&&(!(0,f.cr)("cmp-clp-label-scoping")||(0,we.Z)(e,"email")))).forEach((e=>{r.push({name:e.displayName,title:e.tooltip,onClick:()=>{(0,Ie.Z)(t,e,i)},key:e.id,disabled:n&&e.isEncryptingLabel,canCheck:!0,checked:(0,Se.Z)(e,s.selectedCLPLabel),subMenuProps:e.children&&e.children.filter((e=>e.isLabelEnabled)).length>0?{items:Ee(e.children,t,n,i)}:null})})),r}var Pe=n(81605),Te=n(159686),Re=n(768219),xe=n(820263),ke=n(764403),Ne=n.n(ke);const Ae=(0,s.Pi)((function(e){var t;const n={computer:ie.useRef(ie.createRef()),onlineLocation:ie.useRef(ie.createRef()),onlineLocationOneDrive:ie.useRef(ie.createRef()),otherOnlineLocations:ie.useRef(ie.createRef()),uploadAndShareFromCloud:ie.useRef(ie.createRef()),targetWindow:ie.useContext(K.Z)},s=ie.useRef();s.current||(s.current=null===(t=d.kg.tryImportForRender())||void 0===t?void 0:t(!0));const le=(0,X.v)((()=>{const{composeViewState:t}=e;if(e.composeViewState.isSending)return[pe.get()];{let e;return e=(0,q.Z)(t)?[me.get(),ge.get(),we.get(),Ee.get(),Oe.get(),Fe.get(),Le.get(),ze.get(),Ae.get(),De.get(),Ze.get()]:[ce.get(),me.get(),ge.get(),Se.get(),we.get(),Ee.get(),ke.get(),Me.get(),Oe.get(),be.get(),Ie.get(),Fe.get(),_e.get(),Le.get(),ze.get(),Ae.get(),De.get(),Ze.get()],e}})),ce=(0,X.v)((()=>new g.k_({0:"customItem",4:0,9:()=>{var t;return ie.createElement("div",{style:{paddingRight:e.leftPadding}},null===(t=e.renderCustomItem)||void 0===t?void 0:t.call(e))}}))),pe=(0,X.v)((()=>new g.k_({0:(0,v.ZP)(N.v),4:0,9:()=>ie.createElement("div",{className:he},ie.createElement(o.$,null),ie.createElement("span",{className:fe},(0,v.ZP)(N.v)))}))),me=(0,X.v)((()=>{const{composeViewState:t}=e,i=0!==t.uiEnabledState;let r;return r=(0,q.Z)(t)?(0,v.ZP)(re.Bl):(0,v.ZP)(C.h),new g.k_({0:r,1:"Send",2:()=>{(0,U.lW)(t,n.targetWindow)},4:0,5:i})})),ge=(0,X.v)((()=>{var t,r;const o=e.composeViewState,a=(0,ee.Z)(o.smimeViewState),d=(0,i.f)(n,o,c.c,oe.Z.CommandingBar),u=Object.keys(c.c).reduce(((e,t,n,i)=>{var r;const o=t,s=c.c[o],a=null===(r=s.ariaLabel)||void 0===r?void 0:r.call(s),l=new g.k_({0:"onlineLocationOneDrive"===o||"otherOnlineLocations"===o?(0,c.CU)(o):s.text(),2:()=>{d[o]()}});return l.iconProps=s.iconProps,l.ariaLabel=a,l.title=a,e[o]=l,e}),{}),p=[],m=(0,Y.Z)(),h=null==m?void 0:m.ClassicAttachmentsEnabled,f=null==m?void 0:m.ReferenceAttachmentsEnabled,y=(0,z.Z)(o),b=!(!f||y!==l.jf.None),I=y===l.jf.PlainText;if(h&&p.push(u.computer),!a){(h||f)&&((0,c.xq)(c.bb.OnlineLocation)&&p.push(u.onlineLocation),(0,c.xq)(c.bb.OnlineLocationOneDrive)&&p.push(u.onlineLocationOneDrive),(0,c.xq)(c.bb.OtherOnlineLocations)&&p.push(u.otherOnlineLocations)),c.c.uploadAndShareFromCloud.isEnabled(!!(null===(t=o.attachmentWell)||void 0===t?void 0:t.groupId),I)&&p.push(u.uploadAndShareFromCloud);const e=null===(r=s.current)||void 0===r?void 0:r.getContextualMenuItems(!a,o.referenceItemId,b,!0,!I,((e,t)=>{(0,se.M)(e,t,o,n.targetWindow)}),o.suggestedAttachmentSessionId,o.mailboxInfo);e&&p.push(...e)}const w={items:p,onMenuOpened:()=>{var e,t;(0,Re.Z)(null===(e=o.referenceItemId)||void 0===e?void 0:e.Id),null===(t=s.current)||void 0===t||t.onMenuOpened(!a,o.referenceItemId,o.composeId,(a?(0,ae.SR)():(0,ae.pX)(!b,I)).join(","),b,!0,!I,(0,B.Z)(o),o.suggestedAttachmentSessionId,o.mailboxInfo)},onMenuDismissed:()=>{var e;null===(e=s.current)||void 0===e||e.onMenuDismissed(!a,o.referenceItemId,b,!0,!I,o.mailboxInfo)}},C=!h&&!f||Ue()||(0,Te.Z)(o);return new g.k_({0:(0,v.ZP)(S.QV),1:"Attach",5:C,6:w})})),Se=(0,X.v)((()=>{const t=e.composeViewState,i=(0,ee.Z)(t.smimeViewState),{clpLabels:r}=W.d,o=Ce(r,t,i,n.targetWindow);return new g.k_({0:(0,v.ZP)(A.LH),1:"MarkAsProtected",3:()=>(0,j.Z)(),5:Ue(),6:o})})),be=(0,X.v)((()=>{const{RmsV2UIEnabled:t}=(0,Q.Z)();return new g.k_({0:(0,v.ZP)(w.Es),3:()=>!!((0,h.Z)()&&(0,j.Z)()&&t&&(0,Pe.Z)([H.rg,H.J2])),4:2,5:(0,G.Z)(e.composeViewState.protectionViewState)||Ue(),6:de(e.composeViewState,[H.rg,H.J2])})})),Ie=(0,X.v)((()=>{const{RmsV2UIEnabled:t}=(0,Q.Z)();return new g.k_({0:(0,v.ZP)(w.YA),3:()=>!(!(0,h.Z)()||t||!(0,Pe.Z)()),4:2,5:!(!(0,G.Z)(e.composeViewState.protectionViewState)||0!=W.d.messageClassifications.size),6:ue(e.composeViewState)})})),we=(0,X.v)((()=>{const{composeViewState:t}=e,{protectionViewState:i}=t,r=(0,G.Z)(i)||Ue(),{RmsV2UIEnabled:o}=(0,Q.Z)();if((0,J.uf)()){const e=new g.k_({0:(0,v.ZP)(re.JO),2:()=>{(0,V.Z)(t,H.rg,n.targetWindow)},5:!!(0,G.Z)(i,H.rg)}),o=new g.k_({0:(0,v.ZP)(re.Dy),2:()=>{(0,V.Z)(t,H.J2,n.targetWindow)},5:!!(0,G.Z)(i,H.J2)});return new g.k_({0:(0,v.ZP)(w.Es),1:"Encryption",3:()=>!(!(0,h.Z)()||r||!(0,Pe.Z)()),5:r,6:[e,o]})}return new g.k_({0:(0,v.ZP)(w.Es),1:(0,j.Z)()?void 0:"Encryption",2:()=>{(0,V.Z)(t,H._S,n.targetWindow)},3:()=>!(!(0,h.Z)()||(0,j.Z)()||r||!o||!(0,Pe.Z)()),4:(0,j.Z)()?2:void 0,5:r})})),Ee=(0,X.v)((()=>new g.k_({0:(0,v.ZP)(I.f),1:"Delete",2:()=>{(0,U.eJ)(e.composeViewState,n.targetWindow)}}))),ke=(0,X.v)((()=>new g.k_({0:(0,v.ZP)(k.D),2:()=>{(0,U.a1)(e.composeViewState),(0,p.RX)(e.composeViewState)},4:2,5:Ue()}))),Ae=(0,X.v)((()=>{const e=xe.rp.tryImportForRender(),t=null==e?void 0:e();return new g.k_({1:"ZoomIn",3:()=>(0,f.cr)("rp-embiggen")&&!(0,f.Pg)(),4:1,5:Ue(),11:(0,v.ZP)(F.Ts),12:(0,v.ZP)(F.Ts),6:t})})),De=(0,X.v)((()=>new g.k_({1:"OpenInNewWindow",2:()=>{(0,U.TV)(e.composeViewState)},3:()=>!(0,ne.I3)()&&n.targetWindow===window,4:1,5:Ue(),11:(0,v.ZP)(x.X),12:(0,v.ZP)(x.X)}))),Ze=(0,X.v)((()=>new g.k_({11:(0,v.ZP)(b.rS),4:1,9:()=>ie.createElement(u.j,null),3:()=>(0,f.cr)("mon-ribbon"),12:(0,v.ZP)(b.rS)}))),Me=(0,X.v)((()=>{if((0,$.Z)()){const t=ye(e.composeViewState);return new g.k_({0:(0,v.ZP)(P.I),2:()=>{t&&0!=t.length||(0,U.Ik)(e.composeViewState)},4:2,5:Ue(),6:t})}return new g.k_({0:(0,v.ZP)(P.I),2:()=>{const t=new a.Gn("ComposeCommandInsertSignature");(0,U.Ik)(e.composeViewState).then((()=>{t.end()}))},4:2,5:Ue()})})),Oe=(0,X.v)((()=>new g.k_({0:e.composeViewState.fromViewState.isFromShown?(0,v.ZP)(re.Bm):(0,v.ZP)(Z.M),2:()=>{(0,L.Z)(e.composeViewState),(0,p.RX)(e.composeViewState)},3:()=>!e.composeViewState.fromViewState.isFromReadOnly,4:2,5:(0,ee.Z)(e.composeViewState.smimeViewState)||Ue()}))),Fe=(0,X.v)((()=>new g.k_({0:(0,v.ZP)(D.a),4:2,5:Ue(),6:[Be((0,v.ZP)(E.X),"High"),Be((0,v.ZP)(R.h),"Normal"),Be((0,v.ZP)(T.I),"Low")]}))),_e=(0,X.v)((()=>new g.k_({0:(0,v.ZP)(M.S),2:()=>{(0,U.Td)(e.composeViewState,n.targetWindow)},3:()=>(0,te.Z)(),4:2,5:Ue()}))),Le=(0,X.v)((()=>{const{composeViewState:t}=e,i="HTML"!=t.bodyType;return new g.k_({0:i?(0,v.ZP)(re.mc):(0,v.ZP)(O.A),2:()=>(0,U.zv)(t,n.targetWindow),4:2,5:Ue()})})),ze=(0,X.v)((()=>{const{composeViewState:t}=e,n="HTML"!=t.bodyType;return new g.k_({0:(0,v.ZP)(y.g),2:Ve,4:2,5:n||Ue(),10:t.accChecker.isOpen,14:!0})})),Be=(t,n)=>{const{composeViewState:i}=e;return new g.k_({0:t,2:()=>{(0,_.Z)(i,n),(0,p.RX)(i)},10:i.importance==n,14:!0})},Ve=()=>{const{composeViewState:t}=e,{accChecker:i}=t;i.isOpen?m.go.import().then((e=>e(i,n.targetWindow))):m.IY.import().then((e=>e(i,t,n.targetWindow)))},Ue=()=>2===e.composeViewState.uiEnabledState,qe=(0,r.B)(n,c.c,e.composeViewState,n.targetWindow);return ie.createElement("span",null,ie.createElement(l.MN,{ref:n.computer.current,fileSelectionFilter:l.lq.None,action:l.QJ.Attach,createAttachmentHandler:qe.computer}),ie.createElement(l.MN,{ref:n.onlineLocation.current,fileSelectionFilter:l.lq.None,action:l.QJ.Attach,createAttachmentHandler:qe.uploadAndLinkFromCloud}),ie.createElement(l.MN,{ref:n.uploadAndShareFromCloud.current,fileSelectionFilter:l.lq.None,action:l.QJ.InsertAsLink,createAttachmentHandler:qe.uploadAndShareFromCloud}),ie.createElement(g.dV,{className:Ne()(ve),filterableItems:le.get(),elipisisAriaLabel:(0,v.ZP)(re.Qb)}))}));var De=n(180955),Ze=n(769295),Me=n(371134);const Oe=(0,Me.lr)("setIsAutorunComposeEventTriggered",(e=>{e.isAutorunComposeEventTriggered=!0}));var Fe=n(249395),_e=n(364913),Le=n(824829),ze=n(514327),Be=n(803571),Ve=n(256548),Ue=n(833824),qe=n(429461),We=n(576421);class He{constructor(){this.htmlEditor=null,this.plainTextEditor=null}getName(){return"EditorRefWorkaround"}initialize(e){this.htmlEditor=e}dispose(){this.htmlEditor=null,this.plainTextEditor=null}}var je=n(853947),Ge=n(92766),Ke=n(347122),Xe=n(41501),$e=n(491962),Je=n(974037),Qe=n(954947);function Ye(e){var t,n;return!!(0,f.cr)("mon-show-addins")&&(!((null===(n=null===(t=e.protectionViewState)||void 0===t?void 0:t.IRMData)||void 0===n?void 0:n.RmsTemplateId)&&(!(0,f.cr)("addin-enableAddinsForIRM")||(0,Qe.Z)()))&&(!(0,Je.s)()||!(0,$e.Zs)()))}var et=n(717420);const tt=new et.nI((()=>n.e(39339).then(n.bind(n,939339))));var nt=n(270210),it=n(629270),rt=n(867310);const ot=new et.nI((()=>Promise.all([n.e(52637),n.e(56337),n.e(42106),n.e(62199),n.e(91992),n.e(50546),n.e(53515),n.e(77044),n.e(30792),n.e(18442),n.e(32062)]).then(n.bind(n,714793)))),st=(0,et.$y)(ot,(e=>e.ComposeInfoBar));var at=n(494711),lt=n(537678),ct=n(928541),dt=n(394834),ut=n(702542),pt=n(776463),mt=n(951356),ht=n(401842),ft=n(364332),Droppable=n(79810),gt=n(937118),vt=n(119316),yt=n(922002),St=n(551977),bt=n(729379),It=n(995082),wt=n(594211),Ct=n(789568);var Et=n(648172),Pt=n(672760),Tt=n(329746),Rt=n(298183),xt=n(821462),kt=n(191266);const Nt={bodyContainer:"h04ZZ",hasAttachment:"BJfGZ",isInlineCompose:"Cx40O",sticky:"NM9vk",editorCommon:"tEMfE",hasRibbon:"Umiif",plainTextEditor:"zx03O",darkMode:"SPY2A",editorBody:"dbf5I",virtualEdit:"zfSMW",virtualEditScroller:"VlCDS",showHistoryButton:"Ib8ZO",showHistoryButtonIcon:"L_Aur",draftSaveTimeContainer:"izeco"};var At=n(254712),Dt=n.n(At);const Zt=Dt().bind(Nt),Mt=(0,s.Pi)((function(e){const{viewState:t,children:n}=e,{attachmentWell:i,isInlineCompose:r,docking:o,smimeViewState:s,dropViewState:d,uiEnabledState:u}=t,m=ie.useContext(K.Z),h=i.docViewAttachments&&i.docViewAttachments.length>0||i.imageViewAttachments&&i.imageViewAttachments.length>0,g=Zt(Nt.bodyContainer,{hasAttachment:h,isInlineCompose:r,sticky:!!o&&!r,darkMode:(0,mt.Z)(t)}),v=ie.useRef();ie.useEffect((()=>()=>{I()}));const y=ie.useCallback((e=>{var n;let i=null,r=!1;const o=(0,ee.Z)(s);switch(e.itemType){case gt.X.LocalFile:const s=e;i=(0,yt.hv)(s.files);break;case gt.X.MailListRow:case gt.X.MultiMailListConversationRows:case gt.X.MultiMailListMessageRows:const l=e;i=(0,yt.gl)(l.subjects,l.latestItemIds,o?l.sizes:[]);break;case gt.X.MailListItemPart:const c=e;i=(0,yt.gl)(c.subjects,c.itemIds,o?l.sizes:[]);break;case gt.X.Attachment:case gt.X.SharePointFile:const d=e;i=[d.attachmentFile],r=d.attachmentFile.fileType===yt.Y0.Cloud||d.attachmentFile.fileType===yt.Y0.CloudSuggestion||d.attachmentFile.fileType===yt.Y0.ContextualSuggestion;break;case gt.X.NoteFeedItem:const u=e;(0,p.RX)(t);const m=null===(n=(new DOMParser).parseFromString(Pt.default.sanitizeHtml(u.htmlContent),"text/html").documentElement.getElementsByTagName("div")[0])||void 0===n?void 0:n.firstElementChild;if(m){(0,vt.Z)(t,m,"",3,"Notes",!1);const e=u.feedItemType;(0,a.y8)("noteFeedItemDragToMail",{FeedNoteType:e},{isCore:!0}),(0,Tt.X)("floodgate")&&"SamsungNote"===e&&Et.Y.import().then((e=>{e("OneNoteFeedSamsungNoteCopiedOrDropped")}))}}if(i){(0,a.y8)("AttachmentDragAndDrop",[e.itemType]);const n={isInline:!1,isHiddenInline:!1},o=r?Object.assign(Object.assign({},n),{shouldShare:!0}):Object.assign(Object.assign({},n),{shouldShare:!1}),s=(0,f.cr)("doc-fullyDeprecateCloudyMaster")||(0,f.cr)("doc-deprecateCloudy-preview-thumbnailView");if(e.itemType===gt.X.LocalFile){const e=function(e,t,n){return c.c.computer.getCreateAttachmentHandler(e.attachmentWell,((n,i,r)=>(0,It.K)(n,e,i,r,t)),(0,z.Z)(e),t,e.mailboxInfo,(async n=>{(await l.uK.import())({files:n.files,isInline:!1,shouldShare:!0,dataProviderType:n.dataProviderType});const i=await bt.gN.import(),r=await Ct.e4.import();i(n.files,(0,wt.E)(e),e,(0,St.Z)(e.toRecipientWell),t,e.mailboxInfo,e.linksContainerId,void 0,r(e.attachmentWell.groupId,n.properties))}),n)}(t,m,s);e({files:i,shouldShare:r,isInline:!1,dataProviderType:null},m)}else if(e.itemType===gt.X.SharePointFile&&s){const e=bt.gN.tryImportForRender();null==e||e(i,(0,wt.E)(t),t,(0,St.Z)(t.toRecipientWell),window,t.mailboxInfo)}else(0,U.lO)(i,t,o,m,void 0)}}),[s,t,m]),S=ie.useCallback((e=>{const n=2===u;if(!(0,Y.Z)().ClassicAttachmentsEnabled||(0,Te.Z)(t)||n)return!1;const i=e.itemType;return i===gt.X.LocalFile||i===gt.X.MailListItemPart||i===gt.X.MailListRow||i===gt.X.MultiMailListConversationRows||i===gt.X.MultiMailListMessageRows||i===gt.X.Attachment||i===gt.X.NoteFeedItem||i===gt.X.SharePointFile}),[t,u]),b=ie.useRef();const I=ie.useCallback((()=>{b.current&&(m.clearInterval(b.current),b.current=null)}),[]);const w=function(e){const t=ie.useRef(),n=ie.useCallback((n=>{t.current=Date.now(),b.current||(b.current=m.setInterval((()=>{(!(null==t?void 0:t.current)||Date.now()-t.current>=3e3)&&(e(null),I())}),3e3)),e(n.itemType)}),[]),i=ie.useCallback((()=>{e(null),I()}),[]);return m.opener?{onDragOver:n,onDragLeave:i}:{}}((function(e){Rt.Z.typeOfItemBeingDragged!=e&&((0,kt.Z)(e),(0,xt.k)(e))}));return ie.createElement(Droppable.Z,Object.assign({ref:v},w,{id:(0,Ve.k)(o,"DockingTriggerPart"),classNames:g,dropViewState:d,onDrop:y,canDrop:S,shouldUseCopyAsDropEffect:!0,shouldIgnoreTransientOnDragLeave:!0}),n)})),Ot="pAc",Ft="qAc";var _t=n(126875),Lt=n(20408),zt=n(942278),Bt=n(920234),Vt=n(324112);function Ut(e){if((0,at.Z)(e))return(0,Lt.uH)(e.groupId);if((0,q.Z)(e)){const t=e;return(0,Vt.u9)(t.publicFolderId)}if((0,zt.Z)(e)){const t=e;return(0,Bt.qW)(t.folderOwnerEmailAddress)}return e.mailboxInfo}var qt=n(567144),Wt=n(239913),Ht=n(679539),jt=n(354028),Gt=n(341747),Kt=n(990960);function Xt(e,t,n){const i=(0,St.Z)(t.toRecipientWell);return(r,o,s,a,l,c)=>{!async function(e,t,n,i,r,o,s,a,l){(await bt.FM.import())(e,(0,wt.E)(t),n,i,r,o,s,a,l,t.linksContainerId)}(e,t,r,o,a,l,i,n,(()=>{c(s)}))}}const $t=(0,s.Pi)((function(e){const{viewState:t}=e,{itemId:n,uiEnabledState:i,attachmentWell:r,bodyType:o,inlineImageV2:s}=t,a=Object.assign(Object.assign({},n),{mailboxInfo:(0,_t.X)(t,(()=>Ut(t)))}),c=2===i,d=ie.useContext(K.Z),u=ie.useCallback((()=>{(0,Wt.F)(r,(0,v.ZP)(Ft)),(0,Ht.T)()&&(0,jt.Z)(t,16)}),[t,r,Ft]),m=ie.useCallback((async(e,n)=>{(await Ct.c7.import())(r,e,n);const i=(0,Gt.Z)(e.attachmentId);if(i){(await Kt.C1.import())(i,t,s)}}),[t,r,s]),h=ie.useCallback((()=>{(0,p.RX)(t)}),[t]),f=ie.useCallback((()=>(0,z.Z)(t)===l.jf.None),[t]);return ie.createElement(qt.F,{attachmentWellViewState:r,parentItemId:a,isDraft:!0,linksContainerId:t.linksContainerId,infoBar:t,onAttachmentDeletedCallback:u,moveAttachmentToInlineHandler:"HTML"==o?m:null,onLostFocus:h,referenceAttachmentsSupported:f,isDeletionDisabled:c,onConvertClassicToLink:Xt(t,t,d)})}));var Jt=n(409849),Qt=n(234853),Yt=n(13998),en=n(23471);function tn(e){return()=>{const{isRibbonShown:t,isInlineCompose:n,composeId:i}=e,r=(0,Yt.bh)().recentAttachmentPills.get(i),o=(null==r?void 0:r.displayPills)&&r.attachmentsPillData.some((e=>e.attachmentPillViewStatus===Yt.p2.Show)),s="Show"===e.proofing.skittleViewStatus;if((0,f.Pg)()){return(e.isInlineCompose&&(0,en.Z)()?48:0)+(o?94:0)+(s?35:0)}return(n?49:56)+(t?48:0)+(o?94:0)+(s?35:0)}}const nn=(0,s.Pi)((function(e){const{viewState:t}=e;return t&&function(){if(!(0,Y.Z)().ClassicAttachmentsEnabled)return!1;const e=Jt.cW.typeOfItemBeingDragged;return e===gt.X.MailListRow||e===gt.X.MultiMailListConversationRows||e===gt.X.MultiMailListMessageRows||e===gt.X.LocalFile||e===gt.X.Attachment||e===gt.X.NoteFeedItem||e===gt.X.SharePointFile}()&&!(0,Te.Z)(t)?ie.createElement(Qt.N,{editorViewState:t,dockingViewState:t.docking,dropViewState:t.dropViewState,dataTransferType:Jt.cW.typeOfItemBeingDragged,getBottomDockingHeight:tn(t)}):null}));var rn=n(157241);var on=n(520974);const sn={buttonBarBkColorNoBDark:"kfvAF",buttonBarBkColorNoBLight:"wA1Qu",buttonBarBkColorNormal:"mDvpt",buttonBar:"YpZyY",buttonBarPlaceholder:"PAe2h",newRibbonRow:"kVWGe",ribbonRow:"JpOD6",composeBottomContainer:"TiH31",isInlineCompose:"i95vN",isInlineComposeRedesign:"UQSbI",composeSpinner:"VP90G",composeBottomStatusText:"TsX7a",composeSpinnerText:"IZyvP",toastIcon:"rfebY",draftSaveTime:"W79by",sendDiscard:"pZbaL",surfaceActionsCommandBar:"weWZz",commandBarButton:"bUsYR",commandBarButtonWithSubMenu:"VJEJy",attachmentCommandBarButtonWithSubMenu:"DyHqn",commandBarIcon:"Zpzw3",commandBarImage:"R9HpX",commandBarMenuIcon:"cFuFX",FluidCommandBarButtonWithSubMenu:"Z8SoY",checkedCommandBarButton:"PqC6R",disabledCommandBarButton:"mDzQT",isImage:"bzXoN",isFluentIcon:"EVYAe",commandBarOverflowIcon:"qdBlX",addinCommandBarItem:"ouB1A",sticky:"_cwYC",stickyMargin:"iZH92",newStickyBottomFiller:"v0HMO",stickyBottomFiller:"LjyW2",splitButtonAriaDescription:"JWTVW",focusOutlineFix:"lYsWr",replyWithSeparator:"w0rvd",editorSkittleContainer:"Ter4q",editorSkittleBottomToolbar:"nPwwE",editorSkittleBottomNoToolbar:"a9Ls_",editorSkittleBottomDraftSaving:"bAYg9",editorSkittleBottomRibbon:"lptMM"},an=Dt().bind(sn),ln=(0,s.Pi)(ie.forwardRef((function(e,t){const n=ie.useRef(ie.createRef());ie.useImperativeHandle(t,(()=>({getWidth:()=>n.current.current?n.current.current.clientWidth:0})),[]);const i=e.viewState.lastSaveTimeStamp||(new Date).toISOString(),r=an(sn.draftSaveTime,{isHidden:null==e.viewState.lastSaveTimeStamp}),o=(0,on.zg)(i);return ie.createElement("div",{ref:n.current,className:r},o&&(0,v.WU)((0,v.ZP)("u4c"),o))}))),cn={iconName:"More",styles:{root:Nt.showHistoryButtonIcon}},dn=(0,s.Pi)((function(e){const{viewState:t,editorRef:n}=e,i=ie.useContext(K.Z),r=ie.useCallback((()=>{(0,U.Wc)(t,i,n)}),[t,i,n]);return t.isInlineCompose?ie.createElement("div",null,ie.createElement(rn.X,{appearance:"icon",title:(0,v.ZP)(Ot),"aria-label":(0,v.ZP)(Ot),onClick:r,className:Nt.showHistoryButton,iconProps:cn}),(0,f.Pg)()&&!(0,en.Z)()&&ie.createElement("div",{className:Nt.draftSaveTimeContainer},ie.createElement(ln,{viewState:t}))):null}));var un=n(987648),pn=n(694786),mn=n(843784);const hn=new Map([["Full",57],["Simple",53],["Compact",49]]);function fn(){var e;const t=(0,mn.E3)();return(null!==(e=hn.get(t))&&void 0!==e?e:0)+((0,f.Pg)()&&(0,Le.m)(0)?40:0)}var gn=n(960069),vn=n(119672),yn=n(126573),Sn=n(992810),bn=n(58515);const In=(0,Me.lr)("setDictationLanguagePickerDropdown",(function(e){(0,bn.E)().languagePickerDropDown=e}));const wn=new et.nI((()=>Promise.all([n.e(85663),n.e(58600),n.e(14238)]).then(n.bind(n,314238)))),Cn=(0,yn.Z)(wn,(e=>e.DictationPlugin),"Dictation",(e=>7==e.eventType&&e.source==Sn.c)),En=new et.EF(wn,(e=>e.getDictationLanguagePickerDropDown)),Pn=new et.EF(wn,(e=>e.toggleDictation));var Tn=n(598211),Rn=n(32281),xn=n(180747),kn=n(894490),Nn=n(200166),An=n(172845),Dn=n(527192);const Zn=new et.nI((()=>Promise.all([n.e(52637),n.e(99458),n.e(64826),n.e(96921),n.e(88928),n.e(62122),n.e(16255),n.e(45156),n.e(9458),n.e(47007),n.e(51873),n.e(65780),n.e(49619)]).then(n.bind(n,449619)))),Mn=(0,yn.Z)(Zn,(e=>e.AutoFormatSettingsPlugin),"AutoFormatSettings",(function(e){var t,n;return 7===e.eventType&&"Format"===e.source&&("autoToggleList"===(null===(t=e.additionalData)||void 0===t?void 0:t.formatApiName)||"autoHyphen"===(null===(n=e.additionalData)||void 0===n?void 0:n.formatApiName))}));var On=n(444377),Fn=n(793773),_n=n(975671),Ln=n(309256),zn=n(256918),Bn=n(450250);const Vn=new et.nI((()=>n.e(32130).then(n.bind(n,732130)))),Un=(0,yn.Z)(Vn,(e=>e.default),"SmartSuggestion",(function(e){if(2===e.eventType){const t=e.rawEvent;if(t.which===Bn.K5||t.which===Bn.L_)return!0}return!1}));var qn=n(744157),Wn=n(774136),Hn=n(246997),jn=n(567156),Gn=n(62447),Kn=n(387500),Xn=n(30811),$n=n(631125);const Jn=new et.nI((()=>Promise.all([n.e(12005),n.e(96596)]).then(n.bind(n,12050)))),Qn=(0,yn.Z)(Jn,(e=>e.default),"LinkPreview",(function(e,t){var n,i;return 7===e.eventType||11===e.eventType||15==e.eventType&&e.entity.type==Xn.it?t.queryElements("a").length>0:10===e.eventType&&1===(null===(i=null===(n=e.fragment)||void 0===n?void 0:n.childNodes)||void 0===i?void 0:i.length)&&(0,$n.b)(e.fragment.firstElementChild)}));var Yn=n(948084),ei=n(891235),ti=n(230181),ni=n(286996),ii=n(242968),ri=n(215191),oi=n(716141),si=n(136743),ai=n(66621);function li(e,t){const n=e.composeId;return()=>{const e=(0,ai.b)().viewStates.get(n);if(!e){throw new Error("Cannot find compose viewState with id: "+n)}return t?e[t]:e}}var ci=n(107269),di=n(233146),ui=n(82180),pi=n(756203),mi=n(369037),hi=n(4161),fi=n(476674),gi=n(785116),vi=n(226362),yi=n(807760);function Si(e){return()=>{const t=(0,fi.Z)(e);return(null==t?void 0:t.subject)||""}}const bi=(0,f.cr)("cmp-autoformat-plugin")&&(0,f.cr)("cmp-autoformat-options")&&(0,f.cr)("cmp-autoformat-list")&&(0,f.cr)("cmp-autoformat-hyphen")&&(0,f.cr)("cmp-autoformat-fractions");var Ii=n(571286),wi=n(136277),Ci=n(223992),Ei=n(128358);const Pi=(e,t,n)=>{const i=null==n?void 0:n.position,r=(1===i||2===i)&&(0,Ei.queryElements)(e.contentDiv,(0,Ei.getEntitySelector)(Ci.l))[0];r&&r.parentNode.removeChild(r);const o=(0,wi.insertNode)(e,t,n);return r&&e.contentDiv.appendChild(r),o};var Ti=n(645900);const Ri="OWAPerfLogCustomData",xi="RoosterJsPerfMeasure",ki={0:{timeThreshold:150,measureGroupSize:10,repeatTestCount:4,minViolationCount:5,handler:(e,t,n,i)=>{0==n.eventType&&Mi(i,t),e.plugins.forEach((e=>{var t;return null===(t=e.onPluginEvent)||void 0===t?void 0:t.call(e,n)})),2==n.eventType&&Oi(i,t)}},1:{timeThreshold:100,measureGroupSize:40,repeatTestCount:2,minViolationCount:2,handler:(e,t,n,i)=>{Mi(i,t,n.eventType),e.plugins.forEach((e=>{var t;return null===(t=e.onPluginEvent)||void 0===t?void 0:t.call(e,n)})),Oi(i,t)}},2:{timeThreshold:50,measureGroupSize:200,repeatTestCount:1,minViolationCount:1,handler:(e,t,n,i)=>{e.plugins.forEach((e=>{e.onPluginEvent&&(Mi(i,t,n.eventType,e.getName()),e.onPluginEvent(n),Oi(i,t))}))}},3:{timeThreshold:Number.MAX_VALUE,measureGroupSize:Number.MAX_VALUE,repeatTestCount:Number.MAX_VALUE,minViolationCount:Number.MAX_VALUE,handler:(e,t,n)=>{e.plugins.forEach((e=>{var t;return null===(t=e.onPluginEvent)||void 0===t?void 0:t.call(e,n)}))}}},Ni={0:"keydown",1:"keypress",3:"input",2:"keyup"};function Ai(e,t){return(n,i,r)=>{if(!n.lifecycle.shadowEditFragment&&(r||!n.plugins.some((e=>function(e,t){var n;if(t.onPluginEvent&&(null===(n=t.willHandleEventExclusively)||void 0===n?void 0:n.call(t,e)))return t.onPluginEvent(e),!0;return!1}(i,e))))){const r=i.eventType;if(11==r){const e=[];n.plugins.forEach((t=>{var n,r;if(t)if(function(e){return!!e&&!!e.addOnImportedCallback}(t)){const r=null===(n=null==t?void 0:t.onPluginEvent)||void 0===n?void 0:n.call(t,i);(function(e){if(e&&e.then)return!0;return!1})(r)&&e.push(r)}else null===(r=t.onPluginEvent)||void 0===r||r.call(t,i)}));const r=()=>function(e){["E2EMailComposeNew","E2EMailComposeReply","E2EMailComposeForward","E2EMailComposeReplyAll"].forEach((t=>{(0,Ti.N)(e,t,"LoadLazyPlugins")}))}(t);Promise.all(e).then(r).catch(r)}else{const t=0==r||1==r||3==r||2==r,o=function(e,t){return(e.lifecycle.customData[Ri]=e.lifecycle.customData[Ri]||{value:{stage:0,markerIndexes:[],meetThresholdCount:0},disposer:e=>{Fi(e,t)}}).value}(n,e);(0,ki[t?o.stage:3].handler)(n,e,i,o)}}}}function Di(e,t){return"roosterjsMarker_"+e+"_"+t}function Zi(e){return"roosterjsMeasure_"+e}function Mi(e,t,n,i){const{markerIndexes:r}=e,o=r[r.length-1],s=2*r.length;(null==o?void 0:o.endIndex)<0&&(o.endIndex=s),r.push({startIndex:s,endIndex:-1,eventType:n,pluginName:i}),window.performance.mark(Di(t,s))}function Oi(e,t){const{markerIndexes:n}=e,i=n[n.length-1],r=2*n.length-1;(null==i?void 0:i.endIndex)<0&&(window.performance.mark(Di(t,r)),i.endIndex=r);const{measureGroupSize:o,timeThreshold:s,minViolationCount:l,repeatTestCount:c}=ki[e.stage];if(n.length>=o){const i=Zi(t);n.forEach((e=>{window.performance.measure(i,Di(t,e.startIndex),Di(t,e.endIndex))}));const r=window.performance.getEntriesByName(i),o=r.filter((e=>e.duration>s));o.length<l?0==e.stage||(e.meetThresholdCount>0?e.meetThresholdCount--:(e.stage=2==e.stage?1:0,e.meetThresholdCount=ki[e.stage].repeatTestCount-1)):e.meetThresholdCount+1<c?e.meetThresholdCount++:2==e.stage?(o.forEach((e=>{const i=r.indexOf(e),o=n[i];o.eventType&&function(e,t,n,i){(0,a.y8)(xi,{editorId:e,event:Ni[t],plugin:n,duration:i})}(t,o.eventType,o.pluginName,e.duration)})),e.stage=3):(e.stage=0==e.stage?1:2,e.meetThresholdCount=0),Fi(e,t)}}function Fi(e,t){window.performance.clearMeasures(Zi(t)),e.markerIndexes.forEach((e=>{window.performance.clearMarks(Di(t,e.startIndex)),window.performance.clearMarks(Di(t,e.endIndex))})),e.markerIndexes=[]}var _i=n(162783);function Li(e){null==e.bodyType&&setTimeout((()=>{throw new Error(`viewState.bodyType was nullish (${e.bodyType}). Please report this + what you were doing before it happened.`)}),0);const t=e.bodyType||"HTML";null==e.preferredEditors&&setTimeout((()=>{throw new Error(`viewState.preferredEditors was nullish (${e.preferredEditors}). Please report this + what you were doing before it happened.`)}),0);const n=e.preferredEditors||Object.assign({},_i.on);try{return n[t]}catch(e){return setTimeout((()=>{throw e}),0),2}}var ReactEditor=n(901189),zi=n(813771),Bi=n(946316);class Vi extends ie.Component{constructor(e){super(e),this.contentEditableRef=ie.createRef(),this._onBlur=()=>{var e;if(!this.props.isEditorDisabled){const t=(null===(e=this.contentEditableRef.current)||void 0===e?void 0:e.innerHTML)||"";(0,zi.Z)(this.props.viewState,t)}},this.innerHTMLObj={__html:e.viewState.content}}shouldComponentUpdate(){return!1}render(){return ie.createElement("div",{contentEditable:!this.props.isEditorDisabled,className:Ne()(Bi.Z.resetColors,this.props.className),onBlur:this._onBlur,ref:this.contentEditableRef,dangerouslySetInnerHTML:this.innerHTMLObj})}}var Ui=n(770538);function qi({classNames:e,plainTextPlaceholder:t,onFocus:n,isEditorDisabled:i,viewState:r,editorRef:o}){const s=ie.useRef(null);ie.useEffect((()=>{const{content:e,selectionStart:t,selectionEnd:n}=r,i=s.current;(0,Ui.Yk)(r,null,i),o&&(o.plainTextEditor=i);const a=i.selectionStart,l=i.selectionEnd;return i.value=e,i.selectionStart=null!=t?t:a,i.selectionEnd=null!=n?n:l,()=>{o&&(o.plainTextEditor=null),(0,Ui.af)(r,null,i)}}),[]);const a=ie.useCallback((()=>{(0,zi.Z)(r,s.current.value)}),[r]);return ie.createElement("textarea",{ref:s,className:e,placeholder:t||"",onFocus:n,onChange:a,readOnly:i})}var Wi=n(715386);const Hi=new et.nI((()=>Promise.all([n.e(41504),n.e(94319)]).then(n.bind(n,394319)))),ji=new et.EF(Hi,(e=>e.domToContentModel)),Gi=new et.EF(Hi,(e=>e.contentModelToDom));class Ki extends Wi.M{constructor(e,t){super(e,t),this.contentDiv=e,this.defaultMergingCallback=e=>{this.setContent(""),this.insertNode(e)},this.getDarkColor=null==t?void 0:t.getDarkColor,Promise.all([ji.import(),Gi.import()]).then((([e,t])=>{this.domToContentModel=e,this.contentModelToDom=t}))}isContentModelEditor(){return!!this.domToContentModel}createContentModelContext(){return{isDarkMode:this.isDarkMode(),zoomScale:this.getZoomScale(),isRightToLeft:"rtl"==(0,Ei.getComputedStyles)(this.contentDiv,"direction")[0],getDarkColor:this.getDarkColor}}createContentModel(e){return this.domToContentModel(e||this.contentDiv,this.createContentModelContext(),!!e,this.getSelectionRangeEx())}setContentModel(e,t=this.defaultMergingCallback){const[n,i]=this.contentModelToDom(e,this.createContentModelContext());switch(null==i?void 0:i.type){case 0:const e=Ei.Position.getStart(i.ranges[0]),r=Ei.Position.getEnd(i.ranges[0]);t(n),this.select(e,r);break;case 1:t(n),this.select(i.table,i.coordinates);break;case void 0:t(n)}}}function Xi(e,t){return new Ki(e,t)}const $i=Dt().bind(Nt),Ji=(0,s.Pi)((function(e){const{viewState:t,editorRef:n}=e,{bodyType:i,isInlineCompose:r,isRibbonShown:o,uiEnabledState:s,composeId:l,addin:c,virtualEdit:{virtualEditContent:d,scrollerId:u}}=t,p=ie.useContext(K.Z),m=ie.useCallback((()=>{(0,Ii.Z)(c,2)}),[c]),h="HTML"==i,g=!!d&&h,y=function(e){const t=(0,f.cr)("cmp-editorPerfMesureV2"),n=(0,f.cr)("cmp-disable-virtual-edit");return ie.useMemo((()=>{const i={};return t&&(i.triggerEvent=Ai(e.editorId,e.logTraceId)),n||(i.insertNode=Pi),i}),[t,e,n])}(t),S=ie.useMemo((()=>(0,un.V)(function(e,t){const{shouldUseFallbackPeoplePicker:n}=gi.Z,i=li(e),r=li(e,"attachmentWell"),o=li(e,"augloopSession"),s=li(e,"proofing"),l=li(e,"docking"),c=li(e,"sonoraMentions"),d=li(e,"oa"),u=li(e,"addin"),p=()=>{const e=(0,fi.Z)(i),t=e?(0,it.cF)(e):[];return(0,oi.Z)(t)},m=()=>{const e=(0,fi.Z)(i);return e?(0,it.cF)(e):[]},h=()=>(0,fi.Z)(i)?(0,St.Z)(e.toRecipientWell):"",g=()=>{const e=(0,fi.Z)(i);(null==e?void 0:e.showCompactRecipientWell)&&(0,Yn.Z)(e)},y=e=>{const n=(0,fi.Z)(i);n&&(0,ri.Z)([(0,si.C)(e)],n.toRecipientWell,t)},S=e=>{const n=(0,fi.Z)(i);n&&(0,ii.Z)(n.toRecipientWell,e,t)},b=(e,n,r,o,s,a)=>{const l=(0,fi.Z)(i);l&&(0,U.lO)(e,l,n,t,r,o,s,a)},I=(0,di.F3)(),w=(0,qn.P)();return n&&(w||(0,f.cr)("mc-editor-oacf"))&&(0,a.y8)("AtMentionsUserHasConditionalAccessEnabled"),{docking:new Tn.Z(l,i,tn(e),fn),ribbon:new zn.Z(li(e,"ribbon"),i,!(0,f.cr)("cmp-hyperlinkFileSearch")||!(0,Qe.Z)(),e.expressionId),inlineImageV2:new Kt.UT(li(e,"inlineImageV2"),i,r,b,(0,Te.Z)(e)),pasteFiles:(0,f.cr)("doc-attachment-copyPasteFiles")?new kn.x(b):void 0,spellcheckPlugin:new _n.Z,mentionsPicker:!I&&(!w||n)||(0,f.cr)("mc-editor-oacf")?new An.F(li(e,"mentionsPicker"),i,y,S,g,(0,ei.Z)(e),p,n):void 0,topicPicker:(0,jn.c)()?new jn.E(li(e,"topicPicker"),i):void 0,emojiPicker:new Rn.R(li(e,"emojiPicker"),i,!0,e.expressionId),smartSuggestions:(0,f.cr)("mc-smartSuggestions")?new Un(i,e.expressionId):void 0,linkPreview:new Qn,pasteOption:new Dn.g(li(e,"pasteOption"),i,(0,v.fI)()),tableEdit:(0,f.cr)("cmp-new-context-menu")?void 0:new Wn.i,link:new Nn.b(i,Object.assign(Object.assign({},e.attachmentWell),{logTraceId:e.logTraceId}),m,h,!1,(0,f.cr)("cmp-hyperlinkFileSearch")&&(0,Qe.Z)(),(()=>{const e=(0,fi.Z)(i);return e?e.mailboxInfo:(0,vi.zl)()}),e.linksContainerId),fluid:(0,Kn.U)("MailCompose")?new Gn.u1("MailCompose",(e=>{const n=(0,fi.Z)(i);n&&(0,ti.h)(n,e,t)}),e.composeId,hi.x):void 0,proofing:(0,On.r)()?new Fn.$N(s,i,o,4===e.operation?"Edit":"New",!1,i,e.logTraceId,p,(()=>e.mailboxInfo)):void 0,augLoop:(0,ci.n)()?new gn.B(li(e,"augLoop"),i,o,w?d:c,[Hn.A],(()=>(0,gn.t)(m())),Si(i),(C=i,()=>{var e;const t=(0,fi.Z)(C);return null===(e=null==t?void 0:t.referenceItemId)||void 0===e?void 0:e.Id}),4===e.operation?"Edit":"New",vn.F.Mail,(()=>e.mailboxInfo)):void 0,dictation:(0,f.cr)("cmp-dictation")?new Cn(i):void 0,forgottenAttachments:new xn.dK(li(e,"forgottenAttachments"),i),referenceAttachment:new Ln.b(r,(()=>{var e;return null===(e=(0,fi.Z)(i))||void 0===e?void 0:e.itemId}),t),oa:!w||n||(0,f.cr)("mc-editor-oacf")?void 0:new qn.K(d,i,s,4===e.operation?"Edit":"New",4!==e.operation,1===e.operation||2===e.operation||3===e.operation,{addSelectedPersonaToWell:y,removePersonaFromWell:S,onRecipientAdded:g,canModifyRecipients:(0,ei.Z)(e),getAllRecipients:p,getRecipientWells:m},{augloopSessionAdapter:o,attachmentWellAdapter:r,insertLinksHost:(0,wt.E)(e),createAttachmentsCallback:b,getFromAddress:h,getSubject:Si(i)},e.logTraceId,(()=>e.mailboxInfo)),sonoraMentions:I?new di.xu(c,i,4!==e.operation,0===e.operation,{addSelectedPersonaToWell:y,removePersonaFromWell:S,onRecipientAdded:g,canModifyRecipients:(0,ei.Z)(e),getAllRecipients:p},{attachmentWellAdapter:r,insertLinksHost:(0,wt.E)(e),getFromAddress:h,createAttachmentsCallback:b,augloopSessionAdapter:o},e.smartPillViewState.isSmartDocIntentDetected,(()=>e.mailboxInfo)):void 0,messageExtensionCard:(0,f.cr)("me-search-global")?new ni.zX(li(e,"messageExtensionCard"),i):void 0,loremIpsum:new ui.Q,accessibility:new pi.TB(li(e,"accessibility"),i),mailRibbon:new mi.xB,autoFormatSettings:bi?new Mn(li(e,"autoFormatSettings"),i):void 0,virtualEdit:new yi.oW(li(e,"virtualEdit"),i,r,(()=>{const e=(0,fi.Z)(u);return 2==(null==e?void 0:e.lastFocusedControl)}))};var C}(t,p),n)),[t.editorId,n]),b=2===s,I=(0,mt.Z)(t),w={isInlineCompose:r,hasRibbon:o,plainTextEditor:!h,darkMode:I},C=g?$i(Nt.editorCommon,w):"",E=g?Nt.virtualEditScroller:"",P=$i(Nt.editorBody,w,{editorCommon:!g,virtualEdit:g}),T=b?h?3:1:Li(t),R=(0,f.cr)("cmp-roosterjs-contentmodel")?Xi:void 0;!function(e,t){const n=(0,ee.Z)(e.smimeViewState);ie.useEffect((()=>{n&&yi.c3.import().then((n=>n(t.htmlEditor,e.virtualEdit,e,"StopByContent")))}),[n,e,t])}(t,n);const x=3==T?ie.createElement(Vi,{isEditorDisabled:b,className:P,viewState:t}):1==T?ie.createElement(qi,{key:l,plainTextPlaceholder:(0,v.ZP)("oAc"),viewState:t,onFocus:m,classNames:P,isEditorDisabled:b,editorRef:n}):ie.createElement(ReactEditor.Z,{key:l,plugins:S,viewState:t,classNames:P,onFocus:m,ariaLabel:(0,v.ZP)("nAc"),isDarkMode:I,scrollContainerSelector:".customScrollBar",updateOnDispose:!0,coreApiOverride:y,persistUndoSnapshot:!0,supressPluginUI:!0,editorCreator:R});return ie.createElement("div",{className:C},ie.createElement("div",{className:E,id:u},x),ie.createElement(pn.Z,{plugins:S}))}));const Qi=(0,s.Pi)((function(e){const{announcedComponentMessage:t}=e.viewState.attachmentWell;return ie.createElement(Mt,Object.assign({},e),ie.createElement($t,Object.assign({},e)),ie.createElement(Ji,Object.assign({},e)),(0,f.cr)("mc-smartPillsCompose")&&ie.createElement(ht.bj,null),ie.createElement(dn,Object.assign({},e)),ie.createElement(nn,Object.assign({},e)),t&&ie.createElement(ft.Z,{message:`${t}`}))}));var Yi=n(849530),er=n(563278);const tr={1:{bottomActionBar:!0},2:{formattingRibbon:!0,bottomActionBar:!0},3:{}};function nr(e){return tr[e.preferredEditors[e.bodyType]]}var ir=n(193310),rr=n(204673),or=n(647451),sr=n(752548);const ar=(0,s.Pi)((function(e){const t=ie.useRef(),n=ie.useRef(null),i=ie.useCallback((()=>{var e;null===(e=null==n?void 0:n.current)||void 0===e||e.dismissMenu()}),[n]),r="ProofingOptions"===e.uniqueId,o="FluidHeroButton"===e.uniqueId?Gn.zz:e.id;var s;return s=i,ie.useEffect((()=>{const e=()=>{s()};return window.addEventListener("blur",e),()=>{window.removeEventListener("blur",e)}}),[]),ie.createElement(ie.Fragment,null,ie.createElement("div",{ref:t},ie.createElement(sr.Q,Object.assign({},e,{id:o,styles:{root:sn.commandBarButton,rootChecked:sn.checkedCommandBarButton,rootDisabled:sn.disabledCommandBarButton,menuIcon:sn.commandBarMenuIcon},componentRef:n}))),r&&ie.createElement(Fn.Wk,{target:()=>t.current}))}));var lr=n(514743);var cr=n(967318),dr=n(518635),ur=n(488960),pr=n(777391),mr=n(8106),hr=n(321670),fr=n(554254),gr=n(765952),vr=n(661972),yr=n(812842),Sr=n(359287),br=n(115557),Ir=n(257911),wr=n(240059);const Cr=(0,Me.lr)("toggleRibbon",(function(e){e.isRibbonShown=!e.isRibbonShown}));var Er=n(851532),Pr=n(769367),Tr=n(262548),Rr=n(808386),xr=n(382717);var kr=n(862313),Nr=n(961235),Ar=n(741279),Dr=n(938441),Zr=n(881781);const Mr=Dt().bind(sn),Or=(0,Rr.F)("surfaceActions/dictationRecording.svg"),Fr=(0,Rr.F)("surfaceActions/dictate.svg");function _r(e,t,n=""){(0,or.nd)(!0,`${e}${n}`,t)}function Lr({viewState:e,attachmentInlineFilePicker:t,attachmentLocalComputerFilePicker:n,attachmentLocalComputerToCloudFilePicker:i,attachmentLocalFileToLinkPicker:r,editorRef:o}){var s,a,c;const u=ie.useContext(K.Z),h=ie.useRef();h.current||(h.current=null===(s=d.kg.tryImportForRender())||void 0===s?void 0:s(!0));const g=ie.useCallback((()=>{const{itemId:t}=e;return t?(0,Rt.b)().items.get(t.Id):null}),[e]),y=ie.useCallback(((t,n)=>{_r("InsertSignature",n),(0,U.Ik)(e)}),[e]),S=ie.useCallback(((n,i)=>{var r;_r("AddInlineImage",i),e.itemId||(0,U.a1)(e,!1,o),null===(r=t.current)||void 0===r||r.click()}),[e]),b=ie.useCallback(((t,n)=>{_r("SetImportance",n,t),(0,_.Z)(e,t),(0,p.RX)(e)}),[e]),I=ie.useCallback(((t,n)=>{_r("SwitchBodyType",n,"HTML"==e.bodyType?"Plain":"HTML"),(0,U.zv)(e,u)}),[e,u]),C=ie.useCallback(((t,n)=>{const{accChecker:i}=e;let r="";i.isOpen?(r="Close",m.go.import().then((e=>e(i,u)))):(r="Open",m.IY.import().then((t=>t(i,e,u)))),_r("AccChecker",n,r)}),[e,u]),P=ie.useCallback(((t,n)=>{(0,wr.Z)(e,!e.forceInLightMode)}),[e]),x=ie.useCallback(((t,n)=>{_r("ToggleDictation",n),Pn.import().then((t=>t(e))),(0,p.RX)(e)}),[e]),k=ie.useCallback(((t,n)=>{const i=!(0,gr.Z)(e.expressionId);vr.EH.import().then((t=>{t(i,!0,fr.dr,e,e.expressionId,u)})),_r("AddEmoji",n,i?"Open":"Close")}),[e,u]),N=ie.useCallback(((t,n)=>{const i=e;var r;e&&Ir.mh.importAndExecute(i.editorId,"MailComposeView",(r=e,()=>{var e,t,n,i,o,s,a,l,c;return[null!==(n=null===(t=null===(e=null==r?void 0:r.toRecipientWell)||void 0===e?void 0:e.recipients)||void 0===t?void 0:t.map((e=>e.persona.EmailAddress)))&&void 0!==n?n:[],null!==(s=null===(o=null===(i=null==r?void 0:r.ccRecipientWell)||void 0===i?void 0:i.recipients)||void 0===o?void 0:o.map((e=>e.persona.EmailAddress)))&&void 0!==s?s:[],null!==(c=null===(l=null===(a=null==r?void 0:r.bccRecipientWell)||void 0===a?void 0:a.recipients)||void 0===l?void 0:l.map((e=>e.persona.EmailAddress)))&&void 0!==c?c:[]]}),(e=>()=>((null==e?void 0:e.subject)||"").trim())(e),(e=>t=>e?Ir.qK.importAndExecute(e,t):null)(i),u)}),[e,u]),D=ie.useCallback(((t,n)=>{Cr(e),_r("ToggleRibbon",n,e.isRibbonShown?"On":"Off"),(0,p.RX)(e)}),[e]),M=ie.useCallback(((t,n)=>{const i={getRecipientWells:()=>(0,it.cF)(e),fromAddress:(0,St.Z)(e.toRecipientWell),linkIdContainer:Object.assign(Object.assign({},e.attachmentWell),{logTraceId:e.logTraceId})};Gn.NL.importAndExecute(u,e,i,e.subject,(t=>{(0,ti.h)(e,t,u)}),e.composeId,e.mailboxInfo)}),[e,u]),F=ie.useCallback((()=>{(0,pr.Z)(e.editorId),On.g.import().then((t=>{(0,mr.GJ)()?(t()(),(0,hr.Z)(e.proofing,"commandBarPaneButtonClicked",!0)):t(!0)()}))}),[e,u]),X=ie.useCallback((()=>{(0,V.Z)(e,H._S,u)}),[e,u]),J=ie.useCallback(((t,n)=>{_r("SaveDraft",n),(0,U.a1)(e,!1,o),(0,p.RX)(e)}),[e,o]),te=ie.useCallback((()=>{Er.Ez.importAndExecute("mail","surfaceActions","composeSurfaceActions",void 0,e.mailboxInfo),Ze.OM.importAndExecute((0,lr.Z)().shouldHighlightUnpinnedAdminAddins?"HighlightedAndClicked":"Clicked","OverFlowMenu")}),[e]),ne=ie.useCallback(((t,n)=>{_r("ShowFrom",n,e.fromViewState.isFromShown?"Hide":"Show"),(0,L.Z)(e),(0,p.RX)(e)}),[e,e.fromViewState.isFromShown]),oe=ie.useCallback((()=>{(0,U.Td)(e,u)}),[e,u]),le=ie.useCallback((t=>{if(!t.renderButtonAs||t.renderedInOverflow)return null;{const n=Ye(e),i=t.renderButtonAs;return ie.createElement(ie.Fragment,null,ie.createElement(Nr.kg,{targetWindow:u,messageExtensionType:n?"Compose":"ComposeMessageExtensions",linkedEntity:{type:Dr.py.m365_messageextension,id:"Compose,"+e.composeId},tabId:(0,Tr.Z)(u)},ie.createElement("div",{id:Ar.eH},ie.createElement(i,Object.assign({},t)))))}}),[e,u]),ce=ie.useCallback((t=>{t.forEach((t=>{(0,f.cr)("cmp-fluid-formsLoop")&&(0,Kn.U)("MailCompose")&&("afde34e6-58a4-4122-8a52-ef402180a878"===t.key||"b51e3efb-9c17-4a01-af72-09187d818a57"===t.key)&&"HTML"===e.bodyType&&(t.disabled="HTML"!==e.bodyType,t.onClick=M)}))}),[e,e.bodyType,M]),pe=ie.useCallback(((t,o)=>{var s,a,c,d,p;if(t.hideInGroup&&(0,$e.Zs)())return null;const m="HTML"!=e.bodyType,g=t.key;let M,_,L,U,K=(0,or.aY)(g),{iconName:ie,fallbackIconName:ce,isImage:pe,isFluentIcon:me}=(0,or.zD)(g),he=!1,fe=!1,ge=!1;const ve=(0,z.Z)(e)===l.jf.None,{clpLabels:Se}=W.d,Ie=(0,q.Z)(e),we=(0,Y.Z)(),Ee=(0,ee.Z)(e.smimeViewState);switch(g){case"AddAttachment":he=!we.ClassicAttachmentsEnabled&&!we.ReferenceAttachmentsEnabled||(0,Te.Z)(e);const t=(0,ae.ZP)((()=>n.current||null),(()=>i.current||null),(()=>r.current||null),e,u),o=null===(s=h.current)||void 0===s?void 0:s.getContextualMenuItems(!Ee,e.referenceItemId,ve,!0,!m,((t,n)=>{(0,se.M)(t,n,e,u)}),e.suggestedAttachmentSessionId,e.mailboxInfo);let l=t;o&&o.length>0&&(l=o.concat([{key:"replyWithSeparator",iconProps:{iconName:null,styles:{root:{margin:"0px",width:"0px"}}},className:sn.replyWithSeparator,itemType:be.n.Divider}]).concat(t)),_={items:l,onMenuOpened:()=>{var t,n;(0,Re.Z)(null===(t=e.referenceItemId)||void 0===t?void 0:t.Id),null===(n=h.current)||void 0===n||n.onMenuOpened(!Ee,e.referenceItemId,e.composeId,(Ee?(0,ae.SR)():(0,ae.pX)(!ve,m)).join(","),ve,!0,!m,(0,B.Z)(e),e.suggestedAttachmentSessionId,e.mailboxInfo)},onMenuDismissed:()=>{var t;null===(t=h.current)||void 0===t||t.onMenuDismissed(!Ee,e.referenceItemId,ve,!0,!m,e.mailboxInfo)},directionalHint:cr.b.topLeftEdge,directionalHintFixed:!1},L=sn.attachmentCommandBarButtonWithSubMenu;break;case"AddInlineImage":M=S,he=m||(0,Te.Z)(e);break;case"AddEmoji":M=k,he=m,fe=!0,ge=(0,gr.Z)(e.expressionId);break;case"ToggleDarkCompose":(0,mn.BR)()&&(K=e.forceInLightMode?(0,v.ZP)("z4c"):(0,v.ZP)("y4c"),ie=e.forceInLightMode?"ClearNight":"Sunny",M=P);break;case"FluidHeroButton":he=m||!(0,Kn.U)("MailCompose")||!(0,f.cr)("cmp-fluid-createNew"),_=null===(a=Gn.BW.tryImportForRender())||void 0===a?void 0:a("MailCompose",e.composeId,Zr.l3,e.mailboxInfo),L=sn.FluidCommandBarButtonWithSubMenu;break;case"ToggleDictation":M=x,he=m,fe=!0;const g=(0,bn.E)().isDictationOn;ie=g?Or:Fr,ce=ie,pe=!0,K=g?(0,v.ZP)("x4c"):(0,v.ZP)("w4c");break;case"SetDictationLanguage":he=m,_={items:(0,bn.E)().languagePickerDropDown,onMenuOpened:()=>{!async function(){const e=await En.import();In(e())}()}},L=sn.commandBarButtonWithSubMenu;break;case"ToggleRibbon":he=m,K=(0,v.ZP)(yr.K),M=D,fe=!0,ge=e.isRibbonShown;break;case"ProofingOptions":const{proofing:z}=e;he=z.isProofingDisabled,(0,mr.GJ)()?_={items:null!==(d=null===(c=Fn.Am.tryImportForRender())||void 0===c?void 0:c(z,e.editorId))&&void 0!==d?d:[]}:M=F;break;case"SensitivityMenu":K=(0,v.ZP)(A.LH),(0,j.Z)()&&(_={items:Ce(Se,e,Ee,u)}),L=sn.commandBarButtonWithSubMenu,he=!(0,j.Z)();break;case"ProtectMessage":const{protectionViewState:q}=e;if((0,Qe.Z)())_={items:[{name:(0,v.ZP)(re.JO),key:"Encrypt",onClick:()=>{(0,V.Z)(e,H.rg,u)},disabled:(0,G.Z)(q,H.rg)},{name:(0,v.ZP)(re.Dy),key:"EncryptDNF",onClick:()=>{(0,V.Z)(e,H.J2,u)},disabled:(0,G.Z)(q,H.J2)}]};else if((0,j.Z)())_=de(e,[H.rg,H.J2]);else{const{RmsV2UIEnabled:t}=(0,Q.Z)();t?M=X:(K=(0,v.ZP)(w.YA),_=ue(e))}he=(0,G.Z)(q),L=sn.commandBarButtonWithSubMenu;break;case"SaveDraft":if(Ie)break;M=J;break;case"CustomizeActions":(0,f.cr)("addin-exp-customizedActionsButtonNavBar")&&(M=te);break;case"InsertSignature":if((0,$.Z)()){const t=ye(e);t&&0!=t.length?(_={items:t},L=sn.commandBarButtonWithSubMenu):M=y}else{if(Ie)break;M=y}break;case"ShowFrom":he=e.fromViewState.isFromReadOnly||Ee;K=e.fromViewState.isFromShown?(0,v.ZP)(re.Bm):(0,v.ZP)(Z.M),M=ne;break;case"ShowMessageOptions":if(Ie)break;M=oe;break;case"SetImportance":_={items:[{name:(0,v.ZP)(E.X),key:"High",onClick:(e,t)=>{b("High",t)},canCheck:!0,checked:"High"===e.importance},{name:(0,v.ZP)(R.h),key:"Normal",onClick:(e,t)=>{b("Normal",t)},canCheck:!0,checked:"Normal"===e.importance},{name:(0,v.ZP)(T.I),key:"Low",onClick:(e,t)=>{b("Low",t)},canCheck:!0,checked:"Low"===e.importance}]},L=sn.commandBarButtonWithSubMenu;break;case"SwitchBodyType":e.isInlineCompose||(K=m?(0,v.ZP)(re.mc):(0,v.ZP)(O.A),M=I);break;case"AccChecker":he=m,fe=!0,ge=null===(p=e.accChecker)||void 0===p?void 0:p.isOpen,M=C;break;case"MessageExtensions":K=(0,v.ZP)(Sr.F),U=le,M=zr;break;case"FindTime":(0,f.cr)("cal-native-findtime")&&!(0,Qe.Z)()&&(K=(0,v.ZP)(br._B),M=N,he=m)}if(M||_){return{key:g,id:undefined,uniqueId:g,name:K,iconProps:{iconName:pe?null:ie,iconType:pe?dr.T.image:dr.T.default,imageProps:pe?{shouldFadeIn:!1,src:ce,className:sn.commandBarImage}:null,className:Mr(sn.commandBarIcon,{isFluentIcon:me,isImage:pe})},disabled:he||o,canCheck:fe,checked:ge,onClick:M,subMenuProps:_,className:L,renderButtonAs:ar,onRender:U,iconOnly:!0,ariaLabel:K}}return null}),[y,S,b,I,C,P,x,k,D,...(0,f.cr)("cal-native-findtime")&&!(0,Qe.Z)()?[N]:[],u,e,null===(a=e.accChecker)||void 0===a?void 0:a.isOpen,e.bodyType,e.fromViewState.isFromReadOnly,e.fromViewState.isFromShown,e.importance,e.isInlineCompose,e.isInlineCompose,e.isRibbonShown,e.protectionViewState,null===(c=e.quotedBody)||void 0===c?void 0:c.length,e.referenceItemId,e.smimeViewState,e.forceInLightMode]),me=(0,kr.k_)(e,e.messageExtensionCard,e,"compose_ellipses_menu",(0,_t.X)(e,(()=>Ut(e))),1===e.operation||2===e.operation||3===e.operation,u),he=(()=>{const t=[],n=[],i=2===e.uiEnabledState,r=(0,or.Gc)(e.mailboxInfo);(0,mn.BR)()&&r.push({key:"ToggleDarkCompose",hideInGroup:!1}),((0,xr.o2)()||(0,xr.yp)())&&(0,f.cr)("cmp-dictation")&&r.push({key:"SetDictationLanguage",hideInGroup:!1});const o=(0,Pr.Bb)(Pr.Xm.SurfaceActions);let s=null;return r.forEach((e=>{const r=pe(e,i);r&&((0,or.If)(e.key)?(r.isPinned=!0,r.subMenuProps&&r.subMenuProps.items.forEach((e=>{e.isPinned=!0})),t.push(r)):(r.onRender=null,r.renderedInOverflow=!0,r.subMenuProps&&r.subMenuProps.items.forEach((e=>{e.renderedInOverflow=!0})),"CustomizeActions"!=e.key?n.push(r):(((0,f.cr)("addin-exp-awarenessNudgeCusBtn")||(0,f.cr)("addin-exp-awarenessNudge")||(0,f.cr)("addin-exp-awarenessNudgeWaterDropNudge"))&&Ze.op.importAndExecute(r),s=r)))})),me&&((0,kr.QL)(n,1),me.disabled=!!i,n.push(me)),Ye(e)&&(0,Ze.K_)(e.mailboxInfo)&&(0,ur.B)(_e.a.MessageCompose,g(),e.composeId,o.composeSurfaceAddins,t,n,!1,0,u,sn.addinCommandBarItem,null,e.isInSharedFolder,i),s&&n.push(s),function(e){for(let t=0;t<e.length-Br.size;t++)Br.has(e[t].key)&&(e.push(e.splice(t,1)[0]),t--)}(t),{items:t,overflowItems:n}})();return ce(he.items),ce(he.overflowItems),he}function zr(){}const Br=new Set(["MessageExtensions"]),Vr=(0,s.Pi)(ie.forwardRef((function(e,t){const n=ie.useRef(new Array),i=ie.useRef(null),{viewState:r,editorRef:o,attachmentInlineFilePicker:s,attachmentLocalComputerFilePicker:a,attachmentLocalComputerToCloudFilePicker:l,attachmentLocalFileToLinkPicker:c}=e,d=Lr({viewState:r,attachmentInlineFilePicker:s,attachmentLocalComputerFilePicker:a,attachmentLocalComputerToCloudFilePicker:l,attachmentLocalFileToLinkPicker:c,editorRef:o});!function(e){ie.useEffect((()=>{if((0,f.cr)("addin-exp-awarenessNudgeCusBtn")||(0,f.cr)("addin-exp-awarenessNudge")||(0,f.cr)("addin-exp-awarenessNudgeWaterDropNudge")){const t=(0,lr.Z)();t.shouldHighlightUnpinnedAdminAddins||setTimeout((function(){if(t.shouldHighlightUnpinnedAdminAddins){let t=!1;e.overflowItems.forEach((e=>{t&&Ze.LO.importAndExecute(e,_e.a.MessageCompose),"CustomizeActions"==e.key&&Ze.op.importAndExecute(e),"addinDivider_0"==e.key&&(t=!0)}))}}),1e3)}}))}(d),ie.useImperativeHandle(t,(()=>({resize(){i.current&&i.current.remeasure()}})),[]);const u=e=>e.reduce(((e,t)=>e+t.key),""),{items:p,overflowItems:m}=Object.assign({},d);return ie.createElement(rr.X,{componentRef:i,items:p,overflowItems:m,overflowButtonProps:{id:"compose_ellipses_menu",menuIconProps:{iconName:"More",styles:{root:sn.commandBarOverflowIcon}},ariaLabel:(0,v.ZP)(re.Qb)},buttonAs:ar,overflowButtonAs:ar,className:sn.surfaceActionsCommandBar,onReduceData:e=>{let{primaryItems:t,overflowItems:i,cacheKey:r}=e,o=-1;for(let e=t.length-1;e>=0;e--){const n=t[e];if(n&&!Br.has(n.key)){o=e;break}}if(-1===o)return;const s=t.splice(o,1)[0];return s.isAddin&&(0,f.cr)("mos-messageExtensionsFlyout")?n.current.unshift({index:o,item:s}):i.unshift(s),r=u(t),Object.assign(Object.assign({},e),{primaryItems:t,overflowItems:i,cacheKey:r})},onGrowData:e=>{let{primaryItems:t,overflowItems:i,cacheKey:r}=e;const o=t.length-Br.size,s=n.current.length>0&&n.current[0].index===o;if(!(s||0!==i.length&&(0,or.If)(i[0].key)))return;const a=s?n.current.shift().item:i.shift();return t.splice(t.length-Br.size,0,a),r=u(t),Object.assign(Object.assign({},e),{primaryItems:t,overflowItems:i,cacheKey:r})},onDataReduced:or.in,onDataGrown:or.uE})})));var Ur=n(5989);const qr=(0,s.Pi)((function(e){const{asyncSendState:t,isInlineCompose:n,isSending:i,isSavingSpinnerShown:r}=e.viewState;return i?3==t?ie.createElement("div",{className:sn.buttonBar},ie.createElement("div",{className:sn.composeBottomStatusText},(0,v.ZP)("rAc"))):n?ie.createElement("div",{className:sn.buttonBar},ie.createElement(o.$,{className:sn.composeSpinner}),ie.createElement("div",{className:sn.composeSpinnerText},(0,v.ZP)(N.v))):ie.createElement("div",{className:sn.buttonBar}):r?ie.createElement("div",{className:sn.buttonBar},ie.createElement(o.$,{className:sn.composeSpinner}),ie.createElement("div",{className:sn.composeSpinnerText},(0,v.ZP)("sAc"))):4==t?ie.createElement("div",{className:sn.buttonBar},ie.createElement(Ur.J,{iconName:"CheckMark",className:sn.toastIcon}),ie.createElement("div",{className:sn.composeBottomStatusText},(0,v.ZP)("tAc"))):ie.createElement(ie.Fragment,null,e.children)})),Wr=(0,Me.lr)("setShowSendDiscardAsIcon",(function(e,t){e.showSendDiscardAsIcon=t}));var Hr=n(644707),jr=n(287382),Gr=n(462844),Kr=n(778509);function Xr(e){return Object.assign(Object.assign({},e),{hotmail:$r(e.hotmail),yahoo:$r(e.yahoo),gmail:$r(e.gmail),owa:$r(e.owa),outlook:$r(e.outlook)})}function $r(e){return e instanceof Array?e.length?e[0]:void 0:e}var Jr=n(610190),Qr=n(485306);const Yr={splitButtonAriaDescription:"gUmXA",sendButtonCurved:"GEqns",discardCurved:"POsDB",buttonNoBorder:"JO78F",iconWidthSend:"PLzR9",iconOnlyWidth:"KOX0D",iconOnlyWidthToolbar:"UPQr4",discardPopoutBase:"AqRSG",popoutButton:"ezXN1"};var eo=n(648877);const to=Dt().bind(Yr);const no=(0,s.Pi)((function({onSend:e,viewState:t}){const n=(0,jr.zY)()||window,i=n=>{(0,Gr.Z)(t,n),e()},r=(0,f.Pg)(),o=()=>{(0,eo.m)(n,i)},s=0!==t.uiEnabledState,a=(0,q.Z)(t),l=function(e,t){var n;return!(!(0,Q.Z)().AsyncSendEnabled||(0,at.Z)(e)||t||(null===(n=(0,Q.Z)().SessionSettings)||void 0===n?void 0:n.IsShadowMailbox))}(t,a),c=a?(0,v.ZP)(Qr.oB):(0,v.ZP)(C.h),d=Xr((0,ct.I)().sendMail),u=(0,Jr.a)(d)?`${c} (${(0,Kr.g)(d)})`:c,p={className:to(t.showSendDiscardAsIcon?Yr.iconWidthSend:void 0),onClick:e,ariaLabel:c,disabled:s,title:u,iconProps:r||t.showSendDiscardAsIcon?{iconName:"send"}:void 0},m=(0,Hr.M)("sendSplitButton"),h=l&&o?Object.assign(Object.assign({},p),{split:!0,menuProps:{items:[{key:"RegularSendMessage",text:c,onClick:e},{key:"ScheduleSendMessage",text:(0,v.ZP)(Qr.Dv),onClick:o}],styles:{root:Yr.focusOutlineFix}},splitButtonAriaLabel:(0,v.ZP)(Qr.k_)}):p;return ie.createElement("div",{"data-testid":"ComposeSendButton",className:to(r?Yr.sendButtonCurved:void 0)},ie.createElement(ie.Fragment,null,l&&ie.createElement("span",{className:Yr.splitButtonAriaDescription,id:m},(0,v.ZP)(Qr.zH)),ie.createElement(rn.X,Object.assign({appearance:"primary"},h,{"aria-describedby":l?m:void 0}),!t.showSendDiscardAsIcon&&c)))})),io=Dt().bind(Yr),ro=(0,s.Pi)((function({onDiscard:e,viewState:t}){const n=Xr((0,ct.I)().discardDraft),i=(0,v.ZP)(I.f),r=(0,Jr.a)(n)?`${i} (${(0,Kr.g)(n)})`:i,o=(0,f.Pg)(),s=(0,en.Z)(),a=t.isInlineCompose&&s;let l=t.showSendDiscardAsIcon;o&&(l=!t.isInlineCompose||(!s||t.showSendDiscardAsIcon));const c={className:io(Yr.discardPopoutBase,{iconOnlyWidth:o&&l,iconOnlyWidthToolbar:!o&&l,buttonNoBorder:o&&!a}),onClick:e,ariaLabel:i,title:r,iconProps:o||l?{iconName:"Delete"}:void 0};return ie.createElement("div",{className:io(o?Yr.discardCurved:void 0)},ie.createElement(rn.X,Object.assign({},c,{id:"discardCompose"}),!l&&i))}));var oo=n(955482);const so=Dt().bind(Yr),ao=(0,s.Pi)((function({viewState:e}){const t={className:so(Yr.discardPopoutBase,Yr.iconOnlyWidth,Yr.buttonNoBorder,Yr.popoutButton),onClick:()=>(0,U.TV)(e),ariaLabel:(0,v.ZP)(Qr._i),title:(0,v.ZP)(Qr.jH),iconProps:{iconName:oo.Z}};return ie.createElement(rn.X,Object.assign({},t,{id:"popoutCompose"}))}));function lo(e,t,n,i){const r=ie.useCallback((()=>{(0,U.lW)(e,t,n)}),[e,t]),o=(0,ct.I)();(0,Ge.iu)(i,o.sendMail,r,{allowHotkeyOnTextFields:!0});const s=ie.useCallback((()=>{(0,U.eJ)(e,t)}),[e,t]);(0,Ge.iu)(i,o.discardDraft,s,{allowHotkeyOnTextFields:!0});const a=ie.useCallback((()=>{(0,U.a1)(e,!1,n)}),[e]);return(0,Ge.iu)(i,o.saveDraft,a,{allowHotkeyOnTextFields:!0}),{sendMessage:r,discardDraft:s,saveDraft:a}}const co=Dt().bind(sn),uo=(0,s.Pi)(ie.forwardRef((function(e,t){const n=ie.useRef(null),i=ie.useRef(null),{viewState:r,targetWindow:o,editorRef:s,commandContainerRef:a}=e,{sendMessage:l,discardDraft:c}=lo(r,o,s,a);return ie.useImperativeHandle(t,(()=>({resize(){if(i.current&&n.current){const e=i.current.clientWidth-n.current.getWidth()<380;e!=r.showSendDiscardAsIcon&&Wr(r,e)}}})),[]),ie.createElement("div",{ref:i,className:co(sn.buttonBar,e.viewState.isInlineCompose&&(0,en.Z)()?(0,mt.Z)(e.viewState)?sn.buttonBarBkColorNoBDark:sn.buttonBarBkColorNoBLight:sn.buttonBarBkColorNormal)},!(0,Tt.X)("disableMailComposeSendDiscard")&&ie.createElement("div",{className:sn.sendDiscard},ie.createElement(no,{viewState:e.viewState,onSend:l}),ie.createElement(ro,{viewState:e.viewState,onDiscard:c})),0==ie.Children.count(e.children)?ie.createElement("div",{className:sn.buttonBarPlaceholder}):e.children,ie.createElement(ln,{ref:n,viewState:e.viewState}))})));var po=n(391071),mo=n(945082),ho=n(308785),fo=n(336627);const go=new et.nI((()=>n.e(81237).then(n.bind(n,481237)))),vo=new et.EF(go,(e=>e.openFilePickerFromSmartDoc));var yo=n(547231),So=n(801716);function bo(e,t,n,i,r){ie.useEffect((()=>{(0,Ke.Oy)(t,(async()=>{var t;var o;(await l.hE.import())(),(o=null===(t=null==e?void 0:e.smartPillViewState)||void 0===t?void 0:t.smartDocOption)!==yo.H.LocalFiles&&o!==yo.H.CloudFiles&&o!==yo.H.UploadAndShare||vo.import().then((t=>t(So.g,So.l,(()=>n.current||null),(()=>i.current||null),e,r)))})),(0,Ke.Oy)(t,(()=>{const t=e.attachmentWell;(0,$e.Zs)()&&t&&t.groupId?fo.KM.importAndExecute(e.mailboxInfo,e.attachmentWell.groupId?e.attachmentWell.groupId:void 0,fo.M3.Group):fo.KM.importAndExecute(e.mailboxInfo)}))}),[])}var Io=n(625866);function wo({viewState:e,targetWindow:t,attachmentInlineFilePicker:n,attachmentLocalComputerFilePicker:i,attachmentLocalComputerToCloudFilePicker:r,attachmentLocalFileToLinkPicker:o}){const{createAttachmentHandler:s,handlerForAttachFromComputer:a,handlerForUploadAndInsertLinks:d,handlerForUploadAndShareFromCloud:u}=function(e,t){const n=ie.useCallback((n=>{const i={isInline:n.isInline,isHiddenInline:!1},r=n.shouldShare?Object.assign(Object.assign({},i),{shouldShare:!0}):Object.assign(Object.assign({},i),{shouldShare:!1});(0,It.K)(n.files,e,r,n.dataProviderType,t)}),[e]),i=c.c.computer.getCreateAttachmentHandler(e.attachmentWell,((n,i,r)=>(0,It.K)(n,e,i,r,t)),(0,z.Z)(e),t,e.mailboxInfo,(async n=>{(await l.uK.import())({files:n.files,isInline:!1,shouldShare:!0,dataProviderType:n.dataProviderType});const i=await bt.gN.import(),r=await Ct.e4.import();i(n.files,(0,wt.E)(e),e,(0,St.Z)(e.toRecipientWell),t,e.mailboxInfo,e.linksContainerId,void 0,r(e.attachmentWell.groupId,n.properties))}),(0,f.cr)("doc-fullyDeprecateCloudyMaster")||(0,f.cr)("doc-deprecateCloudy-preview-thumbnailView")),r=c.c.uploadAndShareFromCloud.getCreateAttachmentHandler(e.attachmentWell,((n,i,r)=>(0,It.K)(n,e,i,r,t)),(0,z.Z)(e),t,e.mailboxInfo);return{createAttachmentHandler:n,handlerForAttachFromComputer:i,handlerForUploadAndInsertLinks:c.c.uploadAndShareFromCloud.getCreateAttachmentHandler(e.attachmentWell,((n,i,r)=>(0,Io.R)(n,e,i,r,t)),(0,z.Z)(e),t,e.mailboxInfo),handlerForUploadAndShareFromCloud:r}}(e,t);return ie.createElement(ie.Fragment,null,ie.createElement(l.MN,{ref:n,fileSelectionFilter:l.lq.Images,action:l.QJ.InsertInlineImage,createAttachmentHandler:s}),ie.createElement(l.MN,{ref:i,fileSelectionFilter:l.lq.None,action:l.QJ.Attach,createAttachmentHandler:a}),ie.createElement(l.MN,{ref:r,fileSelectionFilter:l.lq.None,action:l.QJ.Attach,createAttachmentHandler:u}),ie.createElement(l.MN,{ref:o,fileSelectionFilter:l.lq.None,action:l.QJ.InsertAsLink,createAttachmentHandler:d}))}const Co=Dt().bind(sn),Eo=(0,s.Pi)(ie.forwardRef((function(e,t){var n;const{viewState:i,editorRef:r,initialActions:o,composeHeight:s}=e;ie.useImperativeHandle(t,(()=>({resize(){var e,t;null===(e=u.current)||void 0===e||e.resize(),null===(t=p.current)||void 0===t||t.resize()}})),[]);const a=ie.useRef(null),l=ie.useRef(null),c=ie.useRef(null),d=ie.useRef(null),u=ie.useRef(null),p=ie.useRef(null),m=ie.useRef(null),h=ie.useContext(K.Z),g=(0,mt.Z)(i);bo(i,o,l,c,h),ie.useEffect((()=>{(0,mo.L)()&&!(0,ho.Z)(h)&&(0,po.Z)(m,i)}),[]);const y=2===i.uiEnabledState,{isInlineCompose:S,isRibbonShown:b,ribbon:I}=i,w=ie.useMemo((()=>g?void 0:{backgroundColor:(0,ir.y$)().neutralLighterAlt}),[g]);let C=!0;const E=null===(n=m.current)||void 0===n?void 0:n.clientHeight;s&&E&&s<=2*E&&(C=!1);const P=b&&!(0,er.I)(i.composeId),T=(0,f.Pg)()&&!e.useCommandBarSetting,R=(0,en.Z)(),x=i.isInlineCompose&&R,k=i.isInlineCompose&&!R;return ie.createElement("div",{ref:m,className:Co(sn.composeBottomContainer,{isInlineCompose:!T&&S,isInlineComposeRedesign:T&&S,sticky:C,stickyMargin:!S,isHidden:!C})},ie.createElement("div",{className:Co(sn.editorSkittleContainer,{editorSkittleBottomToolbar:!T,editorSkittleBottomNoToolbar:T&&!i.isInlineCompose,editorSkittleBottomDraftSaving:T&&k,editorSkittleBottomRibbon:T&&x})},ie.createElement(Fn.LW,{viewState:i.proofing,editorId:i.editorId,mailboxInfo:i.mailboxInfo})),ie.createElement(Yt.Wr,{composeId:i.composeId,itemId:i.itemId,logTraceId:i.logTraceId,attachmentWell:i.attachmentWell,infoBar:i,mailboxInfo:(0,_t.X)(i,(()=>Ut(i))),targetWindow:h}),!T&&nr(i).formattingRibbon&&P&&ie.createElement(Yi.B,{className:Co(sn.ribbonRow),editorViewState:i,viewState:I,insertLinksHost:(0,wt.E)(i),fromAddress:(0,St.Z)(i.toRecipientWell),upsellClickHandler:()=>{var e;return null===(e=d.current)||void 0===e?void 0:e.click()},focusToButtonBeforeDropDown:!0,isRtl:(0,v.fI)(),isDarkMode:g,isDisabled:y,referenceItemId:i.referenceItemId,isFromComposeBottom:!0,mailboxInfo:i.mailboxInfo}),(!T||x)&&ie.createElement(qr,{viewState:i},ie.createElement(uo,{ref:u,editorRef:r,commandContainerRef:m,viewState:i,targetWindow:h},nr(i).bottomActionBar&&!T?ie.createElement(Vr,{ref:p,editorRef:r,viewState:i,attachmentInlineFilePicker:a,attachmentLocalComputerFilePicker:l,attachmentLocalComputerToCloudFilePicker:c,attachmentLocalFileToLinkPicker:d}):null)),C&&ie.createElement("div",{className:Co(sn.stickyBottomFiller),style:w}),!T&&ie.createElement(wo,{viewState:i,targetWindow:h,attachmentInlineFilePicker:a,attachmentLocalComputerFilePicker:l,attachmentLocalComputerToCloudFilePicker:c,attachmentLocalFileToLinkPicker:d}),(0,f.cr)("cmp-fluid-teachingMoments2")&&ie.createElement(Gn.D,Object.assign({},function(e,t){const n=e.ribbon.formatViewState,i=(0,Kn.U)("MailCompose")&&!!n.fluidLightningScenario,r={getRecipientWells:()=>(0,it.cF)(e),fromAddress:(0,St.Z)(e.toRecipientWell),linkIdContainer:Object.assign(Object.assign({},e.attachmentWell),{logTraceId:e.logTraceId})};return{targetWindow:t,viewState:e,composeParams:r,fileName:e.subject,atMentionHandler:n=>{(0,ti.h)(e,n,t)},viewStateId:e.composeId,componentType:n.fluidLightningScenario,isHidden:!i,mailboxInfo:e.mailboxInfo}}(i,h))))}))),Po="gCX2n",To="O4Jj0",Ro={composeBottomRibbon:"rsB0H"};var xo=n(671463);const ko=Dt().bind(Ro),No=(0,s.Pi)((function({viewState:e}){const t=ie.useRef(ie.createRef()),n=ie.useRef(ie.createRef()),i=ie.useRef(ie.createRef()),r=ie.useRef(ie.createRef()),o=(0,jr.zY)(),s={computer:n,onlineLocation:n,uploadAndShareFromCloud:i,targetWindow:o};return ie.createElement("div",{className:ko(Ro.composeBottomRibbon)},ie.createElement(xo.Dv,{viewState:e,targetWindow:o,attachmentMultiPicker:s,attachmentInlineFilePicker:t.current}),ie.createElement(wo,{viewState:e,targetWindow:o,attachmentInlineFilePicker:t.current,attachmentLocalComputerFilePicker:n.current,attachmentLocalComputerToCloudFilePicker:i.current,attachmentLocalFileToLinkPicker:r.current}))}));var Ao=n(60795),Do=n(800559);const Zo=new Map([["full","densityHeightLarge"],["medium","densityHeightMedium"],["compact","densityHeightSmall"]]),Mo=new Map([["full",30],["medium",26],["compact",22]]);function Oo(){const e=(0,mn.iT)();if(Zo.has(e))return Zo.get(e)}function Fo(){const e=(0,mn.iT)();if(Mo.has(e))return Mo.get(e)}var _o=n(361822),Lo=n(28163),zo=n(690518),Bo=n(688002);const Vo=new et.nI((()=>Promise.all([n.e(64826),n.e(31163)]).then(n.bind(n,631163)))),Uo=(0,et.$y)(Vo,(e=>e.FromContextMenu)),qo=(0,et.$y)(Vo,(e=>e.SendAsTeachingBubble));var Wo=n(48175),Ho=n(950290);const jo={fromRecipientWellWrapper:"W62vo",fromLabel:"guV8Y",nonEditMargin:"Z2voA",editMargin:"ld8B_",editMarginRedesign:"mkV1r",fromLabelGrid:"eOEz5",editFrom:"LAX8n",darkMode:"HxpWc",densityHeightSmall:"yYNaZ",densityHeightMedium:"iFlYy",densityHeightLarge:"_CcB8",fromAddressGrid:"Dmwyg",fromAddress:"JemiZ",fromWell:"Go4Mt",isFromInvalid:"Nv8pj"},Go=Dt().bind(jo),Ko=(0,s.Pi)((function(e){const t=ie.useRef(),{composeViewState:n,containerRefCallback:i}=e,{fromViewState:r}=n,{isFromContextMenuShown:o,isFromEditing:s,isFromValid:a,fromWellFindControlViewState:l}=r,c=r.from,d="fromContainer"+n.editorId,u="fromRecipient"+n.editorId,p=ie.useCallback((()=>{(0,U.W7)(n)}),[n]),m=ie.useCallback((e=>{var i;if(!e)return;const r=e.EmailAddress,o=r?r.EmailAddress:e.primaryText,s=r?r.Name:e.primaryText;o&&s&&((0,U.r5)(n,o,s),null===(i=t.current)||void 0===i||i.clearInput()),(0,Ho.A)(n,o)}),[n,t.current]),h=ie.useCallback((()=>{t.current.getFloatingPicker().forceResolveSuggestion()}),[]),g=ie.useCallback((e=>{"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),h())}),[h]),y=o?ie.createElement(Uo,{composeViewState:n,target:"#"+d,fromWellPeoplePicker:t,onDismiss:p}):null,S=(0,Wo.jc)(n)?ie.createElement(qo,{viewState:n,target:"#"+u}):null,b=s?ie.createElement(zo.Z,{ref:t,className:jo.fromWell,viewState:l,onItemSelected:m,focusAutomatically:!0,openPickerAutomatically:!0,onBlur:h,onInputKeyDown:g}):ie.createElement("div",{className:Go((0,f.Pg)()?void 0:jo.fromAddressGrid,jo.fromAddress,{isFromInvalid:!a}),id:u},ie.createElement(Lo.Z,{key:c.email.EmailAddress,viewState:c,name:c.email.Name,emailAddress:c.email.EmailAddress,onlyShowEmail:!0,mailBoxType:c.email.MailboxType,clientScenario:"ComposeFromMenuReadOnlyRecipient"}),S),I=(0,f.Pg)()&&(0,f.cr)("mon-rp-recipientEdit");return ie.createElement(ie.Fragment,null,ie.createElement("div",{id:d,tabIndex:0,onClick:p,role:Bo.ce.button,"aria-haspopup":"menu",ref:i,className:Go(jo.fromLabel,(0,f.Pg)()?void 0:jo.fromLabelGrid,(0,f.cr)("mon-rp-recipientEdit")?jo.editFrom:jo.nonEditMargin,I?jo.editMarginRedesign:jo.editMargin,(0,mn.BR)()&&jo.darkMode,I?Oo():void 0)},(0,v.ZP)(_o.J)),y,b)})),Xo={sendDiscardBar:"VgWvv",darkModeBgColor:"nX1cA",nonDarkModeBgColor:"tMgZy",sticky:"I3fh9",emptyFrom:"aKR9z",densityBorderFullCompose:"hHQfg",densityBorderinlineComposeTop:"Yc4by",densityHeightSmall:"rbQFI",densityHeightMedium:"OYEEK",densityHeightLarge:"FNFvS",flexDirectionRow:"gTJIC",toRecipientWell:"fIS6p"},$o=Dt().bind(Xo),Jo=(0,s.Pi)((function(e){var t;const{viewState:n,editorRef:i,senderPersona:r}=e,o=null!==(t=(0,jr.zY)())&&void 0!==t?t:window,s=ie.useRef(),{sendMessage:a,discardDraft:l}=lo(n,o,i,s),c=(0,f.cr)("mon-rp-recipientEdit"),d=n.fromViewState.isFromShown,u=!n.isInlineCompose,p=o===window,m=n.isInlineCompose&&(0,en.Z)(),h=n.isInlineCompose&&!(0,en.Z)();return ie.createElement("div",{className:$o(Xo.sendDiscardBar,(0,mt.Z)(n)?Xo.darkModeBgColor:Xo.nonDarkModeBgColor,Xo.sticky,c?Oo():void 0,{densityBorderinlineComposeTop:h,densityBorderFullCompose:u})},!m&&ie.createElement(no,{onSend:a,viewState:n}),d?ie.createElement(Ko,{composeViewState:n}):n.showCompactRecipientWell?ie.createElement(ie.Fragment,null,m&&r,ie.createElement(Ao.Z,{toRecipientWell:n.toRecipientWell,recipientType:Do.C.To,ccRecipientWell:n.ccRecipientWell,bccRecipientWell:n.bccRecipientWell,onSwitchToReadWriteWell:()=>{(0,Yn.Z)(n)},className:Xo.toRecipientWell})):void 0,ie.createElement("div",{className:$o(Xo.flexDirectionRow)},(0,f.cr)("rp-embiggen")&&u&&ie.createElement(xe.Mf,null),p&&!m&&ie.createElement(ro,{viewState:n,onDiscard:l}),p&&ie.createElement(ao,{viewState:n})))}));var Qo=n(437302);const Yo="vAc",es={topContainer:"PyjKh",isInlineCompose:"TTxlX",noTopBorder:"flslw",recipientWell:"G4a5Z",densityHeightSmall:"KLKX0",densityHeightMedium:"DYPcE",densityHeightLarge:"O_y75",recipientWellLine:"pttmI",toField:"Reo8j",compact:"AG3OD",recipientContainer:"XoYXS",edit:"L_Bso",miniWithFrom:"aI_5S",fromGridLine:"Fam8I",toButton:"Obcfa",toButtonPaddingBottom:"_8A9r",toButtonRow:"h_3zb",toButtonRowRedesign:"sddpD",buttonPosition:"CAnAk",toRecipientLine:"YyuKd",toRecipientLineRow:"pNWpr",toRecipientLineRowRedesign:"NgYw8",miniNoFrom:"uFY7u",miniNoFromRow:"_vFLM",miniNoFromRowRedesign:"RDTif",subjectBottomLine:"H6Omf",toGridLine:"mSIML",toGridLineRow:"OPAK7",toGridLineRowRedesign:"NtutP",ccButtonDensity:"bpyNT",ccButtonDensityRow:"xQex4",ccButtonDensityRowRedesign:"APeJf",ccButtonPaddingBottom:"cura6",ccRecipientLine:"XPMhG",ccRecipientLineRow:"A7BWz",ccRecipientLineRowRedesign:"PWMkc",bccButtonDensity:"ZJLoB",bccButtonDensityRow:"PEbVC",bccButtonDensityRowRedesign:"XinH1",bccButtonPaddingBottom:"HPv1O",bccRecipientLine:"C9EzE",bccRecipientLineRow:"S4Wfd",bccRecipientLineRowRedesign:"kWCzW",densityDividerMargin:"uwih8",recipientWellLineGrid:"NaMD_",miniRecipientButtonContainer:"g_4Rk",paddingHeight:"COvTq",densityPadding:"RO_Bn",miniButton:"UpUnl",full:"kHfjb",medium:"PBaJe",readOnlyRecipientWell:"RUEOP",compactRecipientWell:"CGMKS",subject:"FN9jN",subjectContainer:"LmMx2",subjectLine:"xoag9",subjectText:"fqxFK",subjectRightAlignedContainer:"KIfvL",importanceIcon:"jA7WX",meetingDetailsContainer:"C1pX9",subjectIcon:"RCmyt",ribbonIcon:"liJ_8",lockIcon:"MXTiW",darkModeInput:"PoVCt"},ts=(0,s.Pi)((e=>{const{importance:t}=e;if(!t||"Normal"==t)return null;const n="High"==t;return ie.createElement(Ur.J,{key:"importance",className:n?es.importanceIcon:null,iconName:n?"Important":"Down"})}));var ns=n(188464),is=n(972288);var rs=n(42118),os=n(650122),ss=n(540407),as=n(199215),ls=n(133688),cs=n(899974),ds=n(62557);var us=n(262013),ps=n(48856),ms=n(663629);const hs=e=>ie.createElement(us.B,{recipientType:e});var fs=n(141737);const gs=e=>{const t=ie.useContext(K.Z),n=(0,v.ZP)("G4c",(0,v.ZP)(fs.u));return ie.createElement(ie.Fragment,null,ie.createElement(us.B,{onClick:()=>{!function(e){const t=(0,f.cr)("cmp-galRecipientWellModalDeferredChanges")?ms.xw:ms.vL,n=e.targetWindow||window,i=n.document,r=i.createElement("div");r.id="galDialogDiv",i.body.appendChild(r),ps.sY(ie.createElement(ie.Fragment,null,ie.createElement(jr.WU,{window:n},ie.createElement(t,{viewState:e.viewState,onDismiss:()=>{ps.uy(r),i.body.removeChild(r)},wellLabel:hs(e.recipientType)}))),r)}({viewState:e.viewState,recipientType:e.recipientType,targetWindow:t})},recipientType:e.recipientType,roleDesc:n,useKeyActivate:e.useKeyActivate,recipientSize:e.recipientSize,styleAsButton:(0,f.cr)("mon-rp-recipientEdit")}))};var vs=n(808429),ys=n(604135),Ss=n(118336),bs=n(669038),Is=n(136947),ws=n(462480),Cs=n(775390),Es=n(448259);const Ps=(0,Is.aD)("addEntity")((function(e,t,n,i,r,o,s){if(!o)return Es.g4.warn((0,v.WU)("{0} - Attempting to add entity without recipientEmailAddressesAndPositionIndexesDictionary",e.entityScenarioName)),null;if(null==e?void 0:e.hasSessionStarted){const a={QueryString:n||"",QueryStringLength:(0,Cs.T)(n)?0:n.length,DisplayName:i,EmailAddressAndPositionIndex:o,Cvid:e.conversationId};s&&Object.keys(s).forEach((e=>{a[e]=s[e]}));const l=JSON.stringify(a),c=JSON.stringify(Object.keys(o)),d=(0,bs.Z)(e,r,"EntityAdded",c,t,l);(0,Ss.Z)(e,d,!1),e.conversationId=(0,ws.u)(),Es.g4.info((0,v.WU)("{0} Added Entity {1}. Session id: {2}",e.entityScenarioName,c,e.clientSessionId))}}));var Ts=n(955597);function Rs(e){const t=e.EmailAddress;return"PDL"===t.RoutingType?t.Name:(0,Ts.Z)([e])[0]}var xs=n(933635),ks=n(678356),Ns=n(154535),As=n(620638);function Ds(e,t,n,i,r){if(t){const o=Rs(t),s={TargetEntityType:t.PersonaTypeString,ReferenceId:t.ReferenceId,PersonId:t.PersonId};if(r&&(s.Cvid=r),!(0,Cs.T)(o)){const i={};i[o]=n,Ps(e.findPeopleFeedbackManager,function(e,t,n){if(-1!=n&&n<t)return 7;switch(e){case xs.m.Cache:return 7;case xs.m.SearchDirectory:return 3;case xs.m.MixedCacheLive:case xs.m.FindPeople:return 1;default:return 8}}(e.findResultType,e.numberOfCacheResults,n),e.queryString,o,t.TransactionId,i,s)}if((0,As.Z)(e)&&n>=0){const e=(0,vi.zl)(),n=(0,J.pX)(e),r=n.SessionSettings.UserPuid,o=n.SessionSettings.TenantGuid,s=t.LogicalId?t.LogicalId:Ns.Z.sessionIds.latestQFRequestId;ks.dm.importAndExecute(i,r,o,s,t.TransactionId,t.ReferenceId,"EntityClicked")}}}var Zs=n(165956),Ms=n(816958),Os=n(959869),Fs=n(284323),_s=n(406505);const Ls=Dt().bind(es);class zs extends ie.Component{constructor(){super(...arguments),this.controlMap={},this.pendingFocusControl=null,this.elementMap={},this.recipientPanelRefCallback=e=>{this.rootElement=e},this.composeFromMenuRefCallback=e=>{this.elementMap[1]=e},this.focus=(e=2)=>{if(this.props.showCompactRecipientWell)return;const t=this.controlMap[e];t?t.focus():this.pendingFocusControl=e},this.renderRecipientWell=(e,t,n)=>{let i;i=t==Do.C.To?2:t==Do.C.Cc?3:4;const r=e=>{this.elementMap[i]=e},o=2===n.uiEnabledState;if(this.props.isReadOnly){const n=[];return(0,ds.Z)(e,n),ie.createElement("div",{className:es.recipientWell,ref:r},ie.createElement(cs.Z,{wellLabelText:(0,ys.Z)(t),recipients:n,className:es.readOnlyRecipientWell,allowRenderEmptyWell:!0,showPlainText:o}))}return ie.createElement("div",{className:es.recipientWell,ref:r},this.renderRWFabricRecipientWell(e,t,i))},this.renderRWFabricRecipientWell=(e,t,n)=>ie.createElement(Zs.u,{ref:this.createRefCallback(n),viewState:e,inputProps:{onFocus:e=>{(0,Ii.Z)(this.props.composeViewState.addin,0)},"aria-label":(0,ys.Z)(t)},draggableItemType:gt.X.ReadWriteRecipient,dropViewState:e.dropViewState,recipientType:t,onItemsRemoved:this.logOnItemsRemovedFromInfobar,processItemToAdd:Bs(e),convertInitialItemsToWellItems:this.RWFabricRecipientWellCallback,getAdditionalRecipientEmailAddresses:this.getAdditionalRecipientEmailAddresses,inputAriaLabel:(0,ys.Z)(t),isDarkMode:(0,mt.Z)(this.props.composeViewState),showPresence:(0,f.cr)("mon-rp-presence")&&!(0,Qe.Z)()}),this.createRefCallback=e=>t=>{this.controlMap[e]=t,this.pendingFocusControl===e&&t&&(t.focus(),this.pendingFocusControl=null)},this.logOnItemsRemovedFromInfobar=(e,t)=>{t||e.forEach((e=>{var t;(null===(t=e.persona)||void 0===t?void 0:t.EmailAddress)&&this.props.ccRecipientWell&&(0,as.kg)((0,ss.Z)(this.props.ccRecipientWell,[e.persona.EmailAddress]))}))},this.getAdditionalRecipientEmailAddresses=e=>{const t=[];return e!==Do.C.To&&this.props.composeViewState.toRecipientWell.recipients.forEach((e=>t.push(e.persona.EmailAddress.EmailAddress))),e!==Do.C.Cc&&this.props.ccRecipientWell&&this.props.ccRecipientWell.recipients.forEach((e=>t.push(e.persona.EmailAddress.EmailAddress))),e!==Do.C.Bcc&&this.props.bccRecipientWell&&this.props.bccRecipientWell.recipients.forEach((e=>t.push(e.persona.EmailAddress.EmailAddress))),t},this.renderMiniButtonPanel=e=>{const{showCompactRecipientWell:t,composeViewState:n}=this.props,{isInlineCompose:i,importance:r,protectionViewState:o}=n,s=null==o.IRMData||o.IRMData.ModifyRecipientsAllowed,a=!t&&s,l=(0,f.Pg)()&&(0,f.cr)("mon-rp-recipientEdit"),c=(0,mn.iT)();return ie.createElement("div",{className:Ls(es.miniRecipientButtonContainer,l?Oo():es.paddingHeight,l?es.densityPadding:void 0,e,(0,f.cr)("mon-rp-recipientEdit")&&!l?"edit":void 0)},i&&ie.createElement(ts,{importance:r}),a&&!n.isCcShown&&ie.createElement(rn.X,{appearance:"command",onClick:this.onShowCc,className:Ls(es.miniButton,l?c:void 0)},(0,v.ZP)(Qo.F)),a&&!n.isBccShown&&ie.createElement(rn.X,{appearance:"command",onClick:this.onShowBcc,className:Ls(es.miniButton,l?c:void 0,l?es.densityPadding:void 0)},(0,v.ZP)("uAc")),i&&!(0,f.Pg)()&&ie.createElement(rn.X,{appearance:"icon",title:(0,v.ZP)(Yo),iconProps:{iconName:"FullScreen"},onClick:this.onUpConvert,className:Ls(es.miniButton,l?c:void 0),"aria-label":(0,v.ZP)(Yo)}))},this.onUpConvert=()=>{var e,t;const n=null===(t=null===(e=this.rootElement)||void 0===e?void 0:e.ownerDocument)||void 0===t?void 0:t.defaultView;(0,U.Wc)(this.props.composeViewState,n,this.props.editorRef),this.autoFocusControl=3},this.onShowCc=()=>{(0,os.Z)(this.props.composeViewState),this.autoFocusControl=3},this.onShowBcc=()=>{(0,rs.Z)(this.props.composeViewState),this.autoFocusControl=4},this.onSwitchToReadWriteRecipient=()=>{(0,Yn.Z)(this.props.composeViewState),this.autoFocusControl=2},this.composeControlWillUpdate=e=>{this.contentChangeSourceControl=e,this.originalHeight=this.rootElement.clientHeight}}render(){const{isFromShown:e,showCompactRecipientWell:t,ccRecipientWell:n,bccRecipientWell:i,composeViewState:r,senderPersona:o}=this.props,{toRecipientWell:s,isBccShown:a,isCcShown:l}=r,c=(0,f.Pg)();if(t){const e=Ls(es.recipientWellLine,es.toField,c?Oo():es.compact),t=ie.createElement(Ao.Z,{toRecipientWell:s,recipientType:Do.C.To,ccRecipientWell:n,bccRecipientWell:i,onSwitchToReadWriteWell:this.onSwitchToReadWriteRecipient,className:es.compactRecipientWell});return ie.createElement("div",{className:e,key:"recipientPanelDiv",ref:this.recipientPanelRefCallback},o,t,this.renderMiniButtonPanel())}{const t=e?ie.createElement(Ko,{composeViewState:r,containerRefCallback:this.composeFromMenuRefCallback}):null,o=this.renderRecipientWell(s,Do.C.To,r),u=l&&n&&this.renderRecipientWell(n,Do.C.Cc,r),p=a&&i&&this.renderRecipientWell(i,Do.C.Bcc,r);return ie.createElement("div",{ref:this.recipientPanelRefCallback},(0,q.Z)(r)?ie.createElement(ie.Fragment,null,t&&Vs(t),(d=r.publicFolderId,ie.createElement("div",{className:es.recipientWellLine},ie.createElement(ls.O5,{folderId:d})))):ie.createElement(ie.Fragment,null,ie.createElement("div",{className:Ls(es.recipientContainer,(0,f.cr)("mon-rp-recipientEdit")&&!c?"edit":void 0)},!c&&t,!c&&t&&ie.createElement("div",{className:es.fromGridLine}),this.renderMiniButtonPanel(Ls(t?es.miniWithFrom:es.miniNoFrom,!t&&c?es.miniNoFromRowRedesign:void 0,t||c?void 0:es.miniNoFromRow)),!this.props.isReadOnly&&function(e,t,n){const i=(0,f.Pg)()&&(0,f.cr)("mon-rp-recipientEdit");return ie.createElement(ie.Fragment,null,Us(e,Do.C.To,i),t&&Us(t,Do.C.Cc,i),n&&Us(n,Do.C.Bcc,i))}(s,l?n:void 0,a?i:void 0),ie.createElement("div",{className:Ls(es.toRecipientLine,c?es.toRecipientLineRowRedesign:es.toRecipientLineRow,c&&(0,f.cr)("mon-rp-recipientEdit")?Oo():void 0)},o),ie.createElement("div",{className:Ls(es.toGridLine,c&&(0,f.cr)("mon-rp-recipientEdit")?es.densityDividerMargin:void 0,c?es.toGridLineRowRedesign:es.toGridLineRow)}),u&&Vs(u,null,Ls(es.ccRecipientLine,c?es.ccRecipientLineRowRedesign:es.ccRecipientLineRow)),p&&Vs(p,null,Ls(es.bccRecipientLine,c?es.bccRecipientLineRowRedesign:es.bccRecipientLineRow)))))}var d}componentDidMount(){const e=this.props.composeViewState.mailboxInfo.userIdentity;(0,_s.Z)(e)||Fs.D.importAndExecute(e)}UNSAFE_componentWillUpdate(e){this.props.isFromShown==e.isFromShown?!this.props.showCompactRecipientWell||e.showCompactRecipientWell?this.props.ccRecipientWell||!e.ccRecipientWell?this.props.bccRecipientWell||!e.bccRecipientWell||this.composeControlWillUpdate(4):this.composeControlWillUpdate(3):this.composeControlWillUpdate(2):this.composeControlWillUpdate(1)}componentDidUpdate(){if(this.contentChangeSourceControl&&this.props.composeViewState.isInlineCompose){const e=this.rootElement.clientHeight-this.originalHeight,t=this.elementMap[this.contentChangeSourceControl];!function(e,t,n=null){const i=(0,is.Z)(e);if(!i||0==t)return;let r=0,o=i.scrollHeight-i.clientHeight,s=i.scrollTop+t;if(s=Math.max(r,s),s=Math.min(s,o),n&&(r=Math.max(r,n.offsetTop+n.clientHeight-i.clientHeight),o=Math.min(o,n.offsetTop)),s!=i.scrollTop&&s>=r&&s<=o)i.scrollTop=s;else{const e=i.scrollTop;e<r?i.scrollTop=r:e>o&&(i.scrollTop=o)}}(this.props.composeViewState,e,t)}if(this.contentChangeSourceControl=null,this.autoFocusControl){switch(this.autoFocusControl){case 2:case 3:case 4:const e=this.controlMap[this.autoFocusControl];e&&e.focus()}this.autoFocusControl=null}}RWFabricRecipientWellCallback(e){return e}}function Bs(e){return(t,n,i)=>{const r=i||e,o=r.findResultSet.findIndex((e=>e.EmailAddress===t.persona.EmailAddress)),{name:s,customData:l}=vs.Z.AddRecipientFromFindControl;return(0,a.y8)(s,l(o,r.findResultType)),n?function(e,t,n,i){var r,o;if(t){const s=Rs(t),l={TargetEntityType:t.PersonaTypeString};if(!(0,Cs.T)(s)){const c={};c[s]=n,(0,a.y8)("EntityAddSourceFromFindControl",[n,null!==(o=null===(r=e.queryString)||void 0===r?void 0:r.length)&&void 0!==o?o:0,i]),Ps(e.findPeopleFeedbackManager,i,e.queryString,s,t.TransactionId,c,l)}}}(r,t.persona,o,n):Ds(r,t.persona,o,Ms.C.MailCompose,0==r.queryString.length?Os.Z.getCvid(r.userIdentity):void 0),!0}}function Vs(e,t,n){return ie.createElement("div",{className:Ls(es.recipientWellLineGrid,(0,f.Pg)()&&(0,f.cr)("mon-rp-recipientEdit")?es.densityDividerMargin:void 0,n)},e,t)}function Us(e,t,n){const i=(0,f.Pg)(),r=t===Do.C.To,o=t===Do.C.Cc,s=t===Do.C.Bcc,a={toButton:r,toButtonRow:r&&!i,toButtonRowRedesign:r&&i,toButtonPaddingBottom:r&&!n,ccButtonDensity:o,ccButtonDensityRow:o&&!i,ccButtonDensityRowRedesign:o&&i,ccButtonPaddingBottom:o&&!n,bccButtonDensity:s,bccButtonDensityRow:s&&!i,bccButtonDensityRowRedesign:s&&i,bccButtonPaddingBottom:s&&!n};return ie.createElement("div",{className:Ls(n?[Oo(),es.buttonPosition]:void 0,a)},ie.createElement(gs,{viewState:e,recipientType:t,useKeyActivate:!0,recipientSize:n?Fo():void 0}))}const qs=(0,ns.observer)(zs);var Ws=n(102163),Hs=n(6553),js=n(469008);const Gs="wAc",Ks=Dt().bind(es),Xs={wrapper:{flexGrow:1}},$s=(0,s.Pi)(ie.forwardRef((function(e,t){const n=ie.useRef(null),i=ie.useRef(null),r=ie.useCallback((()=>{var t,n;const{subject:r}=e.composeViewState.addin,o=null===(t=i.current)||void 0===t?void 0:t.selectionStart,s=null===(n=i.current)||void 0===n?void 0:n.selectionEnd;o&&s&&(o!=r.selectionStart||s!=r.selectionEnd)&&(0,Hs.Z)(e.composeViewState.addin.subject,o,s)}),[e.composeViewState]);ie.useEffect(r,[]);const o=ie.useCallback(((t,n)=>{(0,js.Z)(e.composeViewState,null!=n?n:"")}),[e.composeViewState]),s=ie.useCallback((()=>{(0,Ii.Z)(e.composeViewState.addin,1)}),[e.composeViewState]),{subject:a,importance:l,smimeViewState:c}=e.composeViewState,d=2===e.composeViewState.uiEnabledState,u=(0,f.Pg)(),p=u&&(0,f.cr)("mon-rp-recipientEdit"),m=p?Oo():void 0;return ie.createElement("div",{className:Ks(p?void 0:es.subjectContainer),ref:n},ie.createElement("div",{className:Ks(es.subjectRightAlignedContainer,m)},u&&ie.createElement(ln,{viewState:e.composeViewState}),ie.createElement(ts,{importance:l})),ie.createElement("div",{className:Ks(es.subjectLine,m)},ie.createElement(Ws.n,{componentRef:i,className:Ks(es.subject,p?es.densityPadding:void 0,p?(0,mn.iT)():void 0),styles:Xs,value:a,inputClassName:(0,mt.Z)(e.composeViewState)?es.darkModeInput:void 0,maxLength:255,borderless:!0,autoComplete:"off",type:"text",spellCheck:!0,placeholder:(0,v.ZP)(Gs),ariaLabel:(0,v.ZP)(Gs),onChange:o,onSelect:r,onFocus:s,readOnly:d}),(null==c?void 0:c.shouldSignMessageAsSmime)&&ie.createElement(Ur.J,{iconName:"Ribbon",className:Ks(es.ribbonIcon,p?es.subjectIcon:void 0,p?(0,mn.iT)():void 0)}),(null==c?void 0:c.shouldEncryptMessageAsSmime)&&ie.createElement(Ur.J,{iconName:"Lock",className:Ks(es.lockIcon,p?es.subjectIcon:void 0,p?(0,mn.iT)():void 0)})),p&&ie.createElement("div",{className:es.subjectBottomLine}))})));var Js=n(390222);const Qs=Dt().bind(es),Ys=[2,3,4],ea=(0,s.Pi)(ie.forwardRef((function(e,t){const n=ie.useRef(),i=ie.useRef();ie.useImperativeHandle(t,(()=>({trySetFocus(e){var t,r;-1!==Ys.indexOf(e)?null===(t=i.current)||void 0===t||t.focus(e):5==e&&(null===(r=n.current)||void 0===r||r.focus())}})),[]);const{viewState:r,senderPersona:o,editorRef:s}=e,{infoBarIds:a,isInlineCompose:l,showCompactRecipientWell:c,fromViewState:d,ccRecipientWell:u,bccRecipientWell:p,meetingRequestItem:m}=r,h=Qs(es.topContainer,{isInlineCompose:l}),f=(a||[]).length+(0,it.wI)(r).length>0;return ie.createElement("div",{className:h,key:"composeTopDiv"},f&&ie.createElement(st,{viewState:r}),ie.createElement(qs,{isReadOnly:!(0,ei.Z)(r),showCompactRecipientWell:c,isFromShown:d.isFromShown,ccRecipientWell:u,bccRecipientWell:p,composeViewState:r,senderPersona:o,ref:e=>i.current=e,editorRef:s}),!l&&ie.createElement($s,{composeViewState:r,ref:e=>n.current=e}),m&&ie.createElement("div",{className:es.meetingDetailsContainer},ie.createElement(Js.zc,{item:m,isForward:!0})))}))),ta=Dt().bind(es),na=[2,3,4],ia=(0,s.Pi)(ie.forwardRef((function(e,t){const n=ie.useRef(null),i=ie.useRef(null);ie.useImperativeHandle(t,(()=>({trySetFocus(e){var t,r;-1!==na.indexOf(e)?null===(t=i.current)||void 0===t||t.focus(e):5==e&&(null===(r=n.current)||void 0===r||r.focus())}})),[]);const{viewState:r,senderPersona:o,editorRef:s}=e,{isInlineCompose:a,showCompactRecipientWell:l,ccRecipientWell:c,bccRecipientWell:d,meetingRequestItem:u}=r,p=(0,f.cr)("mon-rp-recipientEdit")||!(0,Le.m)(0),m=ta(es.topContainer,{isInlineCompose:a,noTopBorder:p}),{isFromShown:h}=r.fromViewState;return ie.createElement("div",{className:m,key:"composeTopDiv"},r.showCompactRecipientWell&&!h?void 0:ie.createElement(qs,{isReadOnly:!(0,ei.Z)(r),showCompactRecipientWell:l,isFromShown:h,ccRecipientWell:c,bccRecipientWell:d,composeViewState:r,senderPersona:o,ref:i,editorRef:s}),!a&&ie.createElement($s,{composeViewState:r,ref:n}),u&&ie.createElement("div",{className:es.meetingDetailsContainer},ie.createElement(Js.zc,{item:u,isForward:!0})))}))),ra=(0,Me.lr)("setIsComposeRendered",(function(e,t){e.isComposeRendered!=t&&(e.isComposeRendered=t)}));var oa=n(243576);const sa="compose_ellipses_menu";function aa({viewState:e,initialActions:t},n,i,r){const[o]=(0,dt.O)(),s=ie.useCallback((()=>o((()=>{n.current&&We.TI.importAndExecute(e.ribbon,n.current.clientWidth),i.current&&i.current.resize()}),1)),[e.ribbon]);ie.useEffect((()=>{const t=function(e){const t=(0,pt.yM)(e.composeId);return 3==(null==t?void 0:t.state)?t.id:""}(e),i=ut.Ej.import().then((e=>{var i,r,o;e(s,t,null!==(o=null===(r=null===(i=n.current)||void 0===i?void 0:i.ownerDocument)||void 0===r?void 0:r.defaultView)&&void 0!==o?o:window)}));return()=>{i.then((()=>{ut.JW.importAndExecute(s,t)}))}}),[s,e]),ie.useEffect((()=>{(0,Ke.Oy)(t,s)}),[])}function la({viewState:e,onUnmountFocusCallback:t},n){const[i,,r]=(0,dt.O)();ie.useEffect((()=>{const o=()=>(r()||i((()=>{if(n.current){const t=function(e){if(!e.selectionPath&&!e.isInlineCompose){if(0==(0,rt.M)(e))return 2;if(!e.subject)return 5}return 7}(e);7==t?(0,p.RX)(e):n.current.trySetFocus(t)}}),10),!0),s=lt.Yp.importAndExecute("MailCompose",o);return o(),()=>{s.then((e=>e())),t?t():lt.MD.importAndExecute()}}),[])}function ca({viewState:e}){var t,n;const i=ie.useRef(!1),r=(0,De.B)((()=>(0,Ze.$4)(e.composeId))),o=ie.useContext(K.Z);ie.useEffect((()=>!i.current&&Ye(e)&&(0,Ze.K_)(e.mailboxInfo)?(Promise.all([Ze._j.import(),Xe.qL.import(),Ze.n2.import(),Ze.r3.import()]).then((([t,n,s,a])=>{var l;i.current=!0,t(r,o);const c=n(e,o);s(r,c,!0,o,null===(l=null==e?void 0:e.itemId)||void 0===l?void 0:l.Id).then((()=>{(0,f.cr)("addin-autoRun")&&(0,f.cr)("addin-autoRun-newComposeEvent")&&function(e){if((0,f.cr)("addin-autoRun-composeEvent"))return 0===e.operation||1===e.operation||2===e.operation||4===e.operation||3===e.operation;if(!e.addin.isAutorunComposeEventTriggered&&(0===e.operation||1===e.operation||2===e.operation||3===e.operation))return!0;return!1}(e)&&((0,f.cr)("addin-autoRun-composeEvent")?(a(r,12,o,null),function(e){return 4===e.operation}(e)||e.addin.isAutorunComposeEventTriggered||a(r,1,o,null)):a(r,1,o,null),Oe(e.addin)),(0,Qe.Z)()||o.requestAnimationFrame((()=>{!function(){const e=(0,Ze.gP)(_e.a.MessageCompose);if(e){let t="New Add-in";const n=(0,Ze.j5)(e);(null==n?void 0:n.DisplayName)&&(t=n.DisplayName),Fe.Y.importAndExecute(_e.a.MessageCompose,e,t)}}()})),((0,f.cr)("addin-exp-awarenessNudgeCusBtn")||(0,f.cr)("addin-exp-awarenessNudge")||(0,f.cr)("addin-exp-awarenessNudgeWaterDropNudge"))&&o.requestAnimationFrame((()=>{!function(){let e=Ze.Xv.WithoutCustomizeActionButton;(0,f.cr)("addin-exp-awarenessNudgeCusBtn")?e=Ze.Xv.WithCustomizeActionButton:(0,f.cr)("addin-exp-awarenessNudgeWaterDropNudge")&&(e=Ze.Xv.WaterDropCallout);Fe.j.importAndExecute(_e.a.MessageCompose,e,sa)}()}))}))})),()=>{Ze.Cp.import().then((e=>e(r,o)))}):()=>{}),[e,null===(n=null===(t=e.protectionViewState)||void 0===t?void 0:t.IRMData)||void 0===n?void 0:n.RmsTemplateId])}const da={allowHotkeyOnTextFields:!0},ua=["MailComposeNew","MailComposeReply","MailComposeReplyAll","MailComposeForward","E2EMailComposeNew","E2EMailComposeReply","E2EMailComposeForward","E2EMailComposeReplyAll"],pa=["E2EMailComposeNew","E2EMailComposeReply","E2EMailComposeForward","E2EMailComposeReplyAll"];const Compose=(0,s.Pi)((function(e){var t;const{className:n,viewState:i,children:r,senderPersona:o}=e,s=ie.useRef(null),a=ie.useRef(null),l=ie.useRef(null),c=ie.useContext(K.Z),d=function(e){return ie.useMemo((()=>new He),[null==e?void 0:e.composeId])}(i),u=ie.useContext(ze.Z);!function({viewState:e},t){const n=ie.useCallback((()=>{(0,U.a1)(e,!0,t)}),[e]);ie.useEffect((()=>{const t=window.setInterval(n,(0,at._)(e)?3e5:3e4);return()=>{window.clearInterval(t),e.shouldUpdateContentOnDispose&&n()}}),[n,e])}(e,d),aa(e,s,l),function({viewState:e},t,n){ie.useEffect((()=>{t.current&&We.TI.importAndExecute(e.ribbon,t.current.clientWidth)}),[n])}(e,s,u),la(e,a),ca(e),ie.useEffect((()=>{tt.importModule("ComposeAttachmentsTelemetry")}),[]),function({viewState:e},t){ie.useEffect((()=>()=>{var n,i,r;const o=null!==(r=null===(i=null===(n=t.current)||void 0===n?void 0:n.ownerDocument)||void 0===i?void 0:i.defaultView)&&void 0!==r?r:window;(0,nt.Z)(e.editorId,o),e.accChecker.isOpen&&m.go.import().then((t=>t(e.accChecker,o))),je.R.importAndExecute(e.expressionId,o),e.proofing.isDexPaneOpen&&qe.w.importAndExecute(e.proofing,o)}),[])}(e,s),ie.useEffect((()=>{var e;(0,oa.Z)(i,{renderComposeCompleted:!0}),e=i.logTraceId,ua.forEach((t=>{(0,Ti.N)(e,t,"RenderComplete")})),(0,f.cr)("mon-ribbon")&&ra(i,!0);const t=()=>function(e){pa.forEach((t=>{(0,Ti.N)(e,t,"PostOpenActions")}))}(i.logTraceId);(0,U.xL)(i,c).then(t).catch(t)}),[i]);const p=(0,ct.I)();(0,Ge.zK)(s,ie.useCallback((()=>[{command:p.sendMail,handler:()=>{var e,t,n;(0,U.lW)(i,null!==(n=null===(t=null===(e=s.current)||void 0===e?void 0:e.ownerDocument)||void 0===t?void 0:t.defaultView)&&void 0!==n?n:window,d)},options:da},{command:p.discardDraft,handler:()=>{var e,t,n;(0,U.eJ)(i,null!==(n=null===(t=null===(e=s.current)||void 0===e?void 0:e.ownerDocument)||void 0===t?void 0:t.defaultView)&&void 0!==n?n:window)},options:da},{command:p.saveDraft,handler:()=>{(0,U.a1)(i,!1,d)},options:da}]),[i]));const h=ie.useCallback((e=>{s.current=e,(null==i?void 0:i.docking)&&e&&(0,Ue.Z)(i,i.docking)}),[i]),g=(i.infoBarIds||[]).length+(0,it.wI)(i).length>0,v=i.isInlineCompose&&(0,en.Z)(),y=i.fromViewState.isFromShown,S=v&&!i.showCompactRecipientWell&&!y;return ie.createElement("div",{className:Ne()(n,Po),ref:h,id:(0,Ve.k)(i.docking,"InitVisiblePart"),style:e.style},ie.createElement("div",{className:(0,mt.Z)(i)?void 0:To},!e.useCommandBarSetting&&(0,f.Pg)()?ie.createElement(ie.Fragment,null,g&&ie.createElement(st,{viewState:i}),ie.createElement(Be.Z,{editorViewState:i,dockingViewState:i.docking,isBottom:!1}),!S&&ie.createElement(Jo,{viewState:i,editorRef:d,senderPersona:o}),ie.createElement(ia,Object.assign({},e,{ref:a,editorRef:d})),(0,Le.m)(0)?ie.createElement(No,Object.assign({},e)):null):ie.createElement(ie.Fragment,null,ie.createElement(ea,Object.assign({},e,{ref:a,editorRef:d}))),ie.createElement(Qi,Object.assign({},e,{editorRef:d})),ie.createElement(Eo,Object.assign({ref:l,editorRef:d,composeHeight:null===(t=s.current)||void 0===t?void 0:t.clientHeight},e)),ie.createElement(Be.Z,{editorViewState:i,dockingViewState:i.docking,isBottom:!0})),r)}));var ma=n(71548);var ha=n(522535),fa=n(967575);const ga="jR1I4",va="Hryeq",ya="R7nP4",Sa="SbbDq",ba=(0,s.Pi)((function(e){const t=t=>{t.stopPropagation(),pt.Cl.importAndExecute(e.viewState)},{viewState:n,className:i,subjectClassName:r}=e,s=(0,ai.b)().viewStates.get(n.data);if(!s)return null;const a=(0,fa.Z)(s.subject);switch(s.asyncSendState){case 3:return ie.createElement("div",{className:i,title:a},ie.createElement(o.$,{className:ya}),ie.createElement("div",{className:r},(0,v.ZP)("K6a")));case 2:return ie.createElement("div",{className:i,title:a},ie.createElement(Ur.J,{iconName:"Error",className:Ne()(ya,ga)}),ie.createElement("div",{className:r},(0,v.ZP)(ha.p)));case 4:return ie.createElement("div",{className:i,title:a},ie.createElement(Ur.J,{iconName:"CheckMark",className:Ne()(ya,va)}),ie.createElement("div",{className:r},(0,v.ZP)("L6a")));default:return ie.createElement("div",{className:i,title:a},ie.createElement(Ur.J,{iconName:"Edit",className:ya}),ie.createElement("div",{className:r},a),ie.createElement(rn.X,{appearance:"icon",iconProps:{iconName:"Cancel"},onClick:t,className:Sa,"aria-label":(0,v.ZP)(ma.t)}))}}));var Ia=n(915401);const wa="WogUK",Ca="RvwNM";var Ea=n(644674);const Pa=(0,s.Pi)((function(e){ie.useEffect((()=>{(0,Ke.TQ)(t.current)}),[]);const t=ie.useRef((0,Ke.Gr)()),n=e.viewState,i=Ne()(Ca,(0,Ea.Z)(n.composeId)?void 0:wa,"customScrollBar"),r=(0,Ia.Z)();return(0,oa.Z)(n,{renderingCompose:!0}),ie.createElement(ze.Z.Provider,{value:r},ie.createElement(Compose,{viewState:n,className:i,style:(0,xe.QP)(r),initialActions:t.current,useCommandBarSetting:e.useCommandBarSetting}))}));U.gx.importModule("composeCommand")},740615:(e,t,n)=>{"use strict";n.d(t,{B:()=>p});var i=n(995082),r=n(625866),o=n(594211),s=n(55461),a=n(729379),l=n(551977),c=n(210667),d=n(789568);function u(){}function p(e,t,n,p){return{computer:n?t.computer.getCreateAttachmentHandler(n.attachmentWell,((e,t,r)=>{(0,i.K)(e,n,t,r,p)}),(0,c.Z)(n),e.targetWindow,n.mailboxInfo,(async t=>{const i=await a.gN.import(),r=await d.e4.import();i(t.files,(0,o.E)(n),n,(0,l.Z)(n.toRecipientWell),e.targetWindow,n.mailboxInfo,n.linksContainerId,void 0,r(n.attachmentWell.groupId,t.properties))}),(0,s.cr)("doc-fullyDeprecateCloudyMaster")||(0,s.cr)("doc-deprecateCloudy-preview-thumbnailView")):u,uploadAndLinkFromCloud:n?t.uploadAndShareFromCloud.getCreateAttachmentHandler(n.attachmentWell,((t,i,o)=>(0,r.R)(t,n,i,o,e.targetWindow)),(0,c.Z)(n),e.targetWindow,n.mailboxInfo):u,uploadAndShareFromCloud:n?t.uploadAndShareFromCloud.getCreateAttachmentHandler(n.attachmentWell,((e,t,r)=>(0,i.K)(e,n,t,r,p)),(0,c.Z)(n),e.targetWindow,n.mailboxInfo):u}}},625866:(e,t,n)=>{"use strict";n.d(t,{R:()=>a});var i=n(64047),r=n(729379),o=n(551977),s=n(594211);async function a(e,t,n,a,l){(await i.uK.import())({files:e,isInline:!1,shouldShare:!0,dataProviderType:a});(await r.gN.import())(e,(0,s.E)(t),t,(0,o.Z)(t.toRecipientWell),l,t.mailboxInfo,t.linksContainerId,void 0,n)}},537678:(e,t,n)=>{"use strict";n.d(t,{Yp:()=>s,MD:()=>a,UC:()=>l,_6:()=>r});var i=n(717420);const r={sequentialIndex:"0",nonSequentialIndex:"-1"},o=new i.nI((()=>Promise.all([n.e(3918),n.e(27600)]).then(n.bind(n,147834)))),s=new i._5(o,(e=>e.registerComponent)),a=new i._5(o,(e=>e.resetFocus)),l=new i._5(o,(e=>e.setFocusToSynchronous))},928541:(e,t,n)=>{"use strict";n.d(t,{F:()=>y,I:()=>b});var i=n(879022);const r="T9a";var o=n(51778),s=n(819310),a=n(681009),l=n(101060),c=n(55461),d=n(382717),u=n(336417),p=n(719360);const m="writeEmail",h="emailList",f="readEmail",g="goTo",v="emailActions";function y(){return[{category:m,displayName:(0,l.ZP)("$8a")},{category:h,displayName:(0,l.ZP)("a9a")},{category:f,displayName:(0,l.ZP)("b9a")},{category:g,displayName:(0,l.ZP)("c9a")},{category:v,displayName:(0,l.ZP)("d9a")}]}function S(e,t,n){return{category:e,description:t,hotmail:n,yahoo:n,gmail:n,owa:n,outlook:n}}const b=(0,p.O)((function(){const e={};(0,c.cr)("cmp-quickSwitcher")&&(e.goToQuickSwitcher={category:g,description:(0,l.ZP)("e9a"),hotmail:"ctrl+shift+k",yahoo:"ctrl+shift+k",gmail:"ctrl+shift+k",owa:"ctrl+shift+k"});e.exitMessageEditor={category:m,description:(0,l.ZP)("R9a"),hotmail:"alt+f10",gmail:"alt+f10",owa:"alt+f10",outlook:"alt+f10"},(0,c.cr)("mail-navigationLoop")&&(e.ctrlTab={category:g,description:(0,l.ZP)(r),outlook:"ctrl+tab"},e.ctrlShiftTab={category:g,description:(0,l.ZP)(r),outlook:"ctrl+shift+tab"});return Object.assign(Object.assign(Object.assign(Object.assign({},(0,u.r)()),{newMail:{category:m,description:(0,l.ZP)("f9a"),hotmail:["n"],yahoo:"n",gmail:"c",owa:["n"],outlook:"ctrl+n"},sendMail:{category:m,description:(0,l.ZP)("g9a"),hotmail:(0,d.V5)()?["ctrl+enter"]:["ctrl+enter","alt+s"],yahoo:"alt+s",gmail:"ctrl+enter",owa:(0,d.V5)()?["ctrl+enter"]:["ctrl+enter","alt+s"],outlook:(0,d.V5)()?["ctrl+enter"]:["ctrl+enter","alt+s"]},reply:{category:m,description:(0,l.ZP)("h9a"),hotmail:"r",yahoo:"r",gmail:"r",owa:["r","ctrl+r"],outlook:"ctrl+r"},replyAll:{category:m,description:(0,l.ZP)("i9a"),hotmail:["a","shift+r"],yahoo:"a",gmail:"a",owa:["shift+r","ctrl+shift+r"],outlook:"ctrl+shift+r"},forward:{category:m,description:(0,l.ZP)("j9a"),hotmail:"shift+f",yahoo:"f",gmail:"f",owa:["shift+f","ctrl+shift+f"],outlook:"ctrl+f"},saveDraft:S(m,(0,l.ZP)("k9a"),"ctrl+s"),discardDraft:{category:m,description:(0,l.ZP)("l9a"),hotmail:"esc",owa:"esc",outlook:"esc"},gotoInbox:{category:g,description:(0,l.ZP)("m9a"),hotmail:"g i",yahoo:"m",gmail:"g i",owa:"g i",outlook:"ctrl+shift+i"},gotoDrafts:{category:g,description:(0,l.ZP)("n9a"),hotmail:"g d",gmail:"g d",owa:"g d"},gotoSent:{category:g,description:(0,l.ZP)("o9a"),hotmail:"g s",gmail:"g t",owa:"g s"},gotoSearch:{category:g,description:(0,l.ZP)("p9a"),hotmail:"/",yahoo:"s",gmail:"/",owa:"alt+q",outlook:["ctrl+e","f3"]},undoAction:S(v,(0,l.ZP)("q9a"),"ctrl+z"),selectUnselectMessage:{category:h,description:(0,l.ZP)("P9a"),hotmail:"ctrl+space",yahoo:"ctrl+space",gmail:["x","ctrl+x"],owa:"ctrl+space",outlook:"ctrl+space"},selectAll:S(h,(0,l.ZP)(i.q),"ctrl+a"),deselectAll:S(h,(0,l.ZP)("r9a"),"esc"),home:S(h,(0,l.ZP)("s9a"),["home","ctrl+home"]),end:S(h,(0,l.ZP)("t9a"),["end","ctrl+end"]),deleteMail:{category:v,description:(0,l.ZP)("u9a"),hotmail:"del",yahoo:"del",gmail:"#",owa:"del",outlook:"del"},openMail:{category:f,description:(0,l.ZP)("v9a"),hotmail:["o","enter"],gmail:["o","enter"],owa:["o","enter"],outlook:"enter"},openMailInPopout:S(f,(0,l.ZP)("w9a"),"shift+enter"),closeMail:{category:f,description:(0,l.ZP)("x9a"),hotmail:"esc",yahoo:"esc",gmail:"u",owa:"esc",outlook:"esc"},openNextItem:{category:f,description:(0,l.ZP)("y9a"),hotmail:"ctrl+.",yahoo:"ctrl+.",gmail:"j",owa:"ctrl+.",outlook:"ctrl+."},openPrevItem:{category:f,description:(0,l.ZP)("z9a"),hotmail:"ctrl+,",yahoo:"ctrl+,",gmail:"k",owa:"ctrl+,",outlook:"ctrl+,"},focusNextItemPart:{category:f,description:(0,l.ZP)("A9a"),hotmail:".",gmail:"n",owa:"."},focusPrevItemPart:{category:f,description:(0,l.ZP)("B9a"),hotmail:",",gmail:"p",owa:","},expandCollapseAll:{category:f,description:(0,l.ZP)("C9a"),hotmail:"x",owa:"x"},expandAll:{category:f,description:(0,l.ZP)("D9a"),gmail:";",outlook:"right"},collapseAll:{category:f,description:(0,l.ZP)("E9a"),gmail:":",outlook:"left"},softDeleteMail:S(v,(0,l.ZP)("F9a"),"shift+del"),newFolder:{category:v,description:(0,l.ZP)("G9a"),hotmail:"shift+e",yahoo:"ctrl+shift+e",owa:"shift+e",outlook:"ctrl+shift+e"},markAsRead:{category:v,description:(0,l.ZP)("H9a"),hotmail:"q",yahoo:"k",gmail:"shift+i",owa:(0,d.V5)()?"q":["q","ctrl+q"],outlook:"ctrl+q"},markAsUnread:{category:v,description:(0,l.ZP)("I9a"),hotmail:"u",yahoo:"shift+k",gmail:"shift+u",owa:["u","ctrl+u"],outlook:"ctrl+u"},markAsReadUnread:{category:"",description:"",hotmail:["q","u"],yahoo:["k","shift+k"],gmail:["shift+i","shift+u"],owa:(0,d.V5)()?["q","u"]:["ctrl+q","ctrl+u"],outlook:["ctrl+q","ctrl+u"]},toggleFlag:{category:v,description:(0,l.ZP)("J9a"),hotmail:"ins",yahoo:"l",gmail:"s",owa:"ins",outlook:"ins"},archiveMail:{category:v,description:(0,l.ZP)("K9a"),hotmail:"e",gmail:"e",owa:"e",outlook:"backspace"},markAsJunk:{category:v,description:(0,l.ZP)("L9a"),hotmail:"j",gmail:"shift+1",owa:"j",outlook:"ctrl+j"},moveToFolder:{category:v,description:(0,l.ZP)(o.Q),hotmail:"v",gmail:"v",owa:"v",outlook:"ctrl+shift+v"},categorize:{category:v,description:(0,l.ZP)("M9a"),hotmail:"c",gmail:"l",owa:"c"},ignore:{category:v,description:(0,l.ZP)(s.I),hotmail:"ctrl+del",owa:"ctrl+del",outlook:"ctrl+del"},snooze:{category:v,description:(0,l.ZP)(a.H),hotmail:"b",gmail:"b",owa:"b"},insertHyperlink:{category:m,description:(0,l.ZP)("N9a"),hotmail:"ctrl+k",gmail:"ctrl+k",owa:"ctrl+k",outlook:"ctrl+k"},keyboardShortcuts:{category:g,description:(0,l.ZP)("O9a"),hotmail:"?",gmail:"?",owa:"?",yahoo:"?"},f6:{category:g,description:(0,l.ZP)(r),hotmail:"ctrl+f6",gmail:"ctrl+f6",owa:"ctrl+f6",yahoo:"ctrl+f6",outlook:"f6"},shiftF6:{category:g,description:(0,l.ZP)(r),hotmail:"ctrl+shift+f6",gmail:"ctrl+shift+f6",owa:"ctrl+shift+f6",yahoo:"ctrl+shift+f6",outlook:"shift+f6"}}),e),(0,c.cr)("tri-quickSteps")&&(0,c.cr)("mon-ribbon")?{quickStep5:I(5),quickStep6:I(6),quickStep7:I(7),quickStep8:I(8),quickStep9:I(9)}:{})}));function I(e){return S(v,(0,l.ZP)("Q9a"),`ctrl+shift+${e}`)}},324112:(e,t,n)=>{"use strict";n.d(t,{u9:()=>h,Pq:()=>s,hZ:()=>o});var i=n(913717),r=n(933658);function o(){const e=(0,i.ii)();return e&&0==e.tableQuery.type&&(0,r.tA)(e.tableQuery.folderId)}function s(){const e=(0,i.ii)();return e&&0==e.tableQuery.type&&(0,r.tA)(e.tableQuery.folderId)?e.tableQuery.folderId:null}var a=n(371134),l=n(29953),c=n(711414),d=n(559621);const u=(0,a.MT)("publicFolderUtilsStore",new d.ObservableMap)(),p=()=>u;var m=n(964659);function h(e){if(!p().has(e)){const t=l.Z.folderTable.get(e),n=null!=t.replicaList?t.replicaList[0]:(0,m.c6)().SessionSettings.DefaultPublicFolderMailbox,i=(0,c.Z)(n);f(e,i)}return p().get(e)}const f=(0,a.lr)("addPublicFolderMailboxInfoToStore",((e,t)=>{p().set(e,t)}))},78220:(e,t,n)=>{"use strict";n.d(t,{lC:()=>d,ME:()=>u,U_:()=>p,Q5:()=>l,qI:()=>a});var i=n(55461),r=n(552542),o=n(329746),s=n(165201);function a(){var e;return c()&&"false"!==(null===(e=(0,s.rV)(self,"offlineEnabled"))||void 0===e?void 0:e.toLocaleLowerCase())}function l(){return c()&&(0,i.cr)("fwk-offline-data")}function c(){return self.BroadcastChannel&&(0,i.cr)("fwk-graphql-worker-link")&&(0,i.cr)("fwk-offline-sync")&&((0,o.X)("offlineDataAllowed")||(0,o.X)("conditionalOfflineDataAllowed")&&(null===(t=null===(e=(0,r.Z)().PolicySettings)||void 0===e?void 0:e.SignInState)||void 0===t?void 0:t.includes("kmsi")));var e,t}function d(){return a()&&(0,i.cr)("fwk-offline-data")}function u(){return d()&&(0,i.cr)("peo-offline")}function p(){return u()&&(0,i.cr)("peo-offline-via-prapi")}},77214:(e,t,n)=>{"use strict";n.d(t,{n8:()=>r.n,ch:()=>b,vC:()=>I,NP:()=>S,xW:()=>l,x6:()=>o,Ry:()=>i.Z,c7:()=>s,v9:()=>p,v7:()=>g,Rd:()=>f});var i=n(238437),r=n(931058);function o(e,t){return(0,r.Z)(t).overrides[e]}function s(e){return(0,r.Z)(e).report}var a=n(448259);function l(e){const t=(0,r.Z)(e);return t.initialized||a.rx("Attempted to read settings before application settings were initialized."),t.settings}var c=n(922562);function d(e,t={}){let n=0;const i=[];return Object.keys(e).forEach((r=>{const o=e[r];if("object"==typeof o&&null!==o&&!Array.isArray(o)){const{count:o,keys:s}=d(e[r],t[r]);o&&(n+=o,i.push({group:r,settings:s}))}else t.hasOwnProperty(r)||(n+=1,i.push(r))})),{count:n,keys:i}}const u=(e,t,n)=>{const i={};let r=0;const{count:o,keys:s}=d(e,t);if(o&&(i.MissingSettings=s,r=o),r&&(i.MissingSettingsCount=r),n&&(i.LastError=n),r)return i};function p(e,t){const n=(0,r.Z)(t);if(n.initialized=!0,!e)return void(n.report={NoSettings:!0});if(!e.settings)return n.lastError=e.lastError,void(n.report={NoSettings:!0});const i={};Object.keys(c.t).forEach((t=>{i[t]={};const n=e.settings[t],r=c.t[t];Object.keys(r).forEach((e=>{i[t][e]=n&&n.hasOwnProperty(e)?n[e]:c.t[t][e]}))})),n.configIDs=e.configIDs,n.lastError=e.lastError,n.settings=i,n.report=u(c.t,e.settings,e.lastError)}var m,h=n(158447);function f(e,t,n){(0,h.BN)(e,t,n),(0,r.Z)(n).overrides[e]=t}function g(e){(0,h.Iw)(e),(0,r.Z)(e).overrides={}}!function(e){e[e.None=0]="None",e[e.Idb=1]="Idb",e[e.Web=2]="Web",e[e.Remote=4]="Remote",e[e.All=7]="All"}(m||(m={}));var v=n(55461);const y=new Map([["markItemAsRead","fwk-useoutlookgateway-markItemAsRead"],["collab","fwk-useoutlookgateway-collabObject"],["cities","fwk-useoutlookgateway-places-cities"],["roomLists","fwk-useoutlookgateway-places-roomLists"],["rooms","fwk-useoutlookgateway-places-rooms"],["spaces","fwk-useoutlookgateway-places-spaces"]]);function S(e,t,n){return(w(e,t,n)&m.Web)==m.Web}function b(e,t,n){return(w(e,t,n)&m.Idb)==m.Idb}function I(e,t,n){return(w(e,t,n)&m.Remote)==m.Remote}function w(e,t,n){var r;const o=m.All;if(y.has(t)){const e=y.get(t);if(e)return(0,v.cr)(e)&&!n?m.Remote:o}if((0,v.cr)("fwk-application-settings")){const n=(0,i.Z)("EnabledResolvers"),s=null===(r=null==n?void 0:n[e])||void 0===r?void 0:r[t];return null==s?o:s}return o}n(616260)},238437:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(448259),r=n(55461),o=n(931058);function s(e,t,n){let i={};return Object.keys(e).forEach((r=>{if("object"==typeof r&&null!==r&&!Array.isArray(r))i=Object.assign(Object.assign({},i),{[n.shift()]:s(e[r],t,n)});else{const o=[...n,r].join("."),s=t[o];i=Object.assign(Object.assign({},i),{[r]:void 0===s?e[r]:s})}})),i}function a(e,t){const n=(0,o.Z)(t);return n.initialized||i.rx(`Attempted to read ${e} before application settings were initialized.`),(0,r.cr)("fwk-devTools")?s(n.settings[e],n.overrides,[e]):n.settings[e]}},922562:(e,t,n)=>{"use strict";n.d(t,{t:()=>i});const i={Loki:{resourceUrl:"https://loki.delve.office.com/"},Analytics:{disabledDatapoints:[]},AboutOutlook:{enabled:!1},BingNativeAds:{placementOther1:"ARCZfUlvuZ0j9rVyyrDOVrqoWLU1DW5apsssi95fdg/SB0aIpD6l006AvcP/wXoOI40=",placementOther2:"ARBR/vpvU+rZ5Amq3JsP/KgfscqG1qZwde2WRFRcGO+P5RfrTrEp2LPDb/01YVw4sF0=",placementPrimary:"ARB68RharLDirX5n8PKMAX/gwjPisZPgkOV9uea6yzb7MptvVIFyqLkH0kWrQBTCff8=",placementHeader:"ARCyZ6WH59gW6TqsH4dLtbi0U2JLZrEm/ZO3JATMCanRMASaB4TfJmHWe09qcD2AS0g="},EnabledResolvers:{Query:{},Mutation:{},Subscription:{}},CAPIv3:{isCAPIv3Enabled:!1},PersonaOffline:{resyncIntervalMS:864e5,syncPageSize:1e3,maxCountToSync:2e4},AppHealth:{appHealthIntervalInMs:18e5},MonarchNotifications:{enabled:!1},TeamsURL:{resourceURL:""},Ads:{astJsURL:"https://acdn.adnxs.com/ast/static/0.37.1/ast.js"},NativeAdIFrame:{iframeUrl:"https://outlookads.live.com/mail/adsframe"},InboxShopping:{allowedDomainsURL:"https:{0}assets/inboxshopping/v1/allowedDomainsBloom.json"},TaboolaNativeAds:{apiKey:"5b8cb6ece5c7b124b55d084f3a6ee7520d2f0966",publishIdFormat:"msn-outlookcom-{0}",placementOther1:"Inbox_Text_Widget",placementOther2:"Inbox_Text_Widget_v2",placementPrimary:"Inbox_Text_Primary",placementHeader:"Nav_text"},XandrNativeAds:{placementOther1:"WAN1USEN",placementOther2:"WAN2GBL",placementPrimary:"PWP1GBL",placementHeader:"PWN1GBL"},TripleliftNativeAds:{placementOther1:"outlook_mainfeed",placementOther2:"outlook_mainfeed2",placementPrimary:"outlook_mainfeed_primary",placementHeader:"outlook_nav"}}},931058:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l,n:()=>c});var i=n(922562),r=n(158447),o=n(55461);const s={settings:i.t,overrides:(0,r.A7)(void 0),configIDs:void 0,lastError:void 0,initialized:!1,report:void 0,searchKey:void 0},a=new Map([["",Object.assign({},s)]]);function l(e){const t=(0,o.$2)(e);let n=a.get(t);if(!n){const i=Object.assign(Object.assign({},s),{overrides:(0,r.A7)(e)});a.set(t,i),n=i}return n}function c(e){const t=(0,o.$2)(e),n=a.get(t);return null==n?void 0:n.initialized}},158447:(e,t,n)=>{"use strict";n.d(t,{A7:()=>o,BN:()=>s,Iw:()=>a});var i=n(55461),r=n(165201);const o=e=>{const t=(0,r.rV)(self,l(e));if(t)try{return JSON.parse(t)}catch(e){return{}}return{}},s=(e,t,n)=>{const i=o(n);i[e]=t,(0,r.LS)(window,l(n),JSON.stringify(i))},a=e=>{(0,r.cl)(window,l(e))};function l(e){const t=(0,i.$2)(e);return`applicationSettingOverrides${t?`:${t}`:""}`}},329492:(e,t,n)=>{"use strict";function i(e,t){return(100-e[0])*((100-t)/100)+t}n.d(t,{Z:()=>i})},92766:(e,t,n)=>{"use strict";n.d(t,{O8:()=>o.Z,YA:()=>S,iu:()=>b,zK:()=>I,BO:()=>w});var i=n(559621),r=n(989526),o=n(788573),s=n(923912),a=n(984869),l=n(308631);function c(e){if(!e)return;if("string"==typeof(e=(0,o.Z)(e))||Array.isArray(e))return e;const t=(0,s.Z)();return(0,a.Z)()?function(e,t){switch(t){case l.$k.OutlookForWindows:return e.outlook;case l.$k.OutlookForWeb:return e.owa;default:return}}(e,t):function(e,t){switch(t){case 0:return e.hotmail;case 2:return e.yahoo;case 3:return e.gmail;case 4:return e.owa;default:return}}(e,t)}function d(e,t,n,i,r){return o=>{(function(e,t){if(t)return!1;const n=e.target;return"INPUT"==n.tagName||"SELECT"==n.tagName||"TEXTAREA"==n.tagName||n.contentEditable&&"true"==n.contentEditable})(o,e)||t&&!t(o)||(n&&o.stopPropagation(),i&&o.preventDefault(),r(o))}}var u=n(448259);const p={8:"backspace",9:"tab",13:"enter",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",92:"meta"},m={107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",219:"[",221:"]"};for(let e=1;e<20;++e)p[111+e]="f"+e;for(let e=0;e<=9;++e)m[e+96]=e.toString();const h={};for(const e of Object.keys(p))h[p[e]]=1;const f="keyboard";class g{constructor(e){this.targetElement=e,this.eventMapping={keydown:{},keypress:{}},this.sequenceMapping={},this.listenerFunc={},this.hasSequences=!1,this.currentSequence="",this.timerHandle=0}reset(){for(const e of Object.keys(this.eventMapping))this.removeListener(e);this.eventMapping={keydown:{},keypress:{}},this.sequenceMapping={},this.hasSequences=!1,this.currentSequence="",self.clearTimeout(this.timerHandle)}bind(e,t){this.forEachKey(e,(e=>{if(this.isSequence(e))this.addListener("keydown"),this.hasSequences=!0,this.sequenceMapping[e]=t;else{const n=e.indexOf("+")>-1||h[e]?"keydown":"keypress";this.addListener(n);(this.eventMapping[n]=this.eventMapping[n]||{})[e]=t}}))}unbind(e){this.forEachKey(e,(e=>{this.isSequence(e)&&delete this.sequenceMapping[e],Object.keys(this.eventMapping).map((t=>{const n=t;delete this.eventMapping[n][e]}))})),0==Object.keys(this.sequenceMapping).length&&(this.hasSequences=!1),v(this.eventMapping.keydown)&&v(this.sequenceMapping)&&this.removeListener("keydown"),v(this.eventMapping.keypress)&&this.removeListener("keypress")}isSequence(e){return e.indexOf(" ")>-1}handleKeyEvent(e){var t;const n=e,i=n.type,r=function(e){const t="number"!=typeof e.which?e.keyCode:e.which;if("keypress"==e.type){const n=String.fromCharCode(t),i=e.shiftKey?n:n.toLowerCase();return{baseChar:i,char:i}}const n=p[t]||m[t]||String.fromCharCode(t).toLowerCase();let i=n;return e.shiftKey&&(i="shift+"+i),e.altKey&&(i="alt+"+i),(e.ctrlKey||e.metaKey)&&(i="ctrl+"+i),{char:i,baseChar:n}}(n),o=r.char,s=r.baseChar;if(u.g4.verbose(`Received key ${o} for event ${i}`,f),this.hasSequences&&"keydown"==i){self.clearTimeout(this.timerHandle),this.currentSequence+=o;const e=this.sequenceMapping[this.currentSequence];e&&y(e,n,this.currentSequence);Object.keys(this.sequenceMapping).some((e=>e.startsWith(this.currentSequence)&&e!=this.currentSequence))?this.currentSequence+=" ":this.currentSequence="",this.timerHandle=self.setTimeout((()=>{this.currentSequence=""}),500)}if(this.ignoreNextKeyPressChar&&this.ignoreNextKeyPressChar==o&&"keypress"==i)u.g4.info(`Ignore keypress for ${o}`);else{const e=null===(t=this.eventMapping[i])||void 0===t?void 0:t[o];e&&y(e,n,o)}this.ignoreNextKeyPressChar="keydown"==i&&s!=o?s:void 0,setTimeout((()=>{this.ignoreNextKeyPressChar=void 0}),200)}addListener(e){var t;if(!this.listenerFunc[e]){const n=this,i=this.listenerFunc[e]=e=>this.handleKeyEvent.apply(n,[e]);u.g4.info(`Adding event listener ${e} for element with classes ${null===(t=this.targetElement)||void 0===t?void 0:t.className}`,f),this.targetElement.addEventListener(e,i)}}removeListener(e){var t;const n=this.listenerFunc[e];n&&(u.g4.info(`Removing ${e} event listener for element with classes ${null===(t=this.targetElement)||void 0===t?void 0:t.className}`,f),this.targetElement.removeEventListener(e,n),delete this.listenerFunc[e])}forEachKey(e,t){if(Array.isArray(e))for(const n of e)t(n);else t(e)}}function v(e){return 0==Object.keys(e).length}function y(e,t,n){u.g4.info(`Found callback for event ${t.type} on key ${n}`,f),e(t)}function S(e,t,n={}){T(r.useMemo((()=>[{command:e,handler:t,options:n}]),[e,t,n.stopPropagation,n.preventDefault,n.allowHotkeyOnTextFields,n.isEnabled]))}function b(e,t,n,i={}){C(e,r.useMemo((()=>[{command:t,handler:n,options:i}]),[t,n,i.stopPropagation,i.preventDefault,i.allowHotkeyOnTextFields,i.isEnabled]))}function I(e,t){C(e,r.useMemo((()=>t()),[t]))}function w(e,t,n){const i=r.useMemo((()=>t(n)),[t,n]),o=r.useRef();r.useEffect((()=>{const t=(async()=>{const t=await i;return e?E(e,t,o):T(t)})();return()=>{t.then((e=>e()))}}),[e,i])}function C(e,t){const n=r.useRef();r.useEffect((()=>E(e,t,n)),[e,t])}function E(e,t,n){var i;const r=e.current;if(r){let e;(null===(i=n.current)||void 0===i?void 0:i.boundElement)===r?e=n.current.keytrap:(e=new g(r),n.current={keytrap:e,boundElement:r});const o=R(e,t);return()=>{null==e||e.reset(),o()}}return()=>{}}let P;function T(e){P||(P=new g(document.body));const t=R(P,e);return()=>{for(const{command:t}of e){const e=c(t);e&&P.unbind(e)}t()}}function R(e,t){return(0,i.autorun)((()=>{for(const{command:n,handler:i,options:{stopPropagation:r=!0,preventDefault:o=!0,allowHotkeyOnTextFields:s=!1,isEnabled:a}={}}of t){const t=c(n);t&&e&&e.bind(t,d(s,a,r,o,i))}}))}},788573:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(289446);function r(e,t){return e?t(e):e}const o=function(e,t){return Array.isArray(e)||"string"==typeof e?t.reduce(((e,t)=>t(e)),e):{hotmail:t.reduce(((e,t)=>r(e,t)),e.hotmail),owa:t.reduce(((e,t)=>r(e,t)),e.owa),gmail:t.reduce(((e,t)=>r(e,t)),e.gmail),yahoo:t.reduce(((e,t)=>r(e,t)),e.yahoo),outlook:t.reduce(((e,t)=>r(e,t)),e.outlook)}};function s(e){if(Array.isArray(e)){if(e.includes("del"))return e.concat("backspace")}else if(-1!==e.indexOf("del"))return[e,e.replace("del","backspace")];return e}let a;const l=function(e){return(0,i.V5)()?(a||(a=[s]),o(e,a)):e}},923912:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(984869),r=n(552542),o=n(308631);function s(){var e,t;return(0,i.Z)()?(0,o.Bb)(o.Xm.KeyboardShortcuts).keyboardShortcutsMode:null!==(t=null===(e=(0,r.Z)().UserOptions)||void 0===e?void 0:e.KeyboardShortcutsMode)&&void 0!==t?t:4}},984869:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(329746);function r(){return(0,i.X)("nativeFriendlyKeyboarding")}},75277:(e,t,n)=>{"use strict";n.d(t,{z:()=>r});var i=n(136947);class r{constructor(e){this.maxSize=e,this.references=[],this.mruList=[]}initialize(e,t){if(!this.store){this.store=e,this.deleteCallback=t;for(const t of e.keys())this.mruList.push(t)}}add(e,t){(0,i.aD)("MruCache_add")((()=>{this.store.set(e,t),this.mruList.indexOf(e)>=0?this.touch(e):(this.mruList.push(e),this.purgeIfNecessary())}))()}get(e){return this.store.get(e)}getAndTouch(e){const t=this.store.get(e);return t&&this.touch(e),t}has(e){return this.store.has(e)}remove(e){(0,i.aD)("MruCache_remove")((()=>{if(this.store.has(e)&&!this.isReferenced(e))return this.removeItemAtIndex(this.mruList.indexOf(e))}))()}registerReference(e){this.references.push(e)}clear(){(0,i.aD)("MruCache_clear")((()=>{this.purgeTillSize(0)}))()}getItemIds(){return new Array(...this.mruList)}touch(e){const t=this.mruList.indexOf(e);if(t<0)throw new Error(`Item with key '${e}' does not exist in the cache.`);this.mruList.splice(t,1),this.mruList.push(e)}purgeIfNecessary(){this.purgeTillSize(this.maxSize)}purgeTillSize(e){let t=0;for(;this.mruList.length>e&&t<this.mruList.length;){const e=this.mruList[t];this.isReferenced(e)?t++:this.removeItemAtIndex(t)}}removeItemAtIndex(e){if(e<0||e>=this.mruList.length)throw new Error("Invalid index to remove: "+e);const t=this.mruList[e];this.mruList.splice(e,1),this.deleteCallback?this.deleteCallback(t):this.store.delete(t)}isReferenced(e){for(let t=0;t<this.references.length;t++){const n=this.references[t]();if(Array.isArray(n)){if(-1!=n.indexOf(e))return!0}else if(n==e)return!0}return!1}}},869358:(e,t,n)=>{"use strict";n.d(t,{ju:()=>s,k9:()=>a,og:()=>l,Z$:()=>r.Z});var i=n(717420),r=n(720377);const o=new i.nI((()=>Promise.all([n.e(23637),n.e(83809),n.e(52295)]).then(n.bind(n,30529)))),s=new i._5(o,(e=>e.fetchAccessTokenFromMsal)),a=new i._5(o,(e=>e.createMsalPublicClientApplication)),l=new i._5(o,(e=>e.signoutFromMsal))},720377:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(329746),r=n(55461);const o={"https://loki.delve.office.com/":!0,"https://www.yammer.com/":!0,"https://web.yammer.com/teams":!0,"https://fe-26.qas.bing.net/compose":!0,"https://api.diagnostics.office.com":!0,"https://outlook.office365.com/connectors":!0,"https://api.office.net":!0,"https://clients.config.office.net/":!0,"https://outlook.office.com/FocusedInboxB2":!0,"https://outlook.office.com/search":!0,"https://outlook.office365.com/search":!0,"https://augloop.office.com/v2":!0,"https://arc.msn.com/v4":!0,"https://microsoft.sharepoint.com/":!0,"https://microsoft.sharepoint.com":!0,"https://microsoft.sharepoint-df.com/":!0,"https://microsoft.sharepoint-df.com":!0,"https://microsoft-my.sharepoint.com/":!0,"https://microsoft-my.sharepoint.com":!0,"https://microsoft-my.sharepoint-df.com/":!0,"https://microsoft-my.sharepoint-df.com":!0,"https://webdir.online.lync.com":!0,"https://chatsvcagg.teams.microsoft.com":!0,"https://teams.microsoft.com":!0,"https://graph.microsoft.com":!0,"https://graph.microsoft.com/":!0,"https://pushchannel.1drv.ms":!0,"https://outlook.office.com":!0,"https://outlook-sdf.office.com":!0,"https://outlook-sdf.office365.com":!0,"https://outlook-sdf.office.com/":!0,"https://outlook-sdf.office365.com/":!0,"https://outlook.office.com/":!0,"https://outlook.office365.com":!0,"https://outlook.office365.com/":!0,"https://outlook-sdf.live.com":!1,"https://outlook.live.com":!1,"https://cortana.ai":!1,"https://dataservice.o365filtering.com":!1};function s(e){return(0,r.cr)("auth-msaljs-fetchResourceToken")&&(0,i.X)("msalTokenFetch")&&o[e]}},520974:(e,t,n)=>{"use strict";n.d(t,{zg:()=>I,nK:()=>w,vy:()=>r,F1:()=>g,Cb:()=>v,Vh:()=>f,zk:()=>y,wm:()=>p,t9:()=>o,xp:()=>h,GS:()=>s});var i=n(371134);const r=(0,i.aD)("initializeOwaObservableDateTime"),o=(0,i.aD)("observableNowChanged"),s=(0,i.aD)("observableTodayChanged");var a=n(509636),l=n(559621);const c=(0,i.MT)("ObservableDateTime",{now:0,today:0})(),d=()=>c,u=(0,l.computed)((()=>(d().now,(0,a.vk)()))),p=()=>u.get(),m=(0,l.computed)((()=>(0,a.vk)(d().today))),h=()=>m.get(),f=e=>(0,a.RR)(e,p()),g=e=>(0,a.Ax)(e,p()),v=e=>S(e,a.RR),y=e=>S(e,a.Xy),S=(e,t)=>t((0,a.b7)((0,a.vk)(e)),h());var b=n(444928);function I(e){if(!e)return"";const t=(0,a.vk)(e),n=function(e,t){const n=(0,a.b7)(e);if((0,a.KC)(n,t))return b.Ej;const i=e=>(0,a.$c)(n,(0,a.E4)(t,-e),t);if(i(3))return b.an;if(i(30))return b.VI;return b.cv}(t,h());return n(t)}function w(e){if(!e)return"";return function(e,t){const n=(0,a.b7)(e);return(0,a.KC)(n,t)?(0,b.Ej)(e):C(n,t,1)?(0,b.T_)(e):C(n,t,7)?(0,b.um)((0,b.I9)(e),(0,b.Ej)(e)):(0,b.um)((0,b.$j)(e),(0,b.Ej)(e))}((0,a.vk)(e),h())}function C(e,t,n){return(0,a.$c)(e,(0,a.E4)(t,-n),t)}const E=(0,i.aD)("setNow"),P=(0,i.aD)("setToday",(e=>({today:e})));(0,i.ed)(E,(()=>{d().now=(0,a.AB)()})),(0,i.ed)(P,(({today:e})=>{d().today=e}));var T=n(5570),R=n(309094),x=n(448673);let k=!1;function N(){E();const e=(0,a.u3)((0,a.Lg)()),t=d().today!=e;t&&P(e),o(),t&&s()}(0,i._F)(r,(()=>{if(N(),!k){const e=(0,a.zO)(),t=(0,a.Fq)((0,a.mH)(e,1)),n=(0,a._Q)(t,e);setTimeout((()=>setInterval(N,T.qe)),n);const i=(0,x.y)().document;i&&i.addEventListener("visibilitychange",N),k=!0}})),(0,i._F)(R.gU,N)},134e3:(e,t,n)=>{"use strict";n.d(t,{E:()=>o});var i=n(371134),r=n(524681);const o=(0,i.aD)("APPLY_DEFAULT_OPTIONS_ON_LOAD_FAIL",((e=(0,r.Z)())=>({defaultOptions:e})))},524681:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(55461),r=n(954947),o=n(308631);function s(){return{[o.Xm.AdsAggregate]:{feature:o.Xm.AdsAggregate,nativeAdsSeenRunningSum:0,nativeAdsClickedRunningSum:0,nativeAdsDeletedRunningSum:0,nativeCPMRunningSum:0,nativeWinCPMRunningSum:0,wasAdSeenInLastSession:!1,startOfAdFreeTrial:"",miniNativeAdsSeenRunningSum:0,miniNativeAdsClickedRunningSum:0,miniNativeAdsDeletedRunningSum:0,miniNativeCPMRunningSum:0,miniNativeWinCPMRunningSum:0,miniWasAdSeenInLastSession:!1},[o.Xm.SmartSuggestions]:{smartSuggestionsEnabled:!0,browserLocationEnabled:!1},[o.Xm.DiverseEmojis]:{diverseEmojisSelectedSkinTone:""},[o.Xm.SurfaceActions]:{readSurfaceActions:["Reply","ReplyAll","Forward"].concat((0,r.Z)()?[]:["LikeUnlike"]),readSurfaceAddins:[],composeSurfaceActions:["AddAttachment","AddClassicAttachment","InsertLink","AddInlineImage","AddEmoji","ToggleDictation","ProofingOptions","QuickUse","ToggleRibbon","FluidHeroButton"],composeSurfaceAddins:[]},[o.Xm.SkypeNotifications]:{skypeMessageNotification:1,skypeCallingNotification:1},[o.Xm.Confetti]:{confettiEnabled:!0},[o.Xm.ComposeAssistance]:{composeAssistanceEnabled:!0},[o.Xm.CalendarSurfaceAddins]:{calendarSurfaceAddins:[]},[o.Xm.ExternalImages]:{externalImagesSelectedOption:0},[o.Xm.EventCapture]:{autoCollectionEnabled:!1},[o.Xm.Translation]:{translationMode:0,targetLanguage:"",excludedLanguages:[]},[o.Xm.CalendarSurfaceOptions]:{agendaPaneIsClosed:!1,lastKnownRoamingTimeZone:null,roamingTimeZoneNotificationsIsDisabled:!1,allDayWellHeight:0,numDaysInDayRange:1,workLifeView:3,timeScaleSetting:30,isDynamicColumnWidthEnabled:!0},[o.Xm.CalendarHelp]:{calendarHelpEnabled:!1},[o.Xm.LinkedInViewProfile]:{dismissed:!1},[o.Xm.Bohemia]:{bohemiaEnabled:(0,i.cr)("cmp-prague")},[o.Xm.GdprAdsV3]:{feature:o.Xm.GdprAdsV3,encodedTCString:null,allStoreAndAccessDevice:!1,allowDevelopAndImproveProduct:!1,allowPersonalisedAds:!1,allowPersonalisedAdsSelectBasicAd:!1,allowPersonalisedAdsApplyMarketResearch:!1,allowPersonalisedAdsMeasureContentPerformance:!1,allowPersonalisedAdsSelectPersonalisedAds:!1,allowPersonalisedAdsMeasureAdPerf:!1,allowPersonalisedAdsSelectPersonalisedContent:!1,allowPersonalisedAdsCreatePersonalisedContentProfile:!1,allowPersonalisedAdsCreatePersonalisedAdsProfile:!1,allowPreciseGeoDataAndIdentifyDevice:!1,allowPreciseGeoDataAndIdentifyDeviceScanDevice:!1,allowPreciseGeoDataAndIdentifyDeviceGeoData:!1,disselectedVendorId:[],selectedVendorId:[]},[o.Xm.Proofing]:{feature:o.Xm.Proofing,spellCheckEnabled:!0,grammarEnabled:!0,writingRefinementsEnabled:!0,proofingLocale:void 0,overriddenOptions:void 0,isTonalFreExperienceEnabled:!0,isEditorIndicatorEnabled:!0,isToneEnabledInEditorIndicator:!0,shouldShowIndicatorButton:!1},[o.Xm.ActiveProxyAddress]:{feature:o.Xm.ActiveProxyAddress,activeProxyAddresses:[]},[o.Xm.SxS]:{feature:o.Xm.SxS,hideReadingPane:!1,defaultEditCommand:o.Sp.EditInBrowser},[o.Xm.ReadingPaneConversation]:{feature:o.Xm.ReadingPaneConversation,conversationEnabled:!0,conversationEnabledNativeHost:!1},[o.Xm.ListViewColumnHeaders]:{feature:o.Xm.ListViewColumnHeaders,senderColumnWidth:332,subjectColumnWidth:1e3,receivedColumnWidth:(0,i.cr)("mon-tri-mailListItemHoverDeleteSlv")?215:80},[o.Xm.MailLayout]:{feature:o.Xm.MailLayout,useSingleLineMessageListWithRightReadingPane:!0,animationPreference:0},[o.Xm.Search]:{feature:o.Xm.Search,defaultSearchScope:0},[o.Xm.LgpdAds]:{feature:o.Xm.LgpdAds,optIn:!1,optInBit:0},[o.Xm.MicrosoftChoice]:{feature:o.Xm.MicrosoftChoice,optOut:!1},[o.Xm.StartUp]:{feature:o.Xm.StartUp,defaultReopenItems:0},[o.Xm.KeyboardShortcuts]:{feature:o.Xm.KeyboardShortcuts,keyboardShortcutsMode:o.$k.OutlookForWindows},[o.Xm.EmailHeaderContent]:{feature:o.Xm.EmailHeaderContent,inboxShoppingEnabled:!0},[o.Xm.PinnedPane]:{feature:o.Xm.PinnedPane,pinnedPane:o.U7.None},[o.Xm.EUEmailAds]:{feature:o.Xm.EUEmailAds,optInBit:0,hasSuggestNativeAdsDimissed:!1},[o.Xm.OfficeNeutralTheme]:{feature:o.Xm.OfficeNeutralTheme,isSelected:!1},[o.Xm.IsBusinessConsumer]:{feature:o.Xm.IsBusinessConsumer,isBusinessConsumer:!1},[o.Xm.EditorAutoFormat]:{feature:o.Xm.EditorAutoFormat,autoBulletEnabled:!0,autoFractionsEnabled:!0,autoHyphenEnabled:!0,autoNumberingEnabled:!0,autoOrdinalsEnabled:!0}}}},769367:(e,t,n)=>{"use strict";n.d(t,{Sp:()=>o.Sp,jd:()=>c.j,$k:()=>o.$k,Xm:()=>o.Xm,mI:()=>o.mI,jw:()=>l.Z,Bb:()=>o.Bb,mj:()=>c.m,mX:()=>u,tR:()=>m,OP:()=>h,fS:()=>p});var i=n(717420),r=n(134e3),o=n(308631),s=n(371134);const a=[o.Xm.SurfaceActions];(0,s._F)(r.E,(e=>{const t=e.defaultOptions;a.forEach((e=>{t[e]&&(0,o.xH)(Number(e),t[e])}))}));var l=n(524681),c=n(89834);const d=new i.nI((()=>n.e(97404).then(n.bind(n,597404)))),u=new i._5(d,(e=>e.createOrUpdateOptionsForFeature)),p=new i._5(d,(e=>e.updateAddinPinStatus)),m=(new i._5(d,(e=>e.updateAddInArray)),new i.EF(d,(e=>e.getServerOptionsForFeature))),h=new i._5(d,(e=>e.loadOptions))},89834:(e,t,n)=>{"use strict";n.d(t,{j:()=>i,m:()=>a});var i,r=n(371134);!function(e){e[e.OptionsNotLoaded=0]="OptionsNotLoaded",e[e.OptionsLoading=1]="OptionsLoading",e[e.OptionsLoaded=2]="OptionsLoaded"}(i||(i={}));const o={loadState:i.OptionsNotLoaded},s=(0,r.MT)("owsOptionsLoadStateStore",o)(),a=()=>s},73325:(e,t,n)=>{"use strict";n.d(t,{G2:()=>c,uY:()=>d,UG:()=>u});var i=n(325876),r=n(538362),o=n(964659),s=n(55461),a=n(226362),l=n(700842);function c(){const e=(0,i.ej)("targetServer"),t="DefaultAnchorMailbox"+(e?"_"+e.toLocaleLowerCase():"");return(0,i.ej)(t)}function d(){var e,t,n;let i=function(){let e="";const t=(0,r.I)().pathname.split("/").filter((e=>e.length));return t.length>=2&&t[1].match(/.+@.+/)&&(e=t[1]),e}();if(0===i.length){const r=(0,o.c6)();if((0,s.cr)("fwk-routingkey-makeservicerequest-usesmtp")&&!function(){var e,t;const n=(0,o.pX)((0,a.B6)()),i=null===(e=null==n?void 0:n.SessionSettings)||void 0===e?void 0:e.UserEmailAddress,r=null===(t=n.HexCID)||void 0===t?void 0:t.toUpperCase();if(!i||!r||!(0,l.U_)(r,i))return!1;return!0}()){const s=(0,o.pX)((0,a.B6)());let l=null===(e=null==s?void 0:s.SessionSettings)||void 0===e?void 0:e.UserEmailAddress;(null===(t=null==r?void 0:r.SessionSettings)||void 0===t?void 0:t.IsShadowMailbox)&&(l=null===(n=null==r?void 0:r.SessionSettings)||void 0===n?void 0:n.LogonEmailAddress),l&&(i=`SMTP:${l}`)}else if(null==r?void 0:r.SessionSettings){const e=r.SessionSettings.ExternalDirectoryTenantGuid,t=r.SessionSettings.UserPuid;t&&e&&(i=`PUID:${t}@${e}`)}}return 0===i.length&&(i=c()||""),i}function u(e){if(null==e||e.indexOf(":")>-1||-1==e.indexOf("@"))return e;return`SMTP:${e}`}},543047:(e,t,n)=>{"use strict";n.d(t,{S:()=>s});var i=n(55461),r=n(964659),o=n(593651);function s(){return(0,i.cr)("settings-privacySettings")&&(0,r.uf)()&&!(0,o.Z)().analyzeContentEnabled}},593651:(e,t,n)=>{"use strict";n.d(t,{b:()=>r,Z:()=>o});const i=(0,n(371134).MT)("privacyOption",{downloadContentEnabled:!0,analyzeContentEnabled:!0,optionalExperiencesEnabled:!0,optionalDiagnosticsDataEnabled:!0,isInitialized:!1})(),r=()=>i,o=r},276162:(e,t,n)=>{"use strict";n.d(t,{M:()=>y});var i=n(989526),r=n(46893),o=n(749146),s=n(354074),a=n(846681),l=n(71032),c=n(221066),d=n(156222),u=n(101060),p=n(843784),m=n(193310),h=n(92894),f=n(713728);function g(e,t,n){return new f.C(e).mix(new f.C(t),n).toHexString()}function v(){const e=(0,m.y$)(),t=(0,p.BR)();return i.useMemo((()=>{const n={10:(i=e).themeDarker,20:g(i.themeDarker,i.themeDark),30:i.themeDark,40:g(i.themeDark,i.themeDarkAlt),50:i.themeDarkAlt,60:g(i.themeDarkAlt,i.themePrimary),70:i.themePrimary,80:g(i.themePrimary,i.themeSecondary),90:i.themeSecondary,100:g(i.themeSecondary,i.themeTertiary),110:i.themeTertiary,120:g(i.themeTertiary,i.themeLight),130:i.themeLight,140:g(i.themeLight,i.themeLighter),150:i.themeLighter,160:g(i.themeLighter,i.themeLighterAlt)};var i;return(t?c.d:d.f)(n)}),[e,t])}const y=(0,h.Pi)((function({dir:e=((0,u.fI)()?"rtl":"ltr"),targetDocument:t=window.document,children:n}){const c=v(),d=i.useRef(null),{themeClassName:p}=(0,r.t)({theme:c,targetDocument:t},d),m=i.useMemo((()=>({dir:e,targetDocument:t})),[e,t]),h=i.useRef({});return i.createElement(o.a.Provider,{value:m},i.createElement(s.N.Provider,{value:c},i.createElement(a.$.Provider,{value:p},i.createElement(l.d.Provider,{value:h.current},n))))}))},48856:(e,t,n)=>{"use strict";n.d(t,{uy:()=>i.unmountComponentAtNode,jz:()=>i.createPortal,m$:()=>i.findDOMNode,MY:()=>r.M,sY:()=>o.s});var i=n(573961),r=n(276162),o=n(574972)},574972:(e,t,n)=>{"use strict";n.d(t,{s:()=>a});var i=n(573961),r=n(989526),o=n(55461),s=n(276162);const a=function(...[e,t,n]){const a=(0,o.cr)("fwk-fluent-v9")?r.createElement(s.M,null,e):e;return(0,i.render)(r.createElement(r.StrictMode,null,a),t,n)}},915818:(e,t,n)=>{"use strict";function i(e){return Object.assign({__type:"AddEntityFeedbackRequest:#Exchange"},e)}n.d(t,{Z:()=>i})},358713:(e,t,n)=>{"use strict";function i(e){return Object.assign({__type:"DistinguishedFolderId:#Exchange"},e)}n.d(t,{Z:()=>i})},899147:(e,t,n)=>{"use strict";function i(e){return Object.assign({__type:"FolderId:#Exchange"},e)}n.d(t,{Z:()=>i})},723999:(e,t,n)=>{"use strict";function i(e){return Object.assign({__type:"GetGroupInfoRequest:#Exchange"},e)}n.d(t,{Z:()=>i})},828747:(e,t,n)=>{"use strict";function i(e){return Object.assign({__type:"GetItemRequest:#Exchange"},e)}n.d(t,{Z:()=>i})},283491:(e,t,n)=>{"use strict";function i(e){return Object.assign({__type:"IndexedPageView:#Exchange"},e)}n.d(t,{Z:()=>i})},101194:(e,t,n)=>{"use strict";function i(e){return Object.assign({__type:"ItemId:#Exchange"},e)}n.d(t,{Z:()=>i})},402906:(e,t,n)=>{"use strict";function i(e){return Object.assign({__type:"ItemResponseShape:#Exchange"},e)}n.d(t,{Z:()=>i})},376982:(e,t,n)=>{"use strict";function i(e){return Object.assign({__type:"MaskAutoCompleteRecipientRequest:#Exchange"},e)}n.d(t,{Z:()=>i})},742130:(e,t,n)=>{"use strict";function i(e){return Object.assign({__type:"PropertyUri:#Exchange"},e)}n.d(t,{Z:()=>i})},802925:(e,t,n)=>{"use strict";function i(e,t){return e?Object.assign({mailboxInfo:e},t):null!=t?t:void 0}n.d(t,{Z:()=>i})},925967:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(398327);function r(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"AddEntityFeedbackJsonRequest:#Exchange"},n)),(0,i.S)("AddEntityFeedback",e,t)}},619165:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(398327),r=n(723999);function o(e,t){return void 0===e.getGroupInfoRequest||e.getGroupInfoRequest.__type||(e.getGroupInfoRequest=(0,r.Z)(e.getGroupInfoRequest)),(0,i.S)("GetGroupInfo",e,t)}},112178:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(398327);function r(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"GetItemJsonRequest:#Exchange"},n)),(0,i.S)("GetItem",e,t)}},628454:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(398327),r=n(376982);function o(e,t){return void 0===e||e.__type||(e=(0,r.Z)(e)),(0,i.S)("MaskAutoCompleteRecipient",e,t)}},493570:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(343665),r=n(866371);function o(e,t){if(!e){const e=new Error("DoesFolderIdEqualNameInvalidParameters");return(0,i.CZ)(e.message,{stack:e.stack}),!1}return(0,r.Z)(e)===t}},866371:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(116648);function r(e){var t;const n=(0,i.b)();return e&&(null===(t=n.defaultFolderIdToNameMap)||void 0===t?void 0:t.get(e))||"none"}},168462:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(226362),r=n(343665),o=n(386903),s=n(255022);function a(e,t){var n;if(!e){const e=new Error("FolderNameToIdInvalidParameters");return(0,r.CZ)(e.message,{stack:e.stack}),""}if(!(0,i.h1)()){const e=new Error("FolderNameToIdUninitializedAccountSourceListStore");return(0,r.CZ)(e.message,{stack:e.stack}),""}const a=(0,o.q)((0,s.r)(t)),l=null===(n=null==a?void 0:a.defaultFolderNameToIdMap)||void 0===n?void 0:n.get(e);return null!=l?l:""}},676186:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(552542),r=n(770085),o=n(33301);function s(e){const t=!e||(0,o.Z)(e)?(0,i.Z)():(0,r.Z)(e);return null==t?void 0:t.AttachmentPolicy}},945082:(e,t,n)=>{"use strict";n.d(t,{L:()=>a});var i=n(653798),r=n(420983),o=n(552542),s=n(954947);function a(){var e;if("1"===(0,r.mn)("isNewUser"))return!0;const t=(0,o.Z)(),n=t.MailboxCreateDate;return!!n&&Date.now()-new Date(n).getTime()<5184e6&&((0,s.Z)()||(0,i.OS)())&&!(null===(e=t.SessionSettings)||void 0===e?void 0:e.IsShadowMailbox)}},775390:(e,t,n)=>{"use strict";function i(e){return!e||0==e.trim().length}n.d(t,{T:()=>i})},582648:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});class i{constructor(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}add(e){this.taskList.unshift(e),this.scheduleTask()}clear(){this.taskList.splice(0,this.taskList.length)}canRunMoreTasks(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0}scheduleTask(){this.canRunMoreTasks()&&setTimeout((()=>{this.tryRunTask()}),this.taskDelay)}onTaskComplete(){this.numberOfTasksRunning--,this.scheduleTask()}tryRunTask(){if(this.canRunMoreTasks()){const e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then((()=>{this.onTaskComplete()})).catch((()=>{this.onTaskComplete()})),this.scheduleTask()}}}},582478:(e,t,n)=>{"use strict";function i(e){var t;const n=null===(t=null==e?void 0:e.split(" "))||void 0===t?void 0:t[0].toLowerCase();return"msauth1.0"==n||"bearer"==n?e:`Bearer ${e}`}n.d(t,{U:()=>i})},62267:(e,t,n)=>{"use strict";n.d(t,{uX:()=>L,jC:()=>Z,dF:()=>O,n8:()=>M,lV:()=>F});var i=n(554146),r=n(209984),o=n(857486);function s(e){return Object.assign({__type:"TokenRequest:#Exchange"},e)}var a=n(881886),l=n(398327);var c=n(219012),d=n(154394),u=n(325876),p=n(491925);var m=n(329746),h=n(55461),f=n(343665),g=n(582478),v=n(668630);const y="OWA_GetAccessTokenForResource",S=["requestnotcomplete","requesttimeout"];async function b(e,t,n,i,r,o,s,a,l){const h=await async function(e){var t,n;if((0,u.CQ)())return d.Ak.importAndExecute((0,c.P)());const i=(0,p.iE)(),r=i.getUserToken&&await i.getUserToken(void 0,e);if(r&&r.length>0){if("bearer"===(null===(t=null==r?void 0:r.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return r.split(" ")[1];if("msauth1.0"===(null===(n=null==r?void 0:r.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return r}}(a),f=(0,c.P)();if(h&&(e==f||e==f+"/"))return{AccessToken:h};if(e.toLowerCase().indexOf("/notificationchannel")>0||e.toLowerCase().indexOf("/outlookimageproxy.azurewebsites.net")>0)return I(e,t,n,!1,i,r,s,h,a,l);if((0,m.X)("resourceTokenFromHost")){const t=await(0,v.q)(e,o,a,l);if(t)return t}return I(e,t,n,!0,i,r,s,h,a,l)}async function I(e,t,n,i=!0,r,o,a,c,d,p){var m;const f={isUserActivity:!1,datapoint:{customData:{Scenario:y,Resource_Url:e,Retry_attempt:t,Request_Id:n,Target_Tenant_Id:o||"",Api:r||"",Scope:p||""},headersCustomData:e=>({TokenResultDetails:e.get("x-tokenresult")||"",ServerRequestId:e.get("request-id")||""}),jsonCustomData:e=>{var t;return{TokenStatus:(null===(t=null==e?void 0:e.TokenResultCode)||void 0===t?void 0:t.toString())||2}},datapointOptions:{isCore:"lamp152"==(null===(m=(0,u.y_)())||void 0===m?void 0:m.toLowerCase())||(0,h.cr)("auth-logAllDataPointForTokenFetching")}},returnFullResponseOnSuccess:!0,mailboxInfo:d};c&&(f.headers=new Headers,f.headers.set("authorization",(0,g.U)(c)));const v=s({Resource:e,TargetTenantId:o,PreferIdpToken:a});i&&(v.UserToken=c);const S=await function(e,t){return void 0===e||e.__type||(e=s(e)),(0,l.S)("GetAccessTokenforResource",e,t)}(v,f);return await S.json()}async function w(e,t,n,i,r,o,s,l,c,d,p){var m,g,v;return t<1?((0,f.CZ)(`${y}::MaxRetrialAttemptsReached`,{err:null!==(m=null==p?void 0:p.toString())&&void 0!==m?m:"",message:null!==(g=null==p?void 0:p.message)&&void 0!==g?g:"",stk:null!==(v=null==p?void 0:p.stack)&&void 0!==v?v:"",resource:e,requestId:i,apiName:null!=r?r:""},{isCore:(0,h.cr)("auth-logAllDataPointForTokenFetching")}),Promise.reject(p)):b(e,t,i,r,o,s,l,c,d).catch((p=>{var m,g,v,b;return(0,f.CZ)(`${y}::GetAccessTokenServerFetchError`,{err:null!==(m=null==p?void 0:p.toString())&&void 0!==m?m:"",message:null!==(g=null==p?void 0:p.message)&&void 0!==g?g:"",stk:null!==(v=null==p?void 0:p.stack)&&void 0!==v?v:"",resource:e,requestId:i,apiName:null!=r?r:""},{isCore:"lamp152"==(null===(b=(0,u.y_)())||void 0===b?void 0:b.toLowerCase())||(0,h.cr)("auth-logAllDataPointForTokenFetching")}),function(e){var t,n;const i=e,r=null!==(n=null===(t=null==i?void 0:i.fetchErrorType)||void 0===t?void 0:t.toLowerCase())&&void 0!==n?n:"";return-1==S.indexOf(r)}(p)?(0,a.Z)(n).then((()=>w(e,t-1,2*n,i,r,o,s,l,c,d,p))):Promise.reject(p)}))}var C=n(582648);let E;function P(e,t,n,i,r,o,s,a){return new Promise(((l,c)=>{(null==E&&(E=new C.Z(1,T,500)),E).add({onFulfilled:l,onRejected:c,resource:e,requestId:t,apiName:n,targetTenantId:i,wwwAuthenticateHeader:r,preferIdpToken:o,mailboxInfo:s,scope:a})}))}function T(e){return L(e.resource,e.apiName,e.requestId,e.targetTenantId,e.wwwAuthenticateHeader,e.preferIdpToken,e.mailboxInfo,e.scope,!0).then((t=>{e.onFulfilled(t)})).catch((t=>{e.onRejected(t)})),Promise.resolve()}var R=n(533746),x=n(462480),k=n(576378),N=n(226362),A=n(869358);let D=null;async function Z(e,t,n,i,r,o,s,a){n=n||(0,x.u)();let[l,c]=O(e,t,n,i,r,!1,o,s,a);return l||(l=await c),l}async function M(e,t,n,i,r,o,s,a){n=n||(0,x.u)();let[l,c]=O(e,t,n,i,r,!0,o,s,a);return l||(l=await c),l}function O(e,t,n,i,r,o,s,a,l){if((0,A.Z$)(e)){return[void 0,F(e,o).then((c=>{if(c)return c;{const[c,d]=_(e,t,n,i,r,o,s,a,l);return null!=c?c:d}}))]}return _(e,t,n,i,r,o,s,a,l)}async function F(e,t){const n=(0,p.iE)();var i=(null==n?void 0:n.getMsalToken)?await n.getMsalToken(e):await A.ju.importAndExecute(e);if(null==i?void 0:i.AccessToken)return t?(0,k.Z)(i):i.AccessToken}function _(e,t,n,i,o,s,a,l,c){n=n||(0,x.u)();const d=B(e,i,a,l,c);let u;if(o||(u=function(e,t){const n=e.get(t);let i;if((null==n?void 0:n.AccessTokenExpiry)&&n.AccessToken){(0,r.Z)(new Date(n.AccessTokenExpiry),-1)>new Date(Date.now())&&(i=n)}return i}(z(),d)),u)return[s?(0,k.Z)(u):u.AccessToken,void 0];{const r=(0,R.Al)(d);let u;return r?u=r:(u=P(e,n,t,i,o,a,l,c),(0,R.A9)(d,u)),[void 0,u.then((e=>((0,R.eS)(d),s?(0,k.Z)(e):e.AccessToken))).catch((r=>{(0,R.eS)(d),(0,f.CZ)(y,{category:"Promise_For_Token_Request_Failed",err:r?r.toString():"",message:r?r.message:"",stk:r?r.stack:"",resource:e,requestId:n,targetTenantId:i||"",api:t,wwwAuthenticateHeader:o||"",showFullTokenResponse:s||!1,scope:c||""},{isCore:(0,h.cr)("auth-logAllDataPointForTokenFetching")})}))]}}async function L(e,t,n,i,r,s,a,l,c){const d=c?await w(e,3,1500,n,t,i,r,s,a,l):await b(e,3,n,t,i,r,s,a,l);if(null!=d&&0==d.TokenResultCode&&null!=d.AccessTokenExpiry){d.ExpiresIn&&d.ExpiresIn>0&&(d.AccessTokenExpiry=(0,o.Z)(Date.now(),d.ExpiresIn).toISOString());const c=B(e,i,s,a),u=new Date(d.AccessTokenExpiry).getTime()-Date.now()-8e3;u>0&&z().put(c,d,u,(function(o){L(e,t,n,i,r,s,a,l,!1).catch((e=>{(0,f.CZ)(y,{category:"Cache_Expired",err:e?e.toString():"",message:e?e.message:"",stk:e?e.stack:"",resource:o,requestId:n,targetTenantId:i||"",api:t,wwwAuthenticateHeader:r||"",preferIdpToken:s,scope:l||""},{isCore:(0,h.cr)("auth-logAllDataPointForTokenFetching")})}))}))}return d}function z(){return null==D&&(D=new i.Cache),D}function B(e,t,n,i,r){let o=e;t&&(o+="|"+t),n&&(o+="|IdpToken");const s=i?(0,N.rS)(i):void 0;return s&&(o+="|"+s),r&&(o+="|"+r),o}},699110:(e,t,n)=>{"use strict";n.d(t,{AdalErrorCode:()=>N,MsalErrorCode:()=>W,getAccessTokenOnBehalfOfResource:()=>q,getAccessTokenforResource:()=>i.jC,getAccessTokenforResourceAsLazy:()=>i.dF,getDelegationTokenForOwa:()=>R,getFullAccessTokenResponseforResource:()=>i.n8});var i=n(62267),r=n(554146),o=n(533746),s=n(582648),a=n(485582),l=n(857486),c=n(343665),d=n(329746),u=n(219012),p=n(668630);const m="OWA_GetDelegationAccessToken",h={};function f(e){return(0,d.X)("resourceTokenFromHost")?async function(e){const t=await(0,p.q)((0,u.P)(),e.wwwAuthenticateHeader,e.mailboxInfo,e.scope);if(t)return t;return{}}(e):async function(e){const t=encodeURIComponent(e.client_id+e.scope+e.requestId);let n={};try{n=await async function(e,t,n){const i=function(e){const t={response_type:"token",prompt:"none",redirect_uri:e.redirect_uri,scope:e.scope,client_id:e.client_id};return e.authorization_uri+"?"+a.stringify(t)}(e);if(!t.document.getElementById(n)){const r=t.document.createElement("iframe");return r.src=i.toString(),r.style.display="none",r.id=n,t.document.body.appendChild(r),new Promise(((i,o)=>{h[n]=function(n){let s={};try{r.contentWindow&&r.contentWindow.location.host==t.location.host&&(s=function(e,t){var n;const i=a.parse(e),r={};i.access_token?(r.AccessToken=g(i.access_token),r.AccessTokenExpiry=(0,l.Z)(Date.now(),parseInt(null!==(n=g(i.expires_in))&&void 0!==n?n:"0")).toISOString(),r.TokenResultCode=0):"login_required"==i.error||"interaction_required"==i.error||"consent_required"==i.error?(r.TokenResultCode=3,(0,c.CZ)(m+" MSA Failure Unauthorized",{error:i.error,param:e,requestId:t})):(r.TokenResultCode=2,(0,c.CZ)(m+" MSA Failure",{error:g(i.error),param:e,requestId:t}));return r}(r.contentWindow.location.hash.substring(1),e.requestId))}catch(t){(0,c.CZ)(m+" Hash Param Parsing Failure ",{err:t.toString(),message:t.message,stk:t.stack||"",scope:e.scope,uri:e.redirect_uri,requestId:e.requestId}),s.TokenResultCode=2,o(s)}i(s)},r.addEventListener("load",h[n],!1)}))}return{TokenResultCode:2}}(e,window,t)}catch(e){n.TokenResultCode=2}finally{!function(e,t){var n=t.document.getElementById(e);null!=n&&(n.removeEventListener("load",h[e]),t.document.body.removeChild(n),delete h[e])}(t,window)}return n}(e)}function g(e){return Array.isArray(e)?e[0]:e}let v;function y(e){return new Promise(((t,n)=>{(null==v&&(v=new s.Z(3,S,1500)),v).add({onFulfilled:t,onRejected:n,options:e})}))}function S(e){return f(e.options).then((t=>{e.onFulfilled(t)})).catch((t=>{e.onRejected(t)})),Promise.resolve()}var b=n(462480),I=n(576378);let w=null;const C="OWA_GetDelegationAccessToken",E="https://login.live.com/oauth20_authorize.srf",P="/owa/auth/dt.aspx",T="292841";async function R(e,t,n,i,r){const s={scope:e,client_id:"",authorization_uri:"",redirect_uri:"",requestId:n||(0,b.u)(),mailboxInfo:r};let a;try{return a=await async function(e,t,n){const i=function(e){var t;return e.client_id+e.scope+((null===(t=e.mailboxInfo)||void 0===t?void 0:t.sourceId)||"")}(e),r=function(e,t){const n=e.get(t);let i;if(null==n?void 0:n.AccessTokenExpiry){new Date(n.AccessTokenExpiry)>new Date(Date.now())&&(i=n)}return i}(x(),i);if(null==r?void 0:r.AccessToken)return n?(0,I.Z)(r):r.AccessToken;{const r=(0,o.Al)(i);let s;return r?s=r:(s=y(e),(0,o.A9)(i,s)),s.then((e=>(function(e,t){if(t&&0==t.TokenResultCode&&t.AccessTokenExpiry){const n=new Date(t.AccessTokenExpiry).getTime()-Date.now();n>0&&x().put(e,t,n)}}(i,e),(0,o.eS)(i),n?(0,I.Z)(e):e.AccessToken))).catch((n=>{(0,o.eS)(i),(0,c.CZ)(C,{category:"Promise_For_Token_Request_Failed",err:n?n.toString():"",message:n?n.message:"",scope:e.scope,requestId:e.requestId,api:t})}))}}((l=s,l.redirect_uri=(0,u.P)()+P,l.authorization_uri=E,l.client_id=T,l),void 0,i),a}catch(n){return(0,c.CZ)("OWA_GetDelegationAccessToken GetDelegationToken Operation failed ",{err:n.toString(),message:n.message,stk:n.stack||"",scope:e,requestId:s.requestId,api:t}),a}var l}function x(){return null==w&&(w=new r.Cache),w}var k=n(491925);n(944293);const N={NoUserLogin:"AADSTS50058",InvalidResourceUrl:"AADSTS50001",NoPreAuth:"AADSTS65001",UserAborted:"AADSTS65004",NotConsent:"AADSTS70011"};function A(e,t,n,i,r){n?e.acquireTokenPopup(t,null,n,r):e.acquireToken(t,(function(n,o){!function(e,t){if(!e)return!1;if(e.indexOf(N.NoUserLogin)>=0)return!0;if(e.indexOf(N.NoPreAuth)>=0&&t)return!0;return!1}(n,i)?r(n,o):e.acquireTokenPopup(t,null,null,r)}))}var D=n(717420);const Z=new D.nI((()=>n.e(27311).then(n.bind(n,427311)))),M=new D._5(Z,(e=>e.createAdalAuthenticationContext));var O=n(751285);const F="adalIdTokenFrame";function _(e,t,n,i,r){e.config.displayCall=function(o){!function(e){if(-1==e.indexOf("?"))throw new Error("Invalid Url in Adal Auth Context Display Call")}(o),window.detectUserCachedCallback=((e,t,n,i,r)=>(o,s)=>{o||!s?r(o,null):(e.getCachedUser(),A(e,t,n,i,r))})(e,t,n,i,r),function(e,t){e._addAdalFrame(F).src="about:blank",e._loadFrame(t+"&prompt=none",F)}(e,o)},e.login()}var L=n(552542),z=n(964659),B=n(226362),V=n(462740),U=n(55461);async function q(e,t,n,i,r,o,s,a){const l=null!=a?a:(0,B.zl)();try{(0,d.X)("resourceTokenFromHost")?await async function(e,t,n,i,r,o){const s=(0,k.iE)();if(s.getResourceToken){const a=await s.getResourceToken(t,void 0,r,void 0,e,n,o);i((null==a?void 0:a.SubErrorCode)||null,(null==a?void 0:a.AccessToken)||null)}else i("Failed to acquire  token from host",null)}(e,n,r,o,l,i):(0,U.cr)("addin-msal")&&s?await V.TW.importAndExecute(e,t,n,i,r,s):await async function(e,t,n,i,r,o,s){var a,l;const c=await(0,O.Z)(),d=await M.importAndExecute(c,e,t),u=(0,L.Z)(),p=null===(a=u.SessionSettings)||void 0===a?void 0:a.UserPrincipalName,m=null===(l=(0,z.pX)(s).SessionSettings)||void 0===l?void 0:l.UserEmailAddress;d._user={profile:{upn:p||m}};d.getCachedUser()?A(d,n,i,r,o):_(d,n,i,r,o)}(e,t,n,i,r,o,l)}catch(e){(0,d.X)("resourceTokenFromHost")?o("Failed to acquire  token from host",null):(0,U.cr)("addin-msal")?null==s||s(e,null):o(e,null)}}const W={InvalidRequest:"invalid_request",NoTokenFound:"no_tokens_found",LoginRequired:"login_required",InteractionRequired:"interaction_required",ConsentRequired:"consent_required",MonitorWindowTimeout:"monitor_window_timeout",EndpointResolutionError:"endpoints_resolution_error",NoUserLogin:"AADSTS50058",InvalidResourceUrl:"AADSTS50001",NoPreAuth:"AADSTS65001",UserAborted:"AADSTS65004",NotConsent:"AADSTS70011"}},462740:(e,t,n)=>{"use strict";n.d(t,{d$:()=>o,TW:()=>s,LY:()=>a});var i=n(717420);const r=new i.nI((()=>Promise.all([n.e(77456),n.e(26362),n.e(77332)]).then(n.bind(n,493111)))),o=new i._5(r,(e=>e.getAccessTokenforResource)),s=new i._5(r,(e=>e.getAccessTokenOnBehalfOfResourceMsal)),a=new i._5(r,(e=>e.getTokenFromMsal))},576378:(e,t,n)=>{"use strict";function i(e){return{error:{subErrorCode:null==e?void 0:e.SubErrorCode},accessToken:null==e?void 0:e.AccessToken,accessTokenExpiry:null==e?void 0:e.AccessTokenExpiry,expiresIn:null==e?void 0:e.ExpiresIn}}n.d(t,{Z:()=>i})},751285:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(219769),r=n(802925);async function o(e){const t=await(0,i.Z)({},(0,r.Z)(e));let n;if(0===(null==t?void 0:t.ResultCode)&&(null==t?void 0:t.AuthenticationUrl)){const e=t.AuthenticationUrl.split("/");n=e[0]+"//"+e[2]+"/"}return n||"https://login.microsoftonline.com/"}},668630:(e,t,n)=>{"use strict";n.d(t,{q:()=>o});var i=n(311744),r=n(491925);async function o(e,t,n,o){var s;const a=(0,i.YG)()?(0,i.WZ)():void 0,l=(0,r.iE)(),c=null!==(s=null==a?void 0:a.getResourceToken)&&void 0!==s?s:l.getResourceToken;return await async function(){const e=(0,r.iE)();if(null==e?void 0:e.isResourceTokenPrefetchEnabled)return!0;const t=(0,i.YG)()?(0,i.WZ)():void 0;return!(!(null==t?void 0:t.isResourceTokenPrefetchEnabled)||!await t.isResourceTokenPrefetchEnabled())}()&&c?c(e,t,n,o):Promise.resolve(void 0)}},533746:(e,t,n)=>{"use strict";n.d(t,{Al:()=>s,eS:()=>a,A9:()=>l});var i=n(554146);let r=null;function o(){return null==r&&(r=new i.Cache),r}function s(e){return o().get(e)}function a(e){return o().del(e)}function l(e,t){o().put(e,t,9e4)}},930801:(e,t,n)=>{"use strict";n.d(t,{QZ:()=>s,Gv:()=>a,w_:()=>l,mn:()=>r.m});var i=n(717420),r=n(737657);const o=new i.nI((()=>n.e(50097).then(n.bind(n,850097)))),s=new i._5(o,(e=>e.tti)),a=new i._5(o,(e=>e.govern)),l=new i._5(o,(e=>e.enableGovernReport))},737657:(e,t,n)=>{"use strict";var i;n.d(t,{m:()=>i}),function(e){e[e.Framework=0]="Framework",e[e.Lightning=1]="Lightning",e[e.Notifications=2]="Notifications",e[e.SuiteHeader=3]="SuiteHeader",e[e.Inbox=4]="Inbox",e[e.Compose=5]="Compose",e[e.Analytics=6]="Analytics",e[e.Messages=7]="Messages",e[e.Calendar=8]="Calendar",e[e.Default=10]="Default",e[e.IdleInbox=11]="IdleInbox",e[e.IdleCompose=12]="IdleCompose",e[e.Idle=20]="Idle"}(i||(i={}))},938441:(e,t,n)=>{"use strict";var i,r,o,s,a,l,c,d;n.d(t,{py:()=>c}),(r=i||(i={})).show="show",r.hide="hide",r.toggle="toggle",(s=o||(o={})).none="none",s.flush="flush",s.forceFlush="forceFlush",s.new="new",s.extend="extend",(l=a||(a={})).create="create",l.default="default",l.view="view",l.list="list",l.info="info",l.delete="delete",l.signout="signout",l.updateProfilePicture="updateProfilePicture",l.updateDisplayName="updateDisplayName",(d=c||(c={})).identity="identity",d.teams_activity="teams_activity",d.teams_chat="teams_chat",d.teams_channel="teams_channel",d.teams_calendar="teams_calendar",d.teams_calling="teams_calling",d.teams_search="teams_search",d.teams_meet="teams_meet",d.outlook_mail="outlook_mail",d.outlook_calendar="outlook_calendar",d.outlook_people="outlook_people",d.outlook_groups="outlook_groups",d.outlook_fileshub="outlook_fileshub",d.outlook_tasks="outlook_tasks",d.m365_app="m365_app",d.m365_appsideload="m365_appsideload",d.m365_messageextension="m365_messageextension",d.office_home="office_home",d.office_create="office_create",d.office_mycontent="office_mycontent",d.office_feed="office_feed",d.office_gallery="office_gallery",d.office_spaces="office_spaces",d.office_outlook="office_outlook",d.office_teams="office_teams",d.office_word="office_word",d.office_excel="office_excel",d.office_powerpoint="office_powerpoint",d.office_onenote="office_onenote",d.office_sway="office_sway",d.office_forms="office_forms",d.office_visio="office_visio",d.office_stream="office_stream",d.office_onedrive="office_onedrive",d.office_todo="office_todo",d.office_familysafety="office_familysafety",d.office_calendar="office_calendar",d.office_skype="office_skype",d.office_people="office_people",d.office_powerautomate="office_powerautomate",d.office_admin="office_admin"},669438:(e,t,n)=>{"use strict";n.d(t,{zF:()=>i,xM:()=>r,To:()=>o,uL:()=>s,BK:()=>a,Wl:()=>l,hO:()=>c,Xc:()=>d,W9:()=>u,s4:()=>p,Kp:()=>m,$L:()=>h});const i="$sb",r="atb",o="btb",s="ctb",a="dtb",l="etb",c="ftb",d="gtb",u="htb",p="itb",m="jtb",h="ktb"},432147:(e,t,n)=>{"use strict";n.d(t,{Hj:()=>i,TC:()=>r,IF:()=>o});const i="MTb",r="NTb",o="OTb"},304113:(e,t,n)=>{"use strict";n.d(t,{vs:()=>i,t0:()=>r,xE:()=>o,yH:()=>s,IJ:()=>a,Vn:()=>l,EE:()=>c,vL:()=>d});const i="jBc",r="kBc",o="lBc",s="mBc",a="nBc",l="oBc",c="pBc",d="qBc"},219590:(e,t,n)=>{"use strict";n.d(t,{Yf:()=>i,ZJ:()=>r});const i="HQc",r="IQc"},440998:(e,t,n)=>{"use strict";n.d(t,{Ts:()=>i,Vy:()=>r,kr:()=>o,vG:()=>s});const i="v7a",r="w7a",o="x7a",s="y7a"},984047:(e,t,n)=>{"use strict";n.d(t,{lC:()=>i,kz:()=>r,yp:()=>o,ut:()=>s});const i="aib",r="bib",o="cib",s="dib"},908916:(e,t,n)=>{"use strict";n.d(t,{NJ:()=>i,nQ:()=>r});const i="Ykb",r="Zkb"},141737:(e,t,n)=>{"use strict";n.d(t,{u:()=>i});const i="H4c"},49516:(e,t,n)=>{"use strict";n.d(t,{N:()=>i});const i="imc"},705807:(e,t,n)=>{"use strict";n.d(t,{mT:()=>i,Zv:()=>r,rl:()=>o,IZ:()=>s,L5:()=>a,Y4:()=>l});const i="Ylc",r="Zlc",o="_lc",s="$lc",a="amc",l="bmc"},544879:(e,t,n)=>{"use strict";n.d(t,{XQ:()=>i,Mk:()=>r,o2:()=>o,PZ:()=>s,RF:()=>a,XD:()=>l});const i="ZUd",r="_Ud",o="$Ud",s="aVd",a="bVd",l="cVd"},194285:(e,t,n)=>{"use strict";n.d(t,{jg:()=>i,Sw:()=>r,eP:()=>o});const i="cTa",r="dTa",o="eTa"},485306:(e,t,n)=>{"use strict";n.d(t,{Gi:()=>i,oB:()=>r,Dv:()=>o,zH:()=>s,k_:()=>a,jH:()=>l,_i:()=>c});const i="L4c",r="M4c",o="N4c",s="O4c",a="P4c",l="Q4c",c="R4c"},833845:(e,t,n)=>{"use strict";n.d(t,{g:()=>i,Z:()=>r});const i="j6a",r={accCheckerMenuItemText:i}},555609:(e,t,n)=>{"use strict";n.d(t,{h:()=>i});const i="u5c"},332086:(e,t,n)=>{"use strict";n.d(t,{n:()=>i});const i="y$a"},762664:(e,t,n)=>{"use strict";n.d(t,{T:()=>i});const i="z$a"},112702:(e,t,n)=>{"use strict";n.d(t,{QV:()=>i,CY:()=>r});const i="k6a",r="l6a"},437302:(e,t,n)=>{"use strict";n.d(t,{F:()=>i});const i="mvb"},71548:(e,t,n)=>{"use strict";n.d(t,{t:()=>i});const i="M6a"},432050:(e,t,n)=>{"use strict";n.d(t,{Qb:()=>i,JO:()=>r,Dy:()=>o,Bm:()=>s,mc:()=>a,Bl:()=>l,ZP:()=>c});const i="E6a",r="F6a",o="G6a",s="H6a",a="I6a",l="J6a",c={composeEllipsisAriaLabelText:i,encryptMenuText:r,encryptDisableForwardingMenuText:o,hideFrom:s,switchToHTMLMenuItem:a,composePostButtonLabel:l}},985903:(e,t,n)=>{"use strict";n.d(t,{rS:()=>i,ZP:()=>r});const i="QPa",r={toolbarLabel:"MPa",singleLineRibbonLabel:"NPa",multiLineRibbonLabel:"OPa",layoutHeaderLabel:"PPa",ribbonLayoutButtonLabel:i,ribbonDisplayOptionsLabel:"RPa",showTabsOnly:"SPa",showTabsAndButtons:"TPa"}},656761:(e,t,n)=>{"use strict";n.d(t,{f:()=>i,Z:()=>r});const i="m6a",r={composeDiscardButton:i}},618459:(e,t,n)=>{"use strict";n.d(t,{Es:()=>i,YA:()=>r});const i="n6a",r="o6a"},649041:(e,t,n)=>{"use strict";n.d(t,{h:()=>i,Z:()=>r});const i="p6a",r={composeSendButton:i}},419739:(e,t,n)=>{"use strict";n.d(t,{J:()=>i});const i="qPa"},518295:(e,t,n)=>{"use strict";n.d(t,{w:()=>i,Z:()=>r});const i="rPa",r={deleteItem:i}},484982:(e,t,n)=>{"use strict";n.d(t,{z:()=>i});const i="LQc"},252936:(e,t,n)=>{"use strict";n.d(t,{c:()=>i});const i="fmc"},670366:(e,t,n)=>{"use strict";n.d(t,{U:()=>i});const i="MQc"},178815:(e,t,n)=>{"use strict";n.d(t,{W:()=>i});const i="gmc"},73263:(e,t,n)=>{"use strict";n.d(t,{e:()=>i});const i="NQc"},570338:(e,t,n)=>{"use strict";n.d(t,{e:()=>i});const i="OQc"},430647:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});const i="PQc"},781540:(e,t,n)=>{"use strict";n.d(t,{o:()=>i});const i="QQc"},115557:(e,t,n)=>{"use strict";n.d(t,{_B:()=>i,yg:()=>r});const i="VDa",r="WDa"},792236:(e,t,n)=>{"use strict";n.d(t,{C:()=>i});const i="sPa"},580712:(e,t,n)=>{"use strict";n.d(t,{m:()=>i});const i="gTa"},812842:(e,t,n)=>{"use strict";n.d(t,{K:()=>i});const i="v4c"},361822:(e,t,n)=>{"use strict";n.d(t,{J:()=>i});const i="nvb"},648767:(e,t,n)=>{"use strict";n.d(t,{X:()=>i,Z:()=>r});const i="q6a",r={highImportanceMenuText:i}},819310:(e,t,n)=>{"use strict";n.d(t,{I:()=>i});const i="V9a"},68405:(e,t,n)=>{"use strict";n.d(t,{a:()=>i});const i="v5c"},96392:(e,t,n)=>{"use strict";n.d(t,{I:()=>i});const i="r6a"},150748:(e,t,n)=>{"use strict";n.d(t,{J:()=>i});const i="w5c"},269121:(e,t,n)=>{"use strict";n.d(t,{p:()=>i});const i="x5c"},796206:(e,t,n)=>{"use strict";n.d(t,{$:()=>i});const i="tPa"},995339:(e,t,n)=>{"use strict";n.d(t,{w:()=>i});const i="y5c"},175407:(e,t,n)=>{"use strict";n.d(t,{F:()=>i});const i="z5c"},316557:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});const i="Gmb"},478868:(e,t,n)=>{"use strict";n.d(t,{H:()=>i});const i="uPa"},30509:(e,t,n)=>{"use strict";n.d(t,{g:()=>i});const i="vPa"},616206:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});const i="B$a"},886104:(e,t,n)=>{"use strict";n.d(t,{I:()=>i,Z:()=>r});const i="s6a",r={lowImportanceMenuText:i}},131521:(e,t,n)=>{"use strict";n.d(t,{WF:()=>i,S6:()=>r,TZ:()=>o,SY:()=>s,wj:()=>a});const i="zPa",r="APa",o="BPa",s="CPa",a="DPa"},522535:(e,t,n)=>{"use strict";n.d(t,{p:()=>i});const i="N6a"},359287:(e,t,n)=>{"use strict";n.d(t,{F:()=>i});const i="_Pa"},51778:(e,t,n)=>{"use strict";n.d(t,{Q:()=>i});const i="U9a"},265046:(e,t,n)=>{"use strict";n.d(t,{p:()=>i,Z:()=>r});const i="EPa",r={neverBlockSender:i}},717781:(e,t,n)=>{"use strict";n.d(t,{h:()=>i,Z:()=>r});const i="t6a",r={normalImportanceMenuText:i}},621483:(e,t,n)=>{"use strict";n.d(t,{r:()=>i});const i="mtb"},650222:(e,t,n)=>{"use strict";n.d(t,{v:()=>i,Z:()=>r});const i="dLa",r={okButton:i}},155313:(e,t,n)=>{"use strict";n.d(t,{D0:()=>i,UV:()=>r});const i="JQc",r="KQc"},138272:(e,t,n)=>{"use strict";n.d(t,{f:()=>i});const i="fTa"},857621:(e,t,n)=>{"use strict";n.d(t,{C:()=>i});const i="I$a"},322099:(e,t,n)=>{"use strict";n.d(t,{U:()=>i});const i="b6c"},43456:(e,t,n)=>{"use strict";n.d(t,{X:()=>i,Z:()=>r});const i="u6a",r={popoutsOpenInNewWindow:i}},930890:(e,t,n)=>{"use strict";n.d(t,{e:()=>i});const i="A5c"},126019:(e,t,n)=>{"use strict";n.d(t,{T:()=>i,Z:()=>r});const i="JPa",r={reportJunk:i}},28012:(e,t,n)=>{"use strict";n.d(t,{H:()=>i});const i="IPa"},196151:(e,t,n)=>{"use strict";n.d(t,{_:()=>i,Z:()=>r});const i="KPa",r={reportPhishing:i}},487845:(e,t,n)=>{"use strict";n.d(t,{D:()=>i});const i="v6a"},161161:(e,t,n)=>{"use strict";n.d(t,{F:()=>i});const i="hTa"},879022:(e,t,n)=>{"use strict";n.d(t,{q:()=>i});const i="S9a"},979716:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});const i="w6a"},791499:(e,t,n)=>{"use strict";n.d(t,{LH:()=>i,Ou:()=>r,VP:()=>o,ZP:()=>s});const i="x6a",r="y6a",o="z6a",s={sensitivityMenuText:i,clpLabelDropDownLearnMoreButtonText:r,clpLabelDropDownLearnMoreButtonToolTipText:o}},813869:(e,t,n)=>{"use strict";n.d(t,{a:()=>i,Z:()=>r});const i="A6a",r={setImportance:i}},4755:(e,t,n)=>{"use strict";n.d(t,{M:()=>i,Z:()=>r});const i="B6a",r={showFrom:i}},602015:(e,t,n)=>{"use strict";n.d(t,{K:()=>i});const i="L$a"},610040:(e,t,n)=>{"use strict";n.d(t,{S:()=>i,Z:()=>r});const i="C6a",r={showMessageOptions:i}},681009:(e,t,n)=>{"use strict";n.d(t,{H:()=>i});const i="W9a"},735403:(e,t,n)=>{"use strict";n.d(t,{P7:()=>i,Kz:()=>r,bF:()=>o});const i="iTa",r="jTa",o="kTa"},700252:(e,t,n)=>{"use strict";n.d(t,{A:()=>i,Z:()=>r});const i="D6a",r={switchToPlainTextMenuItem:i}},774744:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},143786:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(924077),r=n(772831),o=Object.prototype.hasOwnProperty;const s=function(e,t,n){var s=e[t];o.call(e,t)&&(0,r.Z)(s,n)&&(void 0!==n||t in e)||(0,i.Z)(e,t,n)}},924077:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(613819);const r=function(e,t,n){"__proto__"==t&&i.Z?(0,i.Z)(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},135651:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(859996),r=n(463479),o=n(104161);const s=function(e,t){return(0,o.Z)((0,r.Z)(e,t,i.Z),e+"")}},7172:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(143786),r=n(924077);const o=function(e,t,n,o){var s=!n;n||(n={});for(var a=-1,l=t.length;++a<l;){var c=t[a],d=o?o(n[c],e[c],c,n,e):void 0;void 0===d&&(d=e[c]),s?(0,r.Z)(n,c,d):(0,i.Z)(n,c,d)}return n}},813774:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(135651),r=n(115974);const o=function(e){return(0,i.Z)((function(t,n){var i=-1,o=n.length,s=o>1?n[o-1]:void 0,a=o>2?n[2]:void 0;for(s=e.length>3&&"function"==typeof s?(o--,s):void 0,a&&(0,r.Z)(n[0],n[1],a)&&(s=o<3?void 0:s,o=1),t=Object(t);++i<o;){var l=n[i];l&&e(t,l,i,s)}return t}))}},613819:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(700613);const r=function(){try{var e=(0,i.Z)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}()},115974:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(772831),r=n(50641),o=n(356423),s=n(996288);const a=function(e,t,n){if(!(0,s.Z)(n))return!1;var a=typeof t;return!!("number"==a?(0,r.Z)(n)&&(0,o.Z)(t,n.length):"string"==a&&t in n)&&(0,i.Z)(n[t],e)}},463479:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(774744),r=Math.max;const o=function(e,t,n){return t=r(void 0===t?e.length-1:t,0),function(){for(var o=arguments,s=-1,a=r(o.length-t,0),l=Array(a);++s<a;)l[s]=o[t+s];s=-1;for(var c=Array(t+1);++s<t;)c[s]=o[s];return c[t]=n(l),(0,i.Z)(e,this,c)}}},104161:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});const i=function(e){return function(){return e}};var r=n(613819),o=n(859996);const s=r.Z?function(e,t){return(0,r.Z)(e,"toString",{configurable:!0,enumerable:!1,value:i(t),writable:!0})}:o.Z;const a=(0,n(734593).Z)(s)},734593:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=Date.now;const r=function(e){var t=0,n=0;return function(){var r=i(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},563474:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var i=n(7172),r=n(813774),o=n(771879);const s=(0,r.Z)((function(e,t,n,r){(0,i.Z)(t,(0,o.Z)(t),e,r)}))},336934:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(996288),r=n(185042),o=n(126919),s=Math.max,a=Math.min;const l=function(e,t,n){var l,c,d,u,p,m,h=0,f=!1,g=!1,v=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var n=l,i=c;return l=c=void 0,h=t,u=e.apply(i,n)}function S(e){return h=e,p=setTimeout(I,t),f?y(e):u}function b(e){var n=e-m;return void 0===m||n>=t||n<0||g&&e-h>=d}function I(){var e=(0,r.Z)();if(b(e))return w(e);p=setTimeout(I,function(e){var n=t-(e-m);return g?a(n,d-(e-h)):n}(e))}function w(e){return p=void 0,v&&l?y(e):(l=c=void 0,u)}function C(){var e=(0,r.Z)(),n=b(e);if(l=arguments,c=this,m=e,n){if(void 0===p)return S(m);if(g)return clearTimeout(p),p=setTimeout(I,t),y(m)}return void 0===p&&(p=setTimeout(I,t)),u}return t=(0,o.Z)(t)||0,(0,i.Z)(n)&&(f=!!n.leading,d=(g="maxWait"in n)?s((0,o.Z)(n.maxWait)||0,t):d,v="trailing"in n?!!n.trailing:v),C.cancel=function(){void 0!==p&&clearTimeout(p),h=0,l=m=c=p=void 0},C.flush=function(){return void 0===p?u:w((0,r.Z)())},C}},859996:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i=function(e){return e}},662816:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(948460),r=n(325197);const o=function(e){return"symbol"==typeof e||(0,r.Z)(e)&&"[object Symbol]"==(0,i.Z)(e)}},185042:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var i=n(857649);const r=function(){return i.Z.Date.now()}},126919:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var i=/\s/;const r=function(e){for(var t=e.length;t--&&i.test(e.charAt(t)););return t};var o=/^\s+/;const s=function(e){return e?e.slice(0,r(e)+1).replace(o,""):e};var a=n(996288),l=n(662816),c=/^[-+]0x[0-9a-f]+$/i,d=/^0b[01]+$/i,u=/^0o[0-7]+$/i,p=parseInt;const m=function(e){if("number"==typeof e)return e;if((0,l.Z)(e))return NaN;if((0,a.Z)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=(0,a.Z)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=s(e);var n=d.test(e);return n||u.test(e)?p(e.slice(2),n?2:8):c.test(e)?NaN:+e}}},e=>{Object.assign(e.sriHashes,{10022:"sha384-OneEG/HUG+q1cBdM0niHqd9n8EdE5FINiCKfx+KJHGejy3Vc2GJ0jtooAJjX+A4Q",14238:"sha384-x+BcchpxjwXllcHGAHscBN/G6s2JwMCq2Nj+Xaxih8zxzgGzd+/Bly0xUiUQFjID",14922:"sha384-FfOZ+sEBXORh8SznKjo04k+82Z9kiDOmEcwJw845PnpLHA6QRrOVa+835O6oyhxP",17218:"sha384-OPJxWLEmwPjjZkiOLtZIrfOo6AR/vsmPoz5mZXn4z/+UEgFLJiLxMc5+oOfC6ocg",18358:"sha384-igceOCYAfllmmf4H1jqmPc3O9GoAhLNq73INsuyTCaLza+uOvp3Id/i+hs21QvVw",20287:"sha384-6rnODX7umOlqx4dyjP7kTxii8SqEVED3UcJ5EXW3TV3bxuUKTyd4PSb4jqDwSuq+",21939:"sha384-zXjBQUFCGxUB1gb7l1wsPjdAbJTty2AuIawGuQ8D1vdeRUsa57tkJA1Df31ZY6JX",22013:"sha384-zcyFGK2NlSKkC7ocelbcJDmO0MusAnqF/ufq54TGakg/kopKMgZql53DYicL2ZDw",24134:"sha384-0UQIpEGU6k9xnccTllv0n5WRJich0z5jxey3P6Wj0dk2XFIOeTTkmJ4TC3DLa9Ge",27311:"sha384-0eNHIFYsD6RnW3PKziWqrkEV1XhhUhQIYE/Y9RuJwr4oZPHYV99ddG8RUNetsvhp",29810:"sha384-eDdcGcRki1ffsQTuVxqFo4H9FiLUFPnb/ymkBPYUtIitWfbnuEwr21H3cy2jdAaO",32130:"sha384-NLpLwkaYtdPUE/7KPTbGWtjBPGh4idwKt5qOclhobheg6mWY61xs/tJHPqbrH+uO",33388:"sha384-XMcUYkk8BFSkxUlQfP6VjoeUm95xTxBkXXniFG2pwUB7+dl2d2EegMikSn6e6Q4X",33777:"sha384-vnB92FvRPlkvLLOqBwplq7E72pqaRx6dv6oETHxTyS88EnWmAy03ynhy10K4vbdy",39154:"sha384-5MttwipKK6NFFWgfMRDROonfJSslSmR0UWb9Az30/yIis1OWUuEaak3MjWmgkacq",41504:"sha384-amz3H5ofYYOmeONVop1vMEXJmgRXY46p7wUcPqzhckUEvQGsk9S1WCrVE3GrTNTv",44910:"sha384-BWVW4N6uRtATPdgWqHbsnuHFeOECuXMj/ps4QvPOxW7Qhc7eaGE3g6o0MQNT2LYp",47319:"sha384-5GrPPBZumtosOJCoqoQbK3xLJmrmPVPie8T/aqCXVXMod9cDKCAJ8cmtygY8YMH8",50093:"sha384-Z8rheZ7KOXj1zxkmr51hyxXmO5qGC7Ng5XbdqVsbS9rA9fg0eOC+eYbQtaH/v7vz",50097:"sha384-MR0eEgigWBO7WLZYeUMx3jSAWZOTc3KsPu6PjKTeEa1BAsNCLbx7mnoQ18nUJzH2",52295:"sha384-OstJ3xZxgmMXhqQWY9vBDMNcvrUUxe+RCEtFqV5f7TAFFkfMA0J00jFyrdP+alpe",58600:"sha384-jOKOTqXUdITxiy7alSvY2lCTxVHZgq+bC9l/kQmnYsTJoq3Ib/aODbOzIkpsVVOV",62462:"sha384-Qvnu5bgqdSYqO5vVslsGHFJppJ+ZVdwF2pPs5hO4ZphD6qnYHb8r/UrsPXELoEzd",70529:"sha384-sR2+WoM5UlFjIq2us9oJKgxV9QKNZrHTtf81dwr9T2aiwY11HOGXkN35ctj2fJ6b",72940:"sha384-u9qxcsPJDK60PqKRKhbBgZFQwy/03p8ymCMMu+4nf721hR2rLc6jNJI1gNFMW41x",75126:"sha384-WsabKZQA9a2SoLIAWqi24uQT1KYME0fgQECTqXczy2v05LnNnn1ZVpR+C5xXcvY2",78276:"sha384-BR8w5vLrfcPou6fPDqyiHesCbEEx8bULWr4xOo866GnLBaCid1Ajp1rvsojvNcsw",80300:"sha384-HOMgkYEDjg1nKGNMcP2dPV7e0WRjxwwEzAQohwI9PzKBmHe+vKALr99RhEKzT6Ae",81237:"sha384-1lHh1ccLMW0ZfjdfNbe2Txr/svcHOnW5rxeFiwQJdVBxb6+2i71I++uTGm48MuIr",83809:"sha384-tO0ZAuWp13zqKxEY1ZUqbIQF5C8E3fgwXrRw1qXo6YHirVqKk0hccxNO788Wuxxv",85267:"sha384-m4ASFSqnd1zyI5fowX7FlK47wvlYFIsSwZLlLAmgausb7Kz23rJJTiEWHlAzfcmF",86656:"sha384-2nyxl0iPbW6tMSnDujk8Mv926p9xwT0scOh4LzRCsOBV7ZaUEOnz8kSQeGjX205K",94319:"sha384-cCUTfX/mgK6v4JyQ3QAdxUEwsrMD23BmUGIDlHlkpw8yJbt4e0023Yysc0mXsKUv"})}]),self.scriptsLoaded=self.scriptsLoaded||{},self.scriptsLoaded["owa.MailCompose.js"]=1;